!function(){"use strict";function t(t,e){L[t]=e}function e(t){return L[t]}function n(t,e){F[t]=e}function r(t){return F[t]}function i(t,e){return e={exports:{}},t(e,e.exports),e.exports}function o(t,e){this.x=t||0,this.y=e||0}function s(){var t=100,e=0,n=document.createElement("div");n.id="stats",n.style.cssText="width:80px;opacity:0.9;cursor:pointer";var r=document.createElement("div");r.id="ms",r.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;",n.appendChild(r);var i=document.createElement("div");i.id="msText",i.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",i.innerHTML="Memory",r.appendChild(i);var o=document.createElement("div");for(o.id="msGraph",o.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",r.appendChild(o);o.children.length<74;){var s=document.createElement("span");s.style.cssText="width:1px;height:30px;float:left;background-color:#131",o.appendChild(s)}var u=function(t,e,n){var r=t.appendChild(t.firstChild);r.style.height=e+"px",n&&(r.style.backgroundColor=n)};window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0}),0===performance.memory.totalJSHeapSize&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var a=Date.now(),l=performance.memory.usedJSHeapSize;return{domElement:n,update:function(){function n(t,e){var n=["Bytes","KB","MB","GB","TB"];if(0==t)return"n/a";e=void 0!==e?e:0;var r=Math.pow(10,e),i=Math.floor(Math.log(t)/Math.log(1024));return Math.round(t*r/Math.pow(1024,i))/r+" "+n[i]}if(!(Date.now()-a<1e3/30)){a=Date.now();var r=performance.memory.usedJSHeapSize-l;l=performance.memory.usedJSHeapSize;var s=r<0?"#830":"#131",c=performance.memory.usedJSHeapSize;t=Math.min(t,c),e=Math.max(e,c),i.textContent="Mem: "+n(c,2);var h=c/31457280,f=30*(1-h%1);u(o,f,s)}}}}function u(t,e){it[t]=e}function a(t){return it[t]}function l(t,e,n,r,i,o,s,u){this.maxObjects=10,this.maxLevels=4,this.level=0,this.bounds={},this.objects=[],this.nodes=[],this._empty=[],this.root=u||this,this.entityMap={},this.reset(t,e,n,r,i,o,s)}function c(t,e,n,r,i,o,s,u,a){Wt.insert({Sprite:{name:"asteroid",size:n},Health:{max:a},Collidable:{},Bounce:{mass:u},Position:{x:t,y:e},Motion:{dx:i,dy:o,drotation:s}})}function h(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:40,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:200,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:10,l=new o(e,t),h=new o(0,0),f=new o(0,0),d=[],p=0;p<r;p++)for(var _=0;_<i;_++){var v=V.random(s,u),g=4*Math.PI*Math.random();h.setValues(l.x,l.y-V.random(1,n)),h.rotateAround(l,g);for(var m=!0,y=0;y<d.length;y++){var b=d[y];if(!(2*Math.abs(h.x-b.x)>=1.025*(v+b.width)||2*Math.abs(h.y-b.y)>=1.025*(v+b.height))){m=!1;break}}if(m){d.push({x:h.x,y:h.y,width:v,height:v}),f.setValues(0,Math.random()*a),f.rotate(g),c(h.x,h.y,v,v,f.x,f.y,.25*Math.PI*Math.random(),4*v*v,4*v*v);break}}}function f(){setTimeout(function(){var t=-1400,e=1500*Math.random()-750;Wt.insert({Sprite:{name:"enemyscout",color:"#f00",size:40},Collidable:{},Bounce:{mass:2500},Position:{x:t,y:e},Thruster:{deltaV:1200,maxV:500,active:!0},Steering:{radPerSec:1*Math.PI,seekTargetName:"hero1"},Motion:{},Expiration:{ttl:Gt}})},3e3*Math.random())}var d=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},p=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),_=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},v=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(r)},g=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},m=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},y=60,b=1e3/y,w=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,1e3/60)},x=void 0,k=void 0,E=void 0,C=void 0,S=void 0,A=void 0,T=void 0,O=void 0,M=void 0,P=void 0,j=void 0,R=void 0,I=void 0,z={ENTITY_INSERT:"entity_insert",ENTITY_DESTROY:"entity_destroy"},N=function(){function t(e){var n=this;d(this,t),e=e||{},this.isRunning=!1,this.isPaused=!1,this.debug=!1,this.systems={},e.systems&&this.addSystems(e.systems),this.store={},this.subscribers={},this.tickDuration=b,this.maxTickDelta=5*b,this.tickAccumulator=0,this.lastTickTime=0,this.lastDrawTime=0,this.boundTickLoop=function(){return n.tickLoop()},this.boundDrawLoop=function(t){return n.drawLoop(t)},this.reset()}return p(t,[{key:"start",value:function(){if(!this.isRunning){this.isRunning=!0;for(var t in this.systems)this.systems[t].initialize();return this.lastTickTime=Date.now(),this.lastDrawTime=0,setTimeout(this.boundTickLoop,this.tickDuration),w(this.boundDrawLoop),this}}},{key:"stop",value:function(){return this.isRunning=!1,this}},{key:"pause",value:function(){return this.isPaused=!0,this}},{key:"resume",value:function(){return this.isPaused=!1,this}},{key:"reset",value:function(){this.store={},this.lastEntityId=0}},{key:"subscribe",value:function(t,e){return this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push(e),this}},{key:"unsubscribe",value:function(){return this}},{key:"publish",value:function(t,e){if(this.subscribers[t]){for(j=0,I;I=this.subscribers[t][j];j++)I(t,e);return this}}},{key:"addSystems",value:function(t){for(E in t)C=t[E],S=r(E),k=new S(C),k.setWorld(this),this.systems[E]=k}},{key:"getSystem",value:function(t){return this.systems[t]}},{key:"tick",value:function(t){O=t/1e3;for(E in this.systems)this.systems[E].updateStart(O);for(E in this.systems)this.systems[E].update(O);for(E in this.systems)this.systems[E].updateEnd(O)}},{key:"tickLoop",value:function(){if(T=Date.now(),O=Math.min(T-this.lastTickTime,this.maxTickDelta),this.lastTickTime=T,!this.isPaused)for(this.tickAccumulator+=O;this.tickAccumulator>this.tickDuration;)this.tick(this.tickDuration),this.tickAccumulator-=this.tickDuration;this.isRunning&&setTimeout(this.boundTickLoop,this.tickDuration)}},{key:"draw",value:function(t){O=t/1e3;for(E in this.systems)this.systems[E].drawStart(O);for(E in this.systems)this.systems[E].draw(O);for(E in this.systems)this.systems[E].drawEnd(O)}},{key:"drawLoop",value:function(t){this.lastDrawTime||(this.lastDrawTime=t),O=t-this.lastDrawTime,this.lastDrawTime=t,this.isPaused||this.draw(O),this.isRunning&&w(this.boundDrawLoop)}},{key:"generateEntityId",value:function(){return++this.lastEntityId}},{key:"insert",value:function(){for(var t=[],e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];for(j=0;R=n[j];j++){x=this.generateEntityId();for(A in R)M=R[A],this.addComponent(x,A,M);this.world&&this.world.publish(z.ENTITY_INSERT,x),t.push(x)}return t.length>1?t:t[0]}},{key:"destroy",value:function(t){this.world&&this.world.publish(z.ENTITY_DESTROY,t);for(A in this.store)this.removeComponent(t,A)}},{key:"addComponent",value:function(t,n,r){var i=e(n),o=i.create(r);this.store[n]||(this.store[n]={}),this.store[n][t]=o}},{key:"removeComponent",value:function(t,e){t in this.store[e]&&delete this.store[e][t]}},{key:"hasComponent",value:function(t,e){return e in this.store&&t in this.store[e]}},{key:"get",value:function(t,e){return this.store[t]?e?this.store[t][e]:this.store[t]:null}}]),t}(),B=function(){function t(){d(this,t)}return p(t,null,[{key:"defaults",value:function(){return{}}},{key:"create",value:function(t){return _({},this.defaults(),t||{})}}]),t}(),D=function(){function t(e){d(this,t),this.options=_({},this.defaultOptions(),e||{}),this.debug=this.options.debug||!1}return p(t,[{key:"defaultOptions",value:function(){return{}}},{key:"setWorld",value:function(t){this.world=t}},{key:"matchComponent",value:function(){return""}},{key:"initialize",value:function(){}},{key:"getMatchingComponents",value:function(){return this.world.get(this.matchComponent())}},{key:"updateStart",value:function(){}},{key:"update",value:function(t){P=this.getMatchingComponents();for(x in P)this.updateComponent(t,x,P[x])}},{key:"updateComponent",value:function(){}},{key:"updateEnd",value:function(){}},{key:"drawStart",value:function(){}},{key:"draw",value:function(){}},{key:"getDebugGraphics",value:function(){return this.world.debug?(this.viewportSystem||(this.viewportSystem=this.world.getSystem(this.options.viewportSystemName||"ViewportPixi"),this.gDebug=new PIXI.Graphics,this.viewportSystem.stage.addChild(this.gDebug),this.gDebug.position.x=0,this.gDebug.position.y=0),this.gDebug.clear(),this.gDebug.visible=!0,this.gDebug):void(this.gDebug&&(this.gDebug.visible=!1))}},{key:"drawEnd",value:function(){}}]),t}(),L={},F={},H="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},V=i(function(t,e){(function(){function n(t,e){return t.set(e[0],e[1]),t}function r(t,e){return t.add(e),t}function i(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function o(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var s=t[i];e(r,s,n(s),t)}return r}function s(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}function u(t,e){for(var n=null==t?0:t.length;n--&&e(t[n],n,t)!==!1;);return t}function a(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function l(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}function c(t,e){var n=null==t?0:t.length;return!!n&&w(t,e,0)>-1}function h(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function f(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function d(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function p(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function _(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function v(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function g(t){return t.split("")}function m(t){return t.match(He)||[]}function y(t,e,n){var r;return n(t,function(t,n,i){if(e(t,n,i))return r=n,!1}),r}function b(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function w(t,e,n){return e===e?K(t,e,n):b(t,k,n)}function x(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function k(t){return t!==t}function E(t,e){var n=null==t?0:t.length;return n?O(t,e)/n:zt}function C(t){return function(e){return null==e?nt:e[t]}}function S(t){return function(e){return null==t?nt:t[e]}}function A(t,e,n,r,i){return i(t,function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)}),n}function T(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}function O(t,e){for(var n,r=-1,i=t.length;++r<i;){var o=e(t[r]);o!==nt&&(n=n===nt?o:n+o)}return n}function M(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function P(t,e){return f(e,function(e){return[e,t[e]]})}function j(t){return function(e){return t(e)}}function R(t,e){return f(e,function(e){return t[e]})}function I(t,e){return t.has(e)}function z(t,e){for(var n=-1,r=t.length;++n<r&&w(e,t[n],0)>-1;);return n}function N(t,e){for(var n=t.length;n--&&w(e,t[n],0)>-1;);return n}function B(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}function D(t){return"\\"+tr[t]}function L(t,e){return null==t?nt:t[e]}function F(t){return Gn.test(t)}function V(t){return Xn.test(t)}function W(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function U(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function G(t,e){return function(n){return t(e(n))}}function X(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n];s!==e&&s!==lt||(t[n]=lt,o[i++]=n)}return o}function Y(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}function q(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}function K(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}function $(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}function J(t){return F(t)?Z(t):gr(t)}function Q(t){return F(t)?tt(t):g(t)}function Z(t){for(var e=Wn.lastIndex=0;Wn.test(t);)++e;return e}function tt(t){return t.match(Wn)||[]}function et(t){return t.match(Un)||[]}var nt,rt="4.17.4",it=200,ot="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",st="Expected a function",ut="__lodash_hash_undefined__",at=500,lt="__lodash_placeholder__",ct=1,ht=2,ft=4,dt=1,pt=2,_t=1,vt=2,gt=4,mt=8,yt=16,bt=32,wt=64,xt=128,kt=256,Et=512,Ct=30,St="...",At=800,Tt=16,Ot=1,Mt=2,Pt=3,jt=1/0,Rt=9007199254740991,It=1.7976931348623157e308,zt=NaN,Nt=4294967295,Bt=Nt-1,Dt=Nt>>>1,Lt=[["ary",xt],["bind",_t],["bindKey",vt],["curry",mt],["curryRight",yt],["flip",Et],["partial",bt],["partialRight",wt],["rearg",kt]],Ft="[object Arguments]",Ht="[object Array]",Vt="[object AsyncFunction]",Wt="[object Boolean]",Ut="[object Date]",Gt="[object DOMException]",Xt="[object Error]",Yt="[object Function]",qt="[object GeneratorFunction]",Kt="[object Map]",$t="[object Number]",Jt="[object Null]",Qt="[object Object]",Zt="[object Promise]",te="[object Proxy]",ee="[object RegExp]",ne="[object Set]",re="[object String]",ie="[object Symbol]",oe="[object Undefined]",se="[object WeakMap]",ue="[object WeakSet]",ae="[object ArrayBuffer]",le="[object DataView]",ce="[object Float32Array]",he="[object Float64Array]",fe="[object Int8Array]",de="[object Int16Array]",pe="[object Int32Array]",_e="[object Uint8Array]",ve="[object Uint8ClampedArray]",ge="[object Uint16Array]",me="[object Uint32Array]",ye=/\b__p \+= '';/g,be=/\b(__p \+=) '' \+/g,we=/(__e\(.*?\)|\b__t\)) \+\n'';/g,xe=/&(?:amp|lt|gt|quot|#39);/g,ke=/[&<>"']/g,Ee=RegExp(xe.source),Ce=RegExp(ke.source),Se=/<%-([\s\S]+?)%>/g,Ae=/<%([\s\S]+?)%>/g,Te=/<%=([\s\S]+?)%>/g,Oe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Me=/^\w*$/,Pe=/^\./,je=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Re=/[\\^$.*+?()[\]{}|]/g,Ie=RegExp(Re.source),ze=/^\s+|\s+$/g,Ne=/^\s+/,Be=/\s+$/,De=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Le=/\{\n\/\* \[wrapped with (.+)\] \*/,Fe=/,? & /,He=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ve=/\\(\\)?/g,We=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ue=/\w*$/,Ge=/^[-+]0x[0-9a-f]+$/i,Xe=/^0b[01]+$/i,Ye=/^\[object .+?Constructor\]$/,qe=/^0o[0-7]+$/i,Ke=/^(?:0|[1-9]\d*)$/,$e=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Je=/($^)/,Qe=/['\n\r\u2028\u2029\\]/g,Ze="\\ud800-\\udfff",tn="\\u0300-\\u036f",en="\\ufe20-\\ufe2f",nn="\\u20d0-\\u20ff",rn=tn+en+nn,on="\\u2700-\\u27bf",sn="a-z\\xdf-\\xf6\\xf8-\\xff",un="\\xac\\xb1\\xd7\\xf7",an="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ln="\\u2000-\\u206f",cn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",hn="A-Z\\xc0-\\xd6\\xd8-\\xde",fn="\\ufe0e\\ufe0f",dn=un+an+ln+cn,pn="['’]",_n="["+Ze+"]",vn="["+dn+"]",gn="["+rn+"]",mn="\\d+",yn="["+on+"]",bn="["+sn+"]",wn="[^"+Ze+dn+mn+on+sn+hn+"]",xn="\\ud83c[\\udffb-\\udfff]",kn="(?:"+gn+"|"+xn+")",En="[^"+Ze+"]",Cn="(?:\\ud83c[\\udde6-\\uddff]){2}",Sn="[\\ud800-\\udbff][\\udc00-\\udfff]",An="["+hn+"]",Tn="\\u200d",On="(?:"+bn+"|"+wn+")",Mn="(?:"+An+"|"+wn+")",Pn="(?:"+pn+"(?:d|ll|m|re|s|t|ve))?",jn="(?:"+pn+"(?:D|LL|M|RE|S|T|VE))?",Rn=kn+"?",In="["+fn+"]?",zn="(?:"+Tn+"(?:"+[En,Cn,Sn].join("|")+")"+In+Rn+")*",Nn="\\d*(?:(?:1st|2nd|3rd|(?![123])\\dth)\\b)",Bn="\\d*(?:(?:1ST|2ND|3RD|(?![123])\\dTH)\\b)",Dn=In+Rn+zn,Ln="(?:"+[yn,Cn,Sn].join("|")+")"+Dn,Fn="(?:"+[En+gn+"?",gn,Cn,Sn,_n].join("|")+")",Hn=RegExp(pn,"g"),Vn=RegExp(gn,"g"),Wn=RegExp(xn+"(?="+xn+")|"+Fn+Dn,"g"),Un=RegExp([An+"?"+bn+"+"+Pn+"(?="+[vn,An,"$"].join("|")+")",Mn+"+"+jn+"(?="+[vn,An+On,"$"].join("|")+")",An+"?"+On+"+"+Pn,An+"+"+jn,Bn,Nn,mn,Ln].join("|"),"g"),Gn=RegExp("["+Tn+Ze+rn+fn+"]"),Xn=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Yn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],qn=-1,Kn={};Kn[ce]=Kn[he]=Kn[fe]=Kn[de]=Kn[pe]=Kn[_e]=Kn[ve]=Kn[ge]=Kn[me]=!0,Kn[Ft]=Kn[Ht]=Kn[ae]=Kn[Wt]=Kn[le]=Kn[Ut]=Kn[Xt]=Kn[Yt]=Kn[Kt]=Kn[$t]=Kn[Qt]=Kn[ee]=Kn[ne]=Kn[re]=Kn[se]=!1;var $n={};$n[Ft]=$n[Ht]=$n[ae]=$n[le]=$n[Wt]=$n[Ut]=$n[ce]=$n[he]=$n[fe]=$n[de]=$n[pe]=$n[Kt]=$n[$t]=$n[Qt]=$n[ee]=$n[ne]=$n[re]=$n[ie]=$n[_e]=$n[ve]=$n[ge]=$n[me]=!0,$n[Xt]=$n[Yt]=$n[se]=!1;var Jn={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},Qn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},tr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},er=parseFloat,nr=parseInt,rr="object"==typeof H&&H&&H.Object===Object&&H,ir="object"==typeof self&&self&&self.Object===Object&&self,or=rr||ir||Function("return this")(),sr="object"==typeof e&&e&&!e.nodeType&&e,ur=sr&&"object"==typeof t&&t&&!t.nodeType&&t,ar=ur&&ur.exports===sr,lr=ar&&rr.process,cr=function(){try{return lr&&lr.binding&&lr.binding("util")}catch(t){}}(),hr=cr&&cr.isArrayBuffer,fr=cr&&cr.isDate,dr=cr&&cr.isMap,pr=cr&&cr.isRegExp,_r=cr&&cr.isSet,vr=cr&&cr.isTypedArray,gr=C("length"),mr=S(Jn),yr=S(Qn),br=S(Zn),wr=function t(e){function g(t){if(la(t)&&!wf(t)&&!(t instanceof K)){if(t instanceof H)return t;if(bc.call(t,"__wrapped__"))return ss(t)}return new H(t)}function S(){}function H(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=nt}function K(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Nt,this.__views__=[]}function Z(){var t=new K(this.__wrapped__);return t.__actions__=Fi(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Fi(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Fi(this.__views__),t}function tt(){if(this.__filtered__){var t=new K(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function He(){var t=this.__wrapped__.value(),e=this.__dir__,n=wf(t),r=e<0,i=n?t.length:0,o=Mo(0,i,this.__views__),s=o.start,u=o.end,a=u-s,l=r?u:s-1,c=this.__iteratees__,h=c.length,f=0,d=$c(a,this.__takeCount__);if(!n||!r&&i==a&&d==a)return wi(t,this.__actions__);var p=[];t:for(;a--&&f<d;){l+=e;for(var _=-1,v=t[l];++_<h;){var g=c[_],m=g.iteratee,y=g.type,b=m(v);if(y==Mt)v=b;else if(!b){if(y==Ot)continue t;break t}}p[f++]=v}return p}function Ze(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function tn(){this.__data__=sh?sh(null):{},this.size=0}function en(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function nn(t){var e=this.__data__;if(sh){var n=e[t];return n===ut?nt:n}return bc.call(e,t)?e[t]:nt}function rn(t){var e=this.__data__;return sh?e[t]!==nt:bc.call(e,t)}function on(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=sh&&e===nt?ut:e,this}function sn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function un(){this.__data__=[],this.size=0}function an(t){var e=this.__data__,n=Rn(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():Ic.call(e,n,1),--this.size,!0}function ln(t){var e=this.__data__,n=Rn(e,t);return n<0?nt:e[n][1]}function cn(t){return Rn(this.__data__,t)>-1}function hn(t,e){var n=this.__data__,r=Rn(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function fn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function dn(){this.size=0,this.__data__={hash:new Ze,map:new(nh||sn),string:new Ze}}function pn(t){var e=So(this,t).delete(t);return this.size-=e?1:0,e}function _n(t){return So(this,t).get(t)}function vn(t){return So(this,t).has(t)}function gn(t,e){var n=So(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function mn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new fn;++e<n;)this.add(t[e])}function yn(t){return this.__data__.set(t,ut),this}function bn(t){return this.__data__.has(t)}function wn(t){var e=this.__data__=new sn(t);this.size=e.size}function xn(){this.__data__=new sn,this.size=0}function kn(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function En(t){return this.__data__.get(t)}function Cn(t){return this.__data__.has(t)}function Sn(t,e){var n=this.__data__;if(n instanceof sn){var r=n.__data__;if(!nh||r.length<it-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new fn(r)}return n.set(t,e),this.size=n.size,this}function An(t,e){var n=wf(t),r=!n&&bf(t),i=!n&&!r&&kf(t),o=!n&&!r&&!i&&Tf(t),s=n||r||i||o,u=s?M(t.length,dc):[],a=u.length;for(var l in t)!e&&!bc.call(t,l)||s&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Do(l,a))||u.push(l);return u}function Tn(t){var e=t.length;return e?t[ni(0,e-1)]:nt}function On(t,e){return ns(Fi(t),Ln(e,0,t.length))}function Mn(t){return ns(Fi(t))}function Pn(t,e,n){(n===nt||Ku(t[e],n))&&(n!==nt||e in t)||Bn(t,e,n)}function jn(t,e,n){var r=t[e];bc.call(t,e)&&Ku(r,n)&&(n!==nt||e in t)||Bn(t,e,n)}function Rn(t,e){for(var n=t.length;n--;)if(Ku(t[n][0],e))return n;return-1}function In(t,e,n,r){return mh(t,function(t,i,o){e(r,t,n(t),o)}),r}function zn(t,e){return t&&Hi(e,Ua(e),t)}function Nn(t,e){return t&&Hi(e,Ga(e),t)}function Bn(t,e,n){"__proto__"==e&&Dc?Dc(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function Dn(t,e){for(var n=-1,r=e.length,i=sc(r),o=null==t;++n<r;)i[n]=o?nt:Ha(t,e[n]);return i}function Ln(t,e,n){return t===t&&(n!==nt&&(t=t<=n?t:n),e!==nt&&(t=t>=e?t:e)),t}function Fn(t,e,n,r,i,o){var u,a=e&ct,l=e&ht,c=e&ft;if(n&&(u=i?n(t,r,i,o):n(t)),u!==nt)return u;if(!aa(t))return t;var h=wf(t);if(h){if(u=Ro(t),!a)return Fi(t,u)}else{var f=Mh(t),d=f==Yt||f==qt;if(kf(t))return Ti(t,a);if(f==Qt||f==Ft||d&&!i){if(u=l||d?{}:Io(t),!a)return l?Wi(t,Nn(u,t)):Vi(t,zn(u,t))}else{if(!$n[f])return i?t:{};u=zo(t,f,Fn,a)}}o||(o=new wn);var p=o.get(t);if(p)return p;o.set(t,u);var _=c?l?xo:wo:l?Ga:Ua,v=h?nt:_(t);return s(v||t,function(r,i){v&&(i=r,r=t[i]),jn(u,i,Fn(r,e,n,i,t,o))}),u}function Wn(t){var e=Ua(t);return function(n){return Un(n,t,e)}}function Un(t,e,n){var r=n.length;if(null==t)return!r;for(t=hc(t);r--;){var i=n[r],o=e[i],s=t[i];if(s===nt&&!(i in t)||!o(s))return!1}return!0}function Gn(t,e,n){if("function"!=typeof t)throw new pc(st);return Rh(function(){t.apply(nt,n)},e)}function Xn(t,e,n,r){var i=-1,o=c,s=!0,u=t.length,a=[],l=e.length;if(!u)return a;n&&(e=f(e,j(n))),r?(o=h,s=!1):e.length>=it&&(o=I,s=!1,e=new mn(e));t:for(;++i<u;){var d=t[i],p=null==n?d:n(d);if(d=r||0!==d?d:0,s&&p===p){for(var _=l;_--;)if(e[_]===p)continue t;a.push(d)}else o(e,p,r)||a.push(d)}return a}function Jn(t,e){var n=!0;return mh(t,function(t,r,i){return n=!!e(t,r,i)}),n}function Qn(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],s=e(o);if(null!=s&&(u===nt?s===s&&!ba(s):n(s,u)))var u=s,a=o}return a}function Zn(t,e,n,r){var i=t.length;for(n=Sa(n),n<0&&(n=-n>i?0:i+n),r=r===nt||r>i?i:Sa(r),r<0&&(r+=i),r=n>r?0:Aa(r);n<r;)t[n++]=e;return t}function tr(t,e){var n=[];return mh(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n}function rr(t,e,n,r,i){var o=-1,s=t.length;for(n||(n=Bo),i||(i=[]);++o<s;){var u=t[o];e>0&&n(u)?e>1?rr(u,e-1,n,r,i):d(i,u):r||(i[i.length]=u)}return i}function ir(t,e){return t&&bh(t,e,Ua)}function sr(t,e){return t&&wh(t,e,Ua)}function ur(t,e){return l(e,function(e){return oa(t[e])})}function lr(t,e){e=Si(e,t);for(var n=0,r=e.length;null!=t&&n<r;)t=t[rs(e[n++])];return n&&n==r?t:nt}function cr(t,e,n){var r=e(t);return wf(t)?r:d(r,n(t))}function gr(t){return null==t?t===nt?oe:Jt:Bc&&Bc in hc(t)?Oo(t):$o(t)}function wr(t,e){return t>e}function kr(t,e){return null!=t&&bc.call(t,e)}function Er(t,e){return null!=t&&e in hc(t)}function Cr(t,e,n){return t>=$c(e,n)&&t<Kc(e,n)}function Sr(t,e,n){for(var r=n?h:c,i=t[0].length,o=t.length,s=o,u=sc(o),a=1/0,l=[];s--;){var d=t[s];s&&e&&(d=f(d,j(e))),a=$c(d.length,a),u[s]=!n&&(e||i>=120&&d.length>=120)?new mn(s&&d):nt}d=t[0];var p=-1,_=u[0];t:for(;++p<i&&l.length<a;){var v=d[p],g=e?e(v):v;if(v=n||0!==v?v:0,!(_?I(_,g):r(l,g,n))){for(s=o;--s;){var m=u[s];if(!(m?I(m,g):r(t[s],g,n)))continue t}_&&_.push(g),l.push(v)}}return l}function Ar(t,e,n,r){return ir(t,function(t,i,o){e(r,n(t),i,o)}),r}function Tr(t,e,n){e=Si(e,t),t=Qo(t,e);var r=null==t?t:t[rs(Cs(e))];return null==r?nt:i(r,t,n)}function Or(t){return la(t)&&gr(t)==Ft}function Mr(t){return la(t)&&gr(t)==ae}function Pr(t){return la(t)&&gr(t)==Ut}function jr(t,e,n,r,i){return t===e||(null==t||null==e||!la(t)&&!la(e)?t!==t&&e!==e:Rr(t,e,n,r,jr,i))}function Rr(t,e,n,r,i,o){var s=wf(t),u=wf(e),a=s?Ht:Mh(t),l=u?Ht:Mh(e);a=a==Ft?Qt:a,l=l==Ft?Qt:l;var c=a==Qt,h=l==Qt,f=a==l;if(f&&kf(t)){if(!kf(e))return!1;s=!0,c=!1}if(f&&!c)return o||(o=new wn),s||Tf(t)?go(t,e,n,r,i,o):mo(t,e,a,n,r,i,o);if(!(n&dt)){var d=c&&bc.call(t,"__wrapped__"),p=h&&bc.call(e,"__wrapped__");if(d||p){var _=d?t.value():t,v=p?e.value():e;return o||(o=new wn),i(_,v,n,r,o)}}return!!f&&(o||(o=new wn),yo(t,e,n,r,i,o))}function Ir(t){return la(t)&&Mh(t)==Kt}function zr(t,e,n,r){var i=n.length,o=i,s=!r;if(null==t)return!o;for(t=hc(t);i--;){var u=n[i];if(s&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<o;){u=n[i];var a=u[0],l=t[a],c=u[1];if(s&&u[2]){if(l===nt&&!(a in t))return!1}else{var h=new wn;if(r)var f=r(l,c,a,t,e,h);if(!(f===nt?jr(c,l,dt|pt,r,h):f))return!1}}return!0}function Nr(t){if(!aa(t)||Wo(t))return!1;var e=oa(t)?Sc:Ye;return e.test(is(t))}function Br(t){return la(t)&&gr(t)==ee}function Dr(t){return la(t)&&Mh(t)==ne}function Lr(t){return la(t)&&ua(t.length)&&!!Kn[gr(t)]}function Fr(t){return"function"==typeof t?t:null==t?Il:"object"==typeof t?wf(t)?Xr(t[0],t[1]):Gr(t):Vl(t)}function Hr(t){if(!Uo(t))return qc(t);var e=[];for(var n in hc(t))bc.call(t,n)&&"constructor"!=n&&e.push(n);return e}function Vr(t){if(!aa(t))return Ko(t);var e=Uo(t),n=[];for(var r in t)("constructor"!=r||!e&&bc.call(t,r))&&n.push(r);return n}function Wr(t,e){return t<e}function Ur(t,e){var n=-1,r=$u(t)?sc(t.length):[];return mh(t,function(t,i,o){r[++n]=e(t,i,o)}),r}function Gr(t){var e=Ao(t);return 1==e.length&&e[0][2]?Xo(e[0][0],e[0][1]):function(n){return n===t||zr(n,t,e)}}function Xr(t,e){return Fo(t)&&Go(e)?Xo(rs(t),e):function(n){var r=Ha(n,t);return r===nt&&r===e?Wa(n,t):jr(e,r,dt|pt)}}function Yr(t,e,n,r,i){t!==e&&bh(e,function(o,s){if(aa(o))i||(i=new wn),qr(t,e,s,n,Yr,r,i);else{var u=r?r(t[s],o,s+"",t,e,i):nt;u===nt&&(u=o),Pn(t,s,u)}},Ga)}function qr(t,e,n,r,i,o,s){var u=t[n],a=e[n],l=s.get(a);if(l)return void Pn(t,n,l);var c=o?o(u,a,n+"",t,e,s):nt,h=c===nt;if(h){var f=wf(a),d=!f&&kf(a),p=!f&&!d&&Tf(a);c=a,f||d||p?wf(u)?c=u:Ju(u)?c=Fi(u):d?(h=!1,c=Ti(a,!0)):p?(h=!1,c=zi(a,!0)):c=[]:ga(a)||bf(a)?(c=u,bf(u)?c=Oa(u):(!aa(u)||r&&oa(u))&&(c=Io(a))):h=!1}h&&(s.set(a,c),i(c,a,r,o,s),s.delete(a)),Pn(t,n,c)}function Kr(t,e){var n=t.length;if(n)return e+=e<0?n:0,Do(e,n)?t[e]:nt}function $r(t,e,n){var r=-1;e=f(e.length?e:[Il],j(Co()));var i=Ur(t,function(t,n,i){var o=f(e,function(e){return e(t)});return{criteria:o,index:++r,value:t}});return T(i,function(t,e){return Bi(t,e,n)})}function Jr(t,e){return Qr(t,e,function(e,n){return Wa(t,n)})}function Qr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],u=lr(t,s);n(u,s)&&ai(o,Si(s,t),u)}return o}function Zr(t){return function(e){return lr(e,t)}}function ti(t,e,n,r){var i=r?x:w,o=-1,s=e.length,u=t;for(t===e&&(e=Fi(e)),n&&(u=f(t,j(n)));++o<s;)for(var a=0,l=e[o],c=n?n(l):l;(a=i(u,c,a,r))>-1;)u!==t&&Ic.call(u,a,1),Ic.call(t,a,1);return t}function ei(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;Do(i)?Ic.call(t,i,1):mi(t,i)}}return t}function ni(t,e){return t+Wc(Zc()*(e-t+1))}function ri(t,e,n,r){for(var i=-1,o=Kc(Vc((e-t)/(n||1)),0),s=sc(o);o--;)s[r?o:++i]=t,t+=n;return s}function ii(t,e){var n="";if(!t||e<1||e>Rt)return n;do e%2&&(n+=t),e=Wc(e/2),e&&(t+=t);while(e);return n}function oi(t,e){return Ih(Jo(t,e,Il),t+"")}function si(t){return Tn(rl(t))}function ui(t,e){var n=rl(t);return ns(n,Ln(e,0,n.length))}function ai(t,e,n,r){if(!aa(t))return t;e=Si(e,t);for(var i=-1,o=e.length,s=o-1,u=t;null!=u&&++i<o;){var a=rs(e[i]),l=n;if(i!=s){var c=u[a];l=r?r(c,a,u):nt,l===nt&&(l=aa(c)?c:Do(e[i+1])?[]:{})}jn(u,a,l),u=u[a]}return t}function li(t){return ns(rl(t))}function ci(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=sc(i);++r<i;)o[r]=t[r+e];return o}function hi(t,e){var n;return mh(t,function(t,r,i){return n=e(t,r,i),!n}),!!n}function fi(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e===e&&i<=Dt){for(;r<i;){var o=r+i>>>1,s=t[o];null!==s&&!ba(s)&&(n?s<=e:s<e)?r=o+1:i=o}return i}return di(t,e,Il,n)}function di(t,e,n,r){e=n(e);for(var i=0,o=null==t?0:t.length,s=e!==e,u=null===e,a=ba(e),l=e===nt;i<o;){var c=Wc((i+o)/2),h=n(t[c]),f=h!==nt,d=null===h,p=h===h,_=ba(h);if(s)var v=r||p;else v=l?p&&(r||f):u?p&&f&&(r||!d):a?p&&f&&!d&&(r||!_):!d&&!_&&(r?h<=e:h<e);v?i=c+1:o=c}return $c(o,Bt)}function pi(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n],u=e?e(s):s;if(!n||!Ku(u,a)){var a=u;o[i++]=0===s?0:s}}return o}function _i(t){
return"number"==typeof t?t:ba(t)?zt:+t}function vi(t){if("string"==typeof t)return t;if(wf(t))return f(t,vi)+"";if(ba(t))return vh?vh.call(t):"";var e=t+"";return"0"==e&&1/t==-jt?"-0":e}function gi(t,e,n){var r=-1,i=c,o=t.length,s=!0,u=[],a=u;if(n)s=!1,i=h;else if(o>=it){var l=e?null:Sh(t);if(l)return Y(l);s=!1,i=I,a=new mn}else a=e?[]:u;t:for(;++r<o;){var f=t[r],d=e?e(f):f;if(f=n||0!==f?f:0,s&&d===d){for(var p=a.length;p--;)if(a[p]===d)continue t;e&&a.push(d),u.push(f)}else i(a,d,n)||(a!==u&&a.push(d),u.push(f))}return u}function mi(t,e){return e=Si(e,t),t=Qo(t,e),null==t||delete t[rs(Cs(e))]}function yi(t,e,n,r){return ai(t,e,n(lr(t,e)),r)}function bi(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?ci(t,r?0:o,r?o+1:i):ci(t,r?o+1:0,r?i:o)}function wi(t,e){var n=t;return n instanceof K&&(n=n.value()),p(e,function(t,e){return e.func.apply(e.thisArg,d([t],e.args))},n)}function xi(t,e,n){var r=t.length;if(r<2)return r?gi(t[0]):[];for(var i=-1,o=sc(r);++i<r;)for(var s=t[i],u=-1;++u<r;)u!=i&&(o[i]=Xn(o[i]||s,t[u],e,n));return gi(rr(o,1),e,n)}function ki(t,e,n){for(var r=-1,i=t.length,o=e.length,s={};++r<i;){var u=r<o?e[r]:nt;n(s,t[r],u)}return s}function Ei(t){return Ju(t)?t:[]}function Ci(t){return"function"==typeof t?t:Il}function Si(t,e){return wf(t)?t:Fo(t,e)?[t]:zh(Pa(t))}function Ai(t,e,n){var r=t.length;return n=n===nt?r:n,!e&&n>=r?t:ci(t,e,n)}function Ti(t,e){if(e)return t.slice();var n=t.length,r=Mc?Mc(n):new t.constructor(n);return t.copy(r),r}function Oi(t){var e=new t.constructor(t.byteLength);return new Oc(e).set(new Oc(t)),e}function Mi(t,e){var n=e?Oi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Pi(t,e,r){var i=e?r(U(t),ct):U(t);return p(i,n,new t.constructor)}function ji(t){var e=new t.constructor(t.source,Ue.exec(t));return e.lastIndex=t.lastIndex,e}function Ri(t,e,n){var i=e?n(Y(t),ct):Y(t);return p(i,r,new t.constructor)}function Ii(t){return _h?hc(_h.call(t)):{}}function zi(t,e){var n=e?Oi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ni(t,e){if(t!==e){var n=t!==nt,r=null===t,i=t===t,o=ba(t),s=e!==nt,u=null===e,a=e===e,l=ba(e);if(!u&&!l&&!o&&t>e||o&&s&&a&&!u&&!l||r&&s&&a||!n&&a||!i)return 1;if(!r&&!o&&!l&&t<e||l&&n&&i&&!r&&!o||u&&n&&i||!s&&i||!a)return-1}return 0}function Bi(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,s=i.length,u=n.length;++r<s;){var a=Ni(i[r],o[r]);if(a){if(r>=u)return a;var l=n[r];return a*("desc"==l?-1:1)}}return t.index-e.index}function Di(t,e,n,r){for(var i=-1,o=t.length,s=n.length,u=-1,a=e.length,l=Kc(o-s,0),c=sc(a+l),h=!r;++u<a;)c[u]=e[u];for(;++i<s;)(h||i<o)&&(c[n[i]]=t[i]);for(;l--;)c[u++]=t[i++];return c}function Li(t,e,n,r){for(var i=-1,o=t.length,s=-1,u=n.length,a=-1,l=e.length,c=Kc(o-u,0),h=sc(c+l),f=!r;++i<c;)h[i]=t[i];for(var d=i;++a<l;)h[d+a]=e[a];for(;++s<u;)(f||i<o)&&(h[d+n[s]]=t[i++]);return h}function Fi(t,e){var n=-1,r=t.length;for(e||(e=sc(r));++n<r;)e[n]=t[n];return e}function Hi(t,e,n,r){var i=!n;n||(n={});for(var o=-1,s=e.length;++o<s;){var u=e[o],a=r?r(n[u],t[u],u,n,t):nt;a===nt&&(a=t[u]),i?Bn(n,u,a):jn(n,u,a)}return n}function Vi(t,e){return Hi(t,Th(t),e)}function Wi(t,e){return Hi(t,Oh(t),e)}function Ui(t,e){return function(n,r){var i=wf(n)?o:In,s=e?e():{};return i(n,t,Co(r,2),s)}}function Gi(t){return oi(function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:nt,s=i>2?n[2]:nt;for(o=t.length>3&&"function"==typeof o?(i--,o):nt,s&&Lo(n[0],n[1],s)&&(o=i<3?nt:o,i=1),e=hc(e);++r<i;){var u=n[r];u&&t(e,u,r,o)}return e})}function Xi(t,e){return function(n,r){if(null==n)return n;if(!$u(n))return t(n,r);for(var i=n.length,o=e?i:-1,s=hc(n);(e?o--:++o<i)&&r(s[o],o,s)!==!1;);return n}}function Yi(t){return function(e,n,r){for(var i=-1,o=hc(e),s=r(e),u=s.length;u--;){var a=s[t?u:++i];if(n(o[a],a,o)===!1)break}return e}}function qi(t,e,n){function r(){var e=this&&this!==or&&this instanceof r?o:t;return e.apply(i?n:this,arguments)}var i=e&_t,o=Ji(t);return r}function Ki(t){return function(e){e=Pa(e);var n=F(e)?Q(e):nt,r=n?n[0]:e.charAt(0),i=n?Ai(n,1).join(""):e.slice(1);return r[t]()+i}}function $i(t){return function(e){return p(Ol(ll(e).replace(Hn,"")),t,"")}}function Ji(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=gh(t.prototype),r=t.apply(n,e);return aa(r)?r:n}}function Qi(t,e,n){function r(){for(var s=arguments.length,u=sc(s),a=s,l=Eo(r);a--;)u[a]=arguments[a];var c=s<3&&u[0]!==l&&u[s-1]!==l?[]:X(u,l);if(s-=c.length,s<n)return lo(t,e,eo,r.placeholder,nt,u,c,nt,nt,n-s);var h=this&&this!==or&&this instanceof r?o:t;return i(h,this,u)}var o=Ji(t);return r}function Zi(t){return function(e,n,r){var i=hc(e);if(!$u(e)){var o=Co(n,3);e=Ua(e),n=function(t){return o(i[t],t,i)}}var s=t(e,n,r);return s>-1?i[o?e[s]:s]:nt}}function to(t){return bo(function(e){var n=e.length,r=n,i=H.prototype.thru;for(t&&e.reverse();r--;){var o=e[r];if("function"!=typeof o)throw new pc(st);if(i&&!s&&"wrapper"==ko(o))var s=new H([],!0)}for(r=s?r:n;++r<n;){o=e[r];var u=ko(o),a="wrapper"==u?Ah(o):nt;s=a&&Vo(a[0])&&a[1]==(xt|mt|bt|kt)&&!a[4].length&&1==a[9]?s[ko(a[0])].apply(s,a[3]):1==o.length&&Vo(o)?s[u]():s.thru(o)}return function(){var t=arguments,r=t[0];if(s&&1==t.length&&wf(r))return s.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}})}function eo(t,e,n,r,i,o,s,u,a,l){function c(){for(var g=arguments.length,m=sc(g),y=g;y--;)m[y]=arguments[y];if(p)var b=Eo(c),w=B(m,b);if(r&&(m=Di(m,r,i,p)),o&&(m=Li(m,o,s,p)),g-=w,p&&g<l){var x=X(m,b);return lo(t,e,eo,c.placeholder,n,m,x,u,a,l-g)}var k=f?n:this,E=d?k[t]:t;return g=m.length,u?m=Zo(m,u):_&&g>1&&m.reverse(),h&&a<g&&(m.length=a),this&&this!==or&&this instanceof c&&(E=v||Ji(E)),E.apply(k,m)}var h=e&xt,f=e&_t,d=e&vt,p=e&(mt|yt),_=e&Et,v=d?nt:Ji(t);return c}function no(t,e){return function(n,r){return Ar(n,t,e(r),{})}}function ro(t,e){return function(n,r){var i;if(n===nt&&r===nt)return e;if(n!==nt&&(i=n),r!==nt){if(i===nt)return r;"string"==typeof n||"string"==typeof r?(n=vi(n),r=vi(r)):(n=_i(n),r=_i(r)),i=t(n,r)}return i}}function io(t){return bo(function(e){return e=f(e,j(Co())),oi(function(n){var r=this;return t(e,function(t){return i(t,r,n)})})})}function oo(t,e){e=e===nt?" ":vi(e);var n=e.length;if(n<2)return n?ii(e,t):e;var r=ii(e,Vc(t/J(e)));return F(e)?Ai(Q(r),0,t).join(""):r.slice(0,t)}function so(t,e,n,r){function o(){for(var e=-1,a=arguments.length,l=-1,c=r.length,h=sc(c+a),f=this&&this!==or&&this instanceof o?u:t;++l<c;)h[l]=r[l];for(;a--;)h[l++]=arguments[++e];return i(f,s?n:this,h)}var s=e&_t,u=Ji(t);return o}function uo(t){return function(e,n,r){return r&&"number"!=typeof r&&Lo(e,n,r)&&(n=r=nt),e=Ca(e),n===nt?(n=e,e=0):n=Ca(n),r=r===nt?e<n?1:-1:Ca(r),ri(e,n,r,t)}}function ao(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Ta(e),n=Ta(n)),t(e,n)}}function lo(t,e,n,r,i,o,s,u,a,l){var c=e&mt,h=c?s:nt,f=c?nt:s,d=c?o:nt,p=c?nt:o;e|=c?bt:wt,e&=~(c?wt:bt),e&gt||(e&=~(_t|vt));var _=[t,e,i,d,h,p,f,u,a,l],v=n.apply(nt,_);return Vo(t)&&jh(v,_),v.placeholder=r,ts(v,t,e)}function co(t){var e=cc[t];return function(t,n){if(t=Ta(t),n=null==n?0:$c(Sa(n),292)){var r=(Pa(t)+"e").split("e"),i=e(r[0]+"e"+(+r[1]+n));return r=(Pa(i)+"e").split("e"),+(r[0]+"e"+(+r[1]-n))}return e(t)}}function ho(t){return function(e){var n=Mh(e);return n==Kt?U(e):n==ne?q(e):P(e,t(e))}}function fo(t,e,n,r,i,o,s,u){var a=e&vt;if(!a&&"function"!=typeof t)throw new pc(st);var l=r?r.length:0;if(l||(e&=~(bt|wt),r=i=nt),s=s===nt?s:Kc(Sa(s),0),u=u===nt?u:Sa(u),l-=i?i.length:0,e&wt){var c=r,h=i;r=i=nt}var f=a?nt:Ah(t),d=[t,e,n,r,i,c,h,o,s,u];if(f&&qo(d,f),t=d[0],e=d[1],n=d[2],r=d[3],i=d[4],u=d[9]=d[9]===nt?a?0:t.length:Kc(d[9]-l,0),!u&&e&(mt|yt)&&(e&=~(mt|yt)),e&&e!=_t)p=e==mt||e==yt?Qi(t,e,u):e!=bt&&e!=(_t|bt)||i.length?eo.apply(nt,d):so(t,e,n,r);else var p=qi(t,e,n);var _=f?xh:jh;return ts(_(p,d),t,e)}function po(t,e,n,r){return t===nt||Ku(t,gc[n])&&!bc.call(r,n)?e:t}function _o(t,e,n,r,i,o){return aa(t)&&aa(e)&&(o.set(e,t),Yr(t,e,nt,_o,o),o.delete(e)),t}function vo(t){return ga(t)?nt:t}function go(t,e,n,r,i,o){var s=n&dt,u=t.length,a=e.length;if(u!=a&&!(s&&a>u))return!1;var l=o.get(t);if(l&&o.get(e))return l==e;var c=-1,h=!0,f=n&pt?new mn:nt;for(o.set(t,e),o.set(e,t);++c<u;){var d=t[c],p=e[c];if(r)var _=s?r(p,d,c,e,t,o):r(d,p,c,t,e,o);if(_!==nt){if(_)continue;h=!1;break}if(f){if(!v(e,function(t,e){if(!I(f,e)&&(d===t||i(d,t,n,r,o)))return f.push(e)})){h=!1;break}}else if(d!==p&&!i(d,p,n,r,o)){h=!1;break}}return o.delete(t),o.delete(e),h}function mo(t,e,n,r,i,o,s){switch(n){case le:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ae:return!(t.byteLength!=e.byteLength||!o(new Oc(t),new Oc(e)));case Wt:case Ut:case $t:return Ku(+t,+e);case Xt:return t.name==e.name&&t.message==e.message;case ee:case re:return t==e+"";case Kt:var u=U;case ne:var a=r&dt;if(u||(u=Y),t.size!=e.size&&!a)return!1;var l=s.get(t);if(l)return l==e;r|=pt,s.set(t,e);var c=go(u(t),u(e),r,i,o,s);return s.delete(t),c;case ie:if(_h)return _h.call(t)==_h.call(e)}return!1}function yo(t,e,n,r,i,o){var s=n&dt,u=wo(t),a=u.length,l=wo(e),c=l.length;if(a!=c&&!s)return!1;for(var h=a;h--;){var f=u[h];if(!(s?f in e:bc.call(e,f)))return!1}var d=o.get(t);if(d&&o.get(e))return d==e;var p=!0;o.set(t,e),o.set(e,t);for(var _=s;++h<a;){f=u[h];var v=t[f],g=e[f];if(r)var m=s?r(g,v,f,e,t,o):r(v,g,f,t,e,o);if(!(m===nt?v===g||i(v,g,n,r,o):m)){p=!1;break}_||(_="constructor"==f)}if(p&&!_){var y=t.constructor,b=e.constructor;y!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(p=!1)}return o.delete(t),o.delete(e),p}function bo(t){return Ih(Jo(t,nt,gs),t+"")}function wo(t){return cr(t,Ua,Th)}function xo(t){return cr(t,Ga,Oh)}function ko(t){for(var e=t.name+"",n=ah[e],r=bc.call(ah,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function Eo(t){var e=bc.call(g,"placeholder")?g:t;return e.placeholder}function Co(){var t=g.iteratee||zl;return t=t===zl?Fr:t,arguments.length?t(arguments[0],arguments[1]):t}function So(t,e){var n=t.__data__;return Ho(e)?n["string"==typeof e?"string":"hash"]:n.map}function Ao(t){for(var e=Ua(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Go(i)]}return e}function To(t,e){var n=L(t,e);return Nr(n)?n:nt}function Oo(t){var e=bc.call(t,Bc),n=t[Bc];try{t[Bc]=nt;var r=!0}catch(t){}var i=kc.call(t);return r&&(e?t[Bc]=n:delete t[Bc]),i}function Mo(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=$c(e,t+s);break;case"takeRight":t=Kc(t,e-s)}}return{start:t,end:e}}function Po(t){var e=t.match(Le);return e?e[1].split(Fe):[]}function jo(t,e,n){e=Si(e,t);for(var r=-1,i=e.length,o=!1;++r<i;){var s=rs(e[r]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++r!=i?o:(i=null==t?0:t.length,!!i&&ua(i)&&Do(s,i)&&(wf(t)||bf(t)))}function Ro(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&bc.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function Io(t){return"function"!=typeof t.constructor||Uo(t)?{}:gh(Pc(t))}function zo(t,e,n,r){var i=t.constructor;switch(e){case ae:return Oi(t);case Wt:case Ut:return new i(+t);case le:return Mi(t,r);case ce:case he:case fe:case de:case pe:case _e:case ve:case ge:case me:return zi(t,r);case Kt:return Pi(t,r,n);case $t:case re:return new i(t);case ee:return ji(t);case ne:return Ri(t,r,n);case ie:return Ii(t)}}function No(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(De,"{\n/* [wrapped with "+e+"] */\n")}function Bo(t){return wf(t)||bf(t)||!!(zc&&t&&t[zc])}function Do(t,e){return e=null==e?Rt:e,!!e&&("number"==typeof t||Ke.test(t))&&t>-1&&t%1==0&&t<e}function Lo(t,e,n){if(!aa(n))return!1;var r=typeof e;return!!("number"==r?$u(n)&&Do(e,n.length):"string"==r&&e in n)&&Ku(n[e],t)}function Fo(t,e){if(wf(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ba(t))||(Me.test(t)||!Oe.test(t)||null!=e&&t in hc(e))}function Ho(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function Vo(t){var e=ko(t),n=g[e];if("function"!=typeof n||!(e in K.prototype))return!1;if(t===n)return!0;var r=Ah(n);return!!r&&t===r[0]}function Wo(t){return!!xc&&xc in t}function Uo(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||gc;return t===n}function Go(t){return t===t&&!aa(t)}function Xo(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==nt||t in hc(n)))}}function Yo(t){var e=zu(t,function(t){return n.size===at&&n.clear(),t}),n=e.cache;return e}function qo(t,e){var n=t[1],r=e[1],i=n|r,o=i<(_t|vt|xt),s=r==xt&&n==mt||r==xt&&n==kt&&t[7].length<=e[8]||r==(xt|kt)&&e[7].length<=e[8]&&n==mt;if(!o&&!s)return t;r&_t&&(t[2]=e[2],i|=n&_t?0:gt);var u=e[3];if(u){var a=t[3];t[3]=a?Di(a,u,e[4]):u,t[4]=a?X(t[3],lt):e[4]}return u=e[5],u&&(a=t[5],t[5]=a?Li(a,u,e[6]):u,t[6]=a?X(t[5],lt):e[6]),u=e[7],u&&(t[7]=u),r&xt&&(t[8]=null==t[8]?e[8]:$c(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function Ko(t){var e=[];if(null!=t)for(var n in hc(t))e.push(n);return e}function $o(t){return kc.call(t)}function Jo(t,e,n){return e=Kc(e===nt?t.length-1:e,0),function(){for(var r=arguments,o=-1,s=Kc(r.length-e,0),u=sc(s);++o<s;)u[o]=r[e+o];o=-1;for(var a=sc(e+1);++o<e;)a[o]=r[o];return a[e]=n(u),i(t,this,a)}}function Qo(t,e){return e.length<2?t:lr(t,ci(e,0,-1))}function Zo(t,e){for(var n=t.length,r=$c(e.length,n),i=Fi(t);r--;){var o=e[r];t[r]=Do(o,n)?i[o]:nt}return t}function ts(t,e,n){var r=e+"";return Ih(t,No(r,os(Po(r),n)))}function es(t){var e=0,n=0;return function(){var r=Jc(),i=Tt-(r-n);if(n=r,i>0){if(++e>=At)return arguments[0]}else e=0;return t.apply(nt,arguments)}}function ns(t,e){var n=-1,r=t.length,i=r-1;for(e=e===nt?r:e;++n<e;){var o=ni(n,i),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}function rs(t){if("string"==typeof t||ba(t))return t;var e=t+"";return"0"==e&&1/t==-jt?"-0":e}function is(t){if(null!=t){try{return yc.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function os(t,e){return s(Lt,function(n){var r="_."+n[0];e&n[1]&&!c(t,r)&&t.push(r)}),t.sort()}function ss(t){if(t instanceof K)return t.clone();var e=new H(t.__wrapped__,t.__chain__);return e.__actions__=Fi(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function us(t,e,n){e=(n?Lo(t,e,n):e===nt)?1:Kc(Sa(e),0);var r=null==t?0:t.length;if(!r||e<1)return[];for(var i=0,o=0,s=sc(Vc(r/e));i<r;)s[o++]=ci(t,i,i+=e);return s}function as(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i}function ls(){var t=arguments.length;if(!t)return[];for(var e=sc(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return d(wf(n)?Fi(n):[n],rr(e,1))}function cs(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===nt?1:Sa(e),ci(t,e<0?0:e,r)):[]}function hs(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===nt?1:Sa(e),e=r-e,ci(t,0,e<0?0:e)):[]}function fs(t,e){return t&&t.length?bi(t,Co(e,3),!0,!0):[]}function ds(t,e){return t&&t.length?bi(t,Co(e,3),!0):[]}function ps(t,e,n,r){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&Lo(t,e,n)&&(n=0,r=i),Zn(t,e,n,r)):[]}function _s(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Sa(n);return i<0&&(i=Kc(r+i,0)),b(t,Co(e,3),i)}function vs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r-1;return n!==nt&&(i=Sa(n),i=n<0?Kc(r+i,0):$c(i,r-1)),b(t,Co(e,3),i,!0)}function gs(t){var e=null==t?0:t.length;return e?rr(t,1):[]}function ms(t){var e=null==t?0:t.length;return e?rr(t,jt):[]}function ys(t,e){var n=null==t?0:t.length;return n?(e=e===nt?1:Sa(e),rr(t,e)):[]}function bs(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r}function ws(t){return t&&t.length?t[0]:nt}function xs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:Sa(n);return i<0&&(i=Kc(r+i,0)),w(t,e,i)}function ks(t){var e=null==t?0:t.length;return e?ci(t,0,-1):[]}function Es(t,e){return null==t?"":Yc.call(t,e)}function Cs(t){var e=null==t?0:t.length;return e?t[e-1]:nt}function Ss(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=r;return n!==nt&&(i=Sa(n),i=i<0?Kc(r+i,0):$c(i,r-1)),e===e?$(t,e,i):b(t,k,i,!0)}function As(t,e){return t&&t.length?Kr(t,Sa(e)):nt}function Ts(t,e){return t&&t.length&&e&&e.length?ti(t,e):t}function Os(t,e,n){return t&&t.length&&e&&e.length?ti(t,e,Co(n,2)):t}function Ms(t,e,n){return t&&t.length&&e&&e.length?ti(t,e,nt,n):t}function Ps(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=Co(e,3);++r<o;){var s=t[r];e(s,r,t)&&(n.push(s),i.push(r))}return ei(t,i),n}function js(t){return null==t?t:th.call(t)}function Rs(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&Lo(t,e,n)?(e=0,n=r):(e=null==e?0:Sa(e),n=n===nt?r:Sa(n)),ci(t,e,n)):[]}function Is(t,e){return fi(t,e)}function zs(t,e,n){return di(t,e,Co(n,2))}function Ns(t,e){var n=null==t?0:t.length;if(n){var r=fi(t,e);if(r<n&&Ku(t[r],e))return r}return-1}function Bs(t,e){return fi(t,e,!0)}function Ds(t,e,n){return di(t,e,Co(n,2),!0)}function Ls(t,e){var n=null==t?0:t.length;if(n){var r=fi(t,e,!0)-1;if(Ku(t[r],e))return r}return-1}function Fs(t){return t&&t.length?pi(t):[]}function Hs(t,e){return t&&t.length?pi(t,Co(e,2)):[]}function Vs(t){var e=null==t?0:t.length;return e?ci(t,1,e):[]}function Ws(t,e,n){return t&&t.length?(e=n||e===nt?1:Sa(e),ci(t,0,e<0?0:e)):[]}function Us(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===nt?1:Sa(e),e=r-e,ci(t,e<0?0:e,r)):[]}function Gs(t,e){return t&&t.length?bi(t,Co(e,3),!1,!0):[]}function Xs(t,e){return t&&t.length?bi(t,Co(e,3)):[]}function Ys(t){return t&&t.length?gi(t):[]}function qs(t,e){return t&&t.length?gi(t,Co(e,2)):[]}function Ks(t,e){return e="function"==typeof e?e:nt,t&&t.length?gi(t,nt,e):[]}function $s(t){if(!t||!t.length)return[];var e=0;return t=l(t,function(t){if(Ju(t))return e=Kc(t.length,e),!0}),M(e,function(e){return f(t,C(e))})}function Js(t,e){if(!t||!t.length)return[];var n=$s(t);return null==e?n:f(n,function(t){return i(e,nt,t)})}function Qs(t,e){return ki(t||[],e||[],jn)}function Zs(t,e){return ki(t||[],e||[],ai)}function tu(t){var e=g(t);return e.__chain__=!0,e}function eu(t,e){return e(t),t}function nu(t,e){return e(t)}function ru(){return tu(this)}function iu(){return new H(this.value(),this.__chain__)}function ou(){this.__values__===nt&&(this.__values__=Ea(this.value()));var t=this.__index__>=this.__values__.length,e=t?nt:this.__values__[this.__index__++];return{done:t,value:e}}function su(){return this}function uu(t){for(var e,n=this;n instanceof S;){var r=ss(n);r.__index__=0,r.__values__=nt,e?i.__wrapped__=r:e=r;var i=r;n=n.__wrapped__}return i.__wrapped__=t,e}function au(){var t=this.__wrapped__;if(t instanceof K){var e=t;return this.__actions__.length&&(e=new K(this)),e=e.reverse(),e.__actions__.push({func:nu,args:[js],thisArg:nt}),new H(e,this.__chain__)}return this.thru(js)}function lu(){return wi(this.__wrapped__,this.__actions__)}function cu(t,e,n){var r=wf(t)?a:Jn;return n&&Lo(t,e,n)&&(e=nt),r(t,Co(e,3))}function hu(t,e){var n=wf(t)?l:tr;return n(t,Co(e,3))}function fu(t,e){return rr(mu(t,e),1)}function du(t,e){return rr(mu(t,e),jt)}function pu(t,e,n){return n=n===nt?1:Sa(n),rr(mu(t,e),n)}function _u(t,e){var n=wf(t)?s:mh;return n(t,Co(e,3))}function vu(t,e){var n=wf(t)?u:yh;return n(t,Co(e,3))}function gu(t,e,n,r){t=$u(t)?t:rl(t),n=n&&!r?Sa(n):0;var i=t.length;return n<0&&(n=Kc(i+n,0)),ya(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&w(t,e,n)>-1}function mu(t,e){var n=wf(t)?f:Ur;return n(t,Co(e,3))}function yu(t,e,n,r){return null==t?[]:(wf(e)||(e=null==e?[]:[e]),n=r?nt:n,wf(n)||(n=null==n?[]:[n]),$r(t,e,n))}function bu(t,e,n){var r=wf(t)?p:A,i=arguments.length<3;return r(t,Co(e,4),n,i,mh)}function wu(t,e,n){var r=wf(t)?_:A,i=arguments.length<3;return r(t,Co(e,4),n,i,yh)}function xu(t,e){var n=wf(t)?l:tr;return n(t,Nu(Co(e,3)))}function ku(t){var e=wf(t)?Tn:si;return e(t)}function Eu(t,e,n){e=(n?Lo(t,e,n):e===nt)?1:Sa(e);var r=wf(t)?On:ui;return r(t,e)}function Cu(t){var e=wf(t)?Mn:li;return e(t)}function Su(t){if(null==t)return 0;if($u(t))return ya(t)?J(t):t.length;var e=Mh(t);return e==Kt||e==ne?t.size:Hr(t).length}function Au(t,e,n){var r=wf(t)?v:hi;return n&&Lo(t,e,n)&&(e=nt),r(t,Co(e,3))}function Tu(t,e){if("function"!=typeof e)throw new pc(st);return t=Sa(t),function(){if(--t<1)return e.apply(this,arguments)}}function Ou(t,e,n){return e=n?nt:e,e=t&&null==e?t.length:e,fo(t,xt,nt,nt,nt,nt,e)}function Mu(t,e){var n;if("function"!=typeof e)throw new pc(st);return t=Sa(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=nt),n}}function Pu(t,e,n){e=n?nt:e;var r=fo(t,mt,nt,nt,nt,nt,nt,e);return r.placeholder=Pu.placeholder,r}function ju(t,e,n){e=n?nt:e;var r=fo(t,yt,nt,nt,nt,nt,nt,e);return r.placeholder=ju.placeholder,r}function Ru(t,e,n){function r(e){var n=f,r=d;return f=d=nt,m=e,_=t.apply(r,n)}function i(t){return m=t,v=Rh(u,e),y?r(t):_}function o(t){var n=t-g,r=t-m,i=e-n;return b?$c(i,p-r):i}function s(t){var n=t-g,r=t-m;return g===nt||n>=e||n<0||b&&r>=p}function u(){var t=lf();return s(t)?a(t):void(v=Rh(u,o(t)))}function a(t){return v=nt,w&&f?r(t):(f=d=nt,_)}function l(){v!==nt&&Ch(v),m=0,f=g=d=v=nt}function c(){return v===nt?_:a(lf())}function h(){var t=lf(),n=s(t);if(f=arguments,d=this,g=t,n){if(v===nt)return i(g);if(b)return v=Rh(u,e),r(g)}return v===nt&&(v=Rh(u,e)),_}var f,d,p,_,v,g,m=0,y=!1,b=!1,w=!0;if("function"!=typeof t)throw new pc(st);return e=Ta(e)||0,aa(n)&&(y=!!n.leading,b="maxWait"in n,p=b?Kc(Ta(n.maxWait)||0,e):p,w="trailing"in n?!!n.trailing:w),h.cancel=l,h.flush=c,h}function Iu(t){return fo(t,Et)}function zu(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new pc(st);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(zu.Cache||fn),n}function Nu(t){if("function"!=typeof t)throw new pc(st);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Bu(t){return Mu(2,t)}function Du(t,e){if("function"!=typeof t)throw new pc(st);return e=e===nt?e:Sa(e),oi(t,e)}function Lu(t,e){if("function"!=typeof t)throw new pc(st);return e=null==e?0:Kc(Sa(e),0),oi(function(n){var r=n[e],o=Ai(n,0,e);return r&&d(o,r),i(t,this,o)})}function Fu(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new pc(st);return aa(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ru(t,e,{leading:r,maxWait:e,trailing:i})}function Hu(t){return Ou(t,1)}function Vu(t,e){return _f(Ci(e),t)}function Wu(){if(!arguments.length)return[];var t=arguments[0];return wf(t)?t:[t]}function Uu(t){return Fn(t,ft)}function Gu(t,e){return e="function"==typeof e?e:nt,Fn(t,ft,e)}function Xu(t){return Fn(t,ct|ft)}function Yu(t,e){return e="function"==typeof e?e:nt,Fn(t,ct|ft,e)}function qu(t,e){return null==e||Un(t,e,Ua(e))}function Ku(t,e){return t===e||t!==t&&e!==e}function $u(t){return null!=t&&ua(t.length)&&!oa(t)}function Ju(t){return la(t)&&$u(t)}function Qu(t){return t===!0||t===!1||la(t)&&gr(t)==Wt}function Zu(t){return la(t)&&1===t.nodeType&&!ga(t)}function ta(t){if(null==t)return!0;if($u(t)&&(wf(t)||"string"==typeof t||"function"==typeof t.splice||kf(t)||Tf(t)||bf(t)))return!t.length;var e=Mh(t);if(e==Kt||e==ne)return!t.size;if(Uo(t))return!Hr(t).length;for(var n in t)if(bc.call(t,n))return!1;return!0}function ea(t,e){return jr(t,e)}function na(t,e,n){n="function"==typeof n?n:nt;var r=n?n(t,e):nt;return r===nt?jr(t,e,nt,n):!!r}function ra(t){if(!la(t))return!1;var e=gr(t);return e==Xt||e==Gt||"string"==typeof t.message&&"string"==typeof t.name&&!ga(t)}function ia(t){return"number"==typeof t&&Xc(t)}function oa(t){if(!aa(t))return!1;var e=gr(t);return e==Yt||e==qt||e==Vt||e==te}function sa(t){return"number"==typeof t&&t==Sa(t)}function ua(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Rt}function aa(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function la(t){return null!=t&&"object"==typeof t}function ca(t,e){return t===e||zr(t,e,Ao(e))}function ha(t,e,n){return n="function"==typeof n?n:nt,zr(t,e,Ao(e),n)}function fa(t){return va(t)&&t!=+t}function da(t){if(Ph(t))throw new ac(ot);return Nr(t)}function pa(t){return null===t}function _a(t){return null==t}function va(t){return"number"==typeof t||la(t)&&gr(t)==$t}function ga(t){if(!la(t)||gr(t)!=Qt)return!1;var e=Pc(t);if(null===e)return!0;var n=bc.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&yc.call(n)==Ec}function ma(t){return sa(t)&&t>=-Rt&&t<=Rt}function ya(t){return"string"==typeof t||!wf(t)&&la(t)&&gr(t)==re}function ba(t){return"symbol"==typeof t||la(t)&&gr(t)==ie}function wa(t){return t===nt}function xa(t){return la(t)&&Mh(t)==se}function ka(t){return la(t)&&gr(t)==ue}function Ea(t){if(!t)return[];if($u(t))return ya(t)?Q(t):Fi(t);if(Nc&&t[Nc])return W(t[Nc]());var e=Mh(t),n=e==Kt?U:e==ne?Y:rl;return n(t)}function Ca(t){if(!t)return 0===t?t:0;if(t=Ta(t),t===jt||t===-jt){var e=t<0?-1:1;return e*It}return t===t?t:0}function Sa(t){var e=Ca(t),n=e%1;return e===e?n?e-n:e:0}function Aa(t){return t?Ln(Sa(t),0,Nt):0}function Ta(t){if("number"==typeof t)return t;if(ba(t))return zt;if(aa(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=aa(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(ze,"");var n=Xe.test(t);return n||qe.test(t)?nr(t.slice(2),n?2:8):Ge.test(t)?zt:+t}function Oa(t){return Hi(t,Ga(t))}function Ma(t){return t?Ln(Sa(t),-Rt,Rt):0===t?t:0}function Pa(t){return null==t?"":vi(t)}function ja(t,e){var n=gh(t);return null==e?n:zn(n,e)}function Ra(t,e){return y(t,Co(e,3),ir)}function Ia(t,e){return y(t,Co(e,3),sr)}function za(t,e){return null==t?t:bh(t,Co(e,3),Ga)}function Na(t,e){return null==t?t:wh(t,Co(e,3),Ga)}function Ba(t,e){return t&&ir(t,Co(e,3))}function Da(t,e){return t&&sr(t,Co(e,3))}function La(t){return null==t?[]:ur(t,Ua(t))}function Fa(t){return null==t?[]:ur(t,Ga(t))}function Ha(t,e,n){var r=null==t?nt:lr(t,e);return r===nt?n:r}function Va(t,e){return null!=t&&jo(t,e,kr)}function Wa(t,e){return null!=t&&jo(t,e,Er)}function Ua(t){return $u(t)?An(t):Hr(t)}function Ga(t){return $u(t)?An(t,!0):Vr(t)}function Xa(t,e){var n={};return e=Co(e,3),ir(t,function(t,r,i){Bn(n,e(t,r,i),t)}),n}function Ya(t,e){var n={};return e=Co(e,3),ir(t,function(t,r,i){Bn(n,r,e(t,r,i))}),n}function qa(t,e){return Ka(t,Nu(Co(e)))}function Ka(t,e){if(null==t)return{};var n=f(xo(t),function(t){return[t]});return e=Co(e),Qr(t,n,function(t,n){return e(t,n[0])})}function $a(t,e,n){e=Si(e,t);var r=-1,i=e.length;for(i||(i=1,t=nt);++r<i;){var o=null==t?nt:t[rs(e[r])];o===nt&&(r=i,o=n),t=oa(o)?o.call(t):o}return t}function Ja(t,e,n){return null==t?t:ai(t,e,n)}function Qa(t,e,n,r){return r="function"==typeof r?r:nt,null==t?t:ai(t,e,n,r)}function Za(t,e,n){var r=wf(t),i=r||kf(t)||Tf(t);if(e=Co(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:aa(t)&&oa(o)?gh(Pc(t)):{}}return(i?s:ir)(t,function(t,r,i){return e(n,t,r,i)}),n}function tl(t,e){return null==t||mi(t,e)}function el(t,e,n){return null==t?t:yi(t,e,Ci(n))}function nl(t,e,n,r){return r="function"==typeof r?r:nt,null==t?t:yi(t,e,Ci(n),r)}function rl(t){return null==t?[]:R(t,Ua(t))}function il(t){return null==t?[]:R(t,Ga(t))}function ol(t,e,n){return n===nt&&(n=e,e=nt),n!==nt&&(n=Ta(n),n=n===n?n:0),e!==nt&&(e=Ta(e),e=e===e?e:0),Ln(Ta(t),e,n)}function sl(t,e,n){return e=Ca(e),n===nt?(n=e,e=0):n=Ca(n),t=Ta(t),Cr(t,e,n)}function ul(t,e,n){if(n&&"boolean"!=typeof n&&Lo(t,e,n)&&(e=n=nt),n===nt&&("boolean"==typeof e?(n=e,e=nt):"boolean"==typeof t&&(n=t,t=nt)),t===nt&&e===nt?(t=0,e=1):(t=Ca(t),e===nt?(e=t,t=0):e=Ca(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var i=Zc();return $c(t+i*(e-t+er("1e-"+((i+"").length-1))),e)}return ni(t,e)}function al(t){return td(Pa(t).toLowerCase())}function ll(t){return t=Pa(t),t&&t.replace($e,mr).replace(Vn,"")}function cl(t,e,n){t=Pa(t),e=vi(e);var r=t.length;n=n===nt?r:Ln(Sa(n),0,r);var i=n;return n-=e.length,n>=0&&t.slice(n,i)==e}function hl(t){return t=Pa(t),t&&Ce.test(t)?t.replace(ke,yr):t}function fl(t){return t=Pa(t),t&&Ie.test(t)?t.replace(Re,"\\$&"):t}function dl(t,e,n){t=Pa(t),e=Sa(e);var r=e?J(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return oo(Wc(i),n)+t+oo(Vc(i),n)}function pl(t,e,n){t=Pa(t),e=Sa(e);var r=e?J(t):0;return e&&r<e?t+oo(e-r,n):t}function _l(t,e,n){t=Pa(t),e=Sa(e);var r=e?J(t):0;return e&&r<e?oo(e-r,n)+t:t}function vl(t,e,n){return n||null==e?e=0:e&&(e=+e),Qc(Pa(t).replace(Ne,""),e||0)}function gl(t,e,n){return e=(n?Lo(t,e,n):e===nt)?1:Sa(e),ii(Pa(t),e)}function ml(){var t=arguments,e=Pa(t[0]);return t.length<3?e:e.replace(t[1],t[2])}function yl(t,e,n){return n&&"number"!=typeof n&&Lo(t,e,n)&&(e=n=nt),(n=n===nt?Nt:n>>>0)?(t=Pa(t),t&&("string"==typeof e||null!=e&&!Sf(e))&&(e=vi(e),!e&&F(t))?Ai(Q(t),0,n):t.split(e,n)):[]}function bl(t,e,n){return t=Pa(t),n=null==n?0:Ln(Sa(n),0,t.length),e=vi(e),t.slice(n,n+e.length)==e}function wl(t,e,n){var r=g.templateSettings;n&&Lo(t,e,n)&&(e=nt),t=Pa(t),e=Rf({},e,r,po);var i,o,s=Rf({},e.imports,r.imports,po),u=Ua(s),a=R(s,u),l=0,c=e.interpolate||Je,h="__p += '",f=fc((e.escape||Je).source+"|"+c.source+"|"+(c===Te?We:Je).source+"|"+(e.evaluate||Je).source+"|$","g"),d="//# sourceURL="+("sourceURL"in e?e.sourceURL:"lodash.templateSources["+ ++qn+"]")+"\n";t.replace(f,function(e,n,r,s,u,a){return r||(r=s),h+=t.slice(l,a).replace(Qe,D),n&&(i=!0,h+="' +\n__e("+n+") +\n'"),u&&(o=!0,h+="';\n"+u+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=a+e.length,e}),h+="';\n";var p=e.variable;p||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(ye,""):h).replace(be,"$1").replace(we,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var _=ed(function(){return lc(u,d+"return "+h).apply(nt,a)});if(_.source=h,ra(_))throw _;return _}function xl(t){return Pa(t).toLowerCase()}function kl(t){return Pa(t).toUpperCase()}function El(t,e,n){if(t=Pa(t),t&&(n||e===nt))return t.replace(ze,"");if(!t||!(e=vi(e)))return t;var r=Q(t),i=Q(e),o=z(r,i),s=N(r,i)+1;return Ai(r,o,s).join("")}function Cl(t,e,n){if(t=Pa(t),t&&(n||e===nt))return t.replace(Be,"");if(!t||!(e=vi(e)))return t;var r=Q(t),i=N(r,Q(e))+1;return Ai(r,0,i).join("")}function Sl(t,e,n){if(t=Pa(t),t&&(n||e===nt))return t.replace(Ne,"");if(!t||!(e=vi(e)))return t;var r=Q(t),i=z(r,Q(e));return Ai(r,i).join("")}function Al(t,e){var n=Ct,r=St;if(aa(e)){var i="separator"in e?e.separator:i;n="length"in e?Sa(e.length):n,r="omission"in e?vi(e.omission):r}t=Pa(t);var o=t.length;if(F(t)){var s=Q(t);o=s.length}if(n>=o)return t;var u=n-J(r);if(u<1)return r;var a=s?Ai(s,0,u).join(""):t.slice(0,u);if(i===nt)return a+r;if(s&&(u+=a.length-u),Sf(i)){if(t.slice(u).search(i)){var l,c=a;for(i.global||(i=fc(i.source,Pa(Ue.exec(i))+"g")),i.lastIndex=0;l=i.exec(c);)var h=l.index;a=a.slice(0,h===nt?u:h)}}else if(t.indexOf(vi(i),u)!=u){var f=a.lastIndexOf(i);f>-1&&(a=a.slice(0,f))}return a+r}function Tl(t){return t=Pa(t),t&&Ee.test(t)?t.replace(xe,br):t}function Ol(t,e,n){return t=Pa(t),e=n?nt:e,e===nt?V(t)?et(t):m(t):t.match(e)||[]}function Ml(t){var e=null==t?0:t.length,n=Co();return t=e?f(t,function(t){if("function"!=typeof t[1])throw new pc(st);return[n(t[0]),t[1]]}):[],oi(function(n){for(var r=-1;++r<e;){var o=t[r];if(i(o[0],this,n))return i(o[1],this,n)}})}function Pl(t){return Wn(Fn(t,ct))}function jl(t){return function(){return t}}function Rl(t,e){return null==t||t!==t?e:t}function Il(t){
return t}function zl(t){return Fr("function"==typeof t?t:Fn(t,ct))}function Nl(t){return Gr(Fn(t,ct))}function Bl(t,e){return Xr(t,Fn(e,ct))}function Dl(t,e,n){var r=Ua(e),i=ur(e,r);null!=n||aa(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=ur(e,Ua(e)));var o=!(aa(n)&&"chain"in n&&!n.chain),u=oa(t);return s(i,function(n){var r=e[n];t[n]=r,u&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__),i=n.__actions__=Fi(this.__actions__);return i.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,d([this.value()],arguments))})}),t}function Ll(){return or._===this&&(or._=Cc),this}function Fl(){}function Hl(t){return t=Sa(t),oi(function(e){return Kr(e,t)})}function Vl(t){return Fo(t)?C(rs(t)):Zr(t)}function Wl(t){return function(e){return null==t?nt:lr(t,e)}}function Ul(){return[]}function Gl(){return!1}function Xl(){return{}}function Yl(){return""}function ql(){return!0}function Kl(t,e){if(t=Sa(t),t<1||t>Rt)return[];var n=Nt,r=$c(t,Nt);e=Co(e),t-=Nt;for(var i=M(r,e);++n<t;)e(n);return i}function $l(t){return wf(t)?f(t,rs):ba(t)?[t]:Fi(zh(Pa(t)))}function Jl(t){var e=++wc;return Pa(t)+e}function Ql(t){return t&&t.length?Qn(t,Il,wr):nt}function Zl(t,e){return t&&t.length?Qn(t,Co(e,2),wr):nt}function tc(t){return E(t,Il)}function ec(t,e){return E(t,Co(e,2))}function nc(t){return t&&t.length?Qn(t,Il,Wr):nt}function rc(t,e){return t&&t.length?Qn(t,Co(e,2),Wr):nt}function ic(t){return t&&t.length?O(t,Il):0}function oc(t,e){return t&&t.length?O(t,Co(e,2)):0}e=null==e?or:xr.defaults(or.Object(),e,xr.pick(or,Yn));var sc=e.Array,uc=e.Date,ac=e.Error,lc=e.Function,cc=e.Math,hc=e.Object,fc=e.RegExp,dc=e.String,pc=e.TypeError,_c=sc.prototype,vc=lc.prototype,gc=hc.prototype,mc=e["__core-js_shared__"],yc=vc.toString,bc=gc.hasOwnProperty,wc=0,xc=function(){var t=/[^.]+$/.exec(mc&&mc.keys&&mc.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),kc=gc.toString,Ec=yc.call(hc),Cc=or._,Sc=fc("^"+yc.call(bc).replace(Re,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ac=ar?e.Buffer:nt,Tc=e.Symbol,Oc=e.Uint8Array,Mc=Ac?Ac.allocUnsafe:nt,Pc=G(hc.getPrototypeOf,hc),jc=hc.create,Rc=gc.propertyIsEnumerable,Ic=_c.splice,zc=Tc?Tc.isConcatSpreadable:nt,Nc=Tc?Tc.iterator:nt,Bc=Tc?Tc.toStringTag:nt,Dc=function(){try{var t=To(hc,"defineProperty");return t({},"",{}),t}catch(t){}}(),Lc=e.clearTimeout!==or.clearTimeout&&e.clearTimeout,Fc=uc&&uc.now!==or.Date.now&&uc.now,Hc=e.setTimeout!==or.setTimeout&&e.setTimeout,Vc=cc.ceil,Wc=cc.floor,Uc=hc.getOwnPropertySymbols,Gc=Ac?Ac.isBuffer:nt,Xc=e.isFinite,Yc=_c.join,qc=G(hc.keys,hc),Kc=cc.max,$c=cc.min,Jc=uc.now,Qc=e.parseInt,Zc=cc.random,th=_c.reverse,eh=To(e,"DataView"),nh=To(e,"Map"),rh=To(e,"Promise"),ih=To(e,"Set"),oh=To(e,"WeakMap"),sh=To(hc,"create"),uh=oh&&new oh,ah={},lh=is(eh),ch=is(nh),hh=is(rh),fh=is(ih),dh=is(oh),ph=Tc?Tc.prototype:nt,_h=ph?ph.valueOf:nt,vh=ph?ph.toString:nt,gh=function(){function t(){}return function(e){if(!aa(e))return{};if(jc)return jc(e);t.prototype=e;var n=new t;return t.prototype=nt,n}}();g.templateSettings={escape:Se,evaluate:Ae,interpolate:Te,variable:"",imports:{_:g}},g.prototype=S.prototype,g.prototype.constructor=g,H.prototype=gh(S.prototype),H.prototype.constructor=H,K.prototype=gh(S.prototype),K.prototype.constructor=K,Ze.prototype.clear=tn,Ze.prototype.delete=en,Ze.prototype.get=nn,Ze.prototype.has=rn,Ze.prototype.set=on,sn.prototype.clear=un,sn.prototype.delete=an,sn.prototype.get=ln,sn.prototype.has=cn,sn.prototype.set=hn,fn.prototype.clear=dn,fn.prototype.delete=pn,fn.prototype.get=_n,fn.prototype.has=vn,fn.prototype.set=gn,mn.prototype.add=mn.prototype.push=yn,mn.prototype.has=bn,wn.prototype.clear=xn,wn.prototype.delete=kn,wn.prototype.get=En,wn.prototype.has=Cn,wn.prototype.set=Sn;var mh=Xi(ir),yh=Xi(sr,!0),bh=Yi(),wh=Yi(!0),xh=uh?function(t,e){return uh.set(t,e),t}:Il,kh=Dc?function(t,e){return Dc(t,"toString",{configurable:!0,enumerable:!1,value:jl(e),writable:!0})}:Il,Eh=oi,Ch=Lc||function(t){return or.clearTimeout(t)},Sh=ih&&1/Y(new ih([,-0]))[1]==jt?function(t){return new ih(t)}:Fl,Ah=uh?function(t){return uh.get(t)}:Fl,Th=Uc?function(t){return null==t?[]:(t=hc(t),l(Uc(t),function(e){return Rc.call(t,e)}))}:Ul,Oh=Uc?function(t){for(var e=[];t;)d(e,Th(t)),t=Pc(t);return e}:Ul,Mh=gr;(eh&&Mh(new eh(new ArrayBuffer(1)))!=le||nh&&Mh(new nh)!=Kt||rh&&Mh(rh.resolve())!=Zt||ih&&Mh(new ih)!=ne||oh&&Mh(new oh)!=se)&&(Mh=function(t){var e=gr(t),n=e==Qt?t.constructor:nt,r=n?is(n):"";if(r)switch(r){case lh:return le;case ch:return Kt;case hh:return Zt;case fh:return ne;case dh:return se}return e});var Ph=mc?oa:Gl,jh=es(xh),Rh=Hc||function(t,e){return or.setTimeout(t,e)},Ih=es(kh),zh=Yo(function(t){var e=[];return Pe.test(t)&&e.push(""),t.replace(je,function(t,n,r,i){e.push(r?i.replace(Ve,"$1"):n||t)}),e}),Nh=oi(function(t,e){return Ju(t)?Xn(t,rr(e,1,Ju,!0)):[]}),Bh=oi(function(t,e){var n=Cs(e);return Ju(n)&&(n=nt),Ju(t)?Xn(t,rr(e,1,Ju,!0),Co(n,2)):[]}),Dh=oi(function(t,e){var n=Cs(e);return Ju(n)&&(n=nt),Ju(t)?Xn(t,rr(e,1,Ju,!0),nt,n):[]}),Lh=oi(function(t){var e=f(t,Ei);return e.length&&e[0]===t[0]?Sr(e):[]}),Fh=oi(function(t){var e=Cs(t),n=f(t,Ei);return e===Cs(n)?e=nt:n.pop(),n.length&&n[0]===t[0]?Sr(n,Co(e,2)):[]}),Hh=oi(function(t){var e=Cs(t),n=f(t,Ei);return e="function"==typeof e?e:nt,e&&n.pop(),n.length&&n[0]===t[0]?Sr(n,nt,e):[]}),Vh=oi(Ts),Wh=bo(function(t,e){var n=null==t?0:t.length,r=Dn(t,e);return ei(t,f(e,function(t){return Do(t,n)?+t:t}).sort(Ni)),r}),Uh=oi(function(t){return gi(rr(t,1,Ju,!0))}),Gh=oi(function(t){var e=Cs(t);return Ju(e)&&(e=nt),gi(rr(t,1,Ju,!0),Co(e,2))}),Xh=oi(function(t){var e=Cs(t);return e="function"==typeof e?e:nt,gi(rr(t,1,Ju,!0),nt,e)}),Yh=oi(function(t,e){return Ju(t)?Xn(t,e):[]}),qh=oi(function(t){return xi(l(t,Ju))}),Kh=oi(function(t){var e=Cs(t);return Ju(e)&&(e=nt),xi(l(t,Ju),Co(e,2))}),$h=oi(function(t){var e=Cs(t);return e="function"==typeof e?e:nt,xi(l(t,Ju),nt,e)}),Jh=oi($s),Qh=oi(function(t){var e=t.length,n=e>1?t[e-1]:nt;return n="function"==typeof n?(t.pop(),n):nt,Js(t,n)}),Zh=bo(function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,i=function(e){return Dn(e,t)};return!(e>1||this.__actions__.length)&&r instanceof K&&Do(n)?(r=r.slice(n,+n+(e?1:0)),r.__actions__.push({func:nu,args:[i],thisArg:nt}),new H(r,this.__chain__).thru(function(t){return e&&!t.length&&t.push(nt),t})):this.thru(i)}),tf=Ui(function(t,e,n){bc.call(t,n)?++t[n]:Bn(t,n,1)}),ef=Zi(_s),nf=Zi(vs),rf=Ui(function(t,e,n){bc.call(t,n)?t[n].push(e):Bn(t,n,[e])}),of=oi(function(t,e,n){var r=-1,o="function"==typeof e,s=$u(t)?sc(t.length):[];return mh(t,function(t){s[++r]=o?i(e,t,n):Tr(t,e,n)}),s}),sf=Ui(function(t,e,n){Bn(t,n,e)}),uf=Ui(function(t,e,n){t[n?0:1].push(e)},function(){return[[],[]]}),af=oi(function(t,e){if(null==t)return[];var n=e.length;return n>1&&Lo(t,e[0],e[1])?e=[]:n>2&&Lo(e[0],e[1],e[2])&&(e=[e[0]]),$r(t,rr(e,1),[])}),lf=Fc||function(){return or.Date.now()},cf=oi(function(t,e,n){var r=_t;if(n.length){var i=X(n,Eo(cf));r|=bt}return fo(t,r,e,n,i)}),hf=oi(function(t,e,n){var r=_t|vt;if(n.length){var i=X(n,Eo(hf));r|=bt}return fo(e,r,t,n,i)}),ff=oi(function(t,e){return Gn(t,1,e)}),df=oi(function(t,e,n){return Gn(t,Ta(e)||0,n)});zu.Cache=fn;var pf=Eh(function(t,e){e=1==e.length&&wf(e[0])?f(e[0],j(Co())):f(rr(e,1),j(Co()));var n=e.length;return oi(function(r){for(var o=-1,s=$c(r.length,n);++o<s;)r[o]=e[o].call(this,r[o]);return i(t,this,r)})}),_f=oi(function(t,e){var n=X(e,Eo(_f));return fo(t,bt,nt,e,n)}),vf=oi(function(t,e){var n=X(e,Eo(vf));return fo(t,wt,nt,e,n)}),gf=bo(function(t,e){return fo(t,kt,nt,nt,nt,e)}),mf=ao(wr),yf=ao(function(t,e){return t>=e}),bf=Or(function(){return arguments}())?Or:function(t){return la(t)&&bc.call(t,"callee")&&!Rc.call(t,"callee")},wf=sc.isArray,xf=hr?j(hr):Mr,kf=Gc||Gl,Ef=fr?j(fr):Pr,Cf=dr?j(dr):Ir,Sf=pr?j(pr):Br,Af=_r?j(_r):Dr,Tf=vr?j(vr):Lr,Of=ao(Wr),Mf=ao(function(t,e){return t<=e}),Pf=Gi(function(t,e){if(Uo(e)||$u(e))return void Hi(e,Ua(e),t);for(var n in e)bc.call(e,n)&&jn(t,n,e[n])}),jf=Gi(function(t,e){Hi(e,Ga(e),t)}),Rf=Gi(function(t,e,n,r){Hi(e,Ga(e),t,r)}),If=Gi(function(t,e,n,r){Hi(e,Ua(e),t,r)}),zf=bo(Dn),Nf=oi(function(t){return t.push(nt,po),i(Rf,nt,t)}),Bf=oi(function(t){return t.push(nt,_o),i(Vf,nt,t)}),Df=no(function(t,e,n){t[e]=n},jl(Il)),Lf=no(function(t,e,n){bc.call(t,e)?t[e].push(n):t[e]=[n]},Co),Ff=oi(Tr),Hf=Gi(function(t,e,n){Yr(t,e,n)}),Vf=Gi(function(t,e,n,r){Yr(t,e,n,r)}),Wf=bo(function(t,e){var n={};if(null==t)return n;var r=!1;e=f(e,function(e){return e=Si(e,t),r||(r=e.length>1),e}),Hi(t,xo(t),n),r&&(n=Fn(n,ct|ht|ft,vo));for(var i=e.length;i--;)mi(n,e[i]);return n}),Uf=bo(function(t,e){return null==t?{}:Jr(t,e)}),Gf=ho(Ua),Xf=ho(Ga),Yf=$i(function(t,e,n){return e=e.toLowerCase(),t+(n?al(e):e)}),qf=$i(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()}),Kf=$i(function(t,e,n){return t+(n?" ":"")+e.toLowerCase()}),$f=Ki("toLowerCase"),Jf=$i(function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}),Qf=$i(function(t,e,n){return t+(n?" ":"")+td(e)}),Zf=$i(function(t,e,n){return t+(n?" ":"")+e.toUpperCase()}),td=Ki("toUpperCase"),ed=oi(function(t,e){try{return i(t,nt,e)}catch(t){return ra(t)?t:new ac(t)}}),nd=bo(function(t,e){return s(e,function(e){e=rs(e),Bn(t,e,cf(t[e],t))}),t}),rd=to(),id=to(!0),od=oi(function(t,e){return function(n){return Tr(n,t,e)}}),sd=oi(function(t,e){return function(n){return Tr(t,n,e)}}),ud=io(f),ad=io(a),ld=io(v),cd=uo(),hd=uo(!0),fd=ro(function(t,e){return t+e},0),dd=co("ceil"),pd=ro(function(t,e){return t/e},1),_d=co("floor"),vd=ro(function(t,e){return t*e},1),gd=co("round"),md=ro(function(t,e){return t-e},0);return g.after=Tu,g.ary=Ou,g.assign=Pf,g.assignIn=jf,g.assignInWith=Rf,g.assignWith=If,g.at=zf,g.before=Mu,g.bind=cf,g.bindAll=nd,g.bindKey=hf,g.castArray=Wu,g.chain=tu,g.chunk=us,g.compact=as,g.concat=ls,g.cond=Ml,g.conforms=Pl,g.constant=jl,g.countBy=tf,g.create=ja,g.curry=Pu,g.curryRight=ju,g.debounce=Ru,g.defaults=Nf,g.defaultsDeep=Bf,g.defer=ff,g.delay=df,g.difference=Nh,g.differenceBy=Bh,g.differenceWith=Dh,g.drop=cs,g.dropRight=hs,g.dropRightWhile=fs,g.dropWhile=ds,g.fill=ps,g.filter=hu,g.flatMap=fu,g.flatMapDeep=du,g.flatMapDepth=pu,g.flatten=gs,g.flattenDeep=ms,g.flattenDepth=ys,g.flip=Iu,g.flow=rd,g.flowRight=id,g.fromPairs=bs,g.functions=La,g.functionsIn=Fa,g.groupBy=rf,g.initial=ks,g.intersection=Lh,g.intersectionBy=Fh,g.intersectionWith=Hh,g.invert=Df,g.invertBy=Lf,g.invokeMap=of,g.iteratee=zl,g.keyBy=sf,g.keys=Ua,g.keysIn=Ga,g.map=mu,g.mapKeys=Xa,g.mapValues=Ya,g.matches=Nl,g.matchesProperty=Bl,g.memoize=zu,g.merge=Hf,g.mergeWith=Vf,g.method=od,g.methodOf=sd,g.mixin=Dl,g.negate=Nu,g.nthArg=Hl,g.omit=Wf,g.omitBy=qa,g.once=Bu,g.orderBy=yu,g.over=ud,g.overArgs=pf,g.overEvery=ad,g.overSome=ld,g.partial=_f,g.partialRight=vf,g.partition=uf,g.pick=Uf,g.pickBy=Ka,g.property=Vl,g.propertyOf=Wl,g.pull=Vh,g.pullAll=Ts,g.pullAllBy=Os,g.pullAllWith=Ms,g.pullAt=Wh,g.range=cd,g.rangeRight=hd,g.rearg=gf,g.reject=xu,g.remove=Ps,g.rest=Du,g.reverse=js,g.sampleSize=Eu,g.set=Ja,g.setWith=Qa,g.shuffle=Cu,g.slice=Rs,g.sortBy=af,g.sortedUniq=Fs,g.sortedUniqBy=Hs,g.split=yl,g.spread=Lu,g.tail=Vs,g.take=Ws,g.takeRight=Us,g.takeRightWhile=Gs,g.takeWhile=Xs,g.tap=eu,g.throttle=Fu,g.thru=nu,g.toArray=Ea,g.toPairs=Gf,g.toPairsIn=Xf,g.toPath=$l,g.toPlainObject=Oa,g.transform=Za,g.unary=Hu,g.union=Uh,g.unionBy=Gh,g.unionWith=Xh,g.uniq=Ys,g.uniqBy=qs,g.uniqWith=Ks,g.unset=tl,g.unzip=$s,g.unzipWith=Js,g.update=el,g.updateWith=nl,g.values=rl,g.valuesIn=il,g.without=Yh,g.words=Ol,g.wrap=Vu,g.xor=qh,g.xorBy=Kh,g.xorWith=$h,g.zip=Jh,g.zipObject=Qs,g.zipObjectDeep=Zs,g.zipWith=Qh,g.entries=Gf,g.entriesIn=Xf,g.extend=jf,g.extendWith=Rf,Dl(g,g),g.add=fd,g.attempt=ed,g.camelCase=Yf,g.capitalize=al,g.ceil=dd,g.clamp=ol,g.clone=Uu,g.cloneDeep=Xu,g.cloneDeepWith=Yu,g.cloneWith=Gu,g.conformsTo=qu,g.deburr=ll,g.defaultTo=Rl,g.divide=pd,g.endsWith=cl,g.eq=Ku,g.escape=hl,g.escapeRegExp=fl,g.every=cu,g.find=ef,g.findIndex=_s,g.findKey=Ra,g.findLast=nf,g.findLastIndex=vs,g.findLastKey=Ia,g.floor=_d,g.forEach=_u,g.forEachRight=vu,g.forIn=za,g.forInRight=Na,g.forOwn=Ba,g.forOwnRight=Da,g.get=Ha,g.gt=mf,g.gte=yf,g.has=Va,g.hasIn=Wa,g.head=ws,g.identity=Il,g.includes=gu,g.indexOf=xs,g.inRange=sl,g.invoke=Ff,g.isArguments=bf,g.isArray=wf,g.isArrayBuffer=xf,g.isArrayLike=$u,g.isArrayLikeObject=Ju,g.isBoolean=Qu,g.isBuffer=kf,g.isDate=Ef,g.isElement=Zu,g.isEmpty=ta,g.isEqual=ea,g.isEqualWith=na,g.isError=ra,g.isFinite=ia,g.isFunction=oa,g.isInteger=sa,g.isLength=ua,g.isMap=Cf,g.isMatch=ca,g.isMatchWith=ha,g.isNaN=fa,g.isNative=da,g.isNil=_a,g.isNull=pa,g.isNumber=va,g.isObject=aa,g.isObjectLike=la,g.isPlainObject=ga,g.isRegExp=Sf,g.isSafeInteger=ma,g.isSet=Af,g.isString=ya,g.isSymbol=ba,g.isTypedArray=Tf,g.isUndefined=wa,g.isWeakMap=xa,g.isWeakSet=ka,g.join=Es,g.kebabCase=qf,g.last=Cs,g.lastIndexOf=Ss,g.lowerCase=Kf,g.lowerFirst=$f,g.lt=Of,g.lte=Mf,g.max=Ql,g.maxBy=Zl,g.mean=tc,g.meanBy=ec,g.min=nc,g.minBy=rc,g.stubArray=Ul,g.stubFalse=Gl,g.stubObject=Xl,g.stubString=Yl,g.stubTrue=ql,g.multiply=vd,g.nth=As,g.noConflict=Ll,g.noop=Fl,g.now=lf,g.pad=dl,g.padEnd=pl,g.padStart=_l,g.parseInt=vl,g.random=ul,g.reduce=bu,g.reduceRight=wu,g.repeat=gl,g.replace=ml,g.result=$a,g.round=gd,g.runInContext=t,g.sample=ku,g.size=Su,g.snakeCase=Jf,g.some=Au,g.sortedIndex=Is,g.sortedIndexBy=zs,g.sortedIndexOf=Ns,g.sortedLastIndex=Bs,g.sortedLastIndexBy=Ds,g.sortedLastIndexOf=Ls,g.startCase=Qf,g.startsWith=bl,g.subtract=md,g.sum=ic,g.sumBy=oc,g.template=wl,g.times=Kl,g.toFinite=Ca,g.toInteger=Sa,g.toLength=Aa,g.toLower=xl,g.toNumber=Ta,g.toSafeInteger=Ma,g.toString=Pa,g.toUpper=kl,g.trim=El,g.trimEnd=Cl,g.trimStart=Sl,g.truncate=Al,g.unescape=Tl,g.uniqueId=Jl,g.upperCase=Zf,g.upperFirst=td,g.each=_u,g.eachRight=vu,g.first=ws,Dl(g,function(){var t={};return ir(g,function(e,n){bc.call(g.prototype,n)||(t[n]=e)}),t}(),{chain:!1}),g.VERSION=rt,s(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){g[t].placeholder=g}),s(["drop","take"],function(t,e){K.prototype[t]=function(n){n=n===nt?1:Kc(Sa(n),0);var r=this.__filtered__&&!e?new K(this):this.clone();return r.__filtered__?r.__takeCount__=$c(n,r.__takeCount__):r.__views__.push({size:$c(n,Nt),type:t+(r.__dir__<0?"Right":"")}),r},K.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}}),s(["filter","map","takeWhile"],function(t,e){var n=e+1,r=n==Ot||n==Pt;K.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Co(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}}),s(["head","last"],function(t,e){var n="take"+(e?"Right":"");K.prototype[t]=function(){return this[n](1).value()[0]}}),s(["initial","tail"],function(t,e){var n="drop"+(e?"":"Right");K.prototype[t]=function(){return this.__filtered__?new K(this):this[n](1)}}),K.prototype.compact=function(){return this.filter(Il)},K.prototype.find=function(t){return this.filter(t).head()},K.prototype.findLast=function(t){return this.reverse().find(t)},K.prototype.invokeMap=oi(function(t,e){return"function"==typeof t?new K(this):this.map(function(n){return Tr(n,t,e)})}),K.prototype.reject=function(t){return this.filter(Nu(Co(t)))},K.prototype.slice=function(t,e){t=Sa(t);var n=this;return n.__filtered__&&(t>0||e<0)?new K(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==nt&&(e=Sa(e),n=e<0?n.dropRight(-e):n.take(e-t)),n)},K.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},K.prototype.toArray=function(){return this.take(Nt)},ir(K.prototype,function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),i=g[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);i&&(g.prototype[e]=function(){var e=this.__wrapped__,s=r?[1]:arguments,u=e instanceof K,a=s[0],l=u||wf(e),c=function(t){var e=i.apply(g,d([t],s));return r&&h?e[0]:e};l&&n&&"function"==typeof a&&1!=a.length&&(u=l=!1);var h=this.__chain__,f=!!this.__actions__.length,p=o&&!h,_=u&&!f;if(!o&&l){e=_?e:new K(this);var v=t.apply(e,s);return v.__actions__.push({func:nu,args:[c],thisArg:nt}),new H(v,h)}return p&&_?t.apply(this,s):(v=this.thru(c),p?r?v.value()[0]:v.value():v)})}),s(["pop","push","shift","sort","splice","unshift"],function(t){var e=_c[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);g.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(wf(i)?i:[],t)}return this[n](function(n){return e.apply(wf(n)?n:[],t)})}}),ir(K.prototype,function(t,e){var n=g[e];if(n){var r=n.name+"",i=ah[r]||(ah[r]=[]);i.push({name:e,func:n})}}),ah[eo(nt,vt).name]=[{name:"wrapper",func:nt}],K.prototype.clone=Z,K.prototype.reverse=tt,K.prototype.value=He,g.prototype.at=Zh,g.prototype.chain=ru,g.prototype.commit=iu,g.prototype.next=ou,g.prototype.plant=uu,g.prototype.reverse=au,g.prototype.toJSON=g.prototype.valueOf=g.prototype.value=lu,g.prototype.first=g.prototype.head,Nc&&(g.prototype[Nc]=su),g},xr=wr();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(or._=xr,define(function(){return xr})):ur?((ur.exports=xr)._=xr,sr._=xr):or._=xr}).call(H)});o.cloneFrom=function(t){return new o(t.x,t.y)},o.fromArray=function(t){return new o(t[0],t[1])},o.zero=new o(0,0),o.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},o.prototype.addScalar=function(t){return this.x+=t,this.y+=t,this},o.prototype.eq=function(t){return t.x===this.x&&t.y===this.y},o.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},o.prototype.clone=function(){return new o(this.x,this.y)},o.prototype.set=function(t){return this.x=t.x,this.y=t.y,this},o.prototype.setValues=function(t,e){return this.x=t,this.y=e,this},o.prototype.dist=function(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))},o.prototype.normalise=function(){return this.normalize()},o.prototype.normalize=function(){if(!this.isZero()){var t=this.magnitude();this.x/=t,this.y/=t}return this},o.prototype.isZero=function(){return 0===this.x&&0===this.y},o.prototype.reverse=function(){return this.x=-this.x,this.y=-this.y,this},o.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},o.prototype.toArray=function(){return[this.x,this.y]},o.prototype.angle=function(){return Math.atan2(this.y,this.x)},o.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t);return this.setValues(this.x*e-this.y*n,this.x*n+this.y*e)},o.prototype.angleTo=function(t){return Math.atan2(t.y-this.y,t.x-this.x)},o.prototype.rotateAround=function(t,e){return this.subtract(t).rotate(e).add(t)},o.prototype.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},o.prototype.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},o.prototype.divide=function(t){return this.x/=t.x,this.y/=t.y,this},o.prototype.divideScalar=function(t){return this.x/=t,this.y/=t,this},o.prototype.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},o.prototype.dot=function(t){return this.x*t.x+this.y*t.y};var W=i(function(t){var e=function(){var t=Date.now(),e=t,n=0,r=1/0,i=0,o=0,s=1/0,u=0,a=0,l=0,c=document.createElement("div");c.id="stats",c.addEventListener("mousedown",function(t){t.preventDefault(),m(++l%2)},!1),c.style.cssText="width:80px;opacity:0.9;cursor:pointer";var h=document.createElement("div");h.id="fps",h.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",c.appendChild(h);var f=document.createElement("div");f.id="fpsText",f.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",f.innerHTML="FPS",h.appendChild(f);var d=document.createElement("div");for(d.id="fpsGraph",d.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",h.appendChild(d);74>d.children.length;){var p=document.createElement("span");p.style.cssText="width:1px;height:30px;float:left;background-color:#113",d.appendChild(p)}var _=document.createElement("div");_.id="ms",_.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",c.appendChild(_);var v=document.createElement("div");v.id="msText",v.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",v.innerHTML="MS",_.appendChild(v);var g=document.createElement("div");for(g.id="msGraph",g.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",_.appendChild(g);74>g.children.length;)p=document.createElement("span"),p.style.cssText="width:1px;height:30px;float:left;background-color:#131",g.appendChild(p);var m=function(t){switch(l=t){case 0:h.style.display="block",_.style.display="none";break;case 1:h.style.display="none",_.style.display="block"}};return{REVISION:12,domElement:c,setMode:m,begin:function(){t=Date.now()},end:function(){var l=Date.now();n=l-t,r=Math.min(r,n),i=Math.max(i,n),v.textContent=n+" MS ("+r+"-"+i+")";var c=Math.min(30,30-30*(n/200));return g.appendChild(g.firstChild).style.height=c+"px",a++,l>e+1e3&&(o=Math.round(1e3*a/(l-e)),s=Math.min(s,o),u=Math.max(u,o),f.textContent=o+" FPS ("+s+"-"+u+")",c=Math.min(30,30-30*(o/100)),d.appendChild(d.firstChild).style.height=c+"px",e=l,a=0),l},update:function(){t=this.end()}}};"object"==typeof t&&(t.exports=e)}),U=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"initialize",value:function(){this.drawStats=new W,this.drawStats.setMode(0),this.drawStats.domElement.style.position="absolute",this.drawStats.domElement.style.left="0px",this.drawStats.domElement.style.top="0px",document.body.appendChild(this.drawStats.domElement),this.tickStats=new W,this.tickStats.setMode(0),this.tickStats.domElement.style.position="absolute",this.tickStats.domElement.style.left="0px",this.tickStats.domElement.style.top="55px",document.body.appendChild(this.tickStats.domElement)}},{key:"updateStart",value:function(){this.tickStats.begin()}},{key:"updateEnd",value:function(){this.tickStats.end()}},{key:"drawStart",value:function(){this.drawStats.begin()}},{key:"drawEnd",value:function(){this.drawStats.end()}}]),e}(D);n("DrawStats",U);var G=s,X=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"initialize",value:function(){this.stats=new G,this.stats.domElement.style.position="fixed",this.stats.domElement.style.left="85px",this.stats.domElement.style.top="0px",document.body.appendChild(this.stats.domElement)}},{key:"draw",value:function(){this.stats.update()}}]),e}(D);n("MemoryStats",X);var Y=i(function(t){var e=t.exports=e||{};e.gui=e.gui||{},e.utils=e.utils||{},e.controllers=e.controllers||{},e.dom=e.dom||{},e.color=e.color||{},e.utils.css=function(){return{load:function(t,e){e=e||document;var n=e.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=t,e.getElementsByTagName("head")[0].appendChild(n)},inject:function(t,e){e=e||document;var n=document.createElement("style");n.type="text/css",n.innerHTML=t,e.getElementsByTagName("head")[0].appendChild(n)}}}(),e.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),r=t.length-1;r>=0;r--)n=[t[r].apply(this,n)];return n[0]}},each:function(e,n,r){if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===e.length+0){for(var i=0,o=e.length;i<o;i++)if(i in e&&n.call(r,e[i],i)===this.BREAK)return}else for(var i in e)if(n.call(r,e[i],i)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),e.controllers.Controller=function(t){var e=function(t,e){this.initialValue=t[e],this.domElement=document.createElement("div"),this.object=t,this.property=e,this.__onChange=void 0,this.__onFinishChange=void 0};return t.extend(e.prototype,{onChange:function(t){return this.__onChange=t,this},onFinishChange:function(t){return this.__onFinishChange=t,this},setValue:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),e}(e.utils.common),e.dom.dom=function(t){function e(e){if("0"===e||t.isUndefined(e))return 0;var n=e.match(i);return t.isNull(n)?0:parseFloat(n[1])}var n={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},r={};t.each(n,function(e,n){t.each(e,function(t){r[t]=n})});var i=/(\d+(\.\d+)?)px/,o={makeSelectable:function(t,e){void 0!==t&&void 0!==t.style&&(t.onselectstart=e?function(){return!1}:function(){},t.style.MozUserSelect=e?"auto":"none",t.style.KhtmlUserSelect=e?"auto":"none",t.unselectable=e?"on":"off")},makeFullscreen:function(e,n,r){t.isUndefined(n)&&(n=!0),t.isUndefined(r)&&(r=!0),e.style.position="absolute",n&&(e.style.left=0,e.style.right=0),r&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,n,i,o){i=i||{};var s=r[n];if(!s)throw new Error("Event type "+n+" not supported.");var u=document.createEvent(s);switch(s){case"MouseEvents":var a=i.x||i.clientX||0,l=i.y||i.clientY||0;u.initMouseEvent(n,i.bubbles||!1,i.cancelable||!0,window,i.clickCount||1,0,0,a,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=u.initKeyboardEvent||u.initKeyEvent;t.defaults(i,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(n,i.bubbles||!1,i.cancelable,window,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.keyCode,i.charCode);break;default:u.initEvent(n,i.bubbles||!1,i.cancelable||!0)}t.defaults(u,o),e.dispatchEvent(u)},bind:function(t,e,n,r){return r=r||!1,t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on"+e,n),o},unbind:function(t,e,n,r){return r=r||!1,t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent&&t.detachEvent("on"+e,n),o},addClass:function(t,e){if(void 0===t.className)t.className=e;else if(t.className!==e){var n=t.className.split(/ +/);n.indexOf(e)==-1&&(n.push(e),t.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return o},removeClass:function(t,e){if(e)if(void 0===t.className);else if(t.className===e)t.removeAttribute("class");else{var n=t.className.split(/ +/),r=n.indexOf(e);r!=-1&&(n.splice(r,1),t.className=n.join(" "))}else t.className=void 0;return o},hasClass:function(t,e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(t.className)||!1},getWidth:function(t){var n=getComputedStyle(t);return e(n["border-left-width"])+e(n["border-right-width"])+e(n["padding-left"])+e(n["padding-right"])+e(n.width)},getHeight:function(t){var n=getComputedStyle(t);return e(n["border-top-width"])+e(n["border-bottom-width"])+e(n["padding-top"])+e(n["padding-bottom"])+e(n.height)},getOffset:function(t){var e={left:0,top:0};if(t.offsetParent)do e.left+=t.offsetLeft,e.top+=t.offsetTop;while(t=t.offsetParent);return e},isActive:function(t){return t===document.activeElement&&(t.type||t.href)}};return o}(e.utils.common),e.controllers.OptionController=function(t,e,n){var r=function(t,i,o){r.superclass.call(this,t,i);var s=this;if(this.__select=document.createElement("select"),n.isArray(o)){var u={};n.each(o,function(t){u[t]=t}),o=u}n.each(o,function(t,e){var n=document.createElement("option");n.innerHTML=e,n.setAttribute("value",t),s.__select.appendChild(n)}),this.updateDisplay(),e.bind(this.__select,"change",function(){var t=this.options[this.selectedIndex].value;s.setValue(t)}),this.domElement.appendChild(this.__select)};return r.superclass=t,n.extend(r.prototype,t.prototype,{setValue:function(t){var e=r.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),e},updateDisplay:function(){return this.__select.value=this.getValue(),r.superclass.prototype.updateDisplay.call(this)}}),r}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.NumberController=function(t,e){function n(t){return t=t.toString(),t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var r=function(t,i,o){r.superclass.call(this,t,i),o=o||{},this.__min=o.min,this.__max=o.max,this.__step=o.step,e.isUndefined(this.__step)?0==this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=n(this.__impliedStep)};return r.superclass=t,e.extend(r.prototype,t.prototype,{setValue:function(t){return void 0!==this.__min&&t<this.__min?t=this.__min:void 0!==this.__max&&t>this.__max&&(t=this.__max),void 0!==this.__step&&t%this.__step!=0&&(t=Math.round(t/this.__step)*this.__step),r.superclass.prototype.setValue.call(this,t)},min:function(t){return this.__min=t,this},max:function(t){return this.__max=t,this},step:function(t){return this.__step=t,this}}),r}(e.controllers.Controller,e.utils.common),e.controllers.NumberControllerBox=function(t,e,n){function r(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var i=function(t,r,o){function s(){var t=parseFloat(f.__input.value);n.isNaN(t)||f.setValue(t)}function u(){s(),f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())}function a(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),h=t.clientY}function l(t){var e=h-t.clientY;f.setValue(f.getValue()+e*f.__impliedStep),h=t.clientY}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c)}this.__truncationSuspended=!1,i.superclass.call(this,t,r,o);var h,f=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"change",s),e.bind(this.__input,"blur",u),e.bind(this.__input,"mousedown",a),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&(f.__truncationSuspended=!0,this.blur(),f.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return i.superclass=t,n.extend(i.prototype,t.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():r(this.getValue(),this.__precision),i.superclass.prototype.updateDisplay.call(this)}}),i}(e.controllers.NumberController,e.dom.dom,e.utils.common),e.controllers.NumberControllerSlider=function(t,e,n,r,i){function o(t,e,n,r,i){return r+(i-r)*((t-e)/(n-e))}var s=function(t,n,r,i,u){function a(t){e.bind(window,"mousemove",l),e.bind(window,"mouseup",c),l(t)}function l(t){t.preventDefault();var n=e.getOffset(h.__background),r=e.getWidth(h.__background);return h.setValue(o(t.clientX,n.left,n.left+r,h.__min,h.__max)),!1}function c(){e.unbind(window,"mousemove",l),e.unbind(window,"mouseup",c),h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}s.superclass.call(this,t,n,{min:r,max:i,step:u});var h=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),e.bind(this.__background,"mousedown",a),e.addClass(this.__background,"slider"),e.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return s.superclass=t,s.useDefaultStyles=function(){n.inject(i)},r.extend(s.prototype,t.prototype,{updateDisplay:function(){var t=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*t+"%",s.superclass.prototype.updateDisplay.call(this);
}}),s}(e.controllers.NumberController,e.dom.dom,e.utils.css,e.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),e.controllers.FunctionController=function(t,e,n){var r=function(t,n,i){r.superclass.call(this,t,n);var o=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===i?"Fire":i,e.bind(this.__button,"click",function(t){return t.preventDefault(),o.fire(),!1}),e.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return r.superclass=t,n.extend(r.prototype,t.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),r}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.BooleanController=function(t,e,n){var r=function(t,n){function i(){o.setValue(!o.__prev)}r.superclass.call(this,t,n);var o=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),e.bind(this.__checkbox,"change",i,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return r.superclass=t,n.extend(r.prototype,t.prototype,{setValue:function(t){var e=r.superclass.prototype.setValue.call(this,t);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),e},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,r.superclass.prototype.updateDisplay.call(this)}}),r}(e.controllers.Controller,e.dom.dom,e.utils.common),e.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var n=e.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(e.utils.common),e.color.interpret=function(t,e){var n,r,i=function(){r=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(o,function(i){if(i.litmus(t))return e.each(i.conversions,function(i,o){if(n=i.read(t),r===!1&&n!==!1)return r=n,n.conversionName=o,n.conversion=i,e.BREAK}),e.BREAK}),r},o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3==t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4==t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return i}(e.color.toString,e.utils.common),e.GUI=e.gui.GUI=function(t,e,n,r,i,o,s,u,a,l,c,h,f,d,p){function _(t,e,n,o){if(void 0===e[n])throw new Error("Object "+e+' has no property "'+n+'"');var s;if(o.color)s=new c(e,n);else{var u=[e,n].concat(o.factoryArgs);s=r.apply(t,u)}o.before instanceof i&&(o.before=o.before.__li),m(t,s),d.addClass(s.domElement,"c");var a=document.createElement("span");d.addClass(a,"property-name"),a.innerHTML=s.property;var l=document.createElement("div");l.appendChild(a),l.appendChild(s.domElement);var h=v(t,l,o.before);return d.addClass(h,D.CLASS_CONTROLLER_ROW),d.addClass(h,typeof s.getValue()),g(t,h,s),t.__controllers.push(s),s}function v(t,e,n){var r=document.createElement("li");return e&&r.appendChild(e),n?t.__ul.insertBefore(r,params.before):t.__ul.appendChild(r),t.onResize(),r}function g(t,e,n){if(n.__li=e,n.__gui=t,p.extend(n,{options:function(e){return arguments.length>1?(n.remove(),_(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[p.toArray(arguments)]})):p.isArray(e)||p.isObject(e)?(n.remove(),_(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[e]})):void 0},name:function(t){return n.__li.firstElementChild.firstElementChild.innerHTML=t,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof a){var r=new u(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});p.each(["updateDisplay","onChange","onFinishChange"],function(t){var e=n[t],i=r[t];n[t]=r[t]=function(){var t=Array.prototype.slice.call(arguments);return e.apply(n,t),i.apply(r,t)}}),d.addClass(e,"has-slider"),n.domElement.insertBefore(r.domElement,n.domElement.firstElementChild)}else if(n instanceof u){var i=function(e){return p.isNumber(n.__min)&&p.isNumber(n.__max)?(n.remove(),_(t,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]})):e};n.min=p.compose(i,n.min),n.max=p.compose(i,n.max)}else n instanceof o?(d.bind(e,"click",function(){d.fakeEvent(n.__checkbox,"click")}),d.bind(n.__checkbox,"click",function(t){t.stopPropagation()})):n instanceof s?(d.bind(e,"click",function(){d.fakeEvent(n.__button,"click")}),d.bind(e,"mouseover",function(){d.addClass(n.__button,"hover")}),d.bind(e,"mouseout",function(){d.removeClass(n.__button,"hover")})):n instanceof c&&(d.addClass(e,"color"),n.updateDisplay=p.compose(function(t){return e.style.borderLeftColor=n.__color.toString(),t},n.updateDisplay),n.updateDisplay());n.setValue=p.compose(function(e){return t.getRoot().__preset_select&&n.isModified()&&S(t.getRoot(),!0),e},n.setValue)}function m(t,e){var n=t.getRoot(),r=n.__rememberedObjects.indexOf(e.object);if(r!=-1){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,n.load&&n.load.remembered){var o,s=n.load.remembered;if(s[t.preset])o=s[t.preset];else{if(!s[R])return;o=s[R]}if(o[r]&&void 0!==o[r][e.property]){var u=o[r][e.property];e.initialValue=u,e.setValue(u)}}}}function y(t,e){return document.location.href+"."+e}function b(t){function e(){l.style.display=t.useLocalStorage?"block":"none"}var n=t.__save_row=document.createElement("li");d.addClass(t.domElement,"has-save"),t.__ul.insertBefore(n,t.__ul.firstChild),d.addClass(n,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",d.addClass(r,"button gears");var i=document.createElement("span");i.innerHTML="Save",d.addClass(i,"button"),d.addClass(i,"save");var o=document.createElement("span");o.innerHTML="New",d.addClass(o,"button"),d.addClass(o,"save-as");var s=document.createElement("span");s.innerHTML="Revert",d.addClass(s,"button"),d.addClass(s,"revert");var u=t.__preset_select=document.createElement("select");if(t.load&&t.load.remembered?p.each(t.load.remembered,function(e,n){E(t,n,n==t.preset)}):E(t,R,!1),d.bind(u,"change",function(){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].innerHTML=t.__preset_select[e].value;t.preset=this.value}),n.appendChild(u),n.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(s),I){var a=document.getElementById("dg-save-locally"),l=document.getElementById("dg-local-explain");a.style.display="block";var c=document.getElementById("dg-local-storage");"true"===localStorage.getItem(y(t,"isLocal"))&&c.setAttribute("checked","checked"),e(),d.bind(c,"change",function(){t.useLocalStorage=!t.useLocalStorage,e()})}var h=document.getElementById("dg-new-constructor");d.bind(h,"keydown",function(t){!t.metaKey||67!==t.which&&67!=t.keyCode||T.hide()}),d.bind(r,"click",function(){h.innerHTML=JSON.stringify(t.getSaveObject(),void 0,2),T.show(),h.focus(),h.select()}),d.bind(i,"click",function(){t.save()}),d.bind(o,"click",function(){var e=prompt("Enter a new preset name.");e&&t.saveAs(e)}),d.bind(s,"click",function(){t.revert()})}function w(t){function e(e){return e.preventDefault(),i=e.clientX,d.addClass(t.__closeButton,D.CLASS_DRAG),d.bind(window,"mousemove",n),d.bind(window,"mouseup",r),!1}function n(e){return e.preventDefault(),t.width+=i-e.clientX,t.onResize(),i=e.clientX,!1}function r(){d.removeClass(t.__closeButton,D.CLASS_DRAG),d.unbind(window,"mousemove",n),d.unbind(window,"mouseup",r)}t.__resize_handle=document.createElement("div"),p.extend(t.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var i;d.bind(t.__resize_handle,"mousedown",e),d.bind(t.__closeButton,"mousedown",e),t.domElement.insertBefore(t.__resize_handle,t.domElement.firstElementChild)}function x(t,e){t.domElement.style.width=e+"px",t.__save_row&&t.autoPlace&&(t.__save_row.style.width=e+"px"),t.__closeButton&&(t.__closeButton.style.width=e+"px")}function k(t,e){var n={};return p.each(t.__rememberedObjects,function(r,i){var o={},s=t.__rememberedObjectIndecesToControllers[i];p.each(s,function(t,n){o[n]=e?t.initialValue:t.getValue()}),n[i]=o}),n}function E(t,e,n){var r=document.createElement("option");r.innerHTML=e,r.value=e,t.__preset_select.appendChild(r),n&&(t.__preset_select.selectedIndex=t.__preset_select.length-1)}function C(t){for(var e=0;e<t.__preset_select.length;e++)t.__preset_select[e].value==t.preset&&(t.__preset_select.selectedIndex=e)}function S(t,e){var n=t.__preset_select[t.__preset_select.selectedIndex];e?n.innerHTML=n.value+"*":n.innerHTML=n.value}function A(t){0!=t.length&&h(function(){A(t)}),p.each(t,function(t){t.updateDisplay()})}t.inject(n);var T,O,M="dg",P=72,j=20,R="Default",I=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}}(),z=!0,N=!1,B=[],D=function(t){function e(){localStorage.setItem(y(r,"gui"),JSON.stringify(r.getSaveObject()))}function n(){var t=r.getRoot();t.width+=1,p.defer(function(){t.width-=1})}var r=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),d.addClass(this.domElement,M),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],t=t||{},t=p.defaults(t,{autoPlace:!0,width:D.DEFAULT_WIDTH}),t=p.defaults(t,{resizable:t.autoPlace,hideable:t.autoPlace}),p.isUndefined(t.load)?t.load={preset:R}:t.preset&&(t.load.preset=t.preset),p.isUndefined(t.parent)&&t.hideable&&B.push(this),t.resizable=p.isUndefined(t.parent)&&t.resizable,t.autoPlace&&p.isUndefined(t.scrollable)&&(t.scrollable=!0);var i=I&&"true"===localStorage.getItem(y(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return t.parent}},scrollable:{get:function(){return t.scrollable}},autoPlace:{get:function(){return t.autoPlace}},preset:{get:function(){return r.parent?r.getRoot().preset:t.load.preset},set:function(e){r.parent?r.getRoot().preset=e:t.load.preset=e,C(this),r.revert()}},width:{get:function(){return t.width},set:function(e){t.width=e,x(r,e)}},name:{get:function(){return t.name},set:function(e){t.name=e,s&&(s.innerHTML=t.name)}},closed:{get:function(){return t.closed},set:function(e){t.closed=e,t.closed?d.addClass(r.__ul,D.CLASS_CLOSED):d.removeClass(r.__ul,D.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=e?D.TEXT_OPEN:D.TEXT_CLOSED)}},load:{get:function(){return t.load}},useLocalStorage:{get:function(){return i},set:function(t){I&&(i=t,t?d.bind(window,"unload",e):d.unbind(window,"unload",e),localStorage.setItem(y(r,"isLocal"),t))}}}),p.isUndefined(t.parent)){if(t.closed=!1,d.addClass(this.domElement,D.CLASS_MAIN),d.makeSelectable(this.domElement,!1),I&&i){r.useLocalStorage=!0;var o=localStorage.getItem(y(this,"gui"));o&&(t.load=JSON.parse(o))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=D.TEXT_CLOSED,d.addClass(this.__closeButton,D.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),d.bind(this.__closeButton,"click",function(){r.closed=!r.closed})}else{void 0===t.closed&&(t.closed=!0);var s=document.createTextNode(t.name);d.addClass(s,"controller-name");var u=v(r,s),a=function(t){return t.preventDefault(),r.closed=!r.closed,!1};d.addClass(this.__ul,D.CLASS_CLOSED),d.addClass(u,"title"),d.bind(u,"click",a),t.closed||(this.closed=!1)}t.autoPlace&&(p.isUndefined(t.parent)&&(z&&(O=document.createElement("div"),d.addClass(O,M),d.addClass(O,D.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(O),z=!1),O.appendChild(this.domElement),d.addClass(this.domElement,D.CLASS_AUTO_PLACE)),this.parent||x(r,t.width)),d.bind(window,"resize",function(){r.onResize()}),d.bind(this.__ul,"webkitTransitionEnd",function(){r.onResize()}),d.bind(this.__ul,"transitionend",function(){r.onResize()}),d.bind(this.__ul,"oTransitionEnd",function(){r.onResize()}),this.onResize(),t.resizable&&w(this);r.getRoot();t.parent||n()};return D.toggleHide=function(){N=!N,p.each(B,function(t){t.domElement.style.zIndex=N?-999:999,t.domElement.style.opacity=N?0:1})},D.CLASS_AUTO_PLACE="a",D.CLASS_AUTO_PLACE_CONTAINER="ac",D.CLASS_MAIN="main",D.CLASS_CONTROLLER_ROW="cr",D.CLASS_TOO_TALL="taller-than-window",D.CLASS_CLOSED="closed",D.CLASS_CLOSE_BUTTON="close-button",D.CLASS_DRAG="drag",D.DEFAULT_WIDTH=245,D.TEXT_CLOSED="Close Controls",D.TEXT_OPEN="Open Controls",d.bind(window,"keydown",function(t){"text"===document.activeElement.type||t.which!==P&&t.keyCode!=P||D.toggleHide()},!1),p.extend(D.prototype,{add:function(t,e){return _(this,t,e,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(t,e){return _(this,t,e,{color:!0})},remove:function(t){this.__ul.removeChild(t.__li),this.__controllers.slice(this.__controllers.indexOf(t),1);var e=this;p.defer(function(){e.onResize()})},destroy:function(){this.autoPlace&&O.removeChild(this.domElement)},addFolder:function(t){if(void 0!==this.__folders[t])throw new Error('You already have a folder in this GUI by the name "'+t+'"');var e={name:t,parent:this};e.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[t]&&(e.closed=this.load.folders[t].closed,e.load=this.load.folders[t]);var n=new D(e);this.__folders[t]=n;var r=v(this,n.domElement);return d.addClass(r,"folder"),n},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var t=this.getRoot();if(t.scrollable){var e=d.getOffset(t.__ul).top,n=0;p.each(t.__ul.childNodes,function(e){t.autoPlace&&e===t.__save_row||(n+=d.getHeight(e))}),window.innerHeight-e-j<n?(d.addClass(t.domElement,D.CLASS_TOO_TALL),t.__ul.style.height=window.innerHeight-e-j+"px"):(d.removeClass(t.domElement,D.CLASS_TOO_TALL),t.__ul.style.height="auto")}t.__resize_handle&&p.defer(function(){t.__resize_handle.style.height=t.__ul.offsetHeight+"px"}),t.__closeButton&&(t.__closeButton.style.width=t.width+"px")},remember:function(){if(p.isUndefined(T)&&(T=new f,T.domElement.innerHTML=e),this.parent)throw new Error("You can only call remember on a top level GUI.");var t=this;p.each(Array.prototype.slice.call(arguments),function(e){0==t.__rememberedObjects.length&&b(t),t.__rememberedObjects.indexOf(e)==-1&&t.__rememberedObjects.push(e)}),this.autoPlace&&x(this,this.width)},getRoot:function(){for(var t=this;t.parent;)t=t.parent;return t},getSaveObject:function(){var t=this.load;return t.closed=this.closed,this.__rememberedObjects.length>0&&(t.preset=this.preset,t.remembered||(t.remembered={}),t.remembered[this.preset]=k(this)),t.folders={},p.each(this.__folders,function(e,n){t.folders[n]=e.getSaveObject()}),t},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=k(this),S(this,!1)},saveAs:function(t){this.load.remembered||(this.load.remembered={},this.load.remembered[R]=k(this,!0)),this.load.remembered[t]=k(this),this.preset=t,E(this,t,!0)},revert:function(t){p.each(this.__controllers,function(e){this.getRoot().load.remembered?m(t||this.getRoot(),e):e.setValue(e.initialValue)},this),p.each(this.__folders,function(t){t.revert(t)}),t||S(this.getRoot(),!1)},listen:function(t){var e=0==this.__listening.length;this.__listening.push(t),e&&A(this.__listening)}}),D}(e.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",e.controllers.factory=function(t,e,n,r,i,o,s){return function(u,a){var l=u[a];return s.isArray(arguments[2])||s.isObject(arguments[2])?new t(u,a,arguments[2]):s.isNumber(l)?s.isNumber(arguments[2])&&s.isNumber(arguments[3])?new n(u,a,arguments[2],arguments[3]):new e(u,a,{min:arguments[2],max:arguments[3]}):s.isString(l)?new r(u,a):s.isFunction(l)?new i(u,a,""):s.isBoolean(l)?new o(u,a):void 0}}(e.controllers.OptionController,e.controllers.NumberControllerBox,e.controllers.NumberControllerSlider,e.controllers.StringController=function(t,e,n){var r=function(t,n){function i(){s.setValue(s.__input.value)}function o(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}r.superclass.call(this,t,n);var s=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),e.bind(this.__input,"keyup",i),e.bind(this.__input,"change",i),e.bind(this.__input,"blur",o),e.bind(this.__input,"keydown",function(t){13===t.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return r.superclass=t,n.extend(r.prototype,t.prototype,{updateDisplay:function(){return e.isActive(this.__input)||(this.__input.value=this.getValue()),r.superclass.prototype.updateDisplay.call(this)}}),r}(e.controllers.Controller,e.dom.dom,e.utils.common),e.controllers.FunctionController,e.controllers.BooleanController,e.utils.common),e.controllers.Controller,e.controllers.BooleanController,e.controllers.FunctionController,e.controllers.NumberControllerBox,e.controllers.NumberControllerSlider,e.controllers.OptionController,e.controllers.ColorController=function(t,e,n,r,i){function o(t,e,n,r){t.style.background="",i.each(a,function(i){t.style.cssText+="background: "+i+"linear-gradient("+e+", "+n+" 0%, "+r+" 100%); "})}function s(t){t.style.background="",t.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",t.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",t.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var u=function(t,a){function l(t){d(t),e.bind(window,"mousemove",d),e.bind(window,"mouseup",c)}function c(){e.unbind(window,"mousemove",d),e.unbind(window,"mouseup",c)}function h(){var t=r(this.value);t!==!1?(_.__color.__state=t,_.setValue(_.__color.toOriginal())):this.value=_.__color.toString()}function f(){e.unbind(window,"mousemove",p),e.unbind(window,"mouseup",f)}function d(t){t.preventDefault();var n=e.getWidth(_.__saturation_field),r=e.getOffset(_.__saturation_field),i=(t.clientX-r.left+document.body.scrollLeft)/n,o=1-(t.clientY-r.top+document.body.scrollTop)/n;return o>1?o=1:o<0&&(o=0),i>1?i=1:i<0&&(i=0),_.__color.v=o,_.__color.s=i,_.setValue(_.__color.toOriginal()),!1}function p(t){t.preventDefault();var n=e.getHeight(_.__hue_field),r=e.getOffset(_.__hue_field),i=1-(t.clientY-r.top+document.body.scrollTop)/n;return i>1?i=1:i<0&&(i=0),_.__color.h=360*i,_.setValue(_.__color.toOriginal()),!1}u.superclass.call(this,t,a),this.__color=new n(this.getValue()),this.__temp=new n(0);var _=this;this.domElement=document.createElement("div"),e.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",e.bind(this.__input,"keydown",function(t){13===t.keyCode&&h.call(this)}),e.bind(this.__input,"blur",h),e.bind(this.__selector,"mousedown",function(t){e.addClass(this,"drag").bind(window,"mouseup",function(t){e.removeClass(_.__selector,"drag")})});var v=document.createElement("div");i.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),i.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),i.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),i.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),i.extend(v.style,{width:"100%",height:"100%",background:"none"}),o(v,"top","rgba(0,0,0,0)","#000"),i.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),s(this.__hue_field),i.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),e.bind(this.__saturation_field,"mousedown",l),e.bind(this.__field_knob,"mousedown",l),e.bind(this.__hue_field,"mousedown",function(t){p(t),e.bind(window,"mousemove",p),e.bind(window,"mouseup",f)}),this.__saturation_field.appendChild(v),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};u.superclass=t,i.extend(u.prototype,t.prototype,{updateDisplay:function(){var t=r(this.getValue());if(t!==!1){var e=!1;i.each(n.COMPONENTS,function(n){if(!i.isUndefined(t[n])&&!i.isUndefined(this.__color.__state[n])&&t[n]!==this.__color.__state[n])return e=!0,{}},this),e&&i.extend(this.__color.__state,t)}i.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,u=255-s;i.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,o(this.__saturation_field,"left","#fff",this.__temp.toString()),i.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+u+","+u+","+u+",.7)"})}});var a=["-moz-","-o-","-webkit-","-ms-",""];return u}(e.controllers.Controller,e.dom.dom,e.color.Color=function(t,e,n,r){function i(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(s(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(s(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(u(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(u(this),this.__state.space="HSV"),this.__state[e]=t}})}function s(t,n,i){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,i);else{if("HSV"!==t.__state.space)throw"Corrupted color state";r.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function u(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);r.extend(t.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var a=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return a.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(a.prototype,{toString:function(){
return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(a.prototype,"r",2),i(a.prototype,"g",1),i(a.prototype,"b",0),o(a.prototype,"h"),o(a.prototype,"s"),o(a.prototype,"v"),Object.defineProperty(a.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(a.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),a}(e.color.interpret,e.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=n*(1-e),s=n*(1-i*e),u=n*(1-(1-i)*e),a=[[n,u,o],[s,n,o],[o,n,u],[o,s,n],[u,o,n],[n,o,s]][r];return{r:255*a[0],g:255*a[1],b:255*a[2]}},rgb_to_hsv:function(t,e,n){var r,i,o=Math.min(t,e,n),s=Math.max(t,e,n),u=s-o;return 0==s?{h:NaN,s:0,v:0}:(i=u/s,r=t==s?(e-n)/u:e==s?2+(n-t)/u:4+(t-e)/u,r/=6,r<0&&(r+=1),{h:360*r,s:i,v:s/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,r){return r<<(t=8*n)|e&~(255<<t)}}}(),e.color.toString,e.utils.common),e.color.interpret,e.utils.common),e.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){window.setTimeout(t,1e3/60)}}(),e.dom.CenteredDiv=function(t,e){var n=function(){this.backgroundElement=document.createElement("div"),e.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),t.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),e.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var n=this;t.bind(this.backgroundElement,"click",function(){n.hide()})};return n.prototype.show=function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),e.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})},n.prototype.hide=function(){var e=this,n=function(){e.domElement.style.display="none",e.backgroundElement.style.display="none",t.unbind(e.domElement,"webkitTransitionEnd",n),t.unbind(e.domElement,"transitionend",n),t.unbind(e.domElement,"oTransitionEnd",n)};t.bind(this.domElement,"webkitTransitionEnd",n),t.bind(this.domElement,"transitionend",n),t.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},n.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-t.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-t.getHeight(this.domElement)/2+"px"},n}(e.dom.dom,e.utils.common),e.dom.dom,e.utils.common)}),q=i(function(t){var e=t.exports=e||{};e.color=e.color||{},e.utils=e.utils||{},e.utils.common=function(){var t=Array.prototype.forEach,e=Array.prototype.slice;return{BREAK:{},extend:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(e[n])||(t[n]=e[n])},this),t},defaults:function(t){return this.each(e.call(arguments,1),function(e){for(var n in e)this.isUndefined(t[n])&&(t[n]=e[n])},this),t},compose:function(){var t=e.call(arguments);return function(){for(var n=e.call(arguments),r=t.length-1;r>=0;r--)n=[t[r].apply(this,n)];return n[0]}},each:function(e,n,r){if(t&&e.forEach===t)e.forEach(n,r);else if(e.length===e.length+0){for(var i=0,o=e.length;i<o;i++)if(i in e&&n.call(r,e[i],i)===this.BREAK)return}else for(var i in e)if(n.call(r,e[i],i)===this.BREAK)return},defer:function(t){setTimeout(t,0)},toArray:function(t){return t.toArray?t.toArray():e.call(t)},isUndefined:function(t){return void 0===t},isNull:function(t){return null===t},isNaN:function(t){return t!==t},isArray:Array.isArray||function(t){return t.constructor===Array},isObject:function(t){return t===Object(t)},isNumber:function(t){return t===t+0},isString:function(t){return t===t+""},isBoolean:function(t){return t===!1||t===!0},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(),e.color.toString=function(t){return function(e){if(1==e.a||t.isUndefined(e.a)){for(var n=e.hex.toString(16);n.length<6;)n="0"+n;return"#"+n}return"rgba("+Math.round(e.r)+","+Math.round(e.g)+","+Math.round(e.b)+","+e.a+")"}}(e.utils.common),e.Color=e.color.Color=function(t,e,n,r){function i(t,e,n){Object.defineProperty(t,e,{get:function(){return"RGB"===this.__state.space?this.__state[e]:(s(this,e,n),this.__state[e])},set:function(t){"RGB"!==this.__state.space&&(s(this,e,n),this.__state.space="RGB"),this.__state[e]=t}})}function o(t,e){Object.defineProperty(t,e,{get:function(){return"HSV"===this.__state.space?this.__state[e]:(u(this),this.__state[e])},set:function(t){"HSV"!==this.__state.space&&(u(this),this.__state.space="HSV"),this.__state[e]=t}})}function s(t,n,i){if("HEX"===t.__state.space)t.__state[n]=e.component_from_hex(t.__state.hex,i);else{if("HSV"!==t.__state.space)throw"Corrupted color state";r.extend(t.__state,e.hsv_to_rgb(t.__state.h,t.__state.s,t.__state.v))}}function u(t){var n=e.rgb_to_hsv(t.r,t.g,t.b);r.extend(t.__state,{s:n.s,v:n.v}),r.isNaN(n.h)?r.isUndefined(t.__state.h)&&(t.__state.h=0):t.__state.h=n.h}var a=function(){if(this.__state=t.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return a.COMPONENTS=["r","g","b","h","s","v","hex","a"],r.extend(a.prototype,{toString:function(){return n(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),i(a.prototype,"r",2),i(a.prototype,"g",1),i(a.prototype,"b",0),o(a.prototype,"h"),o(a.prototype,"s"),o(a.prototype,"v"),Object.defineProperty(a.prototype,"a",{get:function(){return this.__state.a},set:function(t){this.__state.a=t}}),Object.defineProperty(a.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=e.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(t){this.__state.space="HEX",this.__state.hex=t}}),a}(e.color.interpret=function(t,e){var n,r,i=function(){r=!1;var t=arguments.length>1?e.toArray(arguments):arguments[0];return e.each(o,function(i){if(i.litmus(t))return e.each(i.conversions,function(i,o){if(n=i.read(t),r===!1&&n!==!1)return r=n,n.conversionName=o,n.conversion=i,e.BREAK}),e.BREAK}),r},o=[{litmus:e.isString,conversions:{THREE_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString()+e[1].toString()+e[2].toString()+e[2].toString()+e[3].toString()+e[3].toString())}},write:t},SIX_CHAR_HEX:{read:function(t){var e=t.match(/^#([A-F0-9]{6})$/i);return null!==e&&{space:"HEX",hex:parseInt("0x"+e[1].toString())}},write:t},CSS_RGB:{read:function(t){var e=t.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3])}},write:t},CSS_RGBA:{read:function(t){var e=t.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null!==e&&{space:"RGB",r:parseFloat(e[1]),g:parseFloat(e[2]),b:parseFloat(e[3]),a:parseFloat(e[4])}},write:t}}},{litmus:e.isNumber,conversions:{HEX:{read:function(t){return{space:"HEX",hex:t,conversionName:"HEX"}},write:function(t){return t.hex}}}},{litmus:e.isArray,conversions:{RGB_ARRAY:{read:function(t){return 3==t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2]}},write:function(t){return[t.r,t.g,t.b]}},RGBA_ARRAY:{read:function(t){return 4==t.length&&{space:"RGB",r:t[0],g:t[1],b:t[2],a:t[3]}},write:function(t){return[t.r,t.g,t.b,t.a]}}}},{litmus:e.isObject,conversions:{RGBA_OBJ:{read:function(t){return!!(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b)&&e.isNumber(t.a))&&{space:"RGB",r:t.r,g:t.g,b:t.b,a:t.a}},write:function(t){return{r:t.r,g:t.g,b:t.b,a:t.a}}},RGB_OBJ:{read:function(t){return!!(e.isNumber(t.r)&&e.isNumber(t.g)&&e.isNumber(t.b))&&{space:"RGB",r:t.r,g:t.g,b:t.b}},write:function(t){return{r:t.r,g:t.g,b:t.b}}},HSVA_OBJ:{read:function(t){return!!(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v)&&e.isNumber(t.a))&&{space:"HSV",h:t.h,s:t.s,v:t.v,a:t.a}},write:function(t){return{h:t.h,s:t.s,v:t.v,a:t.a}}},HSV_OBJ:{read:function(t){return!!(e.isNumber(t.h)&&e.isNumber(t.s)&&e.isNumber(t.v))&&{space:"HSV",h:t.h,s:t.s,v:t.v}},write:function(t){return{h:t.h,s:t.s,v:t.v}}}}}];return i}(e.color.toString,e.utils.common),e.color.math=function(){var t;return{hsv_to_rgb:function(t,e,n){var r=Math.floor(t/60)%6,i=t/60-Math.floor(t/60),o=n*(1-e),s=n*(1-i*e),u=n*(1-(1-i)*e),a=[[n,u,o],[s,n,o],[o,n,u],[o,s,n],[u,o,n],[n,o,s]][r];return{r:255*a[0],g:255*a[1],b:255*a[2]}},rgb_to_hsv:function(t,e,n){var r,i,o=Math.min(t,e,n),s=Math.max(t,e,n),u=s-o;return 0==s?{h:NaN,s:0,v:0}:(i=u/s,r=t==s?(e-n)/u:e==s?2+(n-t)/u:4+(t-e)/u,r/=6,r<0&&(r+=1),{h:360*r,s:i,v:s/255})},rgb_to_hex:function(t,e,n){var r=this.hex_with_component(0,2,t);return r=this.hex_with_component(r,1,e),r=this.hex_with_component(r,0,n)},component_from_hex:function(t,e){return t>>8*e&255},hex_with_component:function(e,n,r){return r<<(t=8*n)|e&~(255<<t)}}}(),e.color.toString,e.utils.common)}),K=Y,$=q;K.color=$;var J=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"initialize",value:function(){this.gui=new K.GUI}}]),e}(D);n("DatGui",J);var Q=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{ttl:0,age:0}}}]),e}(B);t("Expiration",Q);var Z=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"matchComponent",value:function(){return"Expiration"}},{key:"updateComponent",value:function(t,e,n){n.age+=t,n.age>=n.ttl&&this.world.entities.destroy(e)}}]),e}(D);n("Expiration",Z);var tt=2*Math.PI,et=function(t){t||(t=event);var e=t.wheelDelta,n=t.detail;return n?e?e/n/40*n>0?1:-1:-n/3:e/120},nt=function(t){function n(){return d(this,n),m(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return g(n,t),p(n,[{key:"defaultOptions",value:function(){return{lineWidth:2.5,zoom:1,zoomMin:.1,zoomMax:10,zoomWheelFactor:.05,gridEnabled:!0,gridSize:250,gridColor:2236962,followEnabled:!0,followName:null,followEntityId:null}}},{key:"initialize",value:function(){var t=this;this.container=document.querySelector(this.options.container),this.renderer=PIXI.autoDetectRenderer(this.container.offsetWidth,this.container.offsetHeight,{antialias:!0}),this.renderer.autoResize=!0,this.canvas=this.renderer.view,this.container.appendChild(this.canvas),this.stage=new PIXI.Container,this.backdrop=new PIXI.Graphics,this.stage.addChild(this.backdrop),this.graphics={};var e={resize:function(e){t.updateMetrics(e)},orientationchange:function(e){t.updateMetrics(e)},mousedown:function(e){t.onMouseDown(e)},mousemove:function(e){t.onMouseMove(e)},mouseup:function(e){t.onMouseUp(e)}};for(var n in e)this.canvas.addEventListener(n,e[n],!1);var r=function(e){return t.onMouseWheel(e)};window.addEventListener?(window.addEventListener("mousewheel",r,!1),window.addEventListener("DOMMouseScroll",r,!1)):window.attachEvent&&window.attachEvent("onmousewheel",r),this.followEnabled=this.options.followEnabled,this.zoom=this.options.zoom,this.followEntityId=this.options.followEntityId,this.gridEnabled=this.options.gridEnabled,this.lineWidth=this.options.lineWidth,this.cursorRawX=0,this.cursorRawY=0,this.cursorChanged=!1,this.cursorPosition={x:0,y:0},this.cameraX=0,this.cameraY=0,this.debugDummySprite={size:100},this.updateMetrics()}},{key:"onMouseWheel",value:function(t){this.zoom+=et(t)*this.options.zoomWheelFactor,this.zoom<this.options.zoomMin&&(this.zoom=this.options.zoomMin),this.zoom>this.options.zoomMax&&(this.zoom=this.options.zoomMax)}},{key:"onMouseDown",value:function(t){this.setCursor(t.clientX,t.clientY),this.world.publish("mouseDown",this.cursorPosition)}},{key:"onMouseMove",value:function(t){this.setCursor(t.clientX,t.clientY),this.world.publish("mouseMove",this.cursorPosition)}},{key:"onMouseUp",value:function(t){this.setCursor(t.clientX,t.clientY),this.world.publish("mouseUp",this.cursorPosition)}},{key:"setCursor",value:function(t,e){var n=this.container.offsetWidth,r=this.container.offsetHeight;this.cursorRawX=t,this.cursorRawY=e;var i=(t-n/2)/this.zoom+this.cameraX,o=(e-r/2)/this.zoom+this.cameraY;return this.cursorChanged=!1,i===this.cursorPosition.x&&o===this.cursorPosition.y||(this.cursorChanged=!0,this.cursorPosition.x=i,this.cursorPosition.y=o),this.cursorPosition}},{key:"updateMetrics",value:function(){var t=this.container.offsetWidth,e=this.container.offsetHeight;this.visibleWidth=t/this.zoom,this.visibleHeight=e/this.zoom,this.visibleLeft=0-this.visibleWidth/2+this.cameraX,this.visibleTop=0-this.visibleHeight/2+this.cameraY,this.visibleRight=this.visibleLeft+this.visibleWidth,this.visibleBottom=this.visibleTop+this.visibleHeight}},{key:"update",value:function(){var t=this;this.updateMetrics(),this.setCursor(this.cursorRawX,this.cursorRawY),this.world.publish("mouseMove",this.cursorPosition);var e=this.world.get("Sprite"),n=Object.keys(this.graphics).filter(function(t){return!(t in e)});n.forEach(function(e){t.stage.removeChild(t.graphics[e]),delete t.graphics[e]});var r=Object.keys(e).filter(function(e){return!(e in t.graphics)});r.forEach(function(e){t.stage.addChild(t.graphics[e]=new PIXI.Graphics)})}},{key:"draw",value:function(t){this.followEntity(),this.drawBackdrop(t);for(var e in this.graphics)this.drawSprite(this.graphics[e],e,t);this.stage.setTransform(this.container.offsetWidth/2-this.cameraX*this.zoom,this.container.offsetHeight/2-this.cameraY*this.zoom,this.zoom,this.zoom),this.renderer.resize(this.container.offsetWidth,this.container.offsetHeight),this.renderer.render(this.stage)}},{key:"drawSprite",value:function(t,e,n){var r=this.world.get("Sprite",e),i=this.world.get("Position",e),o=a(r.name);return o||(o=a("default")),t.position.x=Math.floor(i.x),t.position.y=Math.floor(i.y),t.rotation=i.rotation+Math.PI/2,t.scale.x=t.scale.y=r.size/100,t.lineStyle(this.lineWidth/(r.size/100),16777215),o(t,r,e,n),r.drawn=!0,t}},{key:"followEntity",value:function(){if(!this.followEnabled)return void(this.cameraX=this.cameraY=0);if(this.options.followName&&!this.followEntityId&&(this.followEntityId=e("Name").findEntityByName(this.world,this.options.followName)),this.followEntityId){var t=this.world.get("Position",this.followEntityId);t&&(this.cameraX=t.x,this.cameraY=t.y,this.setCursor(this.cursorRawX,this.cursorRawY))}}},{key:"drawBackdrop",value:function(){var t=this.backdrop;if(!this.gridEnabled)return void(t.visible=!1);var e=this.options.gridSize,n=this.visibleLeft%e,r=this.visibleTop%e;t.visible=!0,t.clear(),t.lineStyle(1,this.options.gridColor),t.position.x=this.visibleLeft,t.position.y=this.visibleTop;for(var i=-n;i<this.visibleWidth;i+=e)t.moveTo(i,0),t.lineTo(i,this.visibleHeight+e);for(var o=-r;o<this.visibleHeight;o+=e)t.moveTo(0,o),t.lineTo(this.visibleWidth+e,o)}}]),n}(D);n("ViewportPixi",nt);var rt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{name:null,color:"#fff",size:100,width:null,height:null,drawn:!1}}},{key:"create",value:function(t){var n=v(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,t);return n.width||(n.width=n.size),n.height||(n.height=n.size),n}}]),e}(B);t("Sprite",rt);var it={};u("default",function(t,e){e.drawn||(t.arc(0,0,50,0,tt),t.moveTo(0,0),t.lineTo(0,-50),t.moveTo(0,0))}),u("sun",function(t,e){e.drawn||t.arc(0,0,50,0,tt,!0)}),u("enemyscout",function(t,e){e.drawn||(t.moveTo(0,-50),t.lineTo(-45,50),t.lineTo(-12.5,12.5),t.lineTo(0,25),t.lineTo(12.5,12.5),t.lineTo(45,50),t.lineTo(0,-50),t.moveTo(0,-50))}),u("enemywing",function(t,e){e.drawn||(t.lineColor=2263074,t.moveTo(-50,0),t.lineTo(-37.5,-37.5),t.lineTo(0,50),t.lineTo(37.5,-37.5),t.lineTo(50,0),t.lineTo(37.5,50),t.lineTo(25,50),t.lineTo(0,0),t.lineTo(-25,50),t.lineTo(-37.5,50),t.lineTo(-50,0))}),u("hero",function(t,e){e.drawn||(t.moveTo(-50,0),t.lineTo(-37.5,-37.5),t.lineTo(0,-50),t.lineTo(37.5,-37.5),t.lineTo(50,0),t.lineTo(37.5,50),t.lineTo(25,50),t.lineTo(12.5,12.5),t.lineTo(5,25),t.lineTo(-5,25),t.lineTo(-12.5,12.5),t.lineTo(-25,50),t.lineTo(-37.5,50),t.lineTo(-50,0))}),u("asteroid",function(t,e){if(!e.drawn){var n=10+Math.floor(8*Math.random()),r=50,i=35,o=tt/n,s=void 0,u=[];for(s=0;s<n;s++){var a=s*o,l=Math.random()*(r-i)+i;u.push(l*Math.cos(a)),u.push(l*Math.sin(a))}u.push(u[0]),u.push(u[1]),t.drawPolygon(u)}}),u("mine",function(t,e){if(!(e.drawn&&Math.random()>.1)){if(!e.drawn){var n=10+Math.floor(10*Math.random());n%2!==0&&n++;var r=60,i=10;e.legs=[];for(var o=!1,s=0;s<n;s++){var u=o?10:Math.random()*(r-i)+i;e.legs.push(u),o=!o}}var a=[],l=tt/e.legs.length;e.legs.forEach(function(t,e){var n=t*(.9+.5*Math.random()),r=e*l;a.push(n*Math.cos(r)),a.push(n*Math.sin(r))}),a.push(a[0]),a.push(a[1]),t.clear(),t.lineStyle(2.5/(e.size/100),16720418),t.drawPolygon(a)}});var ot=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{name:"unnamed"}}},{key:"findEntityByName",value:function(t,e){var n=t.get("Name");for(var r in n){var i=n[r];if(i.name===e)return r}}}]),e}(B);t("Name",ot);var st=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{max:1e3,current:null,show_bar:!0}}},{key:"create",value:function(t){var n=v(e.__proto__||Object.getPrototypeOf(e),"create",this).call(this,t);return n.current=n.max,n}}]),e}(B);t("Health",st),l.prototype={reset:function(t,e,n,r,i,o,s){this.maxObjects=i||10,this.maxLevels=o||4,this.level=s||0,this.bounds={width:n,height:r,subWidth:Math.floor(n/2),subHeight:Math.floor(r/2),left:Math.round(t),top:Math.round(e),midX:Math.round(t+n/2),midY:Math.round(e+r/2),right:Math.round(t+n),bottom:Math.round(e+r)},this.objects.length=0,this.nodes.length=0},split:function(){this.nodes[0]=new l(this.bounds.left+this.bounds.subWidth,this.bounds.top,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1,this.root),this.nodes[1]=new l(this.bounds.left,this.bounds.top,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1,this.root),this.nodes[2]=new l(this.bounds.left,this.bounds.top+this.bounds.subHeight,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1,this.root),this.nodes[3]=new l(this.bounds.left+this.bounds.subWidth,this.bounds.top+this.bounds.subHeight,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1,this.root)},insert:function(t){var e,n=0;if(null!=this.nodes[0]&&(e=this.getIndex(t),e!==-1))return void this.nodes[e].insert(t);var r=this.root.entityMap[t.entityId];if(r!==this){if(r){var i=r.objects.indexOf(t);i!==-1&&r.objects.splice(i,1)}if(this.objects.push(t),this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();n<this.objects.length;)e=this.getIndex(this.objects[n]),e!==-1?this.nodes[e].insert(this.objects.splice(n,1)[0]):n++}},getIndex:function(t){if(t.left<this.bounds.midX&&t.right<this.bounds.midX){if(t.top<this.bounds.midY&&t.bottom<this.bounds.midY)return 1;if(t.top>this.bounds.midY)return 2}else if(t.left>this.bounds.midX){if(t.top<this.bounds.midY&&t.bottom<this.bounds.midY)return 0;if(t.top>this.bounds.midY)return 3}return-1},iterate:function(t,e,n){for(var r=this.getIndex(t),i=0;i<this.objects.length;i++)e(this.objects[i],n);this.nodes[0]&&(r!==-1?this.nodes[r].iterate(t,e,n):(this.nodes[0].iterate(t,e,n),this.nodes[1].iterate(t,e,n),this.nodes[2].iterate(t,e,n),this.nodes[3].iterate(t,e,n)))},clear:function(){this.objects.length=0;for(var t=this.nodes.length;t--;)this.nodes[t].clear(),this.nodes.splice(t,1);this.nodes.length=0}};var ut=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{x:0,y:0,rotation:0}}}]),e}(B);t("Position",ut);var at=void 0,lt=void 0,ct=void 0,ht=void 0,ft=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"defaultOptions",value:function(){return{quadtreeMaxAge:2,quadtreeObjectsPerNode:5,quadtreeMaxLevels:5}}},{key:"matchComponent",value:function(){return"Position"}},{key:"initialize",value:function(){this.bounds={left:0,top:0,right:0,bottom:0,width:0,height:0},this.quadtree=new l(-1e3,-1e3,2e3,2e3,this.options.quadtreeObjectsPerNode,this.options.quadtreeMaxLevels)}},{key:"update",value:function(t){this.updateBounds(),this.resetQuadtree(t),v(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t)}},{key:"resetQuadtree",value:function(){this.quadtree.reset(this.bounds.left,this.bounds.top,this.bounds.width,this.bounds.height,this.options.quadtreeObjectsPerNode,this.options.quadtreeMaxLevels)}},{key:"updateBounds",value:function(){this.bounds.left=this.bounds.top=this.bounds.right=this.bounds.bottom=null,ht=this.getMatchingComponents();for(at in ht)ct=ht[at],(null===this.bounds.left||ct.left<this.bounds.left)&&(this.bounds.left=ct.left),(null===this.bounds.top||ct.top<this.bounds.top)&&(this.bounds.top=ct.top),(null===this.bounds.right||ct.right>this.bounds.right)&&(this.bounds.right=ct.right),(null===this.bounds.bottom||ct.bottom>this.bounds.bottom)&&(this.bounds.bottom=ct.bottom);this.bounds.width=this.bounds.right-this.bounds.left,this.bounds.height=this.bounds.bottom-this.bounds.top}},{key:"updateComponent",value:function(t,e,n){if(lt=this.world.get("Sprite",e)){var r=lt.width/2,i=lt.height/2;n.entityId=e,n.width=lt.width,n.height=lt.height,n.left=n.x-r,n.top=n.y-i,n.right=n.x+r,n.bottom=n.y+i,this.quadtree.insert(n)}}},{key:"draw",value:function(){var t=this.getDebugGraphics();if(t){t.lineStyle(4,8921634),ht=this.getMatchingComponents();for(at in ht)ct=ht[at],lt=this.world.get("Sprite",at),t.drawCircle(ct.x,ct.y,lt.width/2),t.moveTo(ct.x-20,ct.y),t.lineTo(ct.x+20,ct.y),t.moveTo(ct.x,ct.y-20),t.lineTo(ct.x,ct.y+20);t.lineStyle(4,2263074),this.drawDebugQuadtreeNode(t,this.quadtree),t.lineStyle(4,16777011),t.moveTo(-20,0),t.lineTo(20,0),t.moveTo(0,-20),t.lineTo(0,20),t.moveTo(0,0),t.drawRect(this.bounds.left,this.bounds.top,this.bounds.width,this.bounds.height)}}},{key:"drawDebugQuadtreeNode",value:function(t,e){e&&(t.lineStyle(4,8926088),t.drawRect(e.bounds.left,e.bounds.top,e.bounds.width,e.bounds.height),t.lineStyle(4,1122850),e.objects.forEach(function(e){return t.drawRect(e.left,e.top,e.width,e.height)}),this.drawDebugQuadtreeNode(t,e.nodes[0]),this.drawDebugQuadtreeNode(t,e.nodes[1]),this.drawDebugQuadtreeNode(t,e.nodes[2]),this.drawDebugQuadtreeNode(t,e.nodes[3]))}}]),e}(D);n("Position",ft);var dt=2*Math.PI,pt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{dx:0,dy:0,drotation:0}}}]),e}(B);t("Motion",pt);var _t=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"matchComponent",value:function(){return"Motion"}},{key:"updateComponent",value:function(t,e,n){var r=this.world.get("Position",e);r.x+=n.dx*t,r.y+=n.dy*t,r.rotation=(r.rotation+n.drotation*t)%dt,r.rotation<0&&(r.rotation+=dt)}}]),e}(D);n("Motion",_t);var vt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{active:!0,stop:!1,useBrakes:!0,deltaV:0,maxV:0}}}]),e}(B);t("Thruster",vt);var gt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"matchComponent",value:function(){return"Thruster"}},{key:"initialize",value:function(){this.vInertia=new o,this.vThrust=new o,this.vBrakes=new o}},{key:"updateComponent",value:function(t,e,n){if(n.active){var r=this.world.get("Position",e),i=this.world.get("Motion",e);if(r&&i){this.vInertia.setValues(i.dx,i.dy);var o=t*n.deltaV;if(n.stop||(this.vThrust.setValues(o,0),this.vThrust.rotate(r.rotation),this.vInertia.add(this.vThrust)),n.useBrakes){var s=n.stop?0:n.maxV,u=this.vInertia.magnitude(),a=u-s;if(a>0){var l=Math.min(o,a);this.vBrakes.setValues(this.vInertia.x,this.vInertia.y),this.vBrakes.normalize(),this.vBrakes.multiplyScalar(0-l),this.vInertia.add(this.vBrakes)}n.stop&&0===u&&(n.active=!1)}i.dx=this.vInertia.x,i.dy=this.vInertia.y}}}}]),e}(D);n("Thruster",gt);var mt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{active:!0,targetName:null,targetEntityId:null,targetPosition:null,acquisitionDelay:0,radPerSec:Math.PI}}}]),e}(B);t("Seeker",mt);var yt=function(t){function n(){return d(this,n),m(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return g(n,t),p(n,[{key:"matchComponent",value:function(){return"Seeker"}},{key:"initialize",value:function(){this.vSeeker=new o,this.vTarget=new o}},{key:"updateComponent",value:function(t,n,r){if(r.active){if(r.targetName&&!r.targetEntityId&&(r.targetEntityId=e("Name").findEntityByName(this.world,r.targetName)),r.acquisitionDelay>0)return void(r.acquisitionDelay-=t);var i=this.world.get("Position",n),o=this.world.get("Motion",n);if(i&&o){var s=r.targetPosition;if(s||(s=this.world.get("Position",r.targetEntityId)),s){this.vSeeker.setValues(i.x,i.y),this.vTarget.setValues(s.x,s.y);var u=this.vSeeker.angleTo(this.vTarget);u<0&&(u+=2*Math.PI);var a=u<i.rotation?-1:1,l=Math.abs(u-i.rotation);l>Math.PI&&(a=0-a);var c=a*Math.min(r.radPerSec,l/t),h=c-o.drotation;Math.abs(h)>r.radPerSec&&(h>0?h=r.radPerSec:h<0&&(h=0-r.radPerSec)),o.drotation+=h}}}}}]),n}(D);n("Seeker",yt);var bt=2*Math.PI,wt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{sensorRange:350,obstacleRepel:[400,2.1]}}}]),e}(B);t("Steering",wt);var xt=function(t){function n(){return d(this,n),m(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return g(n,t),p(n,[{key:"matchComponent",value:function(){return"Steering"}},{key:"initialize",value:function(){this.seekFactor=1,this.pushFactor=7,this.avoidFactor=10,this.avoidSeeAhead=500,this.avoidRayWidthFactor=1.5,this.vTarget=new o,this.vectors={avoid:new o,push:new o,seek:new o,flee:new o,wander:new o,evade:new o,pursue:new o}}},{key:"updateComponent",value:function(t,e,n){this.vTarget.setValues(0,0);for(var r in this.vectors)this.vectors[r].setValues(0,0),this[r](this.vectors[r],t,e,n),this.vTarget.add(this.vectors[r]);this.applySteering(t,e,n)}},{key:"avoid",value:function(t,e,n,r){var i=this;this.debug&&(r.vectors=[]);var o=this.world.get("Sprite",n),s=this.world.get("Position",n),u=this.lookForObstacle(n,s,o,r);if(u){var a=r.sensorRange;this.world.getSystem("Collision").quadtree.iterate({x:s.x-a/2,y:s.y-a/2,width:a,height:a},function(e){if(n!==e.entityId){var u=i.world.get("Position",e.entityId);if(u){var a=i.world.get("Sprite",e.entityId),l=0,c=r.obstacleRepel[0],h=0,f=r.obstacleRepel[1],d=s.x-u.x,p=s.y-u.y,_=o.size/2+a.size/2,v=Math.sqrt(d*d+p*p)-_;if(v<=0&&(v=.01),!(v>r.sensorRange)){var g=-l/Math.pow(v,h)+c/Math.pow(v,f);t.x+=d*g,t.y+=p*g,i.debug&&r.vectors.push([u.x,u.y,g])}}}})}}},{key:"push",value:function(){}},{key:"avoid_ray",value:function(t,e,n,r){var i=this.world.get("Sprite",n),o=this.world.get("Position",n),s=this.lookForObstacle(n,o,i,r);if(s){var u=s[0],a=s[1],l=s[2],c=u.sprite.size/2+i.size*this.avoidRayWidthFactor,h=Math.sqrt(Math.pow(u.position.x-a,2)+Math.pow(u.position.y-l,2)),f=Math.asin(c/h);isNaN(f)&&(f=.66*Math.PI);var d=Math.atan2(u.position.y-l,u.position.x-a),p=d+f,_=Math.min(bt-Math.abs(o.rotation-p),Math.abs(o.rotation-p));_>f&&(p=d-f),t.setValues(this.avoidFactor,0),t.rotate(p)}}},{key:"lookForObstacle",value:function(t,e,n,r){var i=n.size*this.avoidRayWidthFactor,s=new o;s.setValues(i,0),s.rotate(e.rotation),this.debug&&(r.hitCircles=[]);for(var u=void 0,a=void 0,l=void 0,c=this.avoidSeeAhead/i,h=0;h<c;h++)if(a=e.x+s.x*h,l=e.y+s.y*h,u=this.searchCircleForObstacle(r,t,a,l,i))return[u,a,l];return null}},{key:"searchCircleForObstacle",value:function(t,e,n,r,i){this.debug&&t.hitCircles.push([n,r,i]);var o=[];return this.world.getSystem("Collision").quadtree.iterate({x:n-i/2,y:r-i/2,width:i,height:i},function(t){if(e!==t.entityId){var s=t.position.x-n,u=t.position.y-r,a=s*s+u*u,l=(i+t.sprite.size)/2;a<l*l&&o.push([a,t])}}),o.sort(function(t,e){return e[0]-t[0]}),o.length?o[0][1]:null}},{key:"seek",value:function(t,n,r,i){if(i.seekTargetName&&!i.seekTargetEntityId&&(i.seekTargetEntityId=e("Name").findEntityByName(this.world,i.seekTargetName)),i.seekTargetEntityId){var o=this.world.get("Position",r);if(o){var s=i.targetPosition;s||(s=this.world.get("Position",i.seekTargetEntityId)),s&&(t.setValues(s.x-o.x,s.y-o.y),t.normalize(),t.multiplyScalar(this.seekFactor))}}}},{key:"flee",value:function(){}},{key:"wander",value:function(){}},{key:"evade",value:function(){}},{key:"pursue",value:function(){}},{key:"applySteering",value:function(t,e,n){var r=this.world.get("Motion",e),i=0;if(!this.vTarget.isZero()){var o=this.world.get("Position",e),s=this.vTarget.angle();s<0&&(s+=2*Math.PI),this.debug&&(n.targetAngle=s);var u=s<o.rotation?-1:1,a=Math.abs(s-o.rotation);a>Math.PI&&(u=0-u),i=u*Math.min(n.radPerSec,a/t)}var l=i-r.drotation;Math.abs(l)>n.radPerSec&&(l>0?l=n.radPerSec:l<0&&(l=0-n.radPerSec)),r.drotation+=l}},{key:"draw",value:function(){!this.debug}},{key:"drawSteeringVsPosition",value:function(t,e,n){this.drawAngle(t,n,n.rotation,"#ddd"),e.targetAngle&&this.drawAngle(t,n,e.targetAngle,"#dd0")}},{key:"drawAngle",value:function(t,e,n,r){var i=new o;i.setValues(this.avoidSeeAhead,0),i.rotate(n),t.strokeStyle=r,t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+i.x,e.y+i.y),t.stroke()}}]),n}(D);n("Steering",xt);var kt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{inCollision:!1,inCollisionWith:{}}}}]),e}(B);t("Collidable",kt);var Et=void 0,Ct=void 0,St=void 0,At=void 0,Tt=void 0,Ot=void 0,Mt=void 0,Pt=void 0,jt=void 0,Rt=void 0,It=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"defaultOptions",value:function(){return{positionSystemName:"Position"}}},{key:"matchComponent",value:function(){return"Collidable"}},{key:"initialize",value:function(){var t=this;this.positionSystem=this.world.getSystem(this.options.positionSystemName),this.width=this.options.width,this.height=this.options.height,this.retrieveBounds={},this.checkCollisionBound=function(e,n){return t.checkCollision(e,n)}}},{key:"update",value:function(){
Ct=this.getMatchingComponents();for(St in Ct){Et=Ct[St],Et.inCollision=!1;for(At in Et.inCollisionWith)delete Et.inCollisionWith[At]}for(St in Ct)Tt=this.world.get("Position",St),Tt&&this.positionSystem.quadtree.iterate(Tt,this.checkCollisionBound,Tt)}},{key:"checkCollision",value:function(t,e){e.entityId!==t.entityId&&(Ot=this.world.get("Collidable",e.entityId),Mt=this.world.get("Collidable",t.entityId),Ot&&Mt&&(Pt=e.x-t.x,jt=e.y-t.y,Rt=(e.width+t.width)/2,Pt*Pt+jt*jt>Rt*Rt||(Ot.inCollision=!0,Ot.inCollisionWith[t.entityId]=1,Mt.inCollision=!0,Mt.inCollisionWith[e.entityId]=1)))}},{key:"draw",value:function(){var t=this.getDebugGraphics();if(t){t.lineStyle(4,10066329);var e=this.world.get("Collidable");for(var n in e){var r=e[n],i=this.world.get("Position",n);r.inCollision&&t.drawCircle(i.x,i.y,40)}}}}]),e}(D);n("Collision",It);var zt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{mass:1e3}}}]),e}(B);t("Bounce",zt);var Nt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"matchComponent",value:function(){return"Bounce"}},{key:"initialize",value:function(){this.dn=new o,this.dt=new o,this.mt=new o,this.v1=new o,this.v2=new o,this.v1n=new o,this.v1t=new o,this.v2n=new o,this.v2t=new o}},{key:"update",value:function(t){var e=this.world,n=this.getMatchingComponents(),r={};for(var i in n){var o=e.get("Collidable",i);for(var s in o.inCollisionWith){var u=[i,s];u.sort(),r[u.join(":")]=u}}for(var a in r){var l=r[a][0],c=e.get("Bounce",l);if(c){var h=r[a][1],f=e.get("Bounce",h);f&&this.resolveElasticCollision(t,l,c,h,f)}}}},{key:"resolveElasticCollision",value:function(t,e,n,r,i){var o=this.world,s=o.get("Position",e),u=o.get("Sprite",e),a=o.get("Motion",e),l=o.get("Position",r),c=o.get("Sprite",r),h=o.get("Motion",r);this.dn.setValues(s.x-l.x,s.y-l.y);var f=this.dn.magnitude();this.dn.normalize(),this.dt.setValues(this.dn.y,-this.dn.x),0===f&&(l.x+=.01);var d=n.mass,p=i.mass,_=d+p;if(this.mt.setValues(this.dn.x*(u.width+c.width-f)*1.1,this.dn.y*(u.height+c.height-f)*1.1),this.v1.setValues(a?a.dx:0,a?a.dy:0),this.v2.setValues(h?h.dx:0,h?h.dy:0),this.v1n.setValues(this.dn.x*this.v1.dot(this.dn),this.dn.y*this.v1.dot(this.dn)),this.v1t.setValues(this.dt.x*this.v1.dot(this.dt),this.dt.y*this.v1.dot(this.dt)),this.v2n.setValues(this.dn.x*this.v2.dot(this.dn),this.dn.y*this.v2.dot(this.dn)),this.v2t.setValues(this.dt.x*this.v2.dot(this.dt),this.dt.y*this.v2.dot(this.dt)),a){var v=(d-p)/_*this.v1n.magnitude()+2*p/_*this.v2n.magnitude();a.dx=this.v1t.x+this.dn.x*v,a.dy=this.v1t.y+this.dn.y*v}if(h){var g=(p-d)/_*this.v2n.magnitude()+2*d/_*this.v1n.magnitude();h.dx=this.v2t.x-this.dn.x*g,h.dy=this.v2t.y-this.dn.y*g}}}]),e}(D);n("Bounce",Nt);var Bt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{width:5e3,height:5e3}}}]),e}(B);t("Pathfinder",Bt);var Dt=(function(){function t(e,n,r,i,o,s){var u=this,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4;d(this,t);var l=e.bounds;this.x=n||l.x,this.y=r||l.y,this.width=i||l.width,this.height=o||l.height,this.right=this.x+this.width,this.bottom=this.y+this.height,this.level=s||0,this.empty=!0,this.full=!1,this.children=[];var c=0;return e.iterate({x:this.x,y:this.y,right:this.right,bottom:this.bottom},function(t){var e=2*Math.abs(t.x-u.x),n=2*Math.abs(t.y-u.y),r=t.right-t.x+u.width,i=t.bottom-t.y+u.height;e<r&&n<i&&(c++,t.x<=u.x&&t.y<=u.y&&t.right>=u.right&&t.bottom>=u.bottom&&(u.full=!0))}),0===c?void(this.empty=!0):(this.empty=!1,void(!this.full&&this.level<a&&this.split(e)))}return p(t,[{key:"split",value:function(e){var n=this.width/2,r=this.height/2;this.children[0]=new t(e,this.x,this.y,n,r,this.level+1),this.children[1]=new t(e,this.x+n,this.y,n,r,this.level+1),this.children[2]=new t(e,this.x,this.y+r,n,r,this.level+1),this.children[3]=new t(e,this.x+n,this.y+r,n,r,this.level+1)}}]),t}(),function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"matchComponent",value:function(){return"Pathfinder"}},{key:"initialize",value:function(){}},{key:"update",value:function(){}},{key:"draw",value:function(t){if(this.debug){var e=this.world.getSystem("ViewportCanvas"),n=e.ctx;n.save(),e.centerAndZoom(t),e.followEntity(t),n.restore()}}}]),e}(D));n("Pathfinding",Dt);var Lt=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,null,[{key:"defaults",value:function(){return{active:!0,radPerSec:2*Math.PI}}}]),e}(B);t("PlayerInputSteering",Lt);var Ft=2*Math.PI,Ht=function(t){function e(){return d(this,e),m(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return g(e,t),p(e,[{key:"defaultOptions",value:function(){return{gamepadDeadzone:.2}}},{key:"matchComponent",value:function(){return"PlayerInputSteering"}},{key:"initialize",value:function(){var t=this;this.gamepad={active:!1},this.pointer={active:!1,x:0,y:0},this.keys={active:!1},this.touch={active:!1,x:0,y:0},this.world.subscribe("mouseDown",function(e,n){return t.setPointer(!0,n)}).subscribe("mouseUp",function(e,n){return t.setPointer(!1,n)}).subscribe("mouseMove",function(e,n){return t.setPointer(t.pointer.active,n)});var e={keydown:this.handleKeyDown,keyup:this.handleKeyUp};Object.keys(e).forEach(function(n){return window.addEventListener(n,e[n].bind(t))})}},{key:"setPointer",value:function(t,e){this.pointer.active=t,this.pointer.x=e.x,this.pointer.y=e.y}},{key:"update",value:function(t){this.updateGamepads(t),this.updateKeyboard(t),v(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,t)}},{key:"updateComponent",value:function(t,e,n){var r=this.world.get("Thruster",e),i=this.world.get("Motion",e);return r.active=!0,r.stop=!1,this.keys.active?this.updateComponentFromKeyboard(t,e,n):this.pointer.active?this.updateComponentFromPointer(t,e,n):this.gamepad.active?this.updateComponentFromGamepad(t,e,n):(r.stop=!0,void(i.drotation=0))}},{key:"updateComponentFromPointer",value:function(t,e,n){var r=this.world.get("Position",e);this.updateMotionFromTargetAngle(t,e,n,Math.atan2(this.pointer.y-r.y,this.pointer.x-r.x))}},{key:"updateComponentFromGamepad",value:function(t,e,n){this.updateMotionFromTargetAngle(t,e,n,Math.atan2(this.gamepad.axis1,this.gamepad.axis0))}},{key:"updateComponentFromKeyboard",value:function(t,e,n){var r=this.world.get("Thruster",e),i=this.world.get("Motion",e),o=this.keys[65]||this.keys[37]||this.gamepad.button13,s=this.keys[68]||this.keys[39]||this.gamepad.button14,u=this.keys[87]||this.keys[38]||this.gamepad.button11;u?r.active=!0:r.stop=!0;var a=o?-1:s?1:0,l=a*n.radPerSec;i.drotation=l}},{key:"updateGamepads",value:function(){for(var t=this,e=navigator.getGamepads?navigator.getGamepads():[],n=0;n<e.length;n++){var r=e[n];if(r&&r.connected){r.buttons.forEach(function(e,n){return t.gamepad["button"+n]=e.pressed}),r.axes.forEach(function(e,n){return t.gamepad["axis"+n]=e});break}}Object.keys(this.gamepad).forEach(function(e){t.gamepad[e]||delete t.gamepad[e]});var i=this.gamepad.axis0,o=this.gamepad.axis1;this.gamepad.active=(Math.abs(i)>0||Math.abs(o)>0)&&Math.sqrt(i*i+o*o)>this.options.gamepadDeadzone}},{key:"updateKeyboard",value:function(){var t=this.keys[65]||this.keys[37]||this.gamepad.button13,e=this.keys[68]||this.keys[39]||this.gamepad.button14,n=this.keys[87]||this.keys[38]||this.gamepad.button11,r=this.keys[83]||this.keys[40]||this.gamepad.button12;this.keys.active=t||e||n||r}},{key:"handleKeyDown",value:function(t){this.keys[t.keyCode]=!0,t.preventDefault()}},{key:"handleKeyUp",value:function(t){delete this.keys[t.keyCode],t.preventDefault()}},{key:"updateMotionFromTargetAngle",value:function(t,e,n,r){var i=this.world.get("Position",e),o=this.world.get("Motion",e),s=r<0?r+Ft:r,u=s<i.rotation?-1:1,a=Math.abs(s-i.rotation);a>Math.PI&&(u=0-u);var l=u*Math.min(n.radPerSec,a/t),c=l-o.drotation;Math.abs(c)>n.radPerSec&&(c>0?c=n.radPerSec:c<0&&(c=0-n.radPerSec)),o.drotation+=c}}]),e}(D);n("PlayerInputSteering",Ht);var Vt=!0,Wt=window.world=new N({systems:{ViewportPixi:{debug:Vt,container:"#game",zoom:.5},Expiration:{},DrawStats:{},MemoryStats:{},DatGui:{},PlayerInputSteering:{},Motion:{},Thruster:{},Seeker:{},Pathfinding:{},Steering:{debug:!0},Collision:{},Bounce:{}}});h(-450,-450,200,25),h(-450,450,200,25),h(0,0,200,25),h(450,-450,200,25),h(450,450,200,25);for(var Ut=7,Gt=20,Xt=0;Xt<Ut;Xt++)f();Wt.subscribe(z.ENTITY_DESTROY,function(){f()}),Wt.insert({Name:{name:"hero1"},Sprite:{name:"hero",color:"#0f0"},Collidable:{},Bounce:{mass:7e5},Position:{x:1100,y:0},Thruster:{deltaV:1200,maxV:500,active:!1},Motion:{},PlayerInputSteering:{radPerSec:Math.PI},Pathfinder:{}}),Wt.start();var Yt=Wt.getSystem("DatGui"),qt=Yt.gui,Kt=qt.addFolder("World");Kt.open(),Kt.add(Wt,"isPaused"),Kt.add(Wt,"debug");var $t=Wt.getSystem("ViewportPixi"),Jt=qt.addFolder("Viewport");Jt.open(),Jt.add($t,"zoom",$t.options.zoomMin,$t.options.zoomMax).listen(),Jt.add($t,"lineWidth",1,4).step(.5).listen();var Qt=["gridEnabled","followEnabled","cameraX","cameraY"];Qt.forEach(function(t){Jt.add($t,t).listen()});var Zt=Wt.getSystem("Collision"),te=qt.addFolder("Collision");te.open(),te.add(Zt,"debug");var ee=Wt.getSystem("Steering"),ne=qt.addFolder("Steering");ne.open(),ne.add(ee,"debug")}();
