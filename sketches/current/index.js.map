{"version":3,"sources":["webpack:///./src/sketches/current.js"],"names":["debug","world","window","systems","ViewportWebGL","container","zoom","gridEnabled","followName","lineWidth","DebugCanvas","viewportSystemName","DrawStats","DatGui","Health","Motion","Position","Thruster","Steering","behaviors","Repulsor","Collision","Bounce","Spawn","pads","forEach","x","idx","push","insert","Name","name","Sprite","color","size","y","spawnShip","Math","random","sourceId","floor","length","source","get","destId","dest","ships","tags","ttl","rotation","PI","mass","Collidable","deltaV","maxV","active","thrusterTurnCutoff","thrusterTurnThrottle","radPerSec","seekFactor","seekTargetPosition","avoidFactor","avoidTags","avoidSensorRange","setTimeout","subscribe","start","vpSystem","getSystem","guiSystem","gui","generalf","addFolder","add","open","vpf","names","listen","options","zoomMin","zoomMax","step"],"mappings":"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","file":"sketches/current/index.js","sourcesContent":["import * as Core from '../lib/core';\n\nimport '../plugins/drawStats';\nimport '../plugins/memoryStats';\nimport '../plugins/datGui';\nimport '../plugins/debugCanvas';\nimport '../plugins/viewportWebGL';\nimport '../plugins/name';\nimport '../plugins/health';\nimport '../plugins/position';\nimport '../plugins/motion';\nimport '../plugins/thruster';\nimport '../plugins/steering';\nimport '../plugins/collision';\nimport '../plugins/bounce';\nimport '../plugins/repulsor';\nimport '../plugins/playerInputSteering';\nimport { MSG_DESPAWN } from '../plugins/spawn';\n\nconst debug = true;\n\nconst world = window.world = new Core.World({\n  systems: {\n    ViewportWebGL: {\n      debug: debug,\n      container: '#game',\n      zoom: 0.2,\n      gridEnabled: false,\n      followName: 'hero1',\n      lineWidth: 2.0\n    },\n    DebugCanvas: {\n      container: '#game',\n      viewportSystemName: 'ViewportWebGL',\n    },\n    DrawStats: {},\n    DatGui: {},\n    Health: {},\n    Motion: {},\n    Position: {},\n    Thruster: {},\n    Steering: {\n      behaviors: [\n        'avoid',\n        'push',\n        'seek',\n        'flee',\n        'wander',\n        'evade',\n        'pursue'\n      ]\n    },\n    Repulsor: {},\n    Collision: {},\n    Bounce: {},\n    Spawn: {},\n  }\n});\n\nworld.debug = debug;\n\nconst pads = [];\n[-2000, 2000].forEach((x, idx) => pads.push(\n  world.insert({\n    Name: { name: `pad${idx}` },\n    Sprite: { name: 'default', color: 0x888888, size: 100 },\n    Position: { x, y: 0 }\n  })\n));\n\nfunction spawnShip() {\n  const idx = Math.random();\n  const sourceId = pads[Math.floor(pads.length * Math.random())];\n  const source = world.get('Position', sourceId);\n  let destId;\n  do { destId = pads[Math.floor(pads.length * Math.random())]; }\n  while (destId === sourceId);\n  const dest = world.get('Position', destId);\n\n  ships.push(world.insert({\n    Name: {\n      name: `ship${idx}`,\n      tags: ['ship']\n    },\n    Spawn: {\n      ttl: 10 + Math.random()\n    },\n    Sprite: {\n      name: 'hero',\n      size: 100,\n      color: 0xffffff * Math.random(),\n    },\n    Position: {\n      x: source.x + (250 * Math.random()),\n      y: source.y + (250 * Math.random()),\n      rotation: Math.PI * 2 * Math.random()\n    },\n    Bounce: {\n      mass: 100\n    },\n    Collidable: { },\n    Motion: { },\n    Thruster: {\n      deltaV: 5000,// + 500 * Math.random(),\n      maxV: 1000,// + 500 * Math.random()\n    },\n    Steering: {\n      active: true,\n      thrusterTurnCutoff: Math.PI * 0.1,\n      thrusterTurnThrottle: 0.0,\n      radPerSec: Math.PI * 1.5,\n\n      seekFactor: 1.0,\n      seekTargetPosition: dest,\n\n      avoidFactor: 1.75,\n      avoidTags: ['ship'],\n      avoidSensorRange: 500,\n    }\n  }));\n}\n\nconst ships = [];\nfor (let idx = 0; idx < 25; idx++) {\n  setTimeout(spawnShip, 5000 * Math.random());\n}\n\nworld.subscribe(MSG_DESPAWN, () => {\n  setTimeout(spawnShip, 1000 * Math.random());\n});\n\nworld.start();\n\nconst vpSystem = world.getSystem('ViewportWebGL');\nconst guiSystem = world.getSystem('DatGui');\nconst gui = guiSystem.gui;\n\nconst generalf = gui.addFolder('General');\ngeneralf.add(world, 'isPaused');\ngeneralf.add(world, 'debug');\ngeneralf.open();\n\nconst vpf = gui.addFolder('Viewport');\nconst names = [ 'gridEnabled', 'followEnabled', 'cameraX', 'cameraY' ];\nnames.forEach(name => vpf.add(vpSystem, name).listen());\nvpf.add(vpSystem, 'zoom',\n  vpSystem.options.zoomMin, vpSystem.options.zoomMax).listen();\nvpf.add(vpSystem, 'lineWidth', 1.0, 4.0).step(0.5).listen();\nvpf.add(vpSystem, 'spriteCount').listen();\nvpf.add(vpSystem, 'lastVertexCount').listen();\nvpf.add(vpSystem, 'actualBufferSize').listen();\nvpf.add(vpSystem, 'calculatedBufferSize').listen();\n\n\n\n// WEBPACK FOOTER //\n// ./src/sketches/current.js"],"sourceRoot":""}