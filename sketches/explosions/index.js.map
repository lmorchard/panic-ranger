{"version":3,"sources":["webpack:///./src/sketches/explosions.js"],"names":["DEBUG","MIN_COUNT","FIELD_SIZE","debugData","count","spawns","despawns","world","window","systems","ViewportWebGL","debug","container","WebGL","zoom","DrawStats","MemoryStats","DatGui","Motion","Position","Spawn","start","colors","spawnExplosion","x","Math","random","y","ttl","color","floor","length","insert","Sprite","name","tombstone","size","i","subscribe","get","vpSystem","getSystem","guiSystem","gui","add","options","zoomMin","zoomMax","listen","forEach"],"mappings":"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","file":"sketches/explosions/index.js","sourcesContent":["import { World } from '../lib/core';\n\nimport '../plugins/drawStats';\nimport '../plugins/memoryStats';\nimport '../plugins/datGui';\nimport '../plugins/viewportWebGL';\nimport '../plugins/name';\nimport '../plugins/position';\nimport '../plugins/motion';\nimport { MSG_SPAWN, MSG_DESPAWN } from '../plugins/spawn';\n\nconst DEBUG = true;\nconst MIN_COUNT = 150;\nconst FIELD_SIZE = 1500;\n\nconst debugData = {\n  count: 0,\n  spawns: 0,\n  despawns: 0\n};\n\nconst world = window.world = new World({\n  systems: {\n    ViewportWebGL: {\n      debug: DEBUG,\n      container: '#game',\n      WebGL: '#viewport',\n      zoom: 0.3\n    },\n    DrawStats: {},\n    MemoryStats: {},\n    DatGui: {},\n    Motion: {},\n    Position: {},\n    Spawn: {}\n  }\n});\nworld.start();\n\nconst colors = [ 0xff0000, 0x00ff00, 0x0000ff, 0xffff00, 0x00ffff, 0xffffff ];\n\nfunction spawnExplosion() {\n  const x = (FIELD_SIZE * 2 * Math.random()) - FIELD_SIZE;\n  const y = (FIELD_SIZE * 2 * Math.random()) - FIELD_SIZE;\n  const ttl = 0.5 + 2.0 * Math.random();\n  const color = colors[Math.floor(Math.random() * colors.length)];\n\n  world.insert({\n    Sprite: { name: 'default', color },\n    Position: { x, y },\n    Spawn: {\n      ttl: Math.random(),\n      tombstone: {\n        Sprite: {\n          name: 'explosion',\n          size: 100 + Math.random() * 500,\n          color, ttl\n        },\n        Position: { x, y },\n        Spawn: { ttl }\n      }\n    }\n  });\n}\n\nfor (let i = 0; i < MIN_COUNT; i++) {\n  spawnExplosion();\n}\n\nworld.subscribe(MSG_SPAWN, (/*msg, entityId*/) => {\n  debugData.spawns++;\n});\n\nworld.subscribe(MSG_DESPAWN, (/*msg, entityId*/) => {\n  debugData.despawns++;\n  debugData.count = Object.keys(world.get('Sprite') || {}).length;\n  for (let i = 0; i < MIN_COUNT - debugData.count; i++) {\n    spawnExplosion();\n  }\n});\n\nconst vpSystem = world.getSystem('ViewportWebGL');\nconst guiSystem = world.getSystem('DatGui');\nconst gui = guiSystem.gui;\n\ngui.add(world, 'isPaused');\ngui.add(world, 'debug');\ngui.add(vpSystem, 'zoom', vpSystem.options.zoomMin, vpSystem.options.zoomMax).listen();\n\n['gridEnabled'].forEach(name => gui.add(vpSystem, name).listen());\n['count', 'spawns', 'despawns'].forEach(name => gui.add(debugData, name).listen());\n\n\n\n// WEBPACK FOOTER //\n// ./src/sketches/explosions.js"],"sourceRoot":""}