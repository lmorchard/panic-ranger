{"version":3,"sources":["webpack:///webpack/bootstrap 5ccb5d1d742bcc1a4dc1","webpack:///./src/lib/core.js","webpack:///./node_modules/babel-runtime/helpers/classCallCheck.js","webpack:///./node_modules/babel-runtime/helpers/createClass.js","webpack:///./node_modules/babel-runtime/core-js/object/get-prototype-of.js","webpack:///./node_modules/babel-runtime/helpers/possibleConstructorReturn.js","webpack:///./node_modules/babel-runtime/helpers/inherits.js","webpack:///./node_modules/core-js/library/modules/_core.js","webpack:///./src/plugins/position.js","webpack:///./src/plugins/motion.js","webpack:///./node_modules/core-js/library/modules/_wks.js","webpack:///./node_modules/core-js/library/modules/_export.js","webpack:///./node_modules/core-js/library/modules/_to-iobject.js","webpack:///./node_modules/core-js/library/modules/_global.js","webpack:///./node_modules/core-js/library/modules/_object-dp.js","webpack:///./node_modules/core-js/library/modules/_descriptors.js","webpack:///./node_modules/core-js/library/modules/_object-keys.js","webpack:///./node_modules/core-js/library/modules/_has.js","webpack:///./src/lib/Vector2D.js","webpack:///./src/plugins/datGui.js","webpack:///./src/plugins/drawStats.js","webpack:///./src/plugins/memoryStats.js","webpack:///./src/plugins/name.js","webpack:///./node_modules/core-js/library/modules/_hide.js","webpack:///./node_modules/core-js/library/modules/_an-object.js","webpack:///./node_modules/core-js/library/modules/_fails.js","webpack:///./node_modules/babel-runtime/helpers/get.js","webpack:///./src/plugins/health.js","webpack:///./src/plugins/spawn.js","webpack:///./src/plugins/seeker.js","webpack:///./src/plugins/thruster.js","webpack:///./src/plugins/viewportWebGL.js","webpack:///./node_modules/core-js/library/modules/_is-object.js","webpack:///./node_modules/core-js/library/modules/_property-desc.js","webpack:///./node_modules/core-js/library/modules/_object-pie.js","webpack:///./node_modules/core-js/library/modules/_to-object.js","webpack:///./src/plugins/bounce.js","webpack:///./node_modules/core-js/library/modules/_iterators.js","webpack:///./src/plugins/collision.js","webpack:///./node_modules/babel-runtime/core-js/object/keys.js","webpack:///./src/plugins/playerInputSteering.js","webpack:///./node_modules/babel-runtime/core-js/object/assign.js","webpack:///./node_modules/core-js/library/modules/_uid.js","webpack:///./node_modules/core-js/library/modules/_ctx.js","webpack:///./node_modules/core-js/library/modules/_to-primitive.js","webpack:///./node_modules/core-js/library/modules/_cof.js","webpack:///./node_modules/core-js/library/modules/_defined.js","webpack:///./node_modules/core-js/library/modules/_to-integer.js","webpack:///./node_modules/core-js/library/modules/_shared-key.js","webpack:///./node_modules/core-js/library/modules/_shared.js","webpack:///./node_modules/core-js/library/modules/_enum-bug-keys.js","webpack:///./node_modules/core-js/library/modules/_object-gops.js","webpack:///./node_modules/core-js/library/modules/_object-sap.js","webpack:///./node_modules/core-js/library/modules/_library.js","webpack:///./node_modules/core-js/library/modules/_object-create.js","webpack:///./node_modules/core-js/library/modules/_set-to-string-tag.js","webpack:///./node_modules/core-js/library/modules/_wks-ext.js","webpack:///./node_modules/core-js/library/modules/_wks-define.js","webpack:///./node_modules/core-js/library/modules/_object-gopd.js","webpack:///./src/plugins/hordeSpawn.js","webpack:///./src/plugins/repulsor.js","webpack:///./node_modules/babel-runtime/helpers/extends.js","webpack:///./node_modules/core-js/library/modules/_ie8-dom-define.js","webpack:///./node_modules/core-js/library/modules/_dom-create.js","webpack:///./node_modules/core-js/library/modules/_object-keys-internal.js","webpack:///./node_modules/core-js/library/modules/_iobject.js","webpack:///./node_modules/core-js/library/modules/_to-length.js","webpack:///./node_modules/core-js/library/modules/_object-gpo.js","webpack:///./node_modules/babel-runtime/helpers/typeof.js","webpack:///./node_modules/core-js/library/modules/es6.string.iterator.js","webpack:///./node_modules/core-js/library/modules/_iter-define.js","webpack:///./node_modules/core-js/library/modules/_redefine.js","webpack:///./node_modules/core-js/library/modules/_object-gopn.js","webpack:///./src/plugins/expiration.js","webpack:///./src/plugins/orbiter.js","webpack:///./src/plugins/pathfinding.js","webpack:///./src/plugins/steering.js","webpack:///./src/plugins/viewportCanvas.js","webpack:///./node_modules/core-js/library/fn/object/assign.js","webpack:///./node_modules/core-js/library/modules/es6.object.assign.js","webpack:///./node_modules/core-js/library/modules/_a-function.js","webpack:///./node_modules/core-js/library/modules/_object-assign.js","webpack:///./node_modules/core-js/library/modules/_array-includes.js","webpack:///./node_modules/core-js/library/modules/_to-absolute-index.js","webpack:///./node_modules/babel-runtime/core-js/object/define-property.js","webpack:///./node_modules/core-js/library/fn/object/define-property.js","webpack:///./node_modules/core-js/library/modules/es6.object.define-property.js","webpack:///./node_modules/core-js/library/fn/object/get-prototype-of.js","webpack:///./node_modules/core-js/library/modules/es6.object.get-prototype-of.js","webpack:///./node_modules/babel-runtime/core-js/symbol/iterator.js","webpack:///./node_modules/core-js/library/fn/symbol/iterator.js","webpack:///./node_modules/core-js/library/modules/_string-at.js","webpack:///./node_modules/core-js/library/modules/_iter-create.js","webpack:///./node_modules/core-js/library/modules/_object-dps.js","webpack:///./node_modules/core-js/library/modules/_html.js","webpack:///./node_modules/core-js/library/modules/web.dom.iterable.js","webpack:///./node_modules/core-js/library/modules/es6.array.iterator.js","webpack:///./node_modules/core-js/library/modules/_add-to-unscopables.js","webpack:///./node_modules/core-js/library/modules/_iter-step.js","webpack:///./node_modules/babel-runtime/core-js/symbol.js","webpack:///./node_modules/core-js/library/fn/symbol/index.js","webpack:///./node_modules/core-js/library/modules/es6.symbol.js","webpack:///./node_modules/core-js/library/modules/_meta.js","webpack:///./node_modules/core-js/library/modules/_keyof.js","webpack:///./node_modules/core-js/library/modules/_enum-keys.js","webpack:///./node_modules/core-js/library/modules/_is-array.js","webpack:///./node_modules/core-js/library/modules/_object-gopn-ext.js","webpack:///./node_modules/core-js/library/modules/es7.symbol.async-iterator.js","webpack:///./node_modules/core-js/library/modules/es7.symbol.observable.js","webpack:///./node_modules/babel-runtime/core-js/object/set-prototype-of.js","webpack:///./node_modules/core-js/library/fn/object/set-prototype-of.js","webpack:///./node_modules/core-js/library/modules/es6.object.set-prototype-of.js","webpack:///./node_modules/core-js/library/modules/_set-proto.js","webpack:///./node_modules/babel-runtime/core-js/object/create.js","webpack:///./node_modules/core-js/library/fn/object/create.js","webpack:///./node_modules/core-js/library/modules/es6.object.create.js","webpack:///./node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js","webpack:///./node_modules/core-js/library/fn/object/get-own-property-descriptor.js","webpack:///./node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js","webpack:///./src/lib/QuadTree.js","webpack:///./node_modules/dat-gui/index.js","webpack:///./node_modules/dat-gui/vendor/dat.gui.js","webpack:///./node_modules/dat-gui/vendor/dat.color.js","webpack:///./node_modules/stats-js/build/stats.min.js","webpack:///./node_modules/core-js/library/fn/object/keys.js","webpack:///./node_modules/core-js/library/modules/es6.object.keys.js","webpack:///./node_modules/memory-stats/memory-stats.js","webpack:///./src/plugins/viewportPixi.js","webpack:///./src/lib/utils.js","webpack:///./node_modules/babel-runtime/helpers/toConsumableArray.js","webpack:///./node_modules/babel-runtime/core-js/array/from.js","webpack:///./node_modules/core-js/library/fn/array/from.js","webpack:///./node_modules/core-js/library/modules/es6.array.from.js","webpack:///./node_modules/core-js/library/modules/_iter-call.js","webpack:///./node_modules/core-js/library/modules/_is-array-iter.js","webpack:///./node_modules/core-js/library/modules/_create-property.js","webpack:///./node_modules/core-js/library/modules/core.get-iterator-method.js","webpack:///./node_modules/core-js/library/modules/_classof.js","webpack:///./node_modules/core-js/library/modules/_iter-detect.js","webpack:///./node_modules/babel-runtime/core-js/object/values.js","webpack:///./node_modules/core-js/library/fn/object/values.js","webpack:///./node_modules/core-js/library/modules/es7.object.values.js","webpack:///./node_modules/core-js/library/modules/_object-to-array.js"],"names":["TARGET_FPS","TARGET_DURATION","requestAnimationFrame","window","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","fn","setTimeout","entityId","system","systemName","systemAttrs","systemCls","componentName","timeNow","timeDelta","componentAttrs","matches","idx","item","handler","Messages","ENTITY_INSERT","ENTITY_DESTROY","World","options","isRunning","isPaused","debug","systems","addSystems","store","subscribers","tickDuration","maxTickDelta","tickAccumulator","lastTickTime","lastDrawTime","boundTickLoop","tickLoop","boundDrawLoop","timestamp","drawLoop","reset","initialize","Date","now","lastEntityId","msg","push","data","systemsData","getSystem","setWorld","timeDeltaMS","updateStart","update","updateEnd","Math","min","tick","drawStart","draw","drawEnd","out","items","generateEntityId","addComponent","world","publish","length","removeComponent","componentManager","getComponent","component","create","Component","attrs","defaults","System","defaultOptions","get","matchComponent","getMatchingComponents","updateComponent","componentRegistry","registerComponent","systemRegistry","registerSystem","Position","x","y","rotation","sprite","position","positions","PositionSystem","quadtreeMaxAge","quadtreeObjectsPerNode","quadtreeMaxLevels","bounds","left","top","right","bottom","width","height","quadtree","updateBounds","resetQuadtree","halfWidth","halfHeight","insert","g","getDebugGraphics","lineStyle","drawCircle","moveTo","lineTo","drawDebugQuadtreeNode","drawRect","root","objects","forEach","body","nodes","PI2","PI","Motion","dx","dy","drotation","MotionSystem","motion","pos","Vector2D","cloneFrom","object","fromArray","array","zero","prototype","add","vector","addScalar","val","eq","subtract","clone","set","setValues","_at_x","_at_y","dist","sqrt","normalise","normalize","isZero","m","magnitude","reverse","toArray","angle","atan2","rotate","cos","sin","angleTo","rotateAround","point","multiplyScalar","multiply","divide","divideScalar","round","dot","DatGui","gui","dat","GUI","DrawStats","drawStats","setMode","domElement","style","document","appendChild","tickStats","begin","end","MemoryStatsSystem","stats","Name","name","names","nid","nameComponent","MSG_DAMAGE","MSG_HEAL","health","Health","max","current","show_bar","c","HealthSystem","subscribe","to","amount","MSG_SPAWN","MSG_DESTROY","MSG_DESPAWN","MSG_CAPTURE_CAMERA","spawn","Spawn","ttl","age","destroy","tombstone","SpawnSystem","spawned","captureCamera","Seeker","active","targetName","targetEntityId","targetPosition","acquisitionDelay","radPerSec","SeekerSystem","vSeeker","vTarget","seeker","findEntityByName","targetAngle","direction","offset","abs","targetDr","impulseDr","Thruster","stop","useBrakes","deltaV","maxV","ThrusterSystem","vInertia","vThrust","vBrakes","thruster","tickDeltaV","currV","overV","brakingDv","TYPE_SIZES","sprites","sceneSprite","wheelDistance","evt","event","w","wheelDelta","d","detail","ViewportWebGL","lineWidth","zoom","zoomMin","zoomMax","zoomWheelFactor","gridEnabled","gridSize","gridColor","followEnabled","followName","followEntityId","container","querySelector","canvas","createElement","initWebGL","scene","events","ev","updateMetrics","onMouseDown","onMouseMove","onMouseUp","addEventListener","boundOnMouseWheel","onMouseWheel","attachEvent","cursorRawX","cursorRawY","cursorChanged","cursorPosition","cameraX","cameraY","debugDummySprite","size","setCursor","clientX","clientY","offsetWidth","offsetHeight","newX","newY","visibleWidth","visibleHeight","visibleLeft","visibleTop","visibleRight","visibleBottom","charAt","updateBackdrop","shapes","WebGLSprite","init","visible","scale","color","followEntity","setUniforms","uLineWidth","uCameraZoom","uCameraOrigin","uViewportSize","clientWidth","clientHeight","bufferSize","calculateBufferSizeForScene","buffer","Float32Array","vertexCount","fillBufferFromScene","gl","bufferData","ARRAY_BUFFER","STATIC_DRAW","viewport","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","drawArrays","TRIANGLE_STRIP","_backdrop","gridOffsetX","gridOffsetY","getContext","antialias","preserveDrawingBuffer","premultipliedAlpha","blendFunc","SRC_ALPHA","ONE","enable","BLEND","disable","DEPTH_TEST","program","createProgram","createShader","VERTEX_SHADER","SHADER_VERTEX","FRAGMENT_SHADER","SHADER_FRAGMENT","useProgram","bindBuffer","createBuffer","numAttribs","getProgramParameter","ACTIVE_ATTRIBUTES","attribs","vertexSize","i","info","getActiveAttrib","type","vertexAttribPointer","FLOAT","enableVertexAttribArray","uniforms","numUniforms","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","source","shader","shaderSource","compileShader","success","getShaderParameter","COMPILE_STATUS","deleteShader","vertexShader","fragmentShader","attachShader","linkProgram","LINK_STATUS","deleteProgram","reduce","acc","shape","bufferPos","deltaPosition","deltaScale","deltaRotation","lineIdx","shapesIdx","bufferVertex","shapeIdx","sceneKeys","sort","sceneKeysIdx","key","call","drawn","registry","default","getHandler","defaultShape","rot","register","heroShapes","repulsorSides","repulsorPoints","repulsorShapes","map","p","NUM_POINTS","floor","random","MAX_RADIUS","MIN_RADIUS","ROTATION","even","legs","BounceComponent","mass","BounceSystem","dn","dt","mt","v1","v2","v1n","v1t","v2n","v2t","entities","pairs","aEntityId","aCollidable","bEntityId","inCollisionWith","pair","join","aBouncer","bBouncer","resolveElasticCollision","aPosition","aSprite","aMotion","bPosition","bSprite","bMotion","delta","m1","m2","M","aFactor","processDamage","bFactor","eid","c_eid","v_motion","bouncer","damage","dmg","from","Collidable","inCollision","match","entityId2","bCollidable","radii","CollisionSystem","positionSystemName","positionSystem","retrieveBounds","checkCollisionBound","neighbor","checkCollision","iterate","collidables","collidable","PlayerInputSteering","PlayerInputSteeringSystem","gamepadDeadzone","gamepad","pointer","keys","touch","setPointer","windowEvents","keydown","handleKeyDown","keyup","handleKeyUp","k","bind","updateGamepads","updateKeyboard","steering","updateComponentFromKeyboard","updateComponentFromPointer","updateComponentFromGamepad","updateMotionFromTargetAngle","axis1","axis0","dleft","button13","dright","button14","dup","button11","gamepads","navigator","getGamepads","gp","connected","buttons","pressed","axes","axisX","axisY","ddown","button12","keyCode","preventDefault","targetAngleRaw","HordeSpawn","HordeSpawnSystem","viewportSystemName","minCount","maxFrameSpawn","offscreenTTL","spawnMargin","spawnCount","viewportSystem","cnt","spawnOffscreen","hordespawn","margin","h","r","Repulsor","range","force","components","repulsor","repulsorPosition","neighborSprite","neighborPosition","neighborMotion","repelAngle","repelForce","queryBounds","RepulsorSystem","applyRepulsionBound","applyRepulsion","repulsorId","Expiration","ExpirationSystem","expiration","Orbiter","OrbiterSystem","vOrbited","vOrbiter","vOld","orbiter","oPos","angleDelta","Pathfinder","SpaceTree","level","maxLevel","empty","full","children","ct","obj","dwidth","dheight","split","splitWidth","splitHeight","PathfindingSystem","vpSystem","ctx","save","centerAndZoom","restore","Steering","sensorRange","obstacleRepel","SteeringSystem","seekFactor","pushFactor","avoidFactor","avoidSeeAhead","avoidRayWidthFactor","vectors","avoid","seek","flee","wander","evade","pursue","applySteering","result","lookForObstacle","targetSprite","A","B","n","edgeRange","distance","U","pow","obstacle","rayX","rayY","oppositeLen","hypotenuseLen","theta","asin","isNaN","obstacleAngle","avoidAngle","travel","rayWidth","vRayUnit","hitCircles","steps","step","searchCircleForObstacle","hits","a","b","seekTargetName","seekTargetEntityId","drawAngle","vec","strokeStyle","beginPath","stroke","CanvasSprite","ViewportCanvas","drawBackdrop","drawScene","drawDebugCursor","fillStyle","fillRect","translate","strokeRect","drawSprite","spriteFn","getSprite","spriteRegistry","registerSprite","arc","points","initialized","radius","maxParticles","maxParticleSize","maxVelocity","particles","free","velocity","maxDistance","alpha","globalAlpha","QuadTree","maxObjects","maxLevels","_empty","entityMap","subWidth","subHeight","midX","midY","index","getIndex","oldNode","objectIndex","indexOf","splice","rect","iteratorFn","optionalParam","ViewportPixi","renderer","PIXI","autoDetectRenderer","autoResize","view","stage","Container","filters","healthBarGraphics","Graphics","addChild","backdrop","graphics","toRemove","filter","removeChild","toAdd","setTransform","resize","render","drawPolygon","lineColor","repulsorShape","t","rings","startR","endR","startO","endO","endT","ring","lerp","heroShape","v0"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAY,2BAA2B;AACvC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kDAA0C,WAAW,EAAE;AACvD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA,kDAA0C,oBAAoB,WAAW;;AAEzE;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpJA,IAAMA,aAAa,EAAnB;AACA,IAAMC,kBAAkB,OAAOD,UAA/B;;AAEA,IAAME,wBACJC,OAAOD,qBAAP,IACAC,OAAOC,2BADP,IAEAD,OAAOE,wBAFP,IAGAF,OAAOG,sBAHP,IAIAH,OAAOI,uBAJP,IAKA,UAAUC,EAAV,EAAc;AAAEC,aAAWD,EAAX,EAAgB,OAAK,EAArB;AAA4B,CAN9C;;AAQA;AACA,IAAIE,iBAAJ;AAAA,IAAcC,eAAd;AAAA,IAAsBC,mBAAtB;AAAA,IAAkCC,oBAAlC;AAAA,IAA+CC,kBAA/C;AAAA,IAA0DC,sBAA1D;AAAA,IACIC,gBADJ;AAAA,IACaC,kBADb;AAAA,IACwBC,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ACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,UAAU,EAAE;AAChD,mBAAmB,sCAAsC;AACzD,CAAC,qCAAqC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;;;;;;;;;;;;ACjCD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,YAAY,eAAe;AAChC;AACA,KAAK;AACL;AACA;;;;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACNA,kBAAkB,yG;;;;;;;;;;;ACAlB;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;AACA,2FAAuE,gEAA4C;;;;;;;;;;;;ACFnH;AACA;;;;;;;;;;;;ACDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;ACRD,kBAAkB,kG;;;;;;;;;;;ACAlB;AACA;AACA;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;;AAEA;AACA,yHAAkF,aAAa,EAAE;;AAEjG;AACA,qDAAqD,4BAA4B;AACjF;AACA;;;;;;;;;;;;ACZA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACZA;AACA;;;;;;;;;;;;ACDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AClBA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC,cAAc;AACd,iBAAiB;AACjB;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACjCA,8BAA8B;;;;;;;;;;;;ACA9B;AACA,UAAU;AACV;;;;;;;;;;;;ACFA,kBAAkB,0F;;;;;;;;;;;ACAlB;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB;AACtB,sBAAsB,uBAAuB,WAAW,IAAI;AAC5D,GAAG;AACH,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA,KAAK;AACL;AACA,sBAAsB,mCAAmC;AACzD,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,gCAAgC;AAChG;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,0DAA0D,kBAAkB;;AAE5E;AACA;AACA;AACA,oBAAoB,uBAAuB;;AAE3C,oDAAoD,6BAA6B;;AAEjF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH,0BAA0B,eAAe,EAAE;AAC3C,0BAA0B,gBAAgB;AAC1C,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,OAAO,QAAQ,iCAAiC;AACpG,CAAC;AACD;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC1OA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD,CAAC;AACD;AACA,qBAAqB;AACrB;AACA,SAAS;AACT,GAAG,EAAE;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;ACdA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AClBA;;;;;;;;;;;;ACAA;;;;;;;;;;;;ACAA,kBAAkB,2G;;;;;;;;;;;ACAlB;AACA;;;;;;;;;;;;ACDA;AACA;AACA,8BAA8B,mEAA8C;;;;;;;;;;;;ACF5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA,OAAO,YAAY,cAAc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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,U;;AAEA,aAAa;;AAEb;;AAEA;;AAEA;AACA;AACA;;AAEA,OAAO;;AAEP;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;;AAEA,OAAO;;AAEP;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA,KAAK;;AAEL;;;AAGA,iD;;AAEA;;AAEA,OAAO,0CAA0C;;AAEjD,yCAAyC,SAAS;AAClD;AACA;;AAEA,OAAO;;AAEP;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;;AAEA,CAAC;;;AAGD;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA,SAAS;;AAET;AACA,qBAAqB,QAAQ;AAC7B;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;;AAGA,CAAC;;;AAGD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,CAAC;;;AAGD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,CAAC;AACD;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,+BAA+B;AAC/B,OAAO;AACP;AACA;AACA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA,qBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA,qBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,QAAQ,OAAO;AACf;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,UAAU;AACzB;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA,oEAAoE,iCAAiC;;AAErG;;AAEA;AACA;;;;AAIA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;;AAEA;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;AACA;AACA;AACA,UAAU,iDAAiD,gBAAgB,uBAAuB,2BAA2B,qBAAqB,qBAAqB,GAAG,gBAAgB,yBAAyB,2BAA2B,gBAAgB,wBAAwB,yBAAyB,+BAA+B,GAAG,sBAAsB,0BAA0B,uBAAuB,2BAA2B,4BAA4B,gBAAgB,iBAAiB,uBAAuB,qBAAqB,kBAAkB,iBAAiB,GAAG;;;AAGlkB;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,CAAC;AACD;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;;AAGA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;AACA,2C;AACA,WAAW;AACX;AACA;;AAEA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA,CAAC;AACD;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA,CAAC;;;AAGD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA,SAAS;;AAET;;AAEA;;AAEA,mDAAmD,EAAE;AACrD;;AAEA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA,SAAS;;AAET;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA,SAAS;;AAET;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;;AAGA;;AAEA;;;AAGA,CAAC;AACD;;;AAGA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA,aAAa,QAAQ;AACrB,aAAa,YAAY;AACzB,aAAa,QAAQ;AACrB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;;AAGL;;AAEA;AACA;;AAEA,KAAK;;AAEL,qBAAqB;;AAErB;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;;;AAGP;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;;AAEA;;AAEA,2CAA2C,mBAAmB;AAC9D,2DAA2D,kBAAkB,EAAE;AAC/E,qDAAqD,mBAAmB;AACxE,sDAAsD,mBAAmB;AACzE;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA,qBAAqB,gCAAgC;AACrD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA,qBAAqB,YAAY;AACjC,oBAAoB,MAAM;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,gCAAgC;;AAEhC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,wCAAwC;;AAExC;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B,oBAAoB,MAAM;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA,qBAAqB,YAAY;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,SAAS;;AAET;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,SAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;;AAEX;AACA;AACA,WAAW;;AAEX;AACA;AACA;;;AAGA,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA,WAAW,wEAAwE;;AAEnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;;AAEf;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA,4BAA4B;AAC5B,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;;AAEP;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AAC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;AAET,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,wGAAwG;AACxG,KAAK;AACL;;AAEA;AACA;AACA,6JAA6J;AAC7J,0JAA0J;AAC1J,qJAAqJ;AACrJ,sJAAsJ;AACtJ,kJAAkJ;AAClJ;;;AAGA;;AAEA,CAAC;AACD;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;AACA;;AAEA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;;AAEA,CAAC;AACD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,CAAC;AACD;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AA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EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;;AAGA;;AAEA;;;AAGA,CAAC;AACD;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;AACA,kB;;;;;;;;;;;AClvBA;AACA,qBAAqB,mG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","file":"core.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tvar parentJsonpFunction = window[\"webpackJsonp\"];\n \twindow[\"webpackJsonp\"] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [], result;\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n \t\tif(executeModules) {\n \t\t\tfor(i=0; i < executeModules.length; i++) {\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = executeModules[i]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t};\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// objects to store loaded and loading chunks\n \tvar installedChunks = {\n \t\t7: 0\n \t};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData === 0) {\n \t\t\treturn new Promise(function(resolve) { resolve(); });\n \t\t}\n\n \t\t// a Promise means \"currently loading\".\n \t\tif(installedChunkData) {\n \t\t\treturn installedChunkData[2];\n \t\t}\n\n \t\t// setup Promise in chunk cache\n \t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t});\n \t\tinstalledChunkData[2] = promise;\n\n \t\t// start chunk loading\n \t\tvar head = document.getElementsByTagName('head')[0];\n \t\tvar script = document.createElement('script');\n \t\tscript.type = 'text/javascript';\n \t\tscript.charset = 'utf-8';\n \t\tscript.async = true;\n \t\tscript.timeout = 120000;\n\n \t\tif (__webpack_require__.nc) {\n \t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t}\n \t\tscript.src = __webpack_require__.p + \"\" + chunkId + \".bundle.js\";\n \t\tvar timeout = setTimeout(onScriptComplete, 120000);\n \t\tscript.onerror = script.onload = onScriptComplete;\n \t\tfunction onScriptComplete() {\n \t\t\t// avoid mem leaks in IE.\n \t\t\tscript.onerror = script.onload = null;\n \t\t\tclearTimeout(timeout);\n \t\t\tvar chunk = installedChunks[chunkId];\n \t\t\tif(chunk !== 0) {\n \t\t\t\tif(chunk) {\n \t\t\t\t\tchunk[1](new Error('Loading chunk ' + chunkId + ' failed.'));\n \t\t\t\t}\n \t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t}\n \t\t};\n \t\thead.appendChild(script);\n\n \t\treturn promise;\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 77);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5ccb5d1d742bcc1a4dc1","const TARGET_FPS = 60;\nconst TARGET_DURATION = 1000 / TARGET_FPS;\n\nconst requestAnimationFrame =\n  window.requestAnimationFrame ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame ||\n  window.oRequestAnimationFrame ||\n  window.msRequestAnimationFrame ||\n  function (fn) { setTimeout(fn, (1000/60)); };\n\n// Commonly used temp variables, pre-declared early.\nlet entityId, system, systemName, systemAttrs, systemCls, componentName,\n    timeNow, timeDelta, componentAttrs, matches, idx, item, handler;\n\nexport const Messages = {\n  ENTITY_INSERT: 'entity_insert',\n  ENTITY_DESTROY: 'entity_destroy'\n};\n\nexport class World {\n  constructor(options) {\n    options = options || {};\n\n    this.isRunning = false;\n    this.isPaused = false;\n    this.debug = false;\n\n    this.systems = {};\n    if (options.systems) {\n      this.addSystems(options.systems);\n    }\n\n    this.store = {};\n\n    this.subscribers = {};\n\n    this.tickDuration = TARGET_DURATION;\n    this.maxTickDelta = TARGET_DURATION * 5;\n    this.tickAccumulator = 0;\n\n    this.lastTickTime = 0;\n    this.lastDrawTime = 0;\n\n    this.boundTickLoop = () => this.tickLoop();\n    this.boundDrawLoop = (timestamp) => this.drawLoop(timestamp);\n\n    this.reset();\n  }\n\n  start() {\n    if (this.isRunning) { return; }\n    this.isRunning = true;\n\n    for (const systemName in this.systems) {\n      this.systems[systemName].initialize();\n    }\n\n    // Game logic separated from display rendering\n    // See also: http://www.chandlerprall.com/2012/06/requestanimationframe-is-not-your-logics-friend/\n    this.lastTickTime = Date.now();\n    this.lastDrawTime = 0;\n\n    setTimeout(this.boundTickLoop, this.tickDuration);\n    requestAnimationFrame(this.boundDrawLoop);\n\n    return this;\n  }\n\n  stop() {\n    this.isRunning = false;\n    return this;\n  }\n\n  pause() {\n    this.isPaused = true;\n    return this;\n  }\n\n  resume() {\n    this.isPaused = false;\n    return this;\n  }\n\n  reset() {\n    this.store = {};\n    this.lastEntityId = 0;\n  }\n\n  // TODO: Use a better pubsub library here. But, pubsub-js seemed to perform\n  // badly in a game loop.\n\n  subscribe(msg, handler) {\n    if (!this.subscribers[msg]) {\n      this.subscribers[msg] = [];\n    }\n    this.subscribers[msg].push(handler);\n    return this;\n  }\n\n  unsubscribe(/* msg, handler */) {\n    // TODO\n    return this;\n  }\n\n  publish(msg, data) {\n    if (!this.subscribers[msg]) { return; }\n    for (idx = 0, handler; handler = this.subscribers[msg][idx]; idx++) {\n      handler(msg, data);\n    }\n    return this;\n  }\n\n  addSystems(systemsData) {\n    for (systemName in systemsData) {\n      systemAttrs = systemsData[systemName];\n      systemCls = getSystem(systemName);\n      system = new systemCls(systemAttrs);\n      system.setWorld(this);\n      this.systems[systemName] = system;\n    }\n  }\n\n  getSystem(systemName) {\n    return this.systems[systemName];\n  }\n\n  tick(timeDeltaMS) {\n    timeDelta = timeDeltaMS / 1000;\n    for (systemName in this.systems) {\n      this.systems[systemName].updateStart(timeDelta);\n    }\n    for (systemName in this.systems) {\n      this.systems[systemName].update(timeDelta);\n    }\n    for (systemName in this.systems) {\n      this.systems[systemName].updateEnd(timeDelta);\n    }\n  }\n\n  tickLoop() {\n    timeNow = Date.now();\n    timeDelta = Math.min(timeNow - this.lastTickTime, this.maxTickDelta);\n    this.lastTickTime = timeNow;\n\n    if (!this.isPaused) {\n      // Fixed-step game logic loop\n      // see: http://gafferongames.com/game-physics/fix-your-timestep/\n      this.tickAccumulator += timeDelta;\n      while (this.tickAccumulator > this.tickDuration) {\n        this.tick(this.tickDuration);\n        this.tickAccumulator -= this.tickDuration;\n      }\n    }\n\n    if (this.isRunning) {\n      setTimeout(this.boundTickLoop, this.tickDuration);\n    }\n  }\n\n  draw(timeDeltaMS) {\n    timeDelta = timeDeltaMS / 1000;\n    for (systemName in this.systems) {\n      this.systems[systemName].drawStart(timeDelta);\n    }\n    for (systemName in this.systems) {\n      this.systems[systemName].draw(timeDelta);\n    }\n    for (systemName in this.systems) {\n      this.systems[systemName].drawEnd(timeDelta);\n    }\n  }\n\n  drawLoop(timestamp) {\n    if (!this.lastDrawTime) { this.lastDrawTime = timestamp; }\n    timeDelta = timestamp - this.lastDrawTime;\n    this.lastDrawTime = timestamp;\n\n    if (!this.isPaused) {\n      this.draw(timeDelta);\n    }\n\n    if (this.isRunning) {\n      requestAnimationFrame(this.boundDrawLoop);\n    }\n  }\n\n  generateEntityId() {\n    return ++(this.lastEntityId);\n  }\n\n  insert(...items) {\n    const out = [];\n    for (idx = 0; item = items[idx]; idx++) {\n      entityId = this.generateEntityId();\n      for (componentName in item) {\n        componentAttrs = item[componentName];\n        this.addComponent(entityId, componentName, componentAttrs);\n      }\n      if (this.world) this.world.publish(Messages.ENTITY_INSERT, entityId);\n      out.push(entityId);\n    }\n    return out.length > 1 ? out : out[0];\n  }\n\n  destroy(entityId) {\n    if (this.world) this.world.publish(Messages.ENTITY_DESTROY, entityId);\n    for (componentName in this.store) {\n      this.removeComponent(entityId, componentName);\n    }\n  }\n\n  addComponent(entityId, componentName, componentAttrs) {\n    const componentManager = getComponent(componentName);\n    const component = componentManager.create(componentAttrs);\n    if (!this.store[componentName]) {\n      this.store[componentName] = {};\n    }\n    this.store[componentName][entityId] = component;\n  }\n\n  removeComponent(entityId, componentName) {\n    if (entityId in this.store[componentName]) {\n      delete this.store[componentName][entityId];\n    }\n  }\n\n  hasComponent(entityId, componentName) {\n    return (componentName in this.store) &&\n           (entityId in this.store[componentName]);\n  }\n\n  get(componentName, entityId) {\n    if (!this.store[componentName]) {\n      return null;\n    } else if (!entityId) {\n      return this.store[componentName];\n    } else {\n      return this.store[componentName][entityId];\n    }\n  }\n\n\n}\n\nexport class Component {\n\n  static defaults() {\n    return {};\n  }\n\n  static create(attrs) {\n    return {...this.defaults(), ...(attrs || {})};\n  }\n\n}\n\nexport class System {\n\n  constructor(options) {\n    this.options = {...this.defaultOptions(), ...(options || {})};\n    this.debug = this.options.debug || false;\n  }\n\n  defaultOptions() {\n    return {};\n  }\n\n  setWorld(world) {\n    this.world = world;\n  }\n\n  matchComponent() { return ''; }\n\n  initialize() { }\n\n  getMatchingComponents() {\n    return this.world.get(this.matchComponent());\n  }\n\n  updateStart(/* timeDelta */) { }\n\n  update(timeDelta) {\n    matches = this.getMatchingComponents();\n    for (entityId in matches) {\n      this.updateComponent(timeDelta, entityId, matches[entityId]);\n    }\n  }\n\n  updateComponent(/* timeDelta, entityId, component */) { }\n\n  updateEnd(/* timeDelta */) { }\n\n  drawStart(/* timeDelta */) { }\n\n  draw(/* timeDelta */) { }\n\n  getDebugGraphics() {\n    // TODO make this work again someday\n    return;\n  }\n\n  drawEnd(/* timeDelta */) { }\n\n}\n\nconst componentRegistry = {};\n\nexport function registerComponent(componentName, componentManager) {\n  componentRegistry[componentName] = componentManager;\n}\n\nexport function getComponent(componentName) {\n  return componentRegistry[componentName];\n}\n\nconst systemRegistry = {};\n\nexport function registerSystem(systemName, system) {\n  systemRegistry[systemName] = system;\n}\n\nexport function getSystem(systemName) {\n  return systemRegistry[systemName];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/core.js","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/classCallCheck.js\n// module id = 1\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = require(\"../core-js/object/define-property\");\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      (0, _defineProperty2.default)(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/createClass.js\n// module id = 2\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/get-prototype-of\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/get-prototype-of.js\n// module id = 3\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && ((typeof call === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(call)) === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/possibleConstructorReturn.js\n// module id = 4\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _setPrototypeOf = require(\"../core-js/object/set-prototype-of\");\n\nvar _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);\n\nvar _create = require(\"../core-js/object/create\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(superClass)));\n  }\n\n  subClass.prototype = (0, _create2.default)(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf2.default ? (0, _setPrototypeOf2.default)(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/inherits.js\n// module id = 5\n// module chunks = 7","var core = module.exports = { version: '2.5.0' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_core.js\n// module id = 6\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\r\nimport QuadTree from '../lib/QuadTree';\r\n\r\nexport class Position extends Component {\r\n  static defaults() {\r\n    return { x: 0, y: 0, rotation: 0 };\r\n  }\r\n}\r\n\r\nregisterComponent('Position', Position);\r\n\r\nlet entityId, sprite, position, positions;\r\n\r\nexport class PositionSystem extends System {\r\n\r\n  defaultOptions() {\r\n    return {\r\n      quadtreeMaxAge: 2,\r\n      quadtreeObjectsPerNode: 5,\r\n      quadtreeMaxLevels: 5\r\n    };\r\n  }\r\n\r\n  matchComponent() { return 'Position'; }\r\n\r\n  initialize() {\r\n    this.bounds = {\r\n      left: 0, top: 0, right: 0, bottom: 0,\r\n      width: 0, height: 0\r\n    };\r\n    this.quadtree = new QuadTree(\r\n      -1000, -1000, 2000, 2000,\r\n      this.options.quadtreeObjectsPerNode,\r\n      this.options.quadtreeMaxLevels\r\n    );\r\n  }\r\n\r\n  update(timeDelta) {\r\n    this.updateBounds();\r\n    this.resetQuadtree(timeDelta);\r\n    super.update(timeDelta);\r\n  }\r\n\r\n  resetQuadtree() {\r\n    this.quadtree.reset(\r\n      this.bounds.left,\r\n      this.bounds.top,\r\n      this.bounds.width,\r\n      this.bounds.height,\r\n      this.options.quadtreeObjectsPerNode,\r\n      this.options.quadtreeMaxLevels\r\n    );\r\n  }\r\n\r\n  updateBounds() {\r\n    this.bounds.left = this.bounds.top = this.bounds.right = this.bounds.bottom = null;\r\n    positions = this.getMatchingComponents();\r\n    for (entityId in positions) {\r\n      position = positions[entityId];\r\n      if (this.bounds.left === null || position.left < this.bounds.left) { this.bounds.left = position.left; }\r\n      if (this.bounds.top === null || position.top < this.bounds.top) { this.bounds.top = position.top; }\r\n      if (this.bounds.right === null || position.right > this.bounds.right) { this.bounds.right = position.right; }\r\n      if (this.bounds.bottom === null || position.bottom > this.bounds.bottom) { this.bounds.bottom = position.bottom; }\r\n    }\r\n    this.bounds.width = this.bounds.right - this.bounds.left;\r\n    this.bounds.height = this.bounds.bottom - this.bounds.top;\r\n  }\r\n\r\n  updateComponent(timeDelta, entityId, position) {\r\n    sprite = this.world.get('Sprite', entityId);\r\n    if (!sprite) { return; }\r\n\r\n    const halfWidth = sprite.width / 2;\r\n    const halfHeight = sprite.height / 2;\r\n\r\n    position.entityId = entityId;\r\n    position.width = sprite.width;\r\n    position.height = sprite.height;\r\n    position.left = position.x - halfWidth;\r\n    position.top = position.y - halfHeight;\r\n    position.right = position.x + halfWidth;\r\n    position.bottom = position.y + halfHeight;\r\n\r\n    this.quadtree.insert(position);\r\n  }\r\n\r\n  draw(/* timeDelta */) {\r\n    const g = this.getDebugGraphics();\r\n    if (!g) { return; }\r\n\r\n    g.lineStyle(4, 0x882222);\r\n    positions = this.getMatchingComponents();\r\n    for (entityId in positions) {\r\n      position = positions[entityId];\r\n      sprite = this.world.get('Sprite', entityId);\r\n      g.drawCircle(position.x, position.y, sprite.width / 2);\r\n      g.moveTo(position.x - 20, position.y);\r\n      g.lineTo(position.x + 20, position.y);\r\n      g.moveTo(position.x, position.y - 20);\r\n      g.lineTo(position.x, position.y + 20);\r\n    }\r\n\r\n    g.lineStyle(4, 0x228822);\r\n    this.drawDebugQuadtreeNode(g, this.quadtree);\r\n\r\n    g.lineStyle(4, 0xffff33);\r\n    g.moveTo(-20, 0);\r\n    g.lineTo(20, 0);\r\n    g.moveTo(0, -20);\r\n    g.lineTo(0, 20);\r\n    g.moveTo(0, 0);\r\n    g.drawRect(\r\n      this.bounds.left,\r\n      this.bounds.top,\r\n      this.bounds.width,\r\n      this.bounds.height\r\n    );\r\n  }\r\n\r\n  drawDebugQuadtreeNode(g, root) {\r\n    if (!root) { return; }\r\n\r\n    g.lineStyle(4, 0x883388);\r\n    g.drawRect(root.bounds.left, root.bounds.top,\r\n               root.bounds.width, root.bounds.height);\r\n\r\n    g.lineStyle(4, 0x112222);\r\n    root.objects.forEach(body =>\r\n      g.drawRect(body.left, body.top, body.width, body.height));\r\n\r\n    this.drawDebugQuadtreeNode(g, root.nodes[0]);\r\n    this.drawDebugQuadtreeNode(g, root.nodes[1]);\r\n    this.drawDebugQuadtreeNode(g, root.nodes[2]);\r\n    this.drawDebugQuadtreeNode(g, root.nodes[3]);\r\n  }\r\n}\r\n\r\nregisterSystem('Position', PositionSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/position.js","import * as Core from '../lib/core';\r\n\r\nimport './position';\r\n\r\nconst PI2 = Math.PI * 2;\r\n\r\nexport class Motion extends Core.Component {\r\n  static defaults() {\r\n    return { dx: 0, dy: 0, drotation: 0 };\r\n  }\r\n}\r\nCore.registerComponent('Motion', Motion);\r\n\r\nexport class MotionSystem extends Core.System {\r\n  matchComponent() {\r\n    return 'Motion';\r\n  }\r\n  updateComponent(timeDelta, entityId, motion) {\r\n    const pos = this.world.get('Position', entityId);\r\n    pos.x += motion.dx * timeDelta;\r\n    pos.y += motion.dy * timeDelta;\r\n\r\n    // Update the rotation, ensuring a 0..2*Math.PI range.\r\n    pos.rotation = (pos.rotation + (motion.drotation * timeDelta)) % PI2;\r\n    if (pos.rotation < 0) {\r\n      pos.rotation += PI2;\r\n    }\r\n  }\r\n}\r\nCore.registerSystem('Motion', MotionSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/motion.js","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_wks.js\n// module id = 9\n// module chunks = 7","var global = require('./_global');\nvar core = require('./_core');\nvar ctx = require('./_ctx');\nvar hide = require('./_hide');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var IS_WRAP = type & $export.W;\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE];\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];\n  var key, own, out;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if (own && key in exports) continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function (C) {\n      var F = function (a, b, c) {\n        if (this instanceof C) {\n          switch (arguments.length) {\n            case 0: return new C();\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if (IS_PROTO) {\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_export.js\n// module id = 10\n// module chunks = 7","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-iobject.js\n// module id = 11\n// module chunks = 7","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_global.js\n// module id = 12\n// module chunks = 7","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-dp.js\n// module id = 13\n// module chunks = 7","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_descriptors.js\n// module id = 14\n// module chunks = 7","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-keys.js\n// module id = 15\n// module chunks = 7","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_has.js\n// module id = 16\n// module chunks = 7","/*\r\n  Originally by Vitalii [Nayjest] Stepanenko <gmail@vitaliy.in>\r\n  Tweaky & fixes by Les Orchard <me@lmorchard.com>\r\n*/\r\n\r\nexport default function Vector2D(x, y) {\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n}\r\n\r\nVector2D.cloneFrom = function(object) {\r\n  return new Vector2D(object.x, object.y);\r\n};\r\n\r\nVector2D.fromArray = function(array) {\r\n  return new Vector2D(array[0], array[1]);\r\n};\r\n\r\nVector2D.zero = new Vector2D(0, 0);\r\n\r\nVector2D.prototype.add = function(vector) {\r\n  this.x += vector.x;\r\n  this.y += vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.addScalar = function(val) {\r\n  this.x += val;\r\n  this.y += val;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.eq = function(vector) {\r\n  return vector.x === this.x && vector.y === this.y;\r\n};\r\n\r\nVector2D.prototype.subtract = function(vector) {\r\n  this.x -= vector.x;\r\n  this.y -= vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.clone = function() {\r\n  return new Vector2D(this.x, this.y);\r\n};\r\n\r\nVector2D.prototype.set = function(vector) {\r\n  this.x = vector.x;\r\n  this.y = vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.setValues = function(_at_x, _at_y) {\r\n  this.x = _at_x;\r\n  this.y = _at_y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.dist = function(vector) {\r\n  return Math.sqrt((vector.x - this.x) * (vector.x - this.x) + (vector.y - this.y) * (vector.y - this.y));\r\n};\r\n\r\nVector2D.prototype.normalise = function() {\r\n  return this.normalize();\r\n};\r\n\r\nVector2D.prototype.normalize = function() {\r\n  if (!this.isZero()) {\r\n    const m = this.magnitude();\r\n    this.x /= m;\r\n    this.y /= m;\r\n  }\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.isZero = function() {\r\n  return this.x === 0 && this.y === 0;\r\n};\r\n\r\nVector2D.prototype.reverse = function() {\r\n  this.x = -this.x;\r\n  this.y = -this.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.magnitude = function() {\r\n  return Math.sqrt(this.x * this.x + this.y * this.y);\r\n};\r\n\r\nVector2D.prototype.toArray = function() {\r\n  return [this.x, this.y];\r\n};\r\n\r\nVector2D.prototype.angle = function() {\r\n  return Math.atan2(this.y, this.x);\r\n};\r\n\r\nVector2D.prototype.rotate = function(angle) {\r\n  const cos = Math.cos(angle);\r\n  const sin = Math.sin(angle);\r\n  return this.setValues(this.x * cos - this.y * sin, this.x * sin + this.y * cos);\r\n};\r\n\r\nVector2D.prototype.angleTo = function(vector) {\r\n  return Math.atan2(vector.y - this.y, vector.x - this.x);\r\n};\r\n\r\nVector2D.prototype.rotateAround = function(point, angle) {\r\n  return this.subtract(point).rotate(angle).add(point);\r\n};\r\n\r\nVector2D.prototype.multiplyScalar = function(val) {\r\n  this.x *= val;\r\n  this.y *= val;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.multiply = function(vector) {\r\n  this.x *= vector.x;\r\n  this.y *= vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.divide = function(vector) {\r\n  this.x /= vector.x;\r\n  this.y /= vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.divideScalar = function(val) {\r\n  this.x /= val;\r\n  this.y /= val;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.round = function() {\r\n  this.x = Math.round(this.x);\r\n  this.y = Math.round(this.y);\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.dot = function(vector) {\r\n  return (this.x * vector.x) + (this.y * vector.y);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/Vector2D.js","import * as Core from '../lib/core';\r\n\r\nimport dat from 'dat-gui';\r\n\r\nexport class DatGui extends Core.System {\r\n\r\n  initialize() {\r\n    this.gui = new dat.GUI();\r\n  }\r\n\r\n}\r\nCore.registerSystem('DatGui', DatGui);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/datGui.js","import * as Core from '../lib/core';\r\n\r\nimport Stats from 'stats-js';\r\n\r\nexport class DrawStats extends Core.System {\r\n\r\n  initialize() {\r\n\r\n    this.drawStats = new Stats();\r\n    this.drawStats.setMode(0);\r\n    this.drawStats.domElement.style.position = 'absolute';\r\n    this.drawStats.domElement.style.left = '0px';\r\n    this.drawStats.domElement.style.top = '0px';\r\n    document.body.appendChild(this.drawStats.domElement);\r\n\r\n    this.tickStats = new Stats();\r\n    this.tickStats.setMode(0);\r\n    this.tickStats.domElement.style.position = 'absolute';\r\n    this.tickStats.domElement.style.left = '0px';\r\n    this.tickStats.domElement.style.top = '55px';\r\n    document.body.appendChild(this.tickStats.domElement);\r\n\r\n  }\r\n\r\n  updateStart() { this.tickStats.begin(); }\r\n\r\n  updateEnd() { this.tickStats.end(); }\r\n\r\n  drawStart() { this.drawStats.begin(); }\r\n\r\n  drawEnd() { this.drawStats.end(); }\r\n\r\n}\r\nCore.registerSystem('DrawStats', DrawStats);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/drawStats.js","import * as Core from '../lib/core';\r\n\r\nimport MemoryStats from 'memory-stats';\r\n\r\nexport class MemoryStatsSystem extends Core.System {\r\n\r\n  initialize() {\r\n    this.stats = new MemoryStats();\r\n    this.stats.domElement.style.position = 'fixed';\r\n    this.stats.domElement.style.left = '85px';\r\n    this.stats.domElement.style.top = '0px';\r\n    document.body.appendChild(this.stats.domElement);\r\n  }\r\n\r\n  draw() { this.stats.update(); }\r\n\r\n}\r\nCore.registerSystem('MemoryStats', MemoryStatsSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/memoryStats.js","import * as Core from '../lib/core';\r\n\r\nexport class Name extends Core.Component {\r\n  static defaults() {\r\n    return { name: 'unnamed' };\r\n  }\r\n  static findEntityByName(world, name) {\r\n    const names = world.get('Name');\r\n    for (const nid in names) {\r\n      const nameComponent = names[nid];\r\n      if (nameComponent.name === name) {\r\n        return nid;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nCore.registerComponent('Name', Name);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/name.js","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_hide.js\n// module id = 22\n// module chunks = 7","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_an-object.js\n// module id = 23\n// module chunks = 7","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_fails.js\n// module id = 24\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _getPrototypeOf = require(\"../core-js/object/get-prototype-of\");\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _getOwnPropertyDescriptor = require(\"../core-js/object/get-own-property-descriptor\");\n\nvar _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = (0, _getOwnPropertyDescriptor2.default)(object, property);\n\n  if (desc === undefined) {\n    var parent = (0, _getPrototypeOf2.default)(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/get.js\n// module id = 25\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\nimport { MSG_DESTROY } from './spawn';\n\nexport const MSG_DAMAGE = 'healthDamage';\nexport const MSG_HEAL = 'healthHeal';\n\nlet health;\n\nexport class Health extends Component {\n  static defaults() {\n    return {\n      max: 1000,\n      current: null,\n      show_bar: true\n    };\n  }\n  static create(attrs) {\n    const c = super.create(attrs);\n    c.current = c.max;\n    return c;\n  }\n}\n\nregisterComponent('Health', Health);\n\nexport class HealthSystem extends System {\n\n  initialize() {\n    this.world\n      .subscribe(MSG_DAMAGE, (msg, data) => {\n        health = this.world.get('Health', data.to);\n        if (health) { health.current -= data.amount; }\n      })\n      .subscribe(MSG_HEAL, (msg, data) => {\n        health = this.world.get('Health', data.to);\n        if (health) { health.current += data.amount; }\n      });\n  }\n\n  matchComponent() { return 'Health'; }\n\n  updateComponent(timeDelta, entityId, health) {\n    if (health.current === null) {\n      health.current = health.max;\n    }\n    if (health.current < 0) {\n      this.world.publish(MSG_DESTROY, entityId);\n    }\n  }\n\n}\n\nregisterSystem('Health', HealthSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/health.js","import { Component, System, registerComponent, registerSystem } from '../lib/core';\r\n\r\nexport const MSG_SPAWN = 'spawnSpawn';\r\nexport const MSG_DESTROY = 'spawnDestroy';\r\nexport const MSG_DESPAWN = 'spawnDespawn';\r\nexport const MSG_CAPTURE_CAMERA = 'spawnCaptureCamera';\r\n\r\nlet spawn;\r\n\r\nexport class Spawn extends Component {\r\n  static defaults() {\r\n    return {\r\n      ttl: null,\r\n      age: 0,\r\n      destroy: false,\r\n      tombstone: null\r\n    };\r\n  }\r\n}\r\n\r\nregisterComponent('Spawn', Spawn);\r\n\r\nexport class SpawnSystem extends System {\r\n  defaultOptions() {\r\n    return {\r\n\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.world.subscribe(MSG_DESTROY, (msg, entityId) => {\r\n      spawn = this.world.get('Spawn', entityId);\r\n      if (spawn) { spawn.destroy = true; }\r\n    });\r\n  }\r\n\r\n  matchComponent() { return 'Spawn'; }\r\n\r\n  updateComponent(timeDelta, entityId, spawn) {\r\n    if (!spawn.spawned) {\r\n      spawn.spawned = true;\r\n      this.world.publish(MSG_SPAWN, entityId);\r\n      if (spawn.captureCamera) {\r\n        this.world.publish(MSG_CAPTURE_CAMERA, entityId);\r\n      }\r\n    }\r\n    if (spawn.ttl !== null) {\r\n      spawn.age += timeDelta;\r\n      if (spawn.age >= spawn.ttl) {\r\n        spawn.destroy = true;\r\n      }\r\n    }\r\n    if (spawn.destroy) {\r\n      if (spawn.tombstone !== null) {\r\n        this.world.insert((typeof spawn.tombstone === 'function') ?\r\n          spawn.tombstone(spawn, entityId) : spawn.tombstone);\r\n      }\r\n      this.world.publish(MSG_DESPAWN, entityId);\r\n      this.world.destroy(entityId);\r\n    }\r\n  }\r\n}\r\n\r\nregisterSystem('Spawn', SpawnSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/spawn.js","import * as Core from '../lib/core';\r\n\r\nimport '../plugins/position';\r\nimport '../plugins/motion';\r\n\r\nimport Vector2D from '../lib/Vector2D';\r\n\r\nexport class Seeker extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      active: true,\r\n      targetName: null,\r\n      targetEntityId: null,\r\n      targetPosition: null,\r\n      acquisitionDelay: 0,\r\n      radPerSec: Math.PI\r\n    };\r\n  }\r\n}\r\n\r\nCore.registerComponent('Seeker', Seeker);\r\n\r\nexport class SeekerSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Seeker'; }\r\n\r\n  initialize() {\r\n    this.vSeeker = new Vector2D();\r\n    this.vTarget = new Vector2D();\r\n  }\r\n\r\n  updateComponent(timeDelta, entityId, seeker) {\r\n\r\n    if (!seeker.active) { return; }\r\n\r\n    // Look up the orbited entity ID, if only name given.\r\n    if (seeker.targetName && !seeker.targetEntityId) {\r\n      seeker.targetEntityId = Core.getComponent('Name')\r\n        .findEntityByName(this.world, seeker.targetName);\r\n    }\r\n\r\n    // Process a delay before the seeker 'acquires' the target and\r\n    // starts steering. Makes missiles look interesting.\r\n    if (seeker.acquisitionDelay > 0) {\r\n      seeker.acquisitionDelay -= timeDelta;\r\n      return;\r\n    }\r\n\r\n    const position = this.world.get('Position', entityId);\r\n    const motion = this.world.get('Motion', entityId);\r\n    if (!position || !motion) { return; }\r\n\r\n    // Accept either a raw x/y coord or entity ID as target\r\n    let targetPosition = seeker.targetPosition;\r\n    if (!targetPosition) {\r\n      targetPosition = this.world.get('Position', seeker.targetEntityId);\r\n    }\r\n    if (!targetPosition) { return; }\r\n\r\n    // Set up the vectors for angle math...\r\n    this.vSeeker.setValues(position.x, position.y);\r\n    this.vTarget.setValues(targetPosition.x, targetPosition.y);\r\n\r\n    // Get the target angle, ensuring a 0..2*Math.PI range.\r\n    let targetAngle = this.vSeeker.angleTo(this.vTarget);\r\n    if (targetAngle < 0) {\r\n      targetAngle += (2 * Math.PI);\r\n    }\r\n\r\n    // Pick the direction from current to target angle\r\n    let direction = (targetAngle < position.rotation) ? -1 : 1;\r\n\r\n    // If the offset between the angles is more than half a circle, go\r\n    // the other way because it'll be shorter.\r\n    const offset = Math.abs(targetAngle - position.rotation);\r\n    if (offset > Math.PI) {\r\n      direction = 0 - direction;\r\n    }\r\n\r\n    // Work out the desired delta-rotation to steer toward target\r\n    const targetDr = direction * Math.min(seeker.radPerSec, offset / timeDelta);\r\n\r\n    // Calculate the delta-rotation impulse required to meet the goal,\r\n    // but constrain to the capability of the steering thrusters\r\n    let impulseDr = (targetDr - motion.drotation);\r\n    if (Math.abs(impulseDr) > seeker.radPerSec) {\r\n      if (impulseDr > 0) {\r\n        impulseDr = seeker.radPerSec;\r\n      } else if (impulseDr < 0) {\r\n        impulseDr = 0 - seeker.radPerSec;\r\n      }\r\n    }\r\n    motion.drotation += impulseDr;\r\n\r\n  }\r\n\r\n}\r\n\r\nCore.registerSystem('Seeker', SeekerSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/seeker.js","import * as Core from '../lib/core';\r\n\r\nimport './position';\r\nimport './motion';\r\n\r\nimport Vector2D from '../lib/Vector2D';\r\n\r\nexport class Thruster extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      active: true,\r\n      stop: false,\r\n      useBrakes: true,\r\n      deltaV: 0,\r\n      maxV: 0\r\n    };\r\n  }\r\n}\r\nCore.registerComponent('Thruster', Thruster);\r\n\r\nexport class ThrusterSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Thruster'; }\r\n\r\n  initialize() {\r\n    this.vInertia = new Vector2D();\r\n    this.vThrust = new Vector2D();\r\n    this.vBrakes = new Vector2D();\r\n  }\r\n\r\n  updateComponent(timeDelta, entityId, thruster) {\r\n\r\n    if (!thruster.active) { return; }\r\n\r\n    const pos = this.world.get('Position', entityId);\r\n    const motion = this.world.get('Motion', entityId);\r\n    if (!pos || !motion) { return; }\r\n\r\n    // Inertia is current motion\r\n    this.vInertia.setValues(motion.dx, motion.dy);\r\n\r\n    // delta-v available for the current tick\r\n    const tickDeltaV = timeDelta * thruster.deltaV;\r\n\r\n    if (!thruster.stop) {\r\n      // Create thrust vector per rotation and add to inertia.\r\n      this.vThrust.setValues(tickDeltaV, 0);\r\n      this.vThrust.rotate(pos.rotation);\r\n      this.vInertia.add(this.vThrust);\r\n    }\r\n\r\n    if (thruster.useBrakes) {\r\n      // Try to enforce the max_v limit with braking thrust.\r\n      const maxV = thruster.stop ? 0 : thruster.maxV;\r\n      const currV = this.vInertia.magnitude();\r\n      const overV = currV - maxV;\r\n      if (overV > 0) {\r\n        // Braking delta-v is max thruster output or remaining overage,\r\n        // whichever is smallest. Braking vector opposes inertia.\r\n        const brakingDv = Math.min(tickDeltaV, overV);\r\n        this.vBrakes.setValues(this.vInertia.x, this.vInertia.y);\r\n        this.vBrakes.normalize();\r\n        this.vBrakes.multiplyScalar(0-brakingDv);\r\n        this.vInertia.add(this.vBrakes);\r\n      }\r\n      if (thruster.stop && currV === 0) {\r\n        thruster.active = false;\r\n      }\r\n    }\r\n\r\n    // Update inertia. Note that we've been careful only to make changes\r\n    // to inertia within the delta-v of the thruster. Other influences\r\n    // on inertia should be preserved.\r\n    motion.dx = this.vInertia.x;\r\n    motion.dy = this.vInertia.y;\r\n  }\r\n\r\n}\r\nCore.registerSystem('Thruster', ThrusterSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/thruster.js","import * as Core from '../lib/core';\n\nconst PI2 = Math.PI * 2;\n\n// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants\nconst TYPE_SIZES = {\n  0x1406: 1, // FLOAT\n  0x8B50: 2, // FLOAT_VEC2\n  0x8B51: 3, // FLOAT_VEC3\n  0x8B52: 4  // FLOAT_VEC4\n};\n\nlet entityId, position, sprites, sprite, sceneSprite;\n\n// See also: http://phrogz.net/JS/wheeldelta.html\nconst wheelDistance = function(evt){\n  if (!evt) evt = event;\n  const w=evt.wheelDelta, d=evt.detail;\n  if (d){\n    if (w) return w/d/40*d>0?1:-1; // Opera\n    else return -d/3;              // Firefox;         TODO: do not /3 for OS X\n  } else return w/120;             // IE/Safari/Chrome TODO: /3 for Chrome OS X\n};\n\nexport class ViewportWebGL extends Core.System {\n\n  defaultOptions() {\n    return {\n      lineWidth: 2,\n      zoom: 1.0,\n      zoomMin: 0.1,\n      zoomMax: 10.0,\n      zoomWheelFactor: 0.05,\n      gridEnabled: true,\n      gridSize: 250,\n      gridColor: 0x222222,\n      followEnabled: true,\n      followName: null,\n      followEntityId: null\n    };\n  }\n\n  initialize() {\n    this.container = document.querySelector(this.options.container);\n    this.canvas = document.createElement('canvas');\n    this.container.appendChild(this.canvas);\n\n    this.initWebGL(this.canvas);\n\n    this.scene = {};\n\n    const events = {\n      'resize': (ev) => { this.updateMetrics(ev); },\n      'orientationchange': (ev) => { this.updateMetrics(ev); },\n      'mousedown': (ev) => { this.onMouseDown(ev); },\n      'mousemove': (ev) => { this.onMouseMove(ev); },\n      'mouseup': (ev) => { this.onMouseUp(ev); }\n    };\n\n    for (const name in events) {\n      this.canvas.addEventListener(name, events[name], false);\n    }\n\n    // See also: http://phrogz.net/JS/wheeldelta.html\n    const boundOnMouseWheel = (ev) => this.onMouseWheel(ev);\n    if (window.addEventListener){\n      window.addEventListener('mousewheel', boundOnMouseWheel, false); // Chrome/Safari/Opera\n      window.addEventListener('DOMMouseScroll', boundOnMouseWheel, false); // Firefox\n    } else if (window.attachEvent){\n      window.attachEvent('onmousewheel', boundOnMouseWheel); // IE\n    }\n\n    this.followEnabled = this.options.followEnabled;\n    this.zoom = this.options.zoom;\n    this.followEntityId = this.options.followEntityId;\n    this.gridEnabled = this.options.gridEnabled;\n    this.lineWidth = this.options.lineWidth;\n\n    this.cursorRawX = 0;\n    this.cursorRawY = 0;\n\n    this.cursorChanged = false;\n    this.cursorPosition = { x: 0, y: 0 };\n\n    this.cameraX = 0;\n    this.cameraY = 0;\n\n    this.debugDummySprite = { size: 100 };\n\n    this.updateMetrics();\n  }\n\n  onMouseWheel(ev) {\n    this.zoom += wheelDistance(ev) * this.options.zoomWheelFactor;\n    if (this.zoom < this.options.zoomMin) {\n      this.zoom = this.options.zoomMin;\n    }\n    if (this.zoom > this.options.zoomMax) {\n      this.zoom = this.options.zoomMax;\n    }\n  }\n\n  // TODO: Use a symbol for 'mouse{Down,Move,Up}' message?\n\n  onMouseDown(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseDown', this.cursorPosition);\n  }\n\n  onMouseMove(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseMove', this.cursorPosition);\n  }\n\n  onMouseUp(ev) {\n    this.setCursor(ev.clientX, ev.clientY, true);\n    this.world.publish('mouseUp', this.cursorPosition);\n  }\n\n  setCursor(x, y) {\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n\n    this.cursorRawX = x;\n    this.cursorRawY = y;\n\n    const newX = ((x - (width / 2)) / this.zoom) + this.cameraX;\n    const newY = ((y - (height / 2)) / this.zoom) + this.cameraY;\n\n    this.cursorChanged = false;\n    if (newX !== this.cursorPosition.x || newY !== this.cursorPosition.y) {\n      this.cursorChanged = true;\n      this.cursorPosition.x = newX;\n      this.cursorPosition.y = newY;\n    }\n\n    return this.cursorPosition;\n  }\n\n  updateMetrics() {\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n\n    this.visibleWidth = width / this.zoom;\n    this.visibleHeight = height / this.zoom;\n\n    this.visibleLeft = (0 - this.visibleWidth / 2) + this.cameraX;\n    this.visibleTop = (0 - this.visibleHeight / 2) + this.cameraY;\n    this.visibleRight = this.visibleLeft + this.visibleWidth;\n    this.visibleBottom = this.visibleTop + this.visibleHeight;\n  }\n\n  update(timeDelta) {\n    this.updateMetrics();\n\n    this.setCursor(this.cursorRawX, this.cursorRawY);\n    // FIXME: Should be able to skip doing this unless\n    // this.cursorChanged === true, but for some reason that's not working\n    this.world.publish('mouseMove', this.cursorPosition);\n\n    sprites = this.world.get('Sprite') || {};\n\n    // Delete any stage items not found in sprites, unless they're particles\n    // with \"_\" prefix\n    for (entityId in this.scene) {\n      if (entityId.charAt(0) !== '_' && !(entityId in sprites)) {\n        delete this.scene[entityId];\n      }\n    }\n\n    this.updateBackdrop(timeDelta);\n\n    // Create items for any sprites not found in stage\n    for (entityId in sprites) {\n      sprite = sprites[entityId];\n      position = this.world.get('Position', entityId);\n\n      if (!(entityId in this.scene)) {\n        this.scene[entityId] = {\n          position: [0.0, 0.0],\n          shapes: WebGLSprite.init(sprite, entityId, timeDelta, this.world)\n        };\n      }\n\n      sprite.visible = (\n        (position.right > this.visibleLeft) &&\n        (position.left < this.visibleRight) &&\n        (position.bottom > this.visibleTop) &&\n        (position.top < this.visibleBottom)\n      );\n\n      sceneSprite = this.scene[entityId];\n      sceneSprite.visible = sprite.visible;\n      sceneSprite.position[0] = position.x;\n      sceneSprite.position[1] = position.y;\n      sceneSprite.rotation = position.rotation;\n      sceneSprite.scale = sprite.size;\n      sceneSprite.color = [\n        // TODO: this math is terrible\n        (sprite.color / 256 / 256) % 256 / 256,\n        (sprite.color / 256) % 256 / 256,\n        sprite.color % 256 / 256,\n        1.0\n      ];\n      WebGLSprite.update(sceneSprite, sprite, entityId, timeDelta, this.world);\n    }\n  }\n\n  draw() {\n    this.followEntity();\n\n    this.canvas.width = this.container.offsetWidth;\n    this.canvas.height = this.container.offsetHeight;\n\n    // gl.uniform1f(uniforms.uTime, currDrawTime);\n    this.setUniforms({\n      uLineWidth: [0.001 * this.lineWidth],\n      uCameraZoom: [this.zoom],\n      uCameraOrigin: [this.cameraX, this.cameraY],\n      uViewportSize: [this.canvas.clientWidth, this.canvas.clientHeight]\n    });\n\n    // Re-allocate larger buffer if current is too small for the scene.\n    const bufferSize = this.calculateBufferSizeForScene();\n    if (bufferSize > this.buffer.length) {\n      this.buffer = new Float32Array(Math.max(bufferSize * 1.5, this.buffer.length * 2));\n    }\n\n    const vertexCount = this.fillBufferFromScene();\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.buffer, this.gl.STATIC_DRAW);\n    this.gl.viewport(0, 0, this.gl.canvas.width, this.gl.canvas.height);\n    this.gl.clearColor(0, 0, 0, 0.5);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n    this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, vertexCount);\n  }\n\n  followEntity() {\n    if (!this.followEnabled) {\n      this.cameraX = this.cameraY = 0;\n      return;\n    }\n    if (this.options.followName && !this.followEntityId) {\n      // Look up named entity, if necessary.\n      this.followEntityId = Core.getComponent('Name')\n        .findEntityByName(this.world, this.options.followName);\n    }\n    if (this.followEntityId) {\n      // Adjust the viewport center offset to the entity position\n      const position = this.world.get('Position', this.followEntityId);\n      if (position) {\n        this.cameraX = position.x;\n        this.cameraY = position.y;\n        this.setCursor(this.cursorRawX, this.cursorRawY);\n      }\n    }\n  }\n\n  updateBackdrop() {\n    if (!this.gridEnabled) {\n      delete this.scene._backdrop;\n      return;\n    }\n\n    if (!this.scene._backdrop) {\n      this.scene._backdrop = {\n        visible: true,\n        position: [0.0, 0.0],\n        color: [1.0, 1.0, 1.0, 0.2],\n        scale: 1,\n        shapes: []\n      };\n    }\n\n    const sceneSprite = this.scene._backdrop;\n\n    const gridSize = this.options.gridSize;\n    const gridOffsetX = this.visibleLeft % gridSize;\n    const gridOffsetY = this.visibleTop % gridSize;\n\n    sceneSprite.position[0] = this.visibleLeft;\n    sceneSprite.position[1] = this.visibleTop;\n    sceneSprite.rotation = Math.PI / 2;\n    sceneSprite.shapes.length = 0;\n\n    for (let x = -gridOffsetX; x < this.visibleWidth; x += gridSize) {\n      sceneSprite.shapes.push([[x, 0], [x, this.visibleHeight + gridSize]]);\n    }\n    for (let y = -gridOffsetY; y < this.visibleHeight; y += gridSize) {\n      sceneSprite.shapes.push([[0, y], [this.visibleWidth + gridSize, y]]);\n    }\n  }\n\n  initWebGL(canvas) {\n    const gl = this.gl = canvas.getContext('webgl', {\n      antialias: true,\n      preserveDrawingBuffer: true,\n      premultipliedAlpha: false\n    });\n\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\n    gl.enable(gl.BLEND);\n    gl.disable(gl.DEPTH_TEST);\n\n    const program = this.createProgram(\n      this.createShader(gl.VERTEX_SHADER, SHADER_VERTEX),\n      this.createShader(gl.FRAGMENT_SHADER, SHADER_FRAGMENT)\n    );\n    gl.useProgram(program);\n\n    // Set up for data buffer\n    gl.bindBuffer(gl.ARRAY_BUFFER, gl.createBuffer());\n\n    // First pass through attributes to count total vertex size and index by name\n    const numAttribs = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    const attribs = {};\n    let vertexSize = 0;\n    for (let i = 0; i < numAttribs; i++) {\n      const info = gl.getActiveAttrib(program, i);\n      const size = TYPE_SIZES[info.type];\n      vertexSize += size;\n      attribs[info.name] = i;\n    }\n\n    // Second pass through attributes to set up attribute pointers into the buffer\n    let pos = 0;\n    for (let i = 0; i < numAttribs; i++) {\n      const info = gl.getActiveAttrib(program, i);\n      const size = TYPE_SIZES[info.type];\n      gl.vertexAttribPointer(i, size, gl.FLOAT, false, vertexSize * 4, pos * 4);\n      gl.enableVertexAttribArray(i);\n      pos += size;\n    }\n\n    // Index uniform locations by name\n    const uniforms = {};\n    const numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n    for (let i = 0; i < numUniforms; i++) {\n      const info = gl.getActiveUniform(program, i);\n      uniforms[info.name] = gl.getUniformLocation(program, info.name);\n    }\n\n    const buffer = new Float32Array(200000);\n\n    Object.assign(this, { gl, uniforms, attribs, vertexSize, buffer });\n  }\n\n  createShader(type, source) {\n    const shader = this.gl.createShader(type);\n    this.gl.shaderSource(shader, source);\n    this.gl.compileShader(shader);\n    const success = this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS);\n    if (success) { return shader; }\n\n    // console.log('shader', type, 'failed to compile', this.gl.getShaderInfoLog(shader));\n    this.gl.deleteShader(shader);\n  }\n\n  createProgram(vertexShader, fragmentShader) {\n    const program = this.gl.createProgram();\n    this.gl.attachShader(program, vertexShader);\n    this.gl.attachShader(program, fragmentShader);\n    this.gl.linkProgram(program);\n    const success = this.gl.getProgramParameter(program, this.gl.LINK_STATUS);\n    if (success) { return program; }\n\n    // console.log(this.gl.getProgramInfoLog(program));\n    this.gl.deleteProgram(program);\n  }\n\n  calculateBufferSizeForScene() {\n    return Object.values(this.scene)\n      .reduce((acc, item) =>\n        item.shapes.reduce((acc, shape) =>\n          acc + (shape.length - 0.5) * this.vertexSize * 4, 0), 0);\n  }\n\n  fillBufferFromScene() {\n    let vertexCount = 0;\n    let bufferPos = 0;\n    let visible, shape, position, scale, rotation,\n        deltaPosition, deltaScale, deltaRotation, color,\n        lineIdx, shapesIdx, shapes;\n\n    const bufferVertex = (shapeIdx, lineIdx) => {\n      vertexCount++;\n      this.buffer[bufferPos++] = lineIdx;\n      this.buffer[bufferPos++] = shape[shapeIdx - 1][0];\n      this.buffer[bufferPos++] = shape[shapeIdx - 1][1];\n      this.buffer[bufferPos++] = shape[shapeIdx][0];\n      this.buffer[bufferPos++] = shape[shapeIdx][1];\n      this.buffer[bufferPos++] = position[0];\n      this.buffer[bufferPos++] = position[1];\n      this.buffer[bufferPos++] = scale;\n      this.buffer[bufferPos++] = rotation;\n      this.buffer[bufferPos++] = deltaPosition[0];\n      this.buffer[bufferPos++] = deltaPosition[1];\n      this.buffer[bufferPos++] = deltaScale;\n      this.buffer[bufferPos++] = deltaRotation;\n      this.buffer[bufferPos++] = color[0];\n      this.buffer[bufferPos++] = color[1];\n      this.buffer[bufferPos++] = color[2];\n      this.buffer[bufferPos++] = color[3];\n    };\n\n    const sceneKeys = Object.keys(this.scene);\n    sceneKeys.sort();\n    for (let sceneKeysIdx = 0; sceneKeysIdx < sceneKeys.length; sceneKeysIdx++) {\n      ({\n        visible, shapes, position=[0.0, 0.0], scale=0, rotation=0,\n        deltaPosition=[0.0, 0.0], deltaScale=0.0, deltaRotation=0.0,\n        color=[1, 1, 1, 1]\n      } = this.scene[sceneKeys[sceneKeysIdx]]);\n      if (!visible) { continue; }\n      for (shapesIdx = 0; shapesIdx < shapes.length; shapesIdx++) {\n        shape = shapes[shapesIdx];\n        bufferVertex(1, 0);\n        for (lineIdx = 1; lineIdx < shape.length; lineIdx += 1) {\n          bufferVertex(lineIdx, 0);\n          bufferVertex(lineIdx, 1);\n          bufferVertex(lineIdx, 2);\n          bufferVertex(lineIdx, 3);\n        }\n        bufferVertex(shape.length - 1, 3);\n      }\n    }\n\n    return vertexCount;\n  }\n\n  setUniforms(data) {\n    Object.keys(data).forEach(key =>\n      this.gl[`uniform${data[key].length}f`]\n        .call(this.gl, this.uniforms[key], ...data[key]));\n  }\n}\n\nCore.registerSystem('ViewportWebGL', ViewportWebGL);\n\nexport class WebGLSprite extends Core.Component {\n  static defaults() {\n    return {\n      name: null,\n      color: 0xffffff,\n      size: 100,\n      width: null,\n      height: null,\n      drawn: false,\n      visible: false\n    };\n  }\n  static create(attrs) {\n    const c = super.create(attrs);\n    if (!c.width) { c.width = c.size; }\n    if (!c.height) { c.height = c.size; }\n    return c;\n  }\n  static register(name, handler) {\n    if (!WebGLSprite.registry) { WebGLSprite.registry = {}; }\n    WebGLSprite.registry[name] = handler;\n  }\n  static getHandler(name) {\n    return name in WebGLSprite.registry\n      ? WebGLSprite.registry[name]\n      : WebGLSprite.registry.default;\n  }\n  static init(sprite, entityId, timeDelta, world) {\n    return WebGLSprite\n      .getHandler(sprite.name)\n      .init(sprite, entityId, timeDelta, world);\n  }\n  static update(sceneSprite, sprite, entityId, timeDelta, world) {\n    const handler = WebGLSprite.getHandler(sprite.name);\n    return 'update' in handler\n      ? handler.update(sceneSprite, sprite, entityId, timeDelta, world)\n      : false;\n  }\n}\n\nCore.registerComponent('Sprite', WebGLSprite);\n\nconst defaultShape = [ [-0.5, 0], [0.5, 0], [0, 0], [0, -0.5], [0, 0.5], [0, 0] ];\nfor (let idx = 0; idx < 8; idx++) {\n  const rot = idx * (PI2 / 8);\n  defaultShape.push([ 0.5 * Math.cos(rot), 0.5 * Math.sin(rot) ]);\n}\ndefaultShape.push([ 0.5, 0 ]);\n\nWebGLSprite.register('default', {\n  init() { return defaultShape; }\n});\n\nconst heroShapes = [\n  [\n    [ 0.0,     0.5],\n    [ 0.125,   0.4167],\n    [ 0.25,    0.0],\n    [ 0.375,  -0.1667],\n    [ 0.25,   -0.5],\n    [ 0.125,  -0.5],\n    [ 0.0625, -0.25],\n    [-0.0625, -0.25],\n    [-0.125,  -0.5],\n    [-0.25,   -0.5],\n    [-0.375,  -0.1667],\n    [-0.25,    0.0],\n    [-0.125,   0.4167],\n    [ 0.0,     0.5],\n  ]\n];\nWebGLSprite.register('hero', {\n  init() { return heroShapes; }\n});\n\nconst repulsorSides = 8;\nconst repulsorPoints = [];\nfor (let idx = 0; idx < repulsorSides; idx++) {\n  const rot = idx * (PI2 / repulsorSides);\n  repulsorPoints.push([ Math.cos(rot), Math.sin(rot) ]);\n}\nrepulsorPoints.push(repulsorPoints[0]);\n\nconst repulsorShapes = [\n  repulsorPoints.map(p => [p[0] * 1, p[1] * 1]),\n  repulsorPoints.map(p => [p[0] * 2, p[1] * 2]),\n  repulsorPoints.map(p => [p[0] * 3, p[1] * 3]),\n  [\n    [-0.50,    0.0],\n    [-0.375,  -0.50],\n    [-0.25,   -0.50],\n    [-0.0625,  0.25],\n    [ 0.0625,  0.25],\n    [ 0.25,   -0.50],\n    [ 0.375,  -0.50],\n    [ 0.50,    0.0],\n    [ 0.375,   0.50],\n    [ 0.25,    0.50],\n    [ 0.0625, -0.25],\n    [-0.0625, -0.25],\n    [-0.25,    0.50],\n    [-0.375,   0.50],\n    [-0.50,    0.0]\n  ]\n];\nWebGLSprite.register('repulsor', {\n  init() { return repulsorShapes; }\n});\n\nWebGLSprite.register('asteroid', {\n  init(sprite) {\n    const NUM_POINTS = 7 + Math.floor(8 * Math.random());\n    const MAX_RADIUS = 0.50;\n    const MIN_RADIUS = 0.35;\n    const ROTATION = PI2 / NUM_POINTS;\n\n    sprite.shape = [];\n    for (let idx = 0; idx < NUM_POINTS; idx++) {\n      const rot = idx * ROTATION;\n      const dist = (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\n      sprite.shape.push([dist * Math.cos(rot), dist * Math.sin(rot)]);\n    }\n\n    sprite.shape.push(sprite.shape[0]);\n    return [\n      sprite.shape\n    ];\n  }\n});\n\nWebGLSprite.register('mine', {\n  init(sprite) {\n    let NUM_POINTS = 10 + Math.floor(10 * Math.random());\n    if (NUM_POINTS % 2 !== 0) { NUM_POINTS++; }\n    const ROTATION = PI2 / NUM_POINTS;\n    const MAX_RADIUS = 0.6;\n    const MIN_RADIUS = 0.1;\n\n    let even = false;\n\n    sprite.legs = [];\n    for (let idx = 0; idx < NUM_POINTS; idx++) {\n      const dist = even ? 0.1 : (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\n      const rot = idx * ROTATION;\n      sprite.legs.push([ dist * Math.cos(rot), dist * Math.sin(rot) ]);\n      even = !even;\n    }\n    sprite.legs.push([ sprite.legs[0][0], sprite.legs[0][1] ]);\n    sprite.shape = sprite.legs;\n    sprite.drawn = true;\n\n    return [\n      sprite.shape\n    ];\n  },\n  update(/* sceneSprite, sprite, entityId, timeDelta, world */) {\n    /*\n    if (sprite.drawn && Math.random() < 0.15) {\n      sceneSprite.shape = sprite.legs.map(p => [\n        p[0] * (0.9 + 0.5 * Math.random()),\n        p[1] * (0.9 + 0.5 * Math.random())\n      ]);\n    }\n    */\n  }\n});\n\nconst SHADER_VERTEX = `\n// see also: http://m1el.github.io/woscope-how/\nprecision mediump float;\n#define EPS 1E-6\n#define PI 3.141592653589793\n#define PI_2 6.283185307179586\n#define PI_H 1.5707963267948966\n#define PI_Q 0.7853981633974483\n\nuniform float uTime;\nuniform float uLineWidth;\nuniform float uCameraZoom;\nuniform float uCameraRotation;\nuniform vec2 uCameraOrigin;\nuniform vec2 uViewportSize;\n\nattribute float aIdx;\nattribute vec4 aLine;\nattribute vec4 aTransform;\nattribute vec4 aDeltaTransform;\nattribute vec4 aColor;\n\nvarying vec4 uvl;\nvarying vec4 vColor;\nvarying float vLen;\n\nvoid main () {\n  float c, s;\n\n  mat3 mViewportToClipSpace = mat3(\n    2.0 / uViewportSize.x, 0, 0,\n    0, -2.0 / uViewportSize.y, 0,\n    0, 0, 0\n  );\n\n  c = cos(uCameraRotation);\n  s = sin(uCameraRotation);\n  mat3 mCameraRotation = mat3(\n    c, -s, 0.0,\n    s, c, 0.0,\n    0.0, 0.0, 1.0\n  );\n\n  mat3 mCameraOrigin = mat3(\n    1.0, 0.0, 0.0,\n    0.0, 1.0, 0.0,\n    -uCameraOrigin.x, -uCameraOrigin.y, 1.0\n  );\n\n  mat3 mCameraZoom = mat3(\n    uCameraZoom, 0.0, 0.0,\n    0.0, uCameraZoom, 0.0,\n    0.0, 0.0, 1.0\n  );\n\n  c = cos(-aTransform.w + PI_H + (aDeltaTransform.w * uTime));\n  s = sin(-aTransform.w + PI_H + (aDeltaTransform.w * uTime));\n  mat3 mRotation = mat3(\n    c, -s, 0.0,\n    s, c, 0.0,\n    0.0, 0.0, 1.0\n  );\n\n  mat3 mPosition = mat3(\n    1.0, 0.0, 0.0,\n    0.0, 1.0, 0.0,\n    aTransform.x + (aDeltaTransform.x * uTime), aTransform.y + (aDeltaTransform.y * uTime), 1.0\n  );\n\n  mat3 mScale = mat3(\n    aTransform.z + (aDeltaTransform.z * uTime), 0.0, 0.0,\n    0.0, aTransform.z + (aDeltaTransform.z * uTime), 0.0,\n    0.0, 0.0, 1.0\n  );\n\n  // TODO: Move some of these matrices into JS?\n  mat3 mAll = mViewportToClipSpace\n    * mCameraZoom * mCameraRotation * mCameraOrigin\n    * mPosition * mScale * mRotation;\n\n  vec2 tStart = (mAll * vec3(aLine.xy, 1)).xy;\n  vec2 tEnd = (mAll * vec3(aLine.zw, 1)).xy;\n\n  float tang;\n  vec2 current;\n  float idx = aIdx;\n  if (idx >= 2.0) {\n    current = tEnd;\n    tang = 1.0;\n  } else {\n    current = tStart;\n    tang = -1.0;\n  }\n\n  float side = (mod(idx, 2.0)-0.5)*2.0;\n  vec2 dir = tEnd-tStart;\n\n  vColor = aColor;\n\n  uvl.xy = vec2(tang, side);\n  uvl.w = floor(aIdx / 4.0 + 0.5);\n  uvl.z = length(dir);\n  if (uvl.z > EPS) {\n    dir = dir / uvl.z;\n  } else {\n    // If the segment is too short draw a square;\n    dir = vec2(1.0, 0.0);\n  }\n  vec2 norm = vec2(-dir.y, dir.x);\n  gl_Position = vec4((current+(tang*dir+norm*side)*uLineWidth),0.0,1.0);\n}\n`;\n\nconst SHADER_FRAGMENT = `\nprecision mediump float;\nvarying vec4 vColor;\n\nvoid main (void)\n{\n    gl_FragColor = vColor;\n}\n`;\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/viewportWebGL.js","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_is-object.js\n// module id = 31\n// module chunks = 7","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_property-desc.js\n// module id = 32\n// module chunks = 7","exports.f = {}.propertyIsEnumerable;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-pie.js\n// module id = 33\n// module chunks = 7","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-object.js\n// module id = 34\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nimport './position';\r\nimport './motion';\r\nimport { MSG_DAMAGE } from './health';\r\n\r\nimport Vector2D from '../lib/Vector2D';\r\n\r\nexport class BounceComponent extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      mass: 1000.0\r\n    };\r\n  }\r\n}\r\n\r\nCore.registerComponent('Bounce', BounceComponent);\r\n\r\nexport class BounceSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Bounce'; }\r\n\r\n  initialize() {\r\n    this.dn = new Vector2D();\r\n    this.dt = new Vector2D();\r\n    this.mt = new Vector2D();\r\n    this.v1 = new Vector2D();\r\n    this.v2 = new Vector2D();\r\n    this.v1n = new Vector2D();\r\n    this.v1t = new Vector2D();\r\n    this.v2n = new Vector2D();\r\n    this.v2t = new Vector2D();\r\n  }\r\n\r\n  update(timeDelta) {\r\n    const entities = this.world;\r\n    const matches = this.getMatchingComponents();\r\n\r\n    const pairs = {};\r\n    for (const aEntityId in matches) {\r\n\r\n      // const bounce = matches[aEntityId];\r\n      const aCollidable = entities.get('Collidable', aEntityId);\r\n\r\n      for (const bEntityId in aCollidable.inCollisionWith) {\r\n        const pair = [aEntityId, bEntityId];\r\n        pair.sort();\r\n        pairs[pair.join(':')] = pair;\r\n      }\r\n\r\n      // TODO: Process world boundary edge bounce?\r\n\r\n    }\r\n\r\n    for (const key in pairs) {\r\n      const aEntityId = pairs[key][0];\r\n      const aBouncer = entities.get('Bounce', aEntityId);\r\n      if (!aBouncer) { continue; }\r\n\r\n      const bEntityId = pairs[key][1];\r\n      const bBouncer = entities.get('Bounce', bEntityId);\r\n      if (!bBouncer) { continue; }\r\n\r\n      this.resolveElasticCollision(timeDelta, aEntityId, aBouncer, bEntityId, bBouncer);\r\n    }\r\n\r\n  }\r\n\r\n  // See also:\r\n  // http://en.m.wikipedia.org/wiki/Elastic_collision\r\n  // http://en.m.wikipedia.org/wiki/Dot_product\r\n  // https://github.com/Edifear/volleyball/blob/master/collision.html\r\n  // https://github.com/DominikWidomski/Processing/blob/master/sketch_canvas_red_particles/particles.pde#L47\r\n  resolveElasticCollision(timeDelta, aEntityId, aBouncer, bEntityId, bBouncer) {\r\n\r\n    const entities = this.world;\r\n\r\n    const aPosition = entities.get('Position', aEntityId);\r\n    const aSprite = entities.get('Sprite', aEntityId);\r\n    const aMotion = entities.get('Motion', aEntityId);\r\n\r\n    const bPosition = entities.get('Position', bEntityId);\r\n    const bSprite = entities.get('Sprite', bEntityId);\r\n    const bMotion = entities.get('Motion', bEntityId);\r\n\r\n    // First, back both entities off to try to prevent sticking\r\n    /*\r\n    aPosition.x -= aMotion.dx * timeDelta;\r\n    aPosition.y -= aMotion.dy * timeDelta;\r\n    bPosition.x -= bMotion.dx * timeDelta;\r\n    bPosition.y -= bMotion.dy * timeDelta;\r\n    const radii, dx, dy;\r\n    while (true) {\r\n      aPosition.x -= aMotion.dx * timeDelta;\r\n      aPosition.y -= aMotion.dy * timeDelta;\r\n      bPosition.x -= bMotion.dx * timeDelta;\r\n      bPosition.y -= bMotion.dy * timeDelta;\r\n\r\n      radii = (aSprite.size + bSprite.size) / 2;\r\n      dx = aPosition.x - bPosition.x;\r\n      dy = aPosition.y - bPosition.y;\r\n      if (dx*dx + dy*dy > radii*radii) { break; }\r\n    }\r\n    */\r\n\r\n    // Vector between entities\r\n    this.dn.setValues(aPosition.x - bPosition.x, aPosition.y - bPosition.y);\r\n\r\n    // Distance between entities\r\n    const delta = this.dn.magnitude();\r\n\r\n    // Normal vector of the collision plane\r\n    this.dn.normalize();\r\n\r\n    // Tangential vector of the collision plane\r\n    this.dt.setValues(this.dn.y, -this.dn.x);\r\n\r\n    // HACK: avoid divide by zero\r\n    if (delta === 0) { bPosition.x += 0.01; }\r\n\r\n    // Get total mass for entities\r\n    const m1 = aBouncer.mass;\r\n    const m2 = bBouncer.mass;\r\n    const M = m1 + m2;\r\n\r\n    // Minimum translation vector to push entities apart\r\n    this.mt.setValues(\r\n      this.dn.x * (aSprite.width + bSprite.width - delta) * 1.1,\r\n      this.dn.y * (aSprite.height + bSprite.height - delta) * 1.1\r\n    );\r\n\r\n    // Velocity vectors of entities before collision\r\n    this.v1.setValues((aMotion) ? aMotion.dx : 0, (aMotion) ? aMotion.dy : 0);\r\n    this.v2.setValues((bMotion) ? bMotion.dx : 0, (bMotion) ? bMotion.dy : 0);\r\n\r\n    // split the velocity vector of the first entity into a normal\r\n    // and a tangential component in respect of the collision plane\r\n    this.v1n.setValues(\r\n      this.dn.x * this.v1.dot(this.dn),\r\n      this.dn.y * this.v1.dot(this.dn)\r\n    );\r\n    this.v1t.setValues(\r\n      this.dt.x * this.v1.dot(this.dt),\r\n      this.dt.y * this.v1.dot(this.dt)\r\n    );\r\n\r\n    // split the velocity vector of the second entity into a normal\r\n    // and a tangential component in respect of the collision plane\r\n    this.v2n.setValues(\r\n      this.dn.x * this.v2.dot(this.dn),\r\n      this.dn.y * this.v2.dot(this.dn)\r\n    );\r\n    this.v2t.setValues(\r\n      this.dt.x * this.v2.dot(this.dt),\r\n      this.dt.y * this.v2.dot(this.dt)\r\n    );\r\n\r\n    // calculate new velocity vectors of the entities, the tangential\r\n    // component stays the same, the normal component changes analog to\r\n    // the 1-Dimensional case\r\n\r\n    if (aMotion) {\r\n      const aFactor = (m1 - m2) / M * this.v1n.magnitude() +\r\n                    2 * m2 / M * this.v2n.magnitude();\r\n      aMotion.dx = this.v1t.x + this.dn.x * aFactor;\r\n      aMotion.dy = this.v1t.y + this.dn.y * aFactor;\r\n      this.processDamage(aEntityId, bEntityId, aMotion, aBouncer, m1);\r\n    }\r\n\r\n    if (bMotion) {\r\n      const bFactor = (m2 - m1) / M * this.v2n.magnitude() +\r\n                    2 * m1 / M * this.v1n.magnitude();\r\n      bMotion.dx = this.v2t.x - this.dn.x * bFactor;\r\n      bMotion.dy = this.v2t.y - this.dn.y * bFactor;\r\n      this.processDamage(bEntityId, aEntityId, bMotion, bBouncer, m1);\r\n    }\r\n\r\n  }\r\n\r\n  processDamage(eid, c_eid, v_motion, bouncer, m1) {\r\n    if (!bouncer.damage) { return; }\r\n\r\n    // Convert a fraction of the rebound velocity into damage by mass\r\n    const dmg = Math.sqrt(v_motion.dx * v_motion.dx + v_motion.dy * v_motion.dy) *\r\n                bouncer.damage * m1;\r\n\r\n    this.world.publish(MSG_DAMAGE, {\r\n      to: eid,\r\n      from: c_eid,\r\n      amount: dmg / 2\r\n    });\r\n\r\n    this.world.publish(MSG_DAMAGE, {\r\n      to: c_eid,\r\n      from: eid,\r\n      amount: dmg / 2\r\n    });\r\n  }\r\n\r\n}\r\n\r\nCore.registerSystem('Bounce', BounceSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/bounce.js","module.exports = {};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iterators.js\n// module id = 36\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nexport class Collidable extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      inCollision: false,\r\n      inCollisionWith: {}\r\n    };\r\n  }\r\n}\r\n\r\nCore.registerComponent('Collidable', Collidable);\r\n\r\nlet match, matches, entityId, entityId2, position, aCollidable, bCollidable, dx, dy, radii;\r\n\r\nexport class CollisionSystem extends Core.System {\r\n\r\n  defaultOptions() {\r\n    return {\r\n      positionSystemName: 'Position'\r\n    };\r\n  }\r\n\r\n  matchComponent() { return 'Collidable'; }\r\n\r\n  initialize() {\r\n    this.positionSystem = this.world.getSystem(this.options.positionSystemName);\r\n    this.width = this.options.width;\r\n    this.height = this.options.height;\r\n    this.retrieveBounds = {};\r\n    this.checkCollisionBound = (neighbor, component) =>\r\n      this.checkCollision(neighbor, component);\r\n  }\r\n\r\n  update(/* timeDelta */) {\r\n    matches = this.getMatchingComponents();\r\n    for (entityId in matches) {\r\n      match = matches[entityId];\r\n      match.inCollision = false;\r\n      for (entityId2 in match.inCollisionWith) {\r\n        delete match.inCollisionWith[entityId2];\r\n      }\r\n    }\r\n    for (entityId in matches) {\r\n      position = this.world.get('Position', entityId);\r\n      if (position) {\r\n        this.positionSystem.quadtree.iterate(position, this.checkCollisionBound, position);\r\n      }\r\n    }\r\n  }\r\n\r\n  checkCollision(bPosition, aPosition) {\r\n    if (aPosition.entityId === bPosition.entityId) { return; }\r\n\r\n    aCollidable = this.world.get('Collidable', aPosition.entityId);\r\n    bCollidable = this.world.get('Collidable', bPosition.entityId);\r\n\r\n    if (!aCollidable || !bCollidable) { return; }\r\n\r\n    dx = aPosition.x - bPosition.x;\r\n    dy = aPosition.y - bPosition.y;\r\n\r\n    // TODO: Pluggable shape intersection detection here?\r\n\r\n    // Check collision circle via distance\r\n    radii = (aPosition.width + bPosition.width) / 2;\r\n    if (dx*dx + dy*dy > radii*radii) { return; }\r\n\r\n    aCollidable.inCollision = true;\r\n    aCollidable.inCollisionWith[bPosition.entityId] = 1;\r\n\r\n    bCollidable.inCollision = true;\r\n    bCollidable.inCollisionWith[aPosition.entityId] = 1;\r\n  }\r\n\r\n  draw(/* timeDelta */) {\r\n    const g = this.getDebugGraphics();\r\n    if (!g) { return; }\r\n\r\n    g.lineStyle(4, 0x999999);\r\n    const collidables = this.world.get('Collidable');\r\n    for (const entityId in collidables) {\r\n      const collidable = collidables[entityId];\r\n      const position = this.world.get('Position', entityId);\r\n\r\n      if (collidable.inCollision) {\r\n        g.drawCircle(position.x, position.y, 40);\r\n      }\r\n    }\r\n\r\n  }\r\n}\r\n\r\nCore.registerSystem('Collision', CollisionSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/collision.js","module.exports = { \"default\": require(\"core-js/library/fn/object/keys\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/keys.js\n// module id = 38\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\n\nexport class PlayerInputSteering extends Component {\n  static defaults() {\n    return {\n      active: true,\n      radPerSec: Math.PI * 2\n    };\n  }\n}\n\nregisterComponent('PlayerInputSteering', PlayerInputSteering);\n\nconst PI2 = Math.PI * 2;\n\nexport class PlayerInputSteeringSystem extends System {\n\n  defaultOptions() {\n    return {\n      gamepadDeadzone: 0.2\n    };\n  }\n\n  matchComponent() { return 'PlayerInputSteering'; }\n\n  initialize() {\n    this.gamepad = { active: false };\n    this.pointer = { active: false, x: 0, y: 0 };\n    this.keys = { active: false };\n    this.touch = { active: false, x: 0, y: 0 };\n\n    this.world\n      .subscribe('mouseDown', (msg, cursorPosition) =>\n        this.setPointer(true, cursorPosition))\n      .subscribe('mouseUp', (msg, cursorPosition) =>\n        this.setPointer(false, cursorPosition))\n      .subscribe('mouseMove', (msg, cursorPosition) =>\n        this.setPointer(this.pointer.active, cursorPosition));\n\n    const windowEvents = {\n      keydown: this.handleKeyDown,\n      keyup: this.handleKeyUp\n    };\n    Object.keys(windowEvents)\n      .forEach(k => window.addEventListener(k, windowEvents[k].bind(this)));\n  }\n\n  setPointer(active, position) {\n    this.pointer.active = active;\n    this.pointer.x = position.x;\n    this.pointer.y = position.y;\n  }\n\n  update(timeDelta) {\n    this.updateGamepads(timeDelta);\n    this.updateKeyboard(timeDelta);\n    super.update(timeDelta);\n  }\n\n  updateComponent(timeDelta, entityId, steering) {\n    const thruster = this.world.get('Thruster', entityId);\n    const motion = this.world.get('Motion', entityId);\n\n    thruster.active = true;\n    thruster.stop = false;\n\n    if (this.keys.active) {\n      return this.updateComponentFromKeyboard(timeDelta, entityId, steering);\n    }\n\n    if (this.pointer.active) {\n      return this.updateComponentFromPointer(timeDelta, entityId, steering);\n    }\n\n    if (this.gamepad.active) {\n      return this.updateComponentFromGamepad(timeDelta, entityId, steering);\n    }\n\n    thruster.stop = true;\n    motion.drotation = 0;\n  }\n\n  updateComponentFromPointer(timeDelta, entityId, steering) {\n    const position = this.world.get('Position', entityId);\n    this.updateMotionFromTargetAngle(timeDelta, entityId, steering,\n      Math.atan2(this.pointer.y - position.y, this.pointer.x - position.x));\n  }\n\n  updateComponentFromGamepad(timeDelta, entityId, steering) {\n    this.updateMotionFromTargetAngle(timeDelta, entityId, steering,\n      Math.atan2(this.gamepad.axis1, this.gamepad.axis0));\n  }\n\n  updateComponentFromKeyboard(timeDelta, entityId, steering) {\n    const thruster = this.world.get('Thruster', entityId);\n    const motion = this.world.get('Motion', entityId);\n\n    const dleft  = (this.keys[65] || this.keys[37] || this.gamepad.button13);\n    const dright = (this.keys[68] || this.keys[39] || this.gamepad.button14);\n    const dup    = (this.keys[87] || this.keys[38] || this.gamepad.button11);\n    // const ddown  = (this.keys[83] || this.keys[40] || this.gamepad.button12);\n\n    if (dup) {\n      thruster.active = true;\n    } else {\n      thruster.stop = true;\n    }\n\n    const direction = dleft ? -1 : (dright ? 1 : 0);\n    const targetDr = direction * steering.radPerSec;\n    motion.drotation = targetDr;\n  }\n\n  updateGamepads() {\n    const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];\n\n    // TODO: specify which gamepad, i.e. for multiplayer\n    for (let i = 0; i < gamepads.length; i++) {\n      const gp = gamepads[i];\n      if (!gp || !gp.connected) continue;\n      gp.buttons.forEach((val, idx) => this.gamepad[`button${idx}`] = val.pressed);\n      gp.axes.forEach((val, idx) => this.gamepad[`axis${idx}`] = val);\n      break; // stop after the first gamepad\n    }\n\n    Object.keys(this.gamepad).forEach(k => {\n      if (!this.gamepad[k]) { delete this.gamepad[k]; }\n    });\n\n    const axisX = this.gamepad.axis0;\n    const axisY = this.gamepad.axis1;\n    this.gamepad.active =\n      (Math.abs(axisX) > 0 || Math.abs(axisY) > 0) &&\n      (Math.sqrt(axisX * axisX + axisY * axisY) > this.options.gamepadDeadzone);\n  }\n\n  updateKeyboard() {\n    const dleft  = (this.keys[65] || this.keys[37] || this.gamepad.button13);\n    const dright = (this.keys[68] || this.keys[39] || this.gamepad.button14);\n    const dup    = (this.keys[87] || this.keys[38] || this.gamepad.button11);\n    const ddown  = (this.keys[83] || this.keys[40] || this.gamepad.button12);\n\n    this.keys.active = (dleft || dright || dup || ddown);\n  }\n\n  handleKeyDown(ev) {\n    this.keys[ev.keyCode] = true;\n    ev.preventDefault();\n  }\n\n  handleKeyUp(ev) {\n    delete this.keys[ev.keyCode];\n    ev.preventDefault();\n  }\n\n  updateMotionFromTargetAngle(timeDelta, entityId, steering, targetAngleRaw) {\n    const position = this.world.get('Position', entityId);\n    const motion = this.world.get('Motion', entityId);\n\n    const targetAngle = (targetAngleRaw < 0) ?\n      targetAngleRaw + PI2 : targetAngleRaw;\n\n    // Pick the direction from current to target angle\n    let direction = (targetAngle < position.rotation) ? -1 : 1;\n\n    // If the offset between the angles is more than half a circle, go\n    // the other way because it'll be shorter.\n    const offset = Math.abs(targetAngle - position.rotation);\n    if (offset > Math.PI) {\n      direction = 0 - direction;\n    }\n\n    // Work out the desired delta-rotation to steer toward target\n    const targetDr = direction * Math.min(steering.radPerSec, offset / timeDelta);\n\n    // Calculate the delta-rotation impulse required to meet the goal,\n    // but constrain to the capability of the steering thrusters\n    let impulseDr = (targetDr - motion.drotation);\n    if (Math.abs(impulseDr) > steering.radPerSec) {\n      if (impulseDr > 0) {\n        impulseDr = steering.radPerSec;\n      } else if (impulseDr < 0) {\n        impulseDr = 0 - steering.radPerSec;\n      }\n    }\n\n    motion.drotation += impulseDr;\n  }\n\n}\n\nregisterSystem('PlayerInputSteering', PlayerInputSteeringSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/playerInputSteering.js","module.exports = { \"default\": require(\"core-js/library/fn/object/assign\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/assign.js\n// module id = 40\n// module chunks = 7","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_uid.js\n// module id = 41\n// module chunks = 7","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_ctx.js\n// module id = 42\n// module chunks = 7","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-primitive.js\n// module id = 43\n// module chunks = 7","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_cof.js\n// module id = 44\n// module chunks = 7","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_defined.js\n// module id = 45\n// module chunks = 7","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-integer.js\n// module id = 46\n// module chunks = 7","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_shared-key.js\n// module id = 47\n// module chunks = 7","var global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function (key) {\n  return store[key] || (store[key] = {});\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_shared.js\n// module id = 48\n// module chunks = 7","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_enum-bug-keys.js\n// module id = 49\n// module chunks = 7","exports.f = Object.getOwnPropertySymbols;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gops.js\n// module id = 50\n// module chunks = 7","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-sap.js\n// module id = 51\n// module chunks = 7","module.exports = true;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_library.js\n// module id = 52\n// module chunks = 7","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-create.js\n// module id = 53\n// module chunks = 7","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_set-to-string-tag.js\n// module id = 54\n// module chunks = 7","exports.f = require('./_wks');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_wks-ext.js\n// module id = 55\n// module chunks = 7","var global = require('./_global');\nvar core = require('./_core');\nvar LIBRARY = require('./_library');\nvar wksExt = require('./_wks-ext');\nvar defineProperty = require('./_object-dp').f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_wks-define.js\n// module id = 56\n// module chunks = 7","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gopd.js\n// module id = 57\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\n\nimport { MSG_DESTROY } from './spawn';\n\n// Commonly used temp variables, pre-declared early.\nlet entityId, matches, sprite;\n\nexport class HordeSpawn extends Component {\n  static defaults() {\n    return { age: 0 };\n  }\n}\n\nregisterComponent('HordeSpawn', HordeSpawn);\n\nexport class HordeSpawnSystem extends System {\n\n  defaultOptions() {\n    return {\n      viewportSystemName: 'ViewportPixi',\n      minCount: 100,\n      maxFrameSpawn: 50,\n      offscreenTTL: 1.0,\n      spawnMargin: 100,\n      spawn: () => {}\n    };\n  }\n\n  initialize() {\n    this.spawnCount = 0;\n    this.viewportSystem = this.world.getSystem(this.options.viewportSystemName);\n  }\n\n  matchComponent() { return 'HordeSpawn'; }\n\n  update(timeDelta) {\n    matches = this.getMatchingComponents() || {};\n    this.spawnCount = Object.keys(matches).length;\n    if (this.spawnCount < this.options.minCount) {\n      const cnt = Math.max(\n        this.options.maxFrameSpawn,\n        this.options.minCount - this.spawnCount\n      );\n      for (let i = 0; i < cnt; i++) {\n        this.spawnOffscreen();\n      }\n    }\n    for (entityId in matches) {\n      this.updateComponent(timeDelta, entityId, matches[entityId]);\n    }\n  }\n\n  updateComponent(timeDelta, entityId, hordespawn) {\n    sprite = this.world.get('Sprite', entityId);\n    if (sprite.visible) {\n      hordespawn.age = 0;\n    } else {\n      hordespawn.age += timeDelta;\n      if (hordespawn.age >= this.options.offscreenTTL) {\n        this.world.publish(MSG_DESTROY, entityId);\n      }\n    }\n  }\n\n  spawnOffscreen() {\n    const {visibleLeft, visibleRight, visibleTop, visibleBottom} = this.viewportSystem;\n    const margin = this.options.spawnMargin;\n    const w = (visibleRight + margin) - (visibleLeft - margin);\n    const h = (visibleBottom + margin) - (visibleTop - margin);\n    const r = Math.random();\n\n    let x, y;\n\n    if (r < 0.5) {\n      y = (visibleTop - margin) + (Math.random() * h);\n    } else {\n      x = (visibleLeft - margin) + (Math.random() * w);\n    }\n\n    if (r < 0.25) {\n      x = visibleLeft - margin;\n    } else if (r < 0.5) {\n      x = visibleRight + margin;\n    } else if (r < 0.75) {\n      y = visibleTop - margin;\n    } else {\n      y = visibleBottom + margin;\n    }\n\n    this.options.spawn(x, y);\n  }\n\n}\n\nregisterSystem('HordeSpawn', HordeSpawnSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/hordeSpawn.js","import { Component, System, registerComponent, registerSystem } from '../lib/core';\r\n\r\nexport class Repulsor extends Component {\r\n    static defaults() {\r\n      return {\r\n        active: true,\r\n        range: 500,\r\n        force: 200\r\n      };\r\n    }\r\n}\r\n\r\nregisterComponent('Repulsor', Repulsor);\r\n\r\nlet components, component, entityId, position, repulsor, repulsorPosition,\r\n    neighborSprite, neighborPosition, neighborMotion, repelAngle, repelForce,\r\n    dist;\r\n\r\nconst queryBounds = {};\r\n\r\nexport class RepulsorSystem extends System {\r\n\r\n  defaultOptions() {\r\n    return {\r\n      positionSystemName: 'Position'\r\n    };\r\n  }\r\n\r\n  matchComponent() { return 'Repulsor'; }\r\n\r\n  initialize() {\r\n    this.positionSystem = this.world.getSystem(this.options.positionSystemName);\r\n    this.applyRepulsionBound = (neighbor, component) =>\r\n      this.applyRepulsion(neighbor, component);\r\n  }\r\n\r\n  updateComponent(timeDelta, entityId, component) {\r\n    if (!component.active) { return; }\r\n\r\n    position = this.world.get('Position', entityId);\r\n\r\n    queryBounds.left = position.left - component.range;\r\n    queryBounds.right = position.right + component.range;\r\n    queryBounds.top = position.top - component.range;\r\n    queryBounds.bottom = position.bottom + component.range;\r\n\r\n    this.positionSystem.quadtree.iterate(queryBounds, this.applyRepulsionBound, entityId);\r\n  }\r\n\r\n  applyRepulsion(neighbor, repulsorId) {\r\n    if (entityId === neighbor.entityId) { return; }\r\n\r\n    neighborSprite = this.world.get('Sprite', neighbor.entityId);\r\n    if (neighborSprite.name !== 'mine') { return; }\r\n\r\n    repulsor = this.world.get('Repulsor', repulsorId);\r\n    repulsorPosition = this.world.get('Position', repulsorId);\r\n    neighborPosition = this.world.get('Position', neighbor.entityId);\r\n    neighborMotion = this.world.get('Motion', neighbor.entityId);\r\n\r\n    dist =\r\n      (neighborPosition.x - repulsorPosition.x) *\r\n      (neighborPosition.x - repulsorPosition.x)\r\n      +\r\n      (neighborPosition.y - repulsorPosition.y) *\r\n      (neighborPosition.y - repulsorPosition.y)\r\n    ;\r\n\r\n    if (dist > (repulsor.range * repulsor.range)) { return; }\r\n    // if (dist < repulsor.range) { return; }\r\n\r\n    repelAngle = Math.atan2(\r\n      repulsorPosition.y - neighborPosition.y,\r\n      repulsorPosition.x - neighborPosition.x\r\n    );\r\n\r\n    repelForce = -repulsor.force;\r\n\r\n    neighborMotion.dx += repelForce * Math.cos(repelAngle);\r\n    neighborMotion.dy += repelForce * Math.sin(repelAngle);\r\n  }\r\n\r\n  draw(/* timeDelta */) {\r\n    const g = this.getDebugGraphics();\r\n    if (!g) { return; }\r\n\r\n    g.lineStyle(4, 0x882222);\r\n    components = this.getMatchingComponents();\r\n    for (entityId in components) {\r\n      component = components[entityId];\r\n      position = this.world.get('Position', entityId);\r\n      g.drawCircle(position.x, position.y, component.range);\r\n    }\r\n  }\r\n\r\n}\r\n\r\nregisterSystem('Repulsor', RepulsorSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/repulsor.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _assign = require(\"../core-js/object/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _assign2.default || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/extends.js\n// module id = 60\n// module chunks = 7","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_ie8-dom-define.js\n// module id = 61\n// module chunks = 7","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_dom-create.js\n// module id = 62\n// module chunks = 7","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-keys-internal.js\n// module id = 63\n// module chunks = 7","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iobject.js\n// module id = 64\n// module chunks = 7","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-length.js\n// module id = 65\n// module chunks = 7","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gpo.js\n// module id = 66\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _iterator = require(\"../core-js/symbol/iterator\");\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _symbol = require(\"../core-js/symbol\");\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nvar _typeof = typeof _symbol2.default === \"function\" && typeof _iterator2.default === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = typeof _symbol2.default === \"function\" && _typeof(_iterator2.default) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n} : function (obj) {\n  return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/typeof.js\n// module id = 67\n// module chunks = 7","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.string.iterator.js\n// module id = 68\n// module chunks = 7","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && !has(IteratorPrototype, ITERATOR)) hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-define.js\n// module id = 69\n// module chunks = 7","module.exports = require('./_hide');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_redefine.js\n// module id = 70\n// module chunks = 7","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gopn.js\n// module id = 71\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nexport class Expiration extends Core.Component {\r\n  static defaults() {\r\n    return { ttl: 0, age: 0 };\r\n  }\r\n}\r\nCore.registerComponent('Expiration', Expiration);\r\n\r\nexport class ExpirationSystem extends Core.System {\r\n  matchComponent() {\r\n    return 'Expiration';\r\n  }\r\n  updateComponent(timeDelta, entityId, expiration) {\r\n    expiration.age += timeDelta;\r\n    if (expiration.age >= expiration.ttl) {\r\n      this.world.destroy(entityId);\r\n    }\r\n  }\r\n}\r\nCore.registerSystem('Expiration', ExpirationSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/expiration.js","import * as Core from '../lib/core';\r\n\r\nimport './position';\r\n\r\nimport Vector2D from '../lib/Vector2D';\r\n\r\nexport class Orbiter extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      name: null,\r\n      entityId: null,\r\n      angle: 0.0,\r\n      rotate: true,\r\n      radPerSec: Math.PI / 4\r\n    };\r\n  }\r\n}\r\nCore.registerComponent('Orbiter', Orbiter);\r\n\r\nexport class OrbiterSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Orbiter'; }\r\n\r\n  initialize() {\r\n    this.vOrbited = new Vector2D();\r\n    this.vOrbiter = new Vector2D();\r\n    this.vOld = new Vector2D();\r\n  }\r\n\r\n  updateComponent(timeDelta, entityId, orbiter) {\r\n\r\n    // Look up the orbited entity ID, if only name given.\r\n    if (orbiter.name && !orbiter.entityId) {\r\n      orbiter.entityId = Core.getComponent('Name')\r\n        .findEntityByName(this.world, orbiter.name);\r\n    }\r\n\r\n    const pos = this.world.get('Position', entityId);\r\n    const oPos = this.world.get('Position', orbiter.entityId);\r\n\r\n    this.vOrbited.setValues(oPos.x, oPos.y);\r\n    this.vOrbiter.setValues(pos.x, pos.y);\r\n\r\n    const angleDelta = timeDelta * orbiter.radPerSec;\r\n    this.vOrbiter.rotateAround(this.vOrbited, angleDelta);\r\n\r\n    this.vOld.setValues(pos.x, pos.y);\r\n    pos.x = this.vOrbiter.x;\r\n    pos.y = this.vOrbiter.y;\r\n    if (orbiter.rotate) {\r\n      pos.rotation = this.vOld.angleTo(this.vOrbiter);\r\n    }\r\n\r\n  }\r\n}\r\nCore.registerSystem('Orbiter', OrbiterSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/orbiter.js","import * as Core from '../lib/core';\r\n\r\nexport class Pathfinder extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      width: 5000,\r\n      height: 5000\r\n    };\r\n  }\r\n}\r\n\r\nCore.registerComponent('Pathfinder', Pathfinder);\r\n\r\nexport class SpaceTree {\r\n\r\n  constructor(quadtree, x, y, width, height, level, maxLevel=4) {\r\n    const bounds = quadtree.bounds;\r\n\r\n    this.x = x || bounds.x;\r\n    this.y = y || bounds.y;\r\n    this.width = width || bounds.width;\r\n    this.height = height || bounds.height;\r\n    this.right = this.x + this.width;\r\n    this.bottom = this.y + this.height;\r\n    this.level = level || 0;\r\n    this.empty = true;\r\n    this.full = false;\r\n    this.children = [];\r\n\r\n    let ct = 0;\r\n\r\n    quadtree.iterate({\r\n      x: this.x, y: this.y, right: this.right, bottom: this.bottom\r\n    }, (obj) => {\r\n\r\n      const dx = Math.abs(obj.x - this.x) * 2;\r\n      const dy = Math.abs(obj.y - this.y) * 2;\r\n      const dwidth = (obj.right - obj.x) + this.width;\r\n      const dheight = (obj.bottom - obj.y) + this.height;\r\n\r\n      if (dx < dwidth && dy < dheight) {\r\n        ct++;\r\n        if (obj.x <= this.x && obj.y <= this.y &&\r\n            obj.right >= this.right && obj.bottom >= this.bottom) {\r\n          this.full = true;\r\n        }\r\n      }\r\n    });\r\n\r\n    if (ct === 0) {\r\n      this.empty = true;\r\n      return;\r\n    }\r\n\r\n    this.empty = false;\r\n    if (!this.full && this.level < maxLevel) {\r\n      this.split(quadtree);\r\n    }\r\n\r\n  }\r\n\r\n  split(quadtree) {\r\n    const splitWidth = this.width / 2;\r\n    const splitHeight = this.height / 2;\r\n\r\n    this.children[0] = new SpaceTree(quadtree,\r\n        this.x, this.y,\r\n        splitWidth, splitHeight, this.level + 1);\r\n\r\n    this.children[1] = new SpaceTree(quadtree,\r\n        this.x + splitWidth, this.y,\r\n        splitWidth, splitHeight, this.level + 1);\r\n\r\n    this.children[2] = new SpaceTree(quadtree,\r\n        this.x, this.y + splitHeight,\r\n        splitWidth, splitHeight, this.level + 1);\r\n\r\n    this.children[3] = new SpaceTree(quadtree,\r\n        this.x + splitWidth, this.y + splitHeight,\r\n        splitWidth, splitHeight, this.level + 1);\r\n  }\r\n\r\n}\r\n\r\nexport class PathfindingSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Pathfinder'; }\r\n\r\n  initialize() {\r\n  }\r\n\r\n  update(/*timeDelta*/) {\r\n    /*\r\n    let collisionSystem = this.world.getSystem('Collision');\r\n    let quadtree = collisionSystem.quadtree;\r\n    */\r\n  }\r\n\r\n  draw(timeDelta) {\r\n    if (!this.debug) { return; }\r\n\r\n    const vpSystem = this.world.getSystem('ViewportCanvas');\r\n\r\n    const ctx = vpSystem.ctx;\r\n    ctx.save();\r\n\r\n    vpSystem.centerAndZoom(timeDelta);\r\n    vpSystem.followEntity(timeDelta);\r\n\r\n    // draw\r\n\r\n    ctx.restore();\r\n  }\r\n\r\n}\r\n\r\nCore.registerSystem('Pathfinding', PathfindingSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/pathfinding.js","import * as Core from '../lib/core';\r\n\r\nimport '../plugins/position';\r\nimport '../plugins/motion';\r\n\r\nimport Vector2D from '../lib/Vector2D';\r\n\r\nconst PI2 = Math.PI * 2;\r\n\r\nexport class Steering extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      sensorRange: 350,\r\n      obstacleRepel: [400, 2.1]\r\n    };\r\n  }\r\n}\r\n\r\nCore.registerComponent('Steering', Steering);\r\n\r\nexport class SteeringSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Steering'; }\r\n\r\n  initialize() {\r\n\r\n    this.seekFactor = 1;\r\n\r\n    this.pushFactor = 7;\r\n\r\n    this.avoidFactor = 10;\r\n\r\n    this.avoidSeeAhead = 500;\r\n    this.avoidRayWidthFactor = 1.5;\r\n\r\n    this.vTarget = new Vector2D();\r\n\r\n    this.vectors = {\r\n      avoid: new Vector2D(),\r\n      push: new Vector2D(),\r\n      seek: new Vector2D(),\r\n      flee: new Vector2D(),\r\n      wander: new Vector2D(),\r\n      evade: new Vector2D(),\r\n      pursue: new Vector2D()\r\n    };\r\n\r\n  }\r\n\r\n  updateComponent(timeDelta, entityId, steering) {\r\n\r\n    this.vTarget.setValues(0, 0);\r\n\r\n    for (const key in this.vectors) {\r\n      this.vectors[key].setValues(0, 0);\r\n      this[key](this.vectors[key], timeDelta, entityId, steering);\r\n      this.vTarget.add(this.vectors[key]);\r\n    }\r\n\r\n    this.applySteering(timeDelta, entityId, steering);\r\n\r\n  }\r\n\r\n  avoid(vector, timeDelta, entityId, steering) {\r\n\r\n    if (this.debug) { steering.vectors = []; }\r\n\r\n    const sprite = this.world.get('Sprite', entityId);\r\n    const position = this.world.get('Position', entityId);\r\n\r\n    const result = this.lookForObstacle(entityId, position, sprite, steering);\r\n    if (!result) { return; }\r\n\r\n    const range = steering.sensorRange;\r\n    this.world.getSystem('Collision').quadtree.iterate({\r\n      x: position.x - (range / 2),\r\n      y: position.y - (range / 2),\r\n      width: range,\r\n      height: range\r\n    }, (item) => {\r\n\r\n      if (entityId === item.entityId) { return; }\r\n\r\n      const targetPosition = this.world.get('Position', item.entityId);\r\n      if (!targetPosition) { return; }\r\n\r\n      const targetSprite = this.world.get('Sprite', item.entityId);\r\n\r\n      const A = 0;\r\n      const B = steering.obstacleRepel[0];\r\n      const n = 0;\r\n      const m = steering.obstacleRepel[1];\r\n\r\n      const dx = position.x - targetPosition.x;\r\n      const dy = position.y - targetPosition.y;\r\n      const edgeRange = sprite.size / 2 + targetSprite.size / 2;\r\n      let distance = Math.sqrt(dx*dx + dy*dy) - edgeRange;\r\n      if (distance <= 0) { distance = 0.01; }\r\n\r\n      if (distance > steering.sensorRange) { return; }\r\n\r\n      const U = (-A / Math.pow(distance, n)) +\r\n              ( B / Math.pow(distance, m));\r\n\r\n      vector.x += dx * U;\r\n      vector.y += dy * U;\r\n\r\n      if (this.debug) {\r\n        steering.vectors.push([targetPosition.x, targetPosition.y, U]);\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  push(/*vector, timeDelta, entityId, steering*/) {\r\n\r\n  }\r\n\r\n  avoid_ray(vector, timeDelta, entityId, steering) {\r\n\r\n    const sprite = this.world.get('Sprite', entityId);\r\n    const position = this.world.get('Position', entityId);\r\n\r\n    // Scan ahead for an obstacle, bail if none found.\r\n    const result = this.lookForObstacle(entityId, position, sprite, steering);\r\n    if (!result) { return; }\r\n\r\n    const obstacle = result[0];\r\n    const rayX = result[1];\r\n    const rayY = result[2];\r\n\r\n    // Opposite right triangle leg is distance from obstacle to avoid collision.\r\n    const oppositeLen = obstacle.sprite.size / 2 +\r\n      sprite.size * this.avoidRayWidthFactor;\r\n\r\n    // Hypotenuse length is distance from obstacle.\r\n    const hypotenuseLen = Math.sqrt(\r\n      Math.pow(obstacle.position.x - rayX, 2) +\r\n      Math.pow(obstacle.position.y - rayY, 2)\r\n    );\r\n\r\n    // Adjacent length would be avoid tangent, but no need to calculate.\r\n\r\n    // Find angle from direct collision to avoidance\r\n    let theta = Math.asin(oppositeLen / hypotenuseLen);\r\n\r\n    // HACK: Too close, panic and steer hard away\r\n    if (isNaN(theta)) { theta = Math.PI * 0.66; }\r\n\r\n    // Find the absolute angle to the obstacle from entity.\r\n    const obstacleAngle = Math.atan2(\r\n      obstacle.position.y - rayY,\r\n      obstacle.position.x - rayX\r\n    );\r\n\r\n    // Calculate nearest target angle for avoidance...\r\n    // Try turning clockwise from obstacle.\r\n    let avoidAngle = (obstacleAngle + theta);\r\n    // Calculate the 'travel' needed from current rotation.\r\n    const travel = Math.min(PI2 - Math.abs(position.rotation - avoidAngle),\r\n                          Math.abs(position.rotation - avoidAngle));\r\n    if (travel > theta) {\r\n      // Clockwise travel exceeds theta, so counterclockwise is shorter.\r\n      avoidAngle = obstacleAngle - theta;\r\n    }\r\n\r\n    // Set up the avoidance vector.\r\n    vector.setValues(this.avoidFactor, 0);\r\n    vector.rotate(avoidAngle);\r\n\r\n  }\r\n\r\n  lookForObstacle(entityId, position, sprite, steering) {\r\n    const rayWidth = sprite.size * this.avoidRayWidthFactor;\r\n\r\n    const vRayUnit = new Vector2D();\r\n    vRayUnit.setValues(rayWidth, 0);\r\n    vRayUnit.rotate(position.rotation);\r\n\r\n    if (this.debug) { steering.hitCircles = []; }\r\n\r\n    let obstacle, rayX, rayY;\r\n    const steps = this.avoidSeeAhead / rayWidth;\r\n    for (let step = 0; step < steps; step++) {\r\n      rayX = position.x + vRayUnit.x * step;\r\n      rayY = position.y + vRayUnit.y * step;\r\n      obstacle = this.searchCircleForObstacle(\r\n        steering, entityId,\r\n        rayX, rayY, rayWidth\r\n      );\r\n      if (obstacle) {\r\n        return [obstacle, rayX, rayY];\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  searchCircleForObstacle(steering, entityId, x, y, size) {\r\n\r\n    if (this.debug) {\r\n      steering.hitCircles.push([x, y, size]);\r\n    }\r\n\r\n    const hits = [];\r\n\r\n    this.world.getSystem('Collision').quadtree.iterate({\r\n      x: x - (size / 2),\r\n      y: y - (size / 2),\r\n      width: size,\r\n      height: size\r\n    }, (item) => {\r\n\r\n      if (entityId === item.entityId) { return; }\r\n      const dx = item.position.x - x;\r\n      const dy = item.position.y - y;\r\n      const range = dx*dx + dy*dy;\r\n      const radii = (size + item.sprite.size) / 2;\r\n      if (range < radii*radii) {\r\n        hits.push([range, item]);\r\n      }\r\n\r\n    });\r\n\r\n    hits.sort(function (a, b) { return b[0] - a[0]; });\r\n    return hits.length ? hits[0][1] : null;\r\n  }\r\n\r\n  seek(vector, timeDelta, entityId, steering) {\r\n\r\n    // Look up the entity ID to seek, if only name given.\r\n    if (steering.seekTargetName && !steering.seekTargetEntityId) {\r\n      steering.seekTargetEntityId = Core.getComponent('Name')\r\n        .findEntityByName(this.world, steering.seekTargetName);\r\n    }\r\n\r\n    if (!steering.seekTargetEntityId) { return; }\r\n\r\n    const position = this.world.get('Position', entityId);\r\n    if (!position) { return; }\r\n\r\n    // Accept either a raw x/y coord or entity ID as target\r\n    let targetPosition = steering.targetPosition;\r\n    if (!targetPosition) {\r\n      targetPosition = this.world.get('Position', steering.seekTargetEntityId);\r\n    }\r\n    if (!targetPosition) { return; }\r\n\r\n    vector.setValues(targetPosition.x - position.x, targetPosition.y - position.y);\r\n    vector.normalize();\r\n    vector.multiplyScalar(this.seekFactor);\r\n\r\n  }\r\n\r\n  flee(/*vector, timeDelta, entityId, steering*/) {\r\n  }\r\n\r\n  wander(/*vector, timeDelta, entityId, steering*/) {\r\n  }\r\n\r\n  evade(/*vector, timeDelta, entityId, steering*/) {\r\n  }\r\n\r\n  pursue(/*vector, timeDelta, entityId, steering*/) {\r\n  }\r\n\r\n  applySteering(timeDelta, entityId, steering) {\r\n\r\n    const motion = this.world.get('Motion', entityId);\r\n\r\n    let targetDr = 0;\r\n\r\n    if (!this.vTarget.isZero()) {\r\n      const position = this.world.get('Position', entityId);\r\n\r\n      // Get the target angle, ensuring a 0..2*Math.PI range.\r\n      let targetAngle = this.vTarget.angle();\r\n      if (targetAngle < 0) { targetAngle += (2 * Math.PI); }\r\n\r\n      if (this.debug) { steering.targetAngle = targetAngle; }\r\n\r\n      // Pick the direction from current to target angle\r\n      let direction = (targetAngle < position.rotation) ? -1 : 1;\r\n\r\n      // If the offset between the angles is more than half a circle, it's\r\n      // shorter to go the other way.\r\n      const offset = Math.abs(targetAngle - position.rotation);\r\n      if (offset > Math.PI) { direction = 0 - direction; }\r\n\r\n      // Work out the desired delta-rotation to steer toward target\r\n      targetDr = direction * Math.min(steering.radPerSec, offset / timeDelta);\r\n    }\r\n\r\n    // Calculate the delta-rotation impulse required to meet the goal,\r\n    // but constrain to the capability of the steering thrusters\r\n    let impulseDr = (targetDr - motion.drotation);\r\n    if (Math.abs(impulseDr) > steering.radPerSec) {\r\n      if (impulseDr > 0) {\r\n        impulseDr = steering.radPerSec;\r\n      } else if (impulseDr < 0) {\r\n        impulseDr = 0 - steering.radPerSec;\r\n      }\r\n    }\r\n\r\n    motion.drotation += impulseDr;\r\n\r\n  }\r\n\r\n  draw(/*timeDelta*/) {\r\n    if (!this.debug) { return; }\r\n\r\n    /*\r\n    const vpSystem = this.world.getSystem('CanvasViewport');\r\n    const ctx = vpSystem.ctx;\r\n    ctx.save();\r\n\r\n    vpSystem.centerAndZoom(timeDelta);\r\n    vpSystem.followEntity(timeDelta);\r\n\r\n    const matches = this.getMatchingComponents();\r\n    for (const entityId in matches) {\r\n      ctx.save();\r\n\r\n      const steering = matches[entityId];\r\n      const position = this.world.get('Position', entityId);\r\n      const sprite = this.world.get('Sprite', entityId);\r\n\r\n      this.drawSteeringVsPosition(ctx, steering, position);\r\n\r\n      if (steering.hitCircles) {\r\n        for (const [x, y, size] of steering.hitCircles) {\r\n          ctx.strokeStyle = '#d00';\r\n          ctx.beginPath();\r\n          ctx.arc(x, y, size, 0, PI2, false);\r\n          ctx.stroke();\r\n        }\r\n      }\r\n\r\n      if (steering.sensorRange) {\r\n          ctx.strokeStyle = 'rgba(0, 64, 64, 0.75)';\r\n          ctx.beginPath();\r\n          ctx.arc(position.x, position.y, steering.sensorRange, 0, PI2, false);\r\n          ctx.stroke();\r\n      }\r\n\r\n      if (steering.vectors) {\r\n        for (const [x, y, U] of steering.vectors) {\r\n          ctx.strokeStyle = 'rgba(0, 64, 64, 0.75)';\r\n          ctx.beginPath();\r\n          ctx.moveTo(position.x, position.y);\r\n          ctx.lineWidth = Math.max(1, Math.min(U, sprite.width));\r\n          ctx.lineTo(x, y);\r\n          ctx.stroke();\r\n        }\r\n      }\r\n\r\n      if (steering.pushing) {\r\n        this.drawAngle(ctx, position, position.rotation, '#d0d');\r\n      }\r\n\r\n      ctx.restore();\r\n    }\r\n\r\n    ctx.restore();\r\n    */\r\n  }\r\n\r\n  drawSteeringVsPosition(ctx, steering, position) {\r\n    this.drawAngle(ctx, position, position.rotation, '#ddd');\r\n    if (steering.targetAngle) {\r\n      this.drawAngle(ctx, position, steering.targetAngle, '#dd0');\r\n    }\r\n  }\r\n\r\n  drawAngle(ctx, position, angle, color) {\r\n    const vec = new Vector2D();\r\n    vec.setValues(this.avoidSeeAhead, 0);\r\n    vec.rotate(angle);\r\n    ctx.strokeStyle = color;\r\n    ctx.beginPath();\r\n    ctx.moveTo(position.x, position.y);\r\n    ctx.lineTo(position.x + vec.x, position.y + vec.y);\r\n    ctx.stroke();\r\n  }\r\n\r\n}\r\n\r\nCore.registerSystem('Steering', SteeringSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/steering.js","import * as Core from '../lib/core';\r\n\r\nexport class CanvasSprite extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      name: null,\r\n      color: '#fff',\r\n      size: 100,\r\n      width: null,\r\n      height: null\r\n    };\r\n  }\r\n  static create(attrs) {\r\n    const c = super.create(attrs);\r\n    if (!c.width) { c.width = c.size; }\r\n    if (!c.height) { c.height = c.size; }\r\n    return c;\r\n  }\r\n}\r\nCore.registerComponent('Sprite', CanvasSprite);\r\n\r\n// See also: http://phrogz.net/JS/wheeldelta.html\r\nconst wheelDistance = function(evt){\r\n  if (!evt) evt = event;\r\n  const w=evt.wheelDelta, d=evt.detail;\r\n  if (d){\r\n    if (w) return w/d/40*d>0?1:-1; // Opera\r\n    else return -d/3;              // Firefox;         TODO: do not /3 for OS X\r\n  } else return w/120;             // IE/Safari/Chrome TODO: /3 for Chrome OS X\r\n};\r\n\r\nexport class ViewportCanvas extends Core.System {\r\n\r\n  defaultOptions() {\r\n    return {\r\n      lineWidth: 1.5,\r\n      zoom: 1.0,\r\n      zoomMin: 0.1,\r\n      zoomMax: 10.0,\r\n      zoomWheelFactor: 0.025,\r\n      gridEnabled: true,\r\n      gridSize: 500,\r\n      gridColor: '#111',\r\n      followEnabled: true,\r\n      followName: null,\r\n      followEntityId: null\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.container = document.querySelector(this.options.container);\r\n    this.canvas = document.createElement('canvas');\r\n    this.container.appendChild(this.canvas);\r\n\r\n    this.ctx = this.canvas.getContext('2d');\r\n\r\n    const events = {\r\n      'resize': (ev) => { this.updateMetrics(ev); },\r\n      'orientationchange': (ev) => { this.updateMetrics(ev); },\r\n      'mousedown': (ev) => { this.onMouseDown(ev); },\r\n      'mousemove': (ev) => { this.onMouseMove(ev); },\r\n      'mouseup': (ev) => { this.onMouseUp(ev); },\r\n      //'wheel': (ev) => { this.onMouseWheel(ev); }\r\n    };\r\n\r\n    for (const name in events) {\r\n      this.canvas.addEventListener(name, events[name], false);\r\n    }\r\n\r\n    // See also: http://phrogz.net/JS/wheeldelta.html\r\n    const boundOnMouseWheel = (ev) => this.onMouseWheel(ev);\r\n    if (window.addEventListener){\r\n      window.addEventListener('mousewheel', boundOnMouseWheel, false); // Chrome/Safari/Opera\r\n      window.addEventListener('DOMMouseScroll', boundOnMouseWheel, false); // Firefox\r\n    } else if (window.attachEvent){\r\n      window.attachEvent('onmousewheel', boundOnMouseWheel); // IE\r\n    }\r\n\r\n    this.followEnabled = this.options.followEnabled;\r\n    this.zoom = this.options.zoom;\r\n    this.followEntityId = this.options.followEntityId;\r\n    this.gridEnabled = this.options.gridEnabled;\r\n    this.lineWidth = this.options.lineWidth;\r\n\r\n    this.cursorRawX = 0;\r\n    this.cursorRawY = 0;\r\n\r\n    this.cursorChanged = false;\r\n    this.cursorPosition = { x: 0, y: 0 };\r\n\r\n    this.cameraX = 0;\r\n    this.cameraY = 0;\r\n\r\n    this.debugDummySprite = { size: 100 };\r\n  }\r\n\r\n  draw(timeDelta) {\r\n    this.updateMetrics();\r\n    this.ctx.save();\r\n\r\n    this.clear();\r\n    this.centerAndZoom(timeDelta);\r\n    this.followEntity(timeDelta);\r\n\r\n    if (this.gridEnabled) { this.drawBackdrop(timeDelta); }\r\n\r\n    this.drawScene(timeDelta);\r\n\r\n    if (this.world.debug) { this.drawDebugCursor(); }\r\n\r\n    this.ctx.restore();\r\n  }\r\n\r\n  onMouseWheel(ev) {\r\n    this.zoom += wheelDistance(ev) * this.options.zoomWheelFactor;\r\n    if (this.zoom < this.options.zoomMin) {\r\n      this.zoom = this.options.zoomMin;\r\n    }\r\n    if (this.zoom > this.options.zoomMax) {\r\n      this.zoom = this.options.zoomMax;\r\n    }\r\n  }\r\n\r\n  // TODO: Use a symbol for 'mouse{Down,Move,Up}' message?\r\n\r\n  onMouseDown(ev) {\r\n    this.setCursor(ev.clientX, ev.clientY);\r\n    this.world.publish('mouseDown', this.cursorPosition);\r\n  }\r\n\r\n  onMouseMove(ev) {\r\n    this.setCursor(ev.clientX, ev.clientY);\r\n  }\r\n\r\n  onMouseUp(ev) {\r\n    this.setCursor(ev.clientX, ev.clientY);\r\n    this.world.publish('mouseUp', this.cursorPosition);\r\n  }\r\n\r\n  update(/* timeDelta */) {\r\n    // Use the cursorChanged flag set by setCursor to limit mouseMove messages\r\n    // to one per game loop tick\r\n    if (this.cursorChanged) {\r\n      this.cursorChanged = false;\r\n      this.world.publish('mouseMove', this.cursorPosition);\r\n    }\r\n  }\r\n\r\n  setCursor(x, y) {\r\n    const width = this.container.offsetWidth;\r\n    const height = this.container.offsetHeight;\r\n\r\n    this.cursorRawX = x;\r\n    this.cursorRawY = y;\r\n\r\n    const newX = ((x - (width / 2)) / this.zoom) + this.cameraX;\r\n    const newY = ((y - (height / 2)) / this.zoom) + this.cameraY;\r\n\r\n    if (newX !== this.cursorPosition.x || newY !== this.cursorPosition.y) {\r\n      this.cursorChanged = true;\r\n      this.cursorPosition.x = newX;\r\n      this.cursorPosition.y = newY;\r\n    }\r\n  }\r\n\r\n  updateMetrics() {\r\n    const width = this.container.offsetWidth;\r\n    const height = this.container.offsetHeight;\r\n\r\n    this.canvas.width = width;\r\n    this.canvas.height = height;\r\n\r\n    this.visibleWidth = width / this.zoom;\r\n    this.visibleHeight = height / this.zoom;\r\n\r\n    this.visibleLeft = (0 - this.visibleWidth / 2) + this.cameraX;\r\n    this.visibleTop = (0 - this.visibleHeight / 2) + this.cameraY;\r\n    this.visibleRight = this.visibleLeft + this.visibleWidth;\r\n    this.visibleBottom = this.visibleTop + this.visibleHeight;\r\n  }\r\n\r\n  clear() {\r\n    this.ctx.fillStyle = 'rgba(0, 0, 0, 1.0)';\r\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n  }\r\n\r\n  centerAndZoom() {\r\n    this.ctx.translate(this.canvas.width / 2, this.canvas.height / 2);\r\n    this.ctx.scale(this.zoom, this.zoom);\r\n  }\r\n\r\n  followEntity() {\r\n    if (!this.followEnabled) {\r\n      this.cameraX = this.cameraY = 0;\r\n      return;\r\n    }\r\n    if (this.options.followName && !this.followEntityId) {\r\n      // Look up named entity, if necessary.\r\n      this.followEntityId = Core.getComponent('Name')\r\n        .findEntityByName(this.world, this.options.followName);\r\n    }\r\n    if (this.followEntityId) {\r\n      // Adjust the viewport center offset to the entity position\r\n      const position = this.world.get('Position', this.followEntityId);\r\n      if (position) {\r\n        this.cameraX = position.x;\r\n        this.cameraY = position.y;\r\n        this.setCursor(this.cursorRawX, this.cursorRawY);\r\n        this.ctx.translate(0 - this.cameraX, 0 - this.cameraY);\r\n      }\r\n    }\r\n  }\r\n\r\n  drawDebugCursor() {\r\n    const ctx = this.ctx;\r\n    ctx.save();\r\n    ctx.strokeStyle = '#f0f';\r\n    ctx.lineWidth = this.lineWidth / this.zoom;\r\n    ctx.translate(this.cursorPosition.x, this.cursorPosition.y);\r\n    ctx.beginPath();\r\n    ctx.moveTo(-20, 0);\r\n    ctx.lineTo(20, 0);\r\n    ctx.moveTo(0, -20);\r\n    ctx.lineTo(0, 20);\r\n    ctx.strokeRect(-10, -10, 20, 20);\r\n    ctx.stroke();\r\n    ctx.restore();\r\n  }\r\n\r\n  drawBackdrop() {\r\n    const gridSize = this.options.gridSize;\r\n    const gridOffsetX = this.visibleLeft % gridSize;\r\n    const gridOffsetY = this.visibleTop % gridSize;\r\n\r\n    const ctx = this.ctx;\r\n\r\n    ctx.save();\r\n    ctx.beginPath();\r\n\r\n    ctx.strokeStyle = this.options.gridColor;\r\n    ctx.lineWidth = this.lineWidth / this.zoom;\r\n\r\n    for (let x = (this.visibleLeft - gridOffsetX); x < this.visibleRight; x += gridSize) {\r\n      ctx.moveTo(x, this.visibleTop);\r\n      ctx.lineTo(x, this.visibleBottom);\r\n    }\r\n\r\n    for (let y = (this.visibleTop - gridOffsetY); y < this.visibleBottom; y += gridSize) {\r\n      ctx.moveTo(this.visibleLeft, y);\r\n      ctx.lineTo(this.visibleRight, y);\r\n    }\r\n\r\n    ctx.stroke();\r\n    ctx.restore();\r\n  }\r\n\r\n  drawScene(timeDelta) {\r\n    const positions = this.world.get('Position');\r\n    for (const entityId in positions) {\r\n      this.drawSprite(timeDelta, entityId, positions[entityId]);\r\n    }\r\n  }\r\n\r\n  drawSprite(timeDelta, entityId, position) {\r\n\r\n    let sprite = this.world.get('Sprite', entityId);\r\n    if (!sprite) { sprite = CanvasSprite.defaults(); }\r\n\r\n    let spriteFn = getSprite(sprite.name);\r\n    if (!spriteFn) { spriteFn = getSprite('default'); }\r\n\r\n    const ctx = this.ctx;\r\n\r\n    ctx.save();\r\n\r\n    ctx.translate(position.x, position.y);\r\n\r\n    ctx.rotate(position.rotation + Math.PI/2);\r\n    ctx.scale(sprite.size / 100, sprite.size / 100);\r\n\r\n    // HACK: Try to keep line width consistent regardless of zoom, to sort of\r\n    // simulate a vector display\r\n    ctx.lineWidth = this.lineWidth / this.zoom / (sprite.size / 100);\r\n\r\n    ctx.strokeStyle = sprite.color;\r\n    spriteFn(ctx, timeDelta, sprite, entityId);\r\n\r\n    ctx.restore();\r\n\r\n  }\r\n\r\n}\r\n\r\nCore.registerSystem('ViewportCanvas', ViewportCanvas);\r\n\r\nconst spriteRegistry = {};\r\nexport function registerSprite(name, sprite) {\r\n  spriteRegistry[name] = sprite;\r\n}\r\nexport function getSprite(name) {\r\n  return spriteRegistry[name];\r\n}\r\n\r\nconst PI2 = Math.PI * 2;\r\n\r\nregisterSprite('default', (ctx/*, timeDelta, sprite, entityId*/) => {\r\n  ctx.beginPath();\r\n  ctx.arc(0, 0, 50, 0, PI2, true);\r\n  ctx.moveTo(0, 0);\r\n  ctx.lineTo(0, -50);\r\n  ctx.moveTo(0, 0);\r\n  ctx.stroke();\r\n});\r\n\r\nregisterSprite('sun', (ctx/*, timeDelta, sprite, entityId*/) => {\r\n  ctx.beginPath();\r\n  ctx.arc(0, 0, 50, 0, PI2, true);\r\n  ctx.stroke();\r\n});\r\n\r\nregisterSprite('enemyscout', (ctx/*, timeDelta, sprite, entityId*/) => {\r\n  ctx.beginPath();\r\n  ctx.moveTo(0, -50);\r\n  ctx.lineTo(-45, 50);\r\n  ctx.lineTo(-12.5, 12.5);\r\n  ctx.lineTo(0, 25);\r\n  ctx.lineTo(12.5, 12.5);\r\n  ctx.lineTo(45, 50);\r\n  ctx.lineTo(0, -50);\r\n  ctx.moveTo(0, -50);\r\n  ctx.stroke();\r\n});\r\n\r\nregisterSprite('hero', (ctx/*, timeDelta, sprite, entityId*/) => {\r\n  ctx.rotate(Math.PI);\r\n  ctx.beginPath();\r\n  ctx.moveTo(-12.5, -50);\r\n  ctx.lineTo(-25, -50);\r\n  ctx.lineTo(-50, 0);\r\n  ctx.arc(0, 0, 50, Math.PI, 0, true);\r\n  ctx.lineTo(25, -50);\r\n  ctx.lineTo(12.5, -50);\r\n  ctx.lineTo(25, 0);\r\n  ctx.arc(0, 0, 25, 0, Math.PI, true);\r\n  ctx.lineTo(-12.5, -50);\r\n  ctx.stroke();\r\n});\r\n\r\nregisterSprite('asteroid', (ctx, timeDelta, sprite/*, entityId*/) => {\r\n  let idx;\r\n\r\n  if (!sprite.points) {\r\n    const NUM_POINTS = 7 + Math.floor(8 * Math.random());\r\n    const MAX_RADIUS = 50;\r\n    const MIN_RADIUS = 35;\r\n    const ROTATION = PI2 / NUM_POINTS;\r\n\r\n    sprite.points = [];\r\n    for (idx = 0; idx < NUM_POINTS; idx++) {\r\n      const rot = idx * ROTATION;\r\n      const dist = (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\r\n      sprite.points.push([dist * Math.cos(rot), dist * Math.sin(rot)]);\r\n    }\r\n  }\r\n\r\n  ctx.beginPath();\r\n  ctx.moveTo(sprite.points[0][0], sprite.points[0][1]);\r\n  for (idx = 0; idx < sprite.points.length; idx++) {\r\n    ctx.lineTo(sprite.points[idx][0], sprite.points[idx][1]);\r\n  }\r\n  ctx.lineTo(sprite.points[0][0], sprite.points[0][1]);\r\n  ctx.stroke();\r\n\r\n});\r\n\r\nregisterSprite('explosion', (ctx, timeDelta, sprite/*, entityId*/) => {\r\n  let p, idx;\r\n\r\n  if (!sprite.initialized) {\r\n\r\n    sprite.initialized = true;\r\n\r\n    Object.assign(sprite, {\r\n      ttl: 2.0,\r\n      radius: 100,\r\n      maxParticles: 25,\r\n      maxParticleSize: 4,\r\n      maxVelocity: 300,\r\n      color: '#f00',\r\n      age: 0,\r\n      stop: false,\r\n      ...sprite\r\n    });\r\n\r\n    sprite.particles = [];\r\n\r\n    for (idx = 0; idx < sprite.maxParticles; idx++) {\r\n      sprite.particles.push({ free: true });\r\n    }\r\n\r\n  }\r\n\r\n  for (idx = 0; idx < sprite.particles.length; idx++) {\r\n    p = sprite.particles[idx];\r\n\r\n    if (!sprite.stop && p.free) {\r\n\r\n      p.velocity = sprite.maxVelocity * Math.random();\r\n      p.angle = (Math.PI * 2) * Math.random();\r\n      p.dx = 0 - (p.velocity * Math.sin(p.angle));\r\n      p.dy = p.velocity * Math.cos(p.angle);\r\n      p.distance = p.x = p.y = 0;\r\n      p.maxDistance = sprite.radius * Math.random();\r\n      p.size = sprite.maxParticleSize;\r\n      p.free = false;\r\n\r\n    } else if (!p.free) {\r\n\r\n      p.x += p.dx * timeDelta;\r\n      p.y += p.dy * timeDelta;\r\n\r\n      p.distance += p.velocity * timeDelta;\r\n      if (p.distance >= p.maxDistance) {\r\n        p.distance = p.maxDistance;\r\n        p.free = true;\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  sprite.age += timeDelta;\r\n\r\n  if (sprite.age >= sprite.ttl) {\r\n    sprite.stop = true;\r\n  }\r\n\r\n  const alpha = Math.max(0, 1 - (sprite.age / sprite.ttl));\r\n\r\n  ctx.save();\r\n  ctx.strokeStyle = sprite.color;\r\n  ctx.fillStyle = sprite.color;\r\n\r\n  for (idx = 0; idx < sprite.particles.length; idx++) {\r\n    p = sprite.particles[idx];\r\n    if (p.free) { continue; }\r\n\r\n    ctx.globalAlpha = (1 - (p.distance / p.maxDistance)) * alpha;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.lineWidth = p.size;\r\n    ctx.lineTo(p.x, p.y);\r\n    ctx.stroke();\r\n  }\r\n\r\n  ctx.restore();\r\n\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/viewportCanvas.js","require('../../modules/es6.object.assign');\nmodule.exports = require('../../modules/_core').Object.assign;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/assign.js\n// module id = 78\n// module chunks = 7","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', { assign: require('./_object-assign') });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.assign.js\n// module id = 79\n// module chunks = 7","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_a-function.js\n// module id = 80\n// module chunks = 7","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nvar toObject = require('./_to-object');\nvar IObject = require('./_iobject');\nvar $assign = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function () {\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line no-undef\n  var S = Symbol();\n  var K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function (k) { B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars\n  var T = toObject(target);\n  var aLen = arguments.length;\n  var index = 1;\n  var getSymbols = gOPS.f;\n  var isEnum = pIE.f;\n  while (aLen > index) {\n    var S = IObject(arguments[index++]);\n    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) if (isEnum.call(S, key = keys[j++])) T[key] = S[key];\n  } return T;\n} : $assign;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-assign.js\n// module id = 81\n// module chunks = 7","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_array-includes.js\n// module id = 82\n// module chunks = 7","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-absolute-index.js\n// module id = 83\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/define-property\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/define-property.js\n// module id = 84\n// module chunks = 7","require('../../modules/es6.object.define-property');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperty(it, key, desc) {\n  return $Object.defineProperty(it, key, desc);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/define-property.js\n// module id = 85\n// module chunks = 7","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.define-property.js\n// module id = 86\n// module chunks = 7","require('../../modules/es6.object.get-prototype-of');\nmodule.exports = require('../../modules/_core').Object.getPrototypeOf;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/get-prototype-of.js\n// module id = 87\n// module chunks = 7","// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject = require('./_to-object');\nvar $getPrototypeOf = require('./_object-gpo');\n\nrequire('./_object-sap')('getPrototypeOf', function () {\n  return function getPrototypeOf(it) {\n    return $getPrototypeOf(toObject(it));\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.get-prototype-of.js\n// module id = 88\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/symbol/iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/symbol/iterator.js\n// module id = 89\n// module chunks = 7","require('../../modules/es6.string.iterator');\nrequire('../../modules/web.dom.iterable');\nmodule.exports = require('../../modules/_wks-ext').f('iterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/symbol/iterator.js\n// module id = 90\n// module chunks = 7","var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_string-at.js\n// module id = 91\n// module chunks = 7","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-create.js\n// module id = 92\n// module chunks = 7","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-dps.js\n// module id = 93\n// module chunks = 7","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_html.js\n// module id = 94\n// module chunks = 7","require('./es6.array.iterator');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar TO_STRING_TAG = require('./_wks')('toStringTag');\n\nvar DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +\n  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +\n  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +\n  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +\n  'TextTrackList,TouchList').split(',');\n\nfor (var i = 0; i < DOMIterables.length; i++) {\n  var NAME = DOMIterables[i];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n  Iterators[NAME] = Iterators.Array;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/web.dom.iterable.js\n// module id = 95\n// module chunks = 7","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.array.iterator.js\n// module id = 96\n// module chunks = 7","module.exports = function () { /* empty */ };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_add-to-unscopables.js\n// module id = 97\n// module chunks = 7","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-step.js\n// module id = 98\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/symbol\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/symbol.js\n// module id = 99\n// module chunks = 7","require('../../modules/es6.symbol');\nrequire('../../modules/es6.object.to-string');\nrequire('../../modules/es7.symbol.async-iterator');\nrequire('../../modules/es7.symbol.observable');\nmodule.exports = require('../../modules/_core').Symbol;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/symbol/index.js\n// module id = 100\n// module chunks = 7","'use strict';\n// ECMAScript 6 symbols shim\nvar global = require('./_global');\nvar has = require('./_has');\nvar DESCRIPTORS = require('./_descriptors');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar META = require('./_meta').KEY;\nvar $fails = require('./_fails');\nvar shared = require('./_shared');\nvar setToStringTag = require('./_set-to-string-tag');\nvar uid = require('./_uid');\nvar wks = require('./_wks');\nvar wksExt = require('./_wks-ext');\nvar wksDefine = require('./_wks-define');\nvar keyOf = require('./_keyof');\nvar enumKeys = require('./_enum-keys');\nvar isArray = require('./_is-array');\nvar anObject = require('./_an-object');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar createDesc = require('./_property-desc');\nvar _create = require('./_object-create');\nvar gOPNExt = require('./_object-gopn-ext');\nvar $GOPD = require('./_object-gopd');\nvar $DP = require('./_object-dp');\nvar $keys = require('./_object-keys');\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function';\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f = $propertyIsEnumerable;\n  require('./_object-gops').f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !require('./_library')) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(key) {\n    if (isSymbol(key)) return keyOf(SymbolRegistry, key);\n    throw TypeError(key + ' is not a symbol!');\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    if (it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    replacer = args[1];\n    if (typeof replacer == 'function') $replacer = replacer;\n    if ($replacer || !isArray(replacer)) replacer = function (key, value) {\n      if ($replacer) value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.symbol.js\n// module id = 101\n// module chunks = 7","var META = require('./_uid')('meta');\nvar isObject = require('./_is-object');\nvar has = require('./_has');\nvar setDesc = require('./_object-dp').f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !require('./_fails')(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_meta.js\n// module id = 102\n// module chunks = 7","var getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nmodule.exports = function (object, el) {\n  var O = toIObject(object);\n  var keys = getKeys(O);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) if (O[key = keys[index++]] === el) return key;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_keyof.js\n// module id = 103\n// module chunks = 7","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_enum-keys.js\n// module id = 104\n// module chunks = 7","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_is-array.js\n// module id = 105\n// module chunks = 7","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject');\nvar gOPN = require('./_object-gopn').f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gopn-ext.js\n// module id = 106\n// module chunks = 7","require('./_wks-define')('asyncIterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.symbol.async-iterator.js\n// module id = 108\n// module chunks = 7","require('./_wks-define')('observable');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.symbol.observable.js\n// module id = 109\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/set-prototype-of\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/set-prototype-of.js\n// module id = 110\n// module chunks = 7","require('../../modules/es6.object.set-prototype-of');\nmodule.exports = require('../../modules/_core').Object.setPrototypeOf;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/set-prototype-of.js\n// module id = 111\n// module chunks = 7","// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = require('./_export');\n$export($export.S, 'Object', { setPrototypeOf: require('./_set-proto').set });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.set-prototype-of.js\n// module id = 112\n// module chunks = 7","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = require('./_is-object');\nvar anObject = require('./_an-object');\nvar check = function (O, proto) {\n  anObject(O);\n  if (!isObject(proto) && proto !== null) throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function (test, buggy, set) {\n      try {\n        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch (e) { buggy = true; }\n      return function setPrototypeOf(O, proto) {\n        check(O, proto);\n        if (buggy) O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_set-proto.js\n// module id = 113\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/create.js\n// module id = 114\n// module chunks = 7","require('../../modules/es6.object.create');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function create(P, D) {\n  return $Object.create(P, D);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/create.js\n// module id = 115\n// module chunks = 7","var $export = require('./_export');\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', { create: require('./_object-create') });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.create.js\n// module id = 116\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js\n// module id = 117\n// module chunks = 7","require('../../modules/es6.object.get-own-property-descriptor');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function getOwnPropertyDescriptor(it, key) {\n  return $Object.getOwnPropertyDescriptor(it, key);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/get-own-property-descriptor.js\n// module id = 118\n// module chunks = 7","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./_to-iobject');\nvar $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js\n// module id = 119\n// module chunks = 7","/**\r\n * @author       Timo Hausmann\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2014 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n/**\r\n * A QuadTree implementation. The original code was a conversion of the Java code posted to GameDevTuts.\r\n * However I've tweaked it massively to add node indexing, removed lots of temp. var creation and significantly increased performance as a result.\r\n * Original version at https://github.com/timohausmann/quadtree-js/\r\n *\r\n * @class QuadTree\r\n * @constructor\r\n * @param {number} x - The top left coordinate of the quadtree.\r\n * @param {number} y - The top left coordinate of the quadtree.\r\n * @param {number} width - The width of the quadtree in pixels.\r\n * @param {number} height - The height of the quadtree in pixels.\r\n * @param {number} [maxObjects=10] - The maximum number of objects per node.\r\n * @param {number} [maxLevels=4] - The maximum number of levels to iterate to.\r\n * @param {number} [level=0] - Which level is this?\r\n */\r\nexport default function QuadTree(left, top, width, height, maxObjects, maxLevels, level, root) {\r\n\r\n  /**\r\n   * @property {number} maxObjects - The maximum number of objects per node.\r\n   * @default\r\n   */\r\n  this.maxObjects = 10;\r\n\r\n  /**\r\n   * @property {number} maxLevels - The maximum number of levels to break down to.\r\n   * @default\r\n   */\r\n  this.maxLevels = 4;\r\n\r\n  /**\r\n   * @property {number} level - The current level.\r\n   */\r\n  this.level = 0;\r\n\r\n  /**\r\n   * @property {object} bounds - Object that contains the quadtree bounds.\r\n   */\r\n  this.bounds = {};\r\n\r\n  /**\r\n   * @property {array} objects - Array of quadtree children.\r\n   */\r\n  this.objects = [];\r\n\r\n  /**\r\n   * @property {array} nodes - Array of associated child nodes.\r\n   */\r\n  this.nodes = [];\r\n\r\n  /**\r\n   * @property {array} _empty - Internal empty array.\r\n   * @private\r\n   */\r\n  this._empty = [];\r\n\r\n  this.root = root || this;\r\n  this.entityMap = {};\r\n\r\n  this.reset(left, top, width, height, maxObjects, maxLevels, level);\r\n\r\n};\r\n\r\nQuadTree.prototype = {\r\n\r\n  /**\r\n   * Resets the QuadTree.\r\n   *\r\n   * @method QuadTree#reset\r\n   * @param {number} x - The top left coordinate of the quadtree.\r\n   * @param {number} y - The top left coordinate of the quadtree.\r\n   * @param {number} width - The width of the quadtree in pixels.\r\n   * @param {number} height - The height of the quadtree in pixels.\r\n   * @param {number} [maxObjects=10] - The maximum number of objects per node.\r\n   * @param {number} [maxLevels=4] - The maximum number of levels to iterate to.\r\n   * @param {number} [level=0] - Which level is this?\r\n   */\r\n  reset: function (left, top, width, height, maxObjects, maxLevels, level) {\r\n\r\n    this.maxObjects = maxObjects || 10;\r\n    this.maxLevels = maxLevels || 4;\r\n    this.level = level || 0;\r\n\r\n    this.bounds = {\r\n      width: width,\r\n      height: height,\r\n      subWidth: Math.floor(width / 2),\r\n      subHeight: Math.floor(height / 2),\r\n      left: Math.round(left),\r\n      top: Math.round(top),\r\n      midX: Math.round(left + width / 2),\r\n      midY: Math.round(top + height / 2),\r\n      right: Math.round(left + width),\r\n      bottom: Math.round(top + height)\r\n    };\r\n\r\n    this.objects.length = 0;\r\n    this.nodes.length = 0;\r\n\r\n  },\r\n\r\n  /**\r\n   * Split the node into 4 subnodes\r\n   *\r\n   * @method QuadTree#split\r\n   */\r\n  split: function () {\r\n\r\n    //  top right node\r\n    this.nodes[0] = new QuadTree(\r\n      this.bounds.left + this.bounds.subWidth,\r\n      this.bounds.top,\r\n      this.bounds.subWidth, this.bounds.subHeight,\r\n      this.maxObjects, this.maxLevels, (this.level + 1), this.root\r\n    );\r\n\r\n    //  top left node\r\n    this.nodes[1] = new QuadTree(\r\n      this.bounds.left,\r\n      this.bounds.top,\r\n      this.bounds.subWidth, this.bounds.subHeight,\r\n      this.maxObjects, this.maxLevels, (this.level + 1), this.root\r\n    );\r\n\r\n    //  bottom left node\r\n    this.nodes[2] = new QuadTree(\r\n      this.bounds.left,\r\n      this.bounds.top + this.bounds.subHeight,\r\n      this.bounds.subWidth, this.bounds.subHeight,\r\n      this.maxObjects, this.maxLevels, (this.level + 1), this.root\r\n    );\r\n\r\n    //  bottom right node\r\n    this.nodes[3] = new QuadTree(\r\n      this.bounds.left + this.bounds.subWidth,\r\n      this.bounds.top + this.bounds.subHeight,\r\n      this.bounds.subWidth, this.bounds.subHeight,\r\n      this.maxObjects, this.maxLevels, (this.level + 1), this.root\r\n    );\r\n\r\n  },\r\n\r\n  /**\r\n   * Insert the object into the node. If the node exceeds the capacity, it will split and add all objects to their corresponding subnodes.\r\n   *\r\n   * @method QuadTree#insert\r\n   * @param {Phaser.Physics.Arcade.Body|object} body - The Body object to insert into the quadtree. Can be any object so long as it exposes x, y, right and bottom properties.\r\n   */\r\n  insert: function (body) {\r\n\r\n    var i = 0;\r\n    var index;\r\n\r\n    //  if we have subnodes ...\r\n    if (this.nodes[0] != null) {\r\n      index = this.getIndex(body);\r\n      if (index !== -1) {\r\n        this.nodes[index].insert(body);\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Check if we already have this item in the quadtree structure.\r\n    var oldNode = this.root.entityMap[body.entityId];\r\n    if (oldNode === this) {\r\n      // If we have the item, and it's this current sub-tree, then just bail.\r\n      return;\r\n    }\r\n    if (oldNode) {\r\n      // If the item is known, but in another sub-tree, then delete it from there.\r\n      var objectIndex = oldNode.objects.indexOf(body);\r\n      if (objectIndex !== -1) {\r\n        oldNode.objects.splice(objectIndex, 1);\r\n      }\r\n    }\r\n\r\n    /*\r\n    // TODO: Need the opposite of split() to consolidate subtrees when they\r\n    // lose items.\r\n\r\n    this.root.entityMap[body.entityId] = this;\r\n    */\r\n\r\n    this.objects.push(body);\r\n\r\n    if (this.objects.length > this.maxObjects && this.level < this.maxLevels) {\r\n      //  Split if we don't already have subnodes\r\n      if (this.nodes[0] == null) {\r\n        this.split();\r\n      }\r\n      //  Add objects to subnodes\r\n      while (i < this.objects.length) {\r\n        index = this.getIndex(this.objects[i]);\r\n        if (index !== -1) {\r\n          //  this is expensive - see what we can do about it\r\n          this.nodes[index].insert(this.objects.splice(i, 1)[0]);\r\n        } else {\r\n          i++;\r\n        }\r\n      }\r\n    }\r\n\r\n  },\r\n\r\n  /**\r\n   * Determine which node the object belongs to.\r\n   *\r\n   * @method QuadTree#getIndex\r\n   * @param {Phaser.Rectangle|object} rect - The bounds in which to check.\r\n   * @return {number} index - Index of the subnode (0-3), or -1 if rect cannot completely fit within a subnode and is part of the parent node.\r\n   */\r\n  getIndex: function (rect) {\r\n    if (rect.left < this.bounds.midX && rect.right < this.bounds.midX) {\r\n      if (rect.top < this.bounds.midY && rect.bottom < this.bounds.midY) {\r\n        //  rect fits within the top-left quadrant of this quadtree\r\n        return 1;\r\n      } else if (rect.top > this.bounds.midY) {\r\n        //  rect fits within the bottom-left quadrant of this quadtree\r\n        return 2;\r\n      }\r\n    } else if (rect.left > this.bounds.midX) {\r\n      //  rect can completely fit within the right quadrants\r\n      if (rect.top < this.bounds.midY && rect.bottom < this.bounds.midY) {\r\n        //  rect fits within the top-right quadrant of this quadtree\r\n        return 0;\r\n      } else if (rect.top > this.bounds.midY) {\r\n        //  rect fits within the bottom-right quadrant of this quadtree\r\n        return 3;\r\n      }\r\n    }\r\n    // rect doesn't fit, i.e. it straddles the internal quadrants\r\n    return -1;\r\n  },\r\n\r\n  /**\r\n   * Iterate through all objects that could collide with the given Sprite or Rectangle.\r\n   *\r\n   * @method QuadTree#retrieve\r\n   * @param {Phaser.Sprite|Phaser.Rectangle} source - The source object to check the QuadTree against. Either a Sprite or Rectangle.\r\n   */\r\n  iterate: function (source, iteratorFn, optionalParam) {\r\n    var index = this.getIndex(source);\r\n\r\n    for (var i = 0; i < this.objects.length; i++) {\r\n      iteratorFn(this.objects[i], optionalParam);\r\n    }\r\n\r\n    if (this.nodes[0]) {\r\n      //  If rect fits into a subnode ..\r\n      if (index !== -1) {\r\n        this.nodes[index].iterate(source, iteratorFn, optionalParam);\r\n      } else {\r\n        //  If rect does not fit into a subnode, check it against all subnodes (unrolled for speed)\r\n        this.nodes[0].iterate(source, iteratorFn, optionalParam);\r\n        this.nodes[1].iterate(source, iteratorFn, optionalParam);\r\n        this.nodes[2].iterate(source, iteratorFn, optionalParam);\r\n        this.nodes[3].iterate(source, iteratorFn, optionalParam);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Clear the quadtree.\r\n   * @method QuadTree#clear\r\n   */\r\n  clear: function () {\r\n    this.objects.length = 0;\r\n    var i = this.nodes.length;\r\n    while (i--) {\r\n      this.nodes[i].clear();\r\n      this.nodes.splice(i, 1);\r\n    }\r\n    this.nodes.length = 0;\r\n  }\r\n\r\n};\r\n\r\n/**\r\n * Javascript QuadTree\r\n * @version 1.0\r\n *\r\n * @version 1.3, March 11th 2014\r\n * @author Richard Davey\r\n * The original code was a conversion of the Java code posted to GameDevTuts. However I've tweaked\r\n * it massively to add node indexing, removed lots of temp. var creation and significantly\r\n * increased performance as a result.\r\n *\r\n * Original version at https://github.com/timohausmann/quadtree-js/\r\n */\r\n\r\n/**\r\n * @copyright © 2012 Timo Hausmann\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining\r\n * a copy of this software and associated documentation files (the\r\n * \"Software\"), to deal in the Software without restriction, including\r\n * without limitation the rights to use, copy, modify, merge, publish,\r\n * distribute, sublicense, and/or sell copies of the Software, and to\r\n * permit persons to whom the Software is furnished to do so, subject to\r\n * the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/QuadTree.js","module.exports = require('./vendor/dat.gui')\nmodule.exports.color = require('./vendor/dat.color')\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dat-gui/index.js\n// module id = 121\n// module chunks = 7","/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n/** @namespace */\nvar dat = module.exports = dat || {};\n\n/** @namespace */\ndat.gui = dat.gui || {};\n\n/** @namespace */\ndat.utils = dat.utils || {};\n\n/** @namespace */\ndat.controllers = dat.controllers || {};\n\n/** @namespace */\ndat.dom = dat.dom || {};\n\n/** @namespace */\ndat.color = dat.color || {};\n\ndat.utils.css = (function () {\n  return {\n    load: function (url, doc) {\n      doc = doc || document;\n      var link = doc.createElement('link');\n      link.type = 'text/css';\n      link.rel = 'stylesheet';\n      link.href = url;\n      doc.getElementsByTagName('head')[0].appendChild(link);\n    },\n    inject: function(css, doc) {\n      doc = doc || document;\n      var injected = document.createElement('style');\n      injected.type = 'text/css';\n      injected.innerHTML = css;\n      doc.getElementsByTagName('head')[0].appendChild(injected);\n    }\n  }\n})();\n\n\ndat.utils.common = (function () {\n  \n  var ARR_EACH = Array.prototype.forEach;\n  var ARR_SLICE = Array.prototype.slice;\n\n  /**\n   * Band-aid methods for things that should be a lot easier in JavaScript.\n   * Implementation and structure inspired by underscore.js\n   * http://documentcloud.github.com/underscore/\n   */\n\n  return { \n    \n    BREAK: {},\n  \n    extend: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (!this.isUndefined(obj[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n      \n    },\n    \n    defaults: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (this.isUndefined(target[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n    \n    },\n    \n    compose: function() {\n      var toCall = ARR_SLICE.call(arguments);\n            return function() {\n              var args = ARR_SLICE.call(arguments);\n              for (var i = toCall.length -1; i >= 0; i--) {\n                args = [toCall[i].apply(this, args)];\n              }\n              return args[0];\n            }\n    },\n    \n    each: function(obj, itr, scope) {\n\n      \n      if (ARR_EACH && obj.forEach === ARR_EACH) { \n        \n        obj.forEach(itr, scope);\n        \n      } else if (obj.length === obj.length + 0) { // Is number but not NaN\n        \n        for (var key = 0, l = obj.length; key < l; key++)\n          if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) \n            return;\n            \n      } else {\n\n        for (var key in obj) \n          if (itr.call(scope, obj[key], key) === this.BREAK)\n            return;\n            \n      }\n            \n    },\n    \n    defer: function(fnc) {\n      setTimeout(fnc, 0);\n    },\n    \n    toArray: function(obj) {\n      if (obj.toArray) return obj.toArray();\n      return ARR_SLICE.call(obj);\n    },\n\n    isUndefined: function(obj) {\n      return obj === undefined;\n    },\n    \n    isNull: function(obj) {\n      return obj === null;\n    },\n    \n    isNaN: function(obj) {\n      return obj !== obj;\n    },\n    \n    isArray: Array.isArray || function(obj) {\n      return obj.constructor === Array;\n    },\n    \n    isObject: function(obj) {\n      return obj === Object(obj);\n    },\n    \n    isNumber: function(obj) {\n      return obj === obj+0;\n    },\n    \n    isString: function(obj) {\n      return obj === obj+'';\n    },\n    \n    isBoolean: function(obj) {\n      return obj === false || obj === true;\n    },\n    \n    isFunction: function(obj) {\n      return Object.prototype.toString.call(obj) === '[object Function]';\n    }\n  \n  };\n    \n})();\n\n\ndat.controllers.Controller = (function (common) {\n\n  /**\n   * @class An \"abstract\" class that represents a given property of an object.\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var Controller = function(object, property) {\n\n    this.initialValue = object[property];\n\n    /**\n     * Those who extend this class will put their DOM elements in here.\n     * @type {DOMElement}\n     */\n    this.domElement = document.createElement('div');\n\n    /**\n     * The object to manipulate\n     * @type {Object}\n     */\n    this.object = object;\n\n    /**\n     * The name of the property to manipulate\n     * @type {String}\n     */\n    this.property = property;\n\n    /**\n     * The function to be called on change.\n     * @type {Function}\n     * @ignore\n     */\n    this.__onChange = undefined;\n\n    /**\n     * The function to be called on finishing change.\n     * @type {Function}\n     * @ignore\n     */\n    this.__onFinishChange = undefined;\n\n  };\n\n  common.extend(\n\n      Controller.prototype,\n\n      /** @lends dat.controllers.Controller.prototype */\n      {\n\n        /**\n         * Specify that a function fire every time someone changes the value with\n         * this Controller.\n         *\n         * @param {Function} fnc This function will be called whenever the value\n         * is modified via this Controller.\n         * @returns {dat.controllers.Controller} this\n         */\n        onChange: function(fnc) {\n          this.__onChange = fnc;\n          return this;\n        },\n\n        /**\n         * Specify that a function fire every time someone \"finishes\" changing\n         * the value wih this Controller. Useful for values that change\n         * incrementally like numbers or strings.\n         *\n         * @param {Function} fnc This function will be called whenever\n         * someone \"finishes\" changing the value via this Controller.\n         * @returns {dat.controllers.Controller} this\n         */\n        onFinishChange: function(fnc) {\n          this.__onFinishChange = fnc;\n          return this;\n        },\n\n        /**\n         * Change the value of <code>object[property]</code>\n         *\n         * @param {Object} newValue The new value of <code>object[property]</code>\n         */\n        setValue: function(newValue) {\n          this.object[this.property] = newValue;\n          if (this.__onChange) {\n            this.__onChange.call(this, newValue);\n          }\n          this.updateDisplay();\n          return this;\n        },\n\n        /**\n         * Gets the value of <code>object[property]</code>\n         *\n         * @returns {Object} The current value of <code>object[property]</code>\n         */\n        getValue: function() {\n          return this.object[this.property];\n        },\n\n        /**\n         * Refreshes the visual display of a Controller in order to keep sync\n         * with the object's current value.\n         * @returns {dat.controllers.Controller} this\n         */\n        updateDisplay: function() {\n          return this;\n        },\n\n        /**\n         * @returns {Boolean} true if the value has deviated from initialValue\n         */\n        isModified: function() {\n          return this.initialValue !== this.getValue()\n        }\n\n      }\n\n  );\n\n  return Controller;\n\n\n})(dat.utils.common);\n\n\ndat.dom.dom = (function (common) {\n\n  var EVENT_MAP = {\n    'HTMLEvents': ['change'],\n    'MouseEvents': ['click','mousemove','mousedown','mouseup', 'mouseover'],\n    'KeyboardEvents': ['keydown']\n  };\n\n  var EVENT_MAP_INV = {};\n  common.each(EVENT_MAP, function(v, k) {\n    common.each(v, function(e) {\n      EVENT_MAP_INV[e] = k;\n    });\n  });\n\n  var CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\n\n  function cssValueToPixels(val) {\n\n    if (val === '0' || common.isUndefined(val)) return 0;\n\n    var match = val.match(CSS_VALUE_PIXELS);\n\n    if (!common.isNull(match)) {\n      return parseFloat(match[1]);\n    }\n\n    // TODO ...ems? %?\n\n    return 0;\n\n  }\n\n  /**\n   * @namespace\n   * @member dat.dom\n   */\n  var dom = {\n\n    /**\n     * \n     * @param elem\n     * @param selectable\n     */\n    makeSelectable: function(elem, selectable) {\n\n      if (elem === undefined || elem.style === undefined) return;\n\n      elem.onselectstart = selectable ? function() {\n        return false;\n      } : function() {\n      };\n\n      elem.style.MozUserSelect = selectable ? 'auto' : 'none';\n      elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\n      elem.unselectable = selectable ? 'on' : 'off';\n\n    },\n\n    /**\n     *\n     * @param elem\n     * @param horizontal\n     * @param vertical\n     */\n    makeFullscreen: function(elem, horizontal, vertical) {\n\n      if (common.isUndefined(horizontal)) horizontal = true;\n      if (common.isUndefined(vertical)) vertical = true;\n\n      elem.style.position = 'absolute';\n\n      if (horizontal) {\n        elem.style.left = 0;\n        elem.style.right = 0;\n      }\n      if (vertical) {\n        elem.style.top = 0;\n        elem.style.bottom = 0;\n      }\n\n    },\n\n    /**\n     *\n     * @param elem\n     * @param eventType\n     * @param params\n     */\n    fakeEvent: function(elem, eventType, params, aux) {\n      params = params || {};\n      var className = EVENT_MAP_INV[eventType];\n      if (!className) {\n        throw new Error('Event type ' + eventType + ' not supported.');\n      }\n      var evt = document.createEvent(className);\n      switch (className) {\n        case 'MouseEvents':\n          var clientX = params.x || params.clientX || 0;\n          var clientY = params.y || params.clientY || 0;\n          evt.initMouseEvent(eventType, params.bubbles || false,\n              params.cancelable || true, window, params.clickCount || 1,\n              0, //screen X\n              0, //screen Y\n              clientX, //client X\n              clientY, //client Y\n              false, false, false, false, 0, null);\n          break;\n        case 'KeyboardEvents':\n          var init = evt.initKeyboardEvent || evt.initKeyEvent; // webkit || moz\n          common.defaults(params, {\n            cancelable: true,\n            ctrlKey: false,\n            altKey: false,\n            shiftKey: false,\n            metaKey: false,\n            keyCode: undefined,\n            charCode: undefined\n          });\n          init(eventType, params.bubbles || false,\n              params.cancelable, window,\n              params.ctrlKey, params.altKey,\n              params.shiftKey, params.metaKey,\n              params.keyCode, params.charCode);\n          break;\n        default:\n          evt.initEvent(eventType, params.bubbles || false,\n              params.cancelable || true);\n          break;\n      }\n      common.defaults(evt, aux);\n      elem.dispatchEvent(evt);\n    },\n\n    /**\n     *\n     * @param elem\n     * @param event\n     * @param func\n     * @param bool\n     */\n    bind: function(elem, event, func, bool) {\n      bool = bool || false;\n      if (elem.addEventListener)\n        elem.addEventListener(event, func, bool);\n      else if (elem.attachEvent)\n        elem.attachEvent('on' + event, func);\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param event\n     * @param func\n     * @param bool\n     */\n    unbind: function(elem, event, func, bool) {\n      bool = bool || false;\n      if (elem.removeEventListener)\n        elem.removeEventListener(event, func, bool);\n      else if (elem.detachEvent)\n        elem.detachEvent('on' + event, func);\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param className\n     */\n    addClass: function(elem, className) {\n      if (elem.className === undefined) {\n        elem.className = className;\n      } else if (elem.className !== className) {\n        var classes = elem.className.split(/ +/);\n        if (classes.indexOf(className) == -1) {\n          classes.push(className);\n          elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\n        }\n      }\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param className\n     */\n    removeClass: function(elem, className) {\n      if (className) {\n        if (elem.className === undefined) {\n          // elem.className = className;\n        } else if (elem.className === className) {\n          elem.removeAttribute('class');\n        } else {\n          var classes = elem.className.split(/ +/);\n          var index = classes.indexOf(className);\n          if (index != -1) {\n            classes.splice(index, 1);\n            elem.className = classes.join(' ');\n          }\n        }\n      } else {\n        elem.className = undefined;\n      }\n      return dom;\n    },\n\n    hasClass: function(elem, className) {\n      return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getWidth: function(elem) {\n\n      var style = getComputedStyle(elem);\n\n      return cssValueToPixels(style['border-left-width']) +\n          cssValueToPixels(style['border-right-width']) +\n          cssValueToPixels(style['padding-left']) +\n          cssValueToPixels(style['padding-right']) +\n          cssValueToPixels(style['width']);\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getHeight: function(elem) {\n\n      var style = getComputedStyle(elem);\n\n      return cssValueToPixels(style['border-top-width']) +\n          cssValueToPixels(style['border-bottom-width']) +\n          cssValueToPixels(style['padding-top']) +\n          cssValueToPixels(style['padding-bottom']) +\n          cssValueToPixels(style['height']);\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getOffset: function(elem) {\n      var offset = {left: 0, top:0};\n      if (elem.offsetParent) {\n        do {\n          offset.left += elem.offsetLeft;\n          offset.top += elem.offsetTop;\n        } while (elem = elem.offsetParent);\n      }\n      return offset;\n    },\n\n    // http://stackoverflow.com/posts/2684561/revisions\n    /**\n     * \n     * @param elem\n     */\n    isActive: function(elem) {\n      return elem === document.activeElement && ( elem.type || elem.href );\n    }\n\n  };\n\n  return dom;\n\n})(dat.utils.common);\n\n\ndat.controllers.OptionController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a select input to alter the property of an object, using a\n   * list of accepted values.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object|string[]} options A map of labels to acceptable values, or\n   * a list of acceptable string values.\n   *\n   * @member dat.controllers\n   */\n  var OptionController = function(object, property, options) {\n\n    OptionController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    /**\n     * The drop down menu\n     * @ignore\n     */\n    this.__select = document.createElement('select');\n\n    if (common.isArray(options)) {\n      var map = {};\n      common.each(options, function(element) {\n        map[element] = element;\n      });\n      options = map;\n    }\n\n    common.each(options, function(value, key) {\n\n      var opt = document.createElement('option');\n      opt.innerHTML = key;\n      opt.setAttribute('value', value);\n      _this.__select.appendChild(opt);\n\n    });\n\n    // Acknowledge original value\n    this.updateDisplay();\n\n    dom.bind(this.__select, 'change', function() {\n      var desiredValue = this.options[this.selectedIndex].value;\n      _this.setValue(desiredValue);\n    });\n\n    this.domElement.appendChild(this.__select);\n\n  };\n\n  OptionController.superclass = Controller;\n\n  common.extend(\n\n      OptionController.prototype,\n      Controller.prototype,\n\n      {\n\n        setValue: function(v) {\n          var toReturn = OptionController.superclass.prototype.setValue.call(this, v);\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          return toReturn;\n        },\n\n        updateDisplay: function() {\n          this.__select.value = this.getValue();\n          return OptionController.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  return OptionController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.NumberController = (function (Controller, common) {\n\n  /**\n   * @class Represents a given property of an object that is a number.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object} [params] Optional parameters\n   * @param {Number} [params.min] Minimum allowed value\n   * @param {Number} [params.max] Maximum allowed value\n   * @param {Number} [params.step] Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberController = function(object, property, params) {\n\n    NumberController.superclass.call(this, object, property);\n\n    params = params || {};\n\n    this.__min = params.min;\n    this.__max = params.max;\n    this.__step = params.step;\n\n    if (common.isUndefined(this.__step)) {\n\n      if (this.initialValue == 0) {\n        this.__impliedStep = 1; // What are we, psychics?\n      } else {\n        // Hey Doug, check this out.\n        this.__impliedStep = Math.pow(10, Math.floor(Math.log(this.initialValue)/Math.LN10))/10;\n      }\n\n    } else {\n\n      this.__impliedStep = this.__step;\n\n    }\n\n    this.__precision = numDecimals(this.__impliedStep);\n\n\n  };\n\n  NumberController.superclass = Controller;\n\n  common.extend(\n\n      NumberController.prototype,\n      Controller.prototype,\n\n      /** @lends dat.controllers.NumberController.prototype */\n      {\n\n        setValue: function(v) {\n\n          if (this.__min !== undefined && v < this.__min) {\n            v = this.__min;\n          } else if (this.__max !== undefined && v > this.__max) {\n            v = this.__max;\n          }\n\n          if (this.__step !== undefined && v % this.__step != 0) {\n            v = Math.round(v / this.__step) * this.__step;\n          }\n\n          return NumberController.superclass.prototype.setValue.call(this, v);\n\n        },\n\n        /**\n         * Specify a minimum value for <code>object[property]</code>.\n         *\n         * @param {Number} minValue The minimum value for\n         * <code>object[property]</code>\n         * @returns {dat.controllers.NumberController} this\n         */\n        min: function(v) {\n          this.__min = v;\n          return this;\n        },\n\n        /**\n         * Specify a maximum value for <code>object[property]</code>.\n         *\n         * @param {Number} maxValue The maximum value for\n         * <code>object[property]</code>\n         * @returns {dat.controllers.NumberController} this\n         */\n        max: function(v) {\n          this.__max = v;\n          return this;\n        },\n\n        /**\n         * Specify a step value that dat.controllers.NumberController\n         * increments by.\n         *\n         * @param {Number} stepValue The step value for\n         * dat.controllers.NumberController\n         * @default if minimum and maximum specified increment is 1% of the\n         * difference otherwise stepValue is 1\n         * @returns {dat.controllers.NumberController} this\n         */\n        step: function(v) {\n          this.__step = v;\n          return this;\n        }\n\n      }\n\n  );\n\n  function numDecimals(x) {\n    x = x.toString();\n    if (x.indexOf('.') > -1) {\n      return x.length - x.indexOf('.') - 1;\n    } else {\n      return 0;\n    }\n  }\n\n  return NumberController;\n\n})(dat.controllers.Controller,\ndat.utils.common);\n\n\ndat.controllers.NumberControllerBox = (function (NumberController, dom, common) {\n\n  /**\n   * @class Represents a given property of an object that is a number and\n   * provides an input element with which to manipulate it.\n   *\n   * @extends dat.controllers.Controller\n   * @extends dat.controllers.NumberController\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object} [params] Optional parameters\n   * @param {Number} [params.min] Minimum allowed value\n   * @param {Number} [params.max] Maximum allowed value\n   * @param {Number} [params.step] Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberControllerBox = function(object, property, params) {\n\n    this.__truncationSuspended = false;\n\n    NumberControllerBox.superclass.call(this, object, property, params);\n\n    var _this = this;\n\n    /**\n     * {Number} Previous mouse y position\n     * @ignore\n     */\n    var prev_y;\n\n    this.__input = document.createElement('input');\n    this.__input.setAttribute('type', 'text');\n\n    // Makes it so manually specified values are not truncated.\n\n    dom.bind(this.__input, 'change', onChange);\n    dom.bind(this.__input, 'blur', onBlur);\n    dom.bind(this.__input, 'mousedown', onMouseDown);\n    dom.bind(this.__input, 'keydown', function(e) {\n\n      // When pressing entire, you can be as precise as you want.\n      if (e.keyCode === 13) {\n        _this.__truncationSuspended = true;\n        this.blur();\n        _this.__truncationSuspended = false;\n      }\n\n    });\n\n    function onChange() {\n      var attempted = parseFloat(_this.__input.value);\n      if (!common.isNaN(attempted)) _this.setValue(attempted);\n    }\n\n    function onBlur() {\n      onChange();\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    function onMouseDown(e) {\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n      prev_y = e.clientY;\n    }\n\n    function onMouseDrag(e) {\n\n      var diff = prev_y - e.clientY;\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\n\n      prev_y = e.clientY;\n\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n    }\n\n    this.updateDisplay();\n\n    this.domElement.appendChild(this.__input);\n\n  };\n\n  NumberControllerBox.superclass = NumberController;\n\n  common.extend(\n\n      NumberControllerBox.prototype,\n      NumberController.prototype,\n\n      {\n\n        updateDisplay: function() {\n\n          this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\n          return NumberControllerBox.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  function roundToDecimal(value, decimals) {\n    var tenTo = Math.pow(10, decimals);\n    return Math.round(value * tenTo) / tenTo;\n  }\n\n  return NumberControllerBox;\n\n})(dat.controllers.NumberController,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.NumberControllerSlider = (function (NumberController, dom, css, common, styleSheet) {\n\n  /**\n   * @class Represents a given property of an object that is a number, contains\n   * a minimum and maximum, and provides a slider element with which to\n   * manipulate it. It should be noted that the slider element is made up of\n   * <code>&lt;div&gt;</code> tags, <strong>not</strong> the html5\n   * <code>&lt;slider&gt;</code> element.\n   *\n   * @extends dat.controllers.Controller\n   * @extends dat.controllers.NumberController\n   * \n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Number} minValue Minimum allowed value\n   * @param {Number} maxValue Maximum allowed value\n   * @param {Number} stepValue Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberControllerSlider = function(object, property, min, max, step) {\n\n    NumberControllerSlider.superclass.call(this, object, property, { min: min, max: max, step: step });\n\n    var _this = this;\n\n    this.__background = document.createElement('div');\n    this.__foreground = document.createElement('div');\n    \n\n\n    dom.bind(this.__background, 'mousedown', onMouseDown);\n    \n    dom.addClass(this.__background, 'slider');\n    dom.addClass(this.__foreground, 'slider-fg');\n\n    function onMouseDown(e) {\n\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n\n      onMouseDrag(e);\n    }\n\n    function onMouseDrag(e) {\n\n      e.preventDefault();\n\n      var offset = dom.getOffset(_this.__background);\n      var width = dom.getWidth(_this.__background);\n      \n      _this.setValue(\n        map(e.clientX, offset.left, offset.left + width, _this.__min, _this.__max)\n      );\n\n      return false;\n\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    this.updateDisplay();\n\n    this.__background.appendChild(this.__foreground);\n    this.domElement.appendChild(this.__background);\n\n  };\n\n  NumberControllerSlider.superclass = NumberController;\n\n  /**\n   * Injects default stylesheet for slider elements.\n   */\n  NumberControllerSlider.useDefaultStyles = function() {\n    css.inject(styleSheet);\n  };\n\n  common.extend(\n\n      NumberControllerSlider.prototype,\n      NumberController.prototype,\n\n      {\n\n        updateDisplay: function() {\n          var pct = (this.getValue() - this.__min)/(this.__max - this.__min);\n          this.__foreground.style.width = pct*100+'%';\n          return NumberControllerSlider.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n\n\n  );\n\n  function map(v, i1, i2, o1, o2) {\n    return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\n  }\n\n  return NumberControllerSlider;\n  \n})(dat.controllers.NumberController,\ndat.dom.dom,\ndat.utils.css,\ndat.utils.common,\n\".slider {\\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\\n  height: 1em;\\n  border-radius: 1em;\\n  background-color: #eee;\\n  padding: 0 0.5em;\\n  overflow: hidden;\\n}\\n\\n.slider-fg {\\n  padding: 1px 0 2px 0;\\n  background-color: #aaa;\\n  height: 1em;\\n  margin-left: -0.5em;\\n  padding-right: 0.5em;\\n  border-radius: 1em 0 0 1em;\\n}\\n\\n.slider-fg:after {\\n  display: inline-block;\\n  border-radius: 1em;\\n  background-color: #fff;\\n  border:  1px solid #aaa;\\n  content: '';\\n  float: right;\\n  margin-right: -1em;\\n  margin-top: -1px;\\n  height: 0.9em;\\n  width: 0.9em;\\n}\");\n\n\ndat.controllers.FunctionController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a GUI interface to fire a specified method, a property of an object.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var FunctionController = function(object, property, text) {\n\n    FunctionController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    this.__button = document.createElement('div');\n    this.__button.innerHTML = text === undefined ? 'Fire' : text;\n    dom.bind(this.__button, 'click', function(e) {\n      e.preventDefault();\n      _this.fire();\n      return false;\n    });\n\n    dom.addClass(this.__button, 'button');\n\n    this.domElement.appendChild(this.__button);\n\n\n  };\n\n  FunctionController.superclass = Controller;\n\n  common.extend(\n\n      FunctionController.prototype,\n      Controller.prototype,\n      {\n        \n        fire: function() {\n          if (this.__onChange) {\n            this.__onChange.call(this);\n          }\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          this.getValue().call(this.object);\n        }\n      }\n\n  );\n\n  return FunctionController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.BooleanController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a checkbox input to alter the boolean property of an object.\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var BooleanController = function(object, property) {\n\n    BooleanController.superclass.call(this, object, property);\n\n    var _this = this;\n    this.__prev = this.getValue();\n\n    this.__checkbox = document.createElement('input');\n    this.__checkbox.setAttribute('type', 'checkbox');\n\n\n    dom.bind(this.__checkbox, 'change', onChange, false);\n\n    this.domElement.appendChild(this.__checkbox);\n\n    // Match original value\n    this.updateDisplay();\n\n    function onChange() {\n      _this.setValue(!_this.__prev);\n    }\n\n  };\n\n  BooleanController.superclass = Controller;\n\n  common.extend(\n\n      BooleanController.prototype,\n      Controller.prototype,\n\n      {\n\n        setValue: function(v) {\n          var toReturn = BooleanController.superclass.prototype.setValue.call(this, v);\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          this.__prev = this.getValue();\n          return toReturn;\n        },\n\n        updateDisplay: function() {\n          \n          if (this.getValue() === true) {\n            this.__checkbox.setAttribute('checked', 'checked');\n            this.__checkbox.checked = true;    \n          } else {\n              this.__checkbox.checked = false;\n          }\n\n          return BooleanController.superclass.prototype.updateDisplay.call(this);\n\n        }\n\n\n      }\n\n  );\n\n  return BooleanController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.color.toString = (function (common) {\n\n  return function(color) {\n\n    if (color.a == 1 || common.isUndefined(color.a)) {\n\n      var s = color.hex.toString(16);\n      while (s.length < 6) {\n        s = '0' + s;\n      }\n\n      return '#' + s;\n\n    } else {\n\n      return 'rgba(' + Math.round(color.r) + ',' + Math.round(color.g) + ',' + Math.round(color.b) + ',' + color.a + ')';\n\n    }\n\n  }\n\n})(dat.utils.common);\n\n\ndat.color.interpret = (function (toString, common) {\n\n  var result, toReturn;\n\n  var interpret = function() {\n\n    toReturn = false;\n\n    var original = arguments.length > 1 ? common.toArray(arguments) : arguments[0];\n\n    common.each(INTERPRETATIONS, function(family) {\n\n      if (family.litmus(original)) {\n\n        common.each(family.conversions, function(conversion, conversionName) {\n\n          result = conversion.read(original);\n\n          if (toReturn === false && result !== false) {\n            toReturn = result;\n            result.conversionName = conversionName;\n            result.conversion = conversion;\n            return common.BREAK;\n\n          }\n\n        });\n\n        return common.BREAK;\n\n      }\n\n    });\n\n    return toReturn;\n\n  };\n\n  var INTERPRETATIONS = [\n\n    // Strings\n    {\n\n      litmus: common.isString,\n\n      conversions: {\n\n        THREE_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt(\n                  '0x' +\n                      test[1].toString() + test[1].toString() +\n                      test[2].toString() + test[2].toString() +\n                      test[3].toString() + test[3].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        SIX_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9]{6})$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt('0x' + test[1].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGB: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3])\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGBA: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3]),\n              a: parseFloat(test[4])\n            };\n\n          },\n\n          write: toString\n\n        }\n\n      }\n\n    },\n\n    // Numbers\n    {\n\n      litmus: common.isNumber,\n\n      conversions: {\n\n        HEX: {\n          read: function(original) {\n            return {\n              space: 'HEX',\n              hex: original,\n              conversionName: 'HEX'\n            }\n          },\n\n          write: function(color) {\n            return color.hex;\n          }\n        }\n\n      }\n\n    },\n\n    // Arrays\n    {\n\n      litmus: common.isArray,\n\n      conversions: {\n\n        RGB_ARRAY: {\n          read: function(original) {\n            if (original.length != 3) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b];\n          }\n\n        },\n\n        RGBA_ARRAY: {\n          read: function(original) {\n            if (original.length != 4) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2],\n              a: original[3]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b, color.a];\n          }\n\n        }\n\n      }\n\n    },\n\n    // Objects\n    {\n\n      litmus: common.isObject,\n\n      conversions: {\n\n        RGBA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b,\n              a: color.a\n            }\n          }\n        },\n\n        RGB_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b\n            }\n          }\n        },\n\n        HSVA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v,\n              a: color.a\n            }\n          }\n        },\n\n        HSV_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v\n            }\n          }\n\n        }\n\n      }\n\n    }\n\n\n  ];\n\n  return interpret;\n\n\n})(dat.color.toString,\ndat.utils.common);\n\n\ndat.GUI = dat.gui.GUI = (function (css, saveDialogueContents, styleSheet, controllerFactory, Controller, BooleanController, FunctionController, NumberControllerBox, NumberControllerSlider, OptionController, ColorController, requestAnimationFrame, CenteredDiv, dom, common) {\n\n  css.inject(styleSheet);\n\n  /** Outer-most className for GUI's */\n  var CSS_NAMESPACE = 'dg';\n\n  var HIDE_KEY_CODE = 72;\n\n  /** The only value shared between the JS and SCSS. Use caution. */\n  var CLOSE_BUTTON_HEIGHT = 20;\n\n  var DEFAULT_DEFAULT_PRESET_NAME = 'Default';\n\n  var SUPPORTS_LOCAL_STORAGE = (function() {\n    try {\n      return 'localStorage' in window && window['localStorage'] !== null;\n    } catch (e) {\n      return false;\n    }\n  })();\n\n  var SAVE_DIALOGUE;\n\n  /** Have we yet to create an autoPlace GUI? */\n  var auto_place_virgin = true;\n\n  /** Fixed position div that auto place GUI's go inside */\n  var auto_place_container;\n\n  /** Are we hiding the GUI's ? */\n  var hide = false;\n\n  /** GUI's which should be hidden */\n  var hideable_guis = [];\n\n  /**\n   * A lightweight controller library for JavaScript. It allows you to easily\n   * manipulate variables and fire functions on the fly.\n   * @class\n   *\n   * @member dat.gui\n   *\n   * @param {Object} [params]\n   * @param {String} [params.name] The name of this GUI.\n   * @param {Object} [params.load] JSON object representing the saved state of\n   * this GUI.\n   * @param {Boolean} [params.auto=true]\n   * @param {dat.gui.GUI} [params.parent] The GUI I'm nested in.\n   * @param {Boolean} [params.closed] If true, starts closed\n   */\n  var GUI = function(params) {\n\n    var _this = this;\n\n    /**\n     * Outermost DOM Element\n     * @type DOMElement\n     */\n    this.domElement = document.createElement('div');\n    this.__ul = document.createElement('ul');\n    this.domElement.appendChild(this.__ul);\n\n    dom.addClass(this.domElement, CSS_NAMESPACE);\n\n    /**\n     * Nested GUI's by name\n     * @ignore\n     */\n    this.__folders = {};\n\n    this.__controllers = [];\n\n    /**\n     * List of objects I'm remembering for save, only used in top level GUI\n     * @ignore\n     */\n    this.__rememberedObjects = [];\n\n    /**\n     * Maps the index of remembered objects to a map of controllers, only used\n     * in top level GUI.\n     *\n     * @private\n     * @ignore\n     *\n     * @example\n     * [\n     *  {\n     *    propertyName: Controller,\n     *    anotherPropertyName: Controller\n     *  },\n     *  {\n     *    propertyName: Controller\n     *  }\n     * ]\n     */\n    this.__rememberedObjectIndecesToControllers = [];\n\n    this.__listening = [];\n\n    params = params || {};\n\n    // Default parameters\n    params = common.defaults(params, {\n      autoPlace: true,\n      width: GUI.DEFAULT_WIDTH\n    });\n\n    params = common.defaults(params, {\n      resizable: params.autoPlace,\n      hideable: params.autoPlace\n    });\n\n\n    if (!common.isUndefined(params.load)) {\n\n      // Explicit preset\n      if (params.preset) params.load.preset = params.preset;\n\n    } else {\n\n      params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\n\n    }\n\n    if (common.isUndefined(params.parent) && params.hideable) {\n      hideable_guis.push(this);\n    }\n\n    // Only root level GUI's are resizable.\n    params.resizable = common.isUndefined(params.parent) && params.resizable;\n\n\n    if (params.autoPlace && common.isUndefined(params.scrollable)) {\n      params.scrollable = true;\n    }\n//    params.scrollable = common.isUndefined(params.parent) && params.scrollable === true;\n\n    // Not part of params because I don't want people passing this in via\n    // constructor. Should be a 'remembered' value.\n    var use_local_storage =\n        SUPPORTS_LOCAL_STORAGE &&\n            localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\n\n    Object.defineProperties(this,\n\n        /** @lends dat.gui.GUI.prototype */\n        {\n\n          /**\n           * The parent <code>GUI</code>\n           * @type dat.gui.GUI\n           */\n          parent: {\n            get: function() {\n              return params.parent;\n            }\n          },\n\n          scrollable: {\n            get: function() {\n              return params.scrollable;\n            }\n          },\n\n          /**\n           * Handles <code>GUI</code>'s element placement for you\n           * @type Boolean\n           */\n          autoPlace: {\n            get: function() {\n              return params.autoPlace;\n            }\n          },\n\n          /**\n           * The identifier for a set of saved values\n           * @type String\n           */\n          preset: {\n\n            get: function() {\n              if (_this.parent) {\n                return _this.getRoot().preset;\n              } else {\n                return params.load.preset;\n              }\n            },\n\n            set: function(v) {\n              if (_this.parent) {\n                _this.getRoot().preset = v;\n              } else {\n                params.load.preset = v;\n              }\n              setPresetSelectIndex(this);\n              _this.revert();\n            }\n\n          },\n\n          /**\n           * The width of <code>GUI</code> element\n           * @type Number\n           */\n          width: {\n            get: function() {\n              return params.width;\n            },\n            set: function(v) {\n              params.width = v;\n              setWidth(_this, v);\n            }\n          },\n\n          /**\n           * The name of <code>GUI</code>. Used for folders. i.e\n           * a folder's name\n           * @type String\n           */\n          name: {\n            get: function() {\n              return params.name;\n            },\n            set: function(v) {\n              // TODO Check for collisions among sibling folders\n              params.name = v;\n              if (title_row_name) {\n                title_row_name.innerHTML = params.name;\n              }\n            }\n          },\n\n          /**\n           * Whether the <code>GUI</code> is collapsed or not\n           * @type Boolean\n           */\n          closed: {\n            get: function() {\n              return params.closed;\n            },\n            set: function(v) {\n              params.closed = v;\n              if (params.closed) {\n                dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\n              } else {\n                dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\n              }\n              // For browsers that aren't going to respect the CSS transition,\n              // Lets just check our height against the window height right off\n              // the bat.\n              this.onResize();\n\n              if (_this.__closeButton) {\n                _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\n              }\n            }\n          },\n\n          /**\n           * Contains all presets\n           * @type Object\n           */\n          load: {\n            get: function() {\n              return params.load;\n            }\n          },\n\n          /**\n           * Determines whether or not to use <a href=\"https://developer.mozilla.org/en/DOM/Storage#localStorage\">localStorage</a> as the means for\n           * <code>remember</code>ing\n           * @type Boolean\n           */\n          useLocalStorage: {\n\n            get: function() {\n              return use_local_storage;\n            },\n            set: function(bool) {\n              if (SUPPORTS_LOCAL_STORAGE) {\n                use_local_storage = bool;\n                if (bool) {\n                  dom.bind(window, 'unload', saveToLocalStorage);\n                } else {\n                  dom.unbind(window, 'unload', saveToLocalStorage);\n                }\n                localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\n              }\n            }\n\n          }\n\n        });\n\n    // Are we a root level GUI?\n    if (common.isUndefined(params.parent)) {\n\n      params.closed = false;\n\n      dom.addClass(this.domElement, GUI.CLASS_MAIN);\n      dom.makeSelectable(this.domElement, false);\n\n      // Are we supposed to be loading locally?\n      if (SUPPORTS_LOCAL_STORAGE) {\n\n        if (use_local_storage) {\n\n          _this.useLocalStorage = true;\n\n          var saved_gui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\n\n          if (saved_gui) {\n            params.load = JSON.parse(saved_gui);\n          }\n\n        }\n\n      }\n\n      this.__closeButton = document.createElement('div');\n      this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\n      this.domElement.appendChild(this.__closeButton);\n\n      dom.bind(this.__closeButton, 'click', function() {\n\n        _this.closed = !_this.closed;\n\n\n      });\n\n\n      // Oh, you're a nested GUI!\n    } else {\n\n      if (params.closed === undefined) {\n        params.closed = true;\n      }\n\n      var title_row_name = document.createTextNode(params.name);\n      dom.addClass(title_row_name, 'controller-name');\n\n      var title_row = addRow(_this, title_row_name);\n\n      var on_click_title = function(e) {\n        e.preventDefault();\n        _this.closed = !_this.closed;\n        return false;\n      };\n\n      dom.addClass(this.__ul, GUI.CLASS_CLOSED);\n\n      dom.addClass(title_row, 'title');\n      dom.bind(title_row, 'click', on_click_title);\n\n      if (!params.closed) {\n        this.closed = false;\n      }\n\n    }\n\n    if (params.autoPlace) {\n\n      if (common.isUndefined(params.parent)) {\n\n        if (auto_place_virgin) {\n          auto_place_container = document.createElement('div');\n          dom.addClass(auto_place_container, CSS_NAMESPACE);\n          dom.addClass(auto_place_container, GUI.CLASS_AUTO_PLACE_CONTAINER);\n          document.body.appendChild(auto_place_container);\n          auto_place_virgin = false;\n        }\n\n        // Put it in the dom for you.\n        auto_place_container.appendChild(this.domElement);\n\n        // Apply the auto styles\n        dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\n\n      }\n\n\n      // Make it not elastic.\n      if (!this.parent) setWidth(_this, params.width);\n\n    }\n\n    dom.bind(window, 'resize', function() { _this.onResize() });\n    dom.bind(this.__ul, 'webkitTransitionEnd', function() { _this.onResize(); });\n    dom.bind(this.__ul, 'transitionend', function() { _this.onResize() });\n    dom.bind(this.__ul, 'oTransitionEnd', function() { _this.onResize() });\n    this.onResize();\n\n\n    if (params.resizable) {\n      addResizeHandle(this);\n    }\n\n    function saveToLocalStorage() {\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\n    }\n\n    var root = _this.getRoot();\n    function resetWidth() {\n        var root = _this.getRoot();\n        root.width += 1;\n        common.defer(function() {\n          root.width -= 1;\n        });\n      }\n\n      if (!params.parent) {\n        resetWidth();\n      }\n\n  };\n\n  GUI.toggleHide = function() {\n\n    hide = !hide;\n    common.each(hideable_guis, function(gui) {\n      gui.domElement.style.zIndex = hide ? -999 : 999;\n      gui.domElement.style.opacity = hide ? 0 : 1;\n    });\n  };\n\n  GUI.CLASS_AUTO_PLACE = 'a';\n  GUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\n  GUI.CLASS_MAIN = 'main';\n  GUI.CLASS_CONTROLLER_ROW = 'cr';\n  GUI.CLASS_TOO_TALL = 'taller-than-window';\n  GUI.CLASS_CLOSED = 'closed';\n  GUI.CLASS_CLOSE_BUTTON = 'close-button';\n  GUI.CLASS_DRAG = 'drag';\n\n  GUI.DEFAULT_WIDTH = 245;\n  GUI.TEXT_CLOSED = 'Close Controls';\n  GUI.TEXT_OPEN = 'Open Controls';\n\n  dom.bind(window, 'keydown', function(e) {\n\n    if (document.activeElement.type !== 'text' &&\n        (e.which === HIDE_KEY_CODE || e.keyCode == HIDE_KEY_CODE)) {\n      GUI.toggleHide();\n    }\n\n  }, false);\n\n  common.extend(\n\n      GUI.prototype,\n\n      /** @lends dat.gui.GUI */\n      {\n\n        /**\n         * @param object\n         * @param property\n         * @returns {dat.controllers.Controller} The new controller that was added.\n         * @instance\n         */\n        add: function(object, property) {\n\n          return add(\n              this,\n              object,\n              property,\n              {\n                factoryArgs: Array.prototype.slice.call(arguments, 2)\n              }\n          );\n\n        },\n\n        /**\n         * @param object\n         * @param property\n         * @returns {dat.controllers.ColorController} The new controller that was added.\n         * @instance\n         */\n        addColor: function(object, property) {\n\n          return add(\n              this,\n              object,\n              property,\n              {\n                color: true\n              }\n          );\n\n        },\n\n        /**\n         * @param controller\n         * @instance\n         */\n        remove: function(controller) {\n\n          // TODO listening?\n          this.__ul.removeChild(controller.__li);\n          this.__controllers.slice(this.__controllers.indexOf(controller), 1);\n          var _this = this;\n          common.defer(function() {\n            _this.onResize();\n          });\n\n        },\n\n        destroy: function() {\n\n          if (this.autoPlace) {\n            auto_place_container.removeChild(this.domElement);\n          }\n\n        },\n\n        /**\n         * @param name\n         * @returns {dat.gui.GUI} The new folder.\n         * @throws {Error} if this GUI already has a folder by the specified\n         * name\n         * @instance\n         */\n        addFolder: function(name) {\n\n          // We have to prevent collisions on names in order to have a key\n          // by which to remember saved values\n          if (this.__folders[name] !== undefined) {\n            throw new Error('You already have a folder in this GUI by the' +\n                ' name \"' + name + '\"');\n          }\n\n          var new_gui_params = { name: name, parent: this };\n\n          // We need to pass down the autoPlace trait so that we can\n          // attach event listeners to open/close folder actions to\n          // ensure that a scrollbar appears if the window is too short.\n          new_gui_params.autoPlace = this.autoPlace;\n\n          // Do we have saved appearance data for this folder?\n\n          if (this.load && // Anything loaded?\n              this.load.folders && // Was my parent a dead-end?\n              this.load.folders[name]) { // Did daddy remember me?\n\n            // Start me closed if I was closed\n            new_gui_params.closed = this.load.folders[name].closed;\n\n            // Pass down the loaded data\n            new_gui_params.load = this.load.folders[name];\n\n          }\n\n          var gui = new GUI(new_gui_params);\n          this.__folders[name] = gui;\n\n          var li = addRow(this, gui.domElement);\n          dom.addClass(li, 'folder');\n          return gui;\n\n        },\n\n        open: function() {\n          this.closed = false;\n        },\n\n        close: function() {\n          this.closed = true;\n        },\n\n        onResize: function() {\n\n          var root = this.getRoot();\n\n          if (root.scrollable) {\n\n            var top = dom.getOffset(root.__ul).top;\n            var h = 0;\n\n            common.each(root.__ul.childNodes, function(node) {\n              if (! (root.autoPlace && node === root.__save_row))\n                h += dom.getHeight(node);\n            });\n\n            if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\n              dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\n              root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\n            } else {\n              dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\n              root.__ul.style.height = 'auto';\n            }\n\n          }\n\n          if (root.__resize_handle) {\n            common.defer(function() {\n              root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\n            });\n          }\n\n          if (root.__closeButton) {\n            root.__closeButton.style.width = root.width + 'px';\n          }\n\n        },\n\n        /**\n         * Mark objects for saving. The order of these objects cannot change as\n         * the GUI grows. When remembering new objects, append them to the end\n         * of the list.\n         *\n         * @param {Object...} objects\n         * @throws {Error} if not called on a top level GUI.\n         * @instance\n         */\n        remember: function() {\n\n          if (common.isUndefined(SAVE_DIALOGUE)) {\n            SAVE_DIALOGUE = new CenteredDiv();\n            SAVE_DIALOGUE.domElement.innerHTML = saveDialogueContents;\n          }\n\n          if (this.parent) {\n            throw new Error(\"You can only call remember on a top level GUI.\");\n          }\n\n          var _this = this;\n\n          common.each(Array.prototype.slice.call(arguments), function(object) {\n            if (_this.__rememberedObjects.length == 0) {\n              addSaveMenu(_this);\n            }\n            if (_this.__rememberedObjects.indexOf(object) == -1) {\n              _this.__rememberedObjects.push(object);\n            }\n          });\n\n          if (this.autoPlace) {\n            // Set save row width\n            setWidth(this, this.width);\n          }\n\n        },\n\n        /**\n         * @returns {dat.gui.GUI} the topmost parent GUI of a nested GUI.\n         * @instance\n         */\n        getRoot: function() {\n          var gui = this;\n          while (gui.parent) {\n            gui = gui.parent;\n          }\n          return gui;\n        },\n\n        /**\n         * @returns {Object} a JSON object representing the current state of\n         * this GUI as well as its remembered properties.\n         * @instance\n         */\n        getSaveObject: function() {\n\n          var toReturn = this.load;\n\n          toReturn.closed = this.closed;\n\n          // Am I remembering any values?\n          if (this.__rememberedObjects.length > 0) {\n\n            toReturn.preset = this.preset;\n\n            if (!toReturn.remembered) {\n              toReturn.remembered = {};\n            }\n\n            toReturn.remembered[this.preset] = getCurrentPreset(this);\n\n          }\n\n          toReturn.folders = {};\n          common.each(this.__folders, function(element, key) {\n            toReturn.folders[key] = element.getSaveObject();\n          });\n\n          return toReturn;\n\n        },\n\n        save: function() {\n\n          if (!this.load.remembered) {\n            this.load.remembered = {};\n          }\n\n          this.load.remembered[this.preset] = getCurrentPreset(this);\n          markPresetModified(this, false);\n\n        },\n\n        saveAs: function(presetName) {\n\n          if (!this.load.remembered) {\n\n            // Retain default values upon first save\n            this.load.remembered = {};\n            this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\n\n          }\n\n          this.load.remembered[presetName] = getCurrentPreset(this);\n          this.preset = presetName;\n          addPresetOption(this, presetName, true);\n\n        },\n\n        revert: function(gui) {\n\n          common.each(this.__controllers, function(controller) {\n            // Make revert work on Default.\n            if (!this.getRoot().load.remembered) {\n              controller.setValue(controller.initialValue);\n            } else {\n              recallSavedValue(gui || this.getRoot(), controller);\n            }\n          }, this);\n\n          common.each(this.__folders, function(folder) {\n            folder.revert(folder);\n          });\n\n          if (!gui) {\n            markPresetModified(this.getRoot(), false);\n          }\n\n\n        },\n\n        listen: function(controller) {\n\n          var init = this.__listening.length == 0;\n          this.__listening.push(controller);\n          if (init) updateDisplays(this.__listening);\n\n        }\n\n      }\n\n  );\n\n  function add(gui, object, property, params) {\n\n    if (object[property] === undefined) {\n      throw new Error(\"Object \" + object + \" has no property \\\"\" + property + \"\\\"\");\n    }\n\n    var controller;\n\n    if (params.color) {\n\n      controller = new ColorController(object, property);\n\n    } else {\n\n      var factoryArgs = [object,property].concat(params.factoryArgs);\n      controller = controllerFactory.apply(gui, factoryArgs);\n\n    }\n\n    if (params.before instanceof Controller) {\n      params.before = params.before.__li;\n    }\n\n    recallSavedValue(gui, controller);\n\n    dom.addClass(controller.domElement, 'c');\n\n    var name = document.createElement('span');\n    dom.addClass(name, 'property-name');\n    name.innerHTML = controller.property;\n\n    var container = document.createElement('div');\n    container.appendChild(name);\n    container.appendChild(controller.domElement);\n\n    var li = addRow(gui, container, params.before);\n\n    dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\n    dom.addClass(li, typeof controller.getValue());\n\n    augmentController(gui, li, controller);\n\n    gui.__controllers.push(controller);\n\n    return controller;\n\n  }\n\n  /**\n   * Add a row to the end of the GUI or before another row.\n   *\n   * @param gui\n   * @param [dom] If specified, inserts the dom content in the new row\n   * @param [liBefore] If specified, places the new row before another row\n   */\n  function addRow(gui, dom, liBefore) {\n    var li = document.createElement('li');\n    if (dom) li.appendChild(dom);\n    if (liBefore) {\n      gui.__ul.insertBefore(li, params.before);\n    } else {\n      gui.__ul.appendChild(li);\n    }\n    gui.onResize();\n    return li;\n  }\n\n  function augmentController(gui, li, controller) {\n\n    controller.__li = li;\n    controller.__gui = gui;\n\n    common.extend(controller, {\n\n      options: function(options) {\n\n        if (arguments.length > 1) {\n          controller.remove();\n\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [common.toArray(arguments)]\n              }\n          );\n\n        }\n\n        if (common.isArray(options) || common.isObject(options)) {\n          controller.remove();\n\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [options]\n              }\n          );\n\n        }\n\n      },\n\n      name: function(v) {\n        controller.__li.firstElementChild.firstElementChild.innerHTML = v;\n        return controller;\n      },\n\n      listen: function() {\n        controller.__gui.listen(controller);\n        return controller;\n      },\n\n      remove: function() {\n        controller.__gui.remove(controller);\n        return controller;\n      }\n\n    });\n\n    // All sliders should be accompanied by a box.\n    if (controller instanceof NumberControllerSlider) {\n\n      var box = new NumberControllerBox(controller.object, controller.property,\n          { min: controller.__min, max: controller.__max, step: controller.__step });\n\n      common.each(['updateDisplay', 'onChange', 'onFinishChange'], function(method) {\n        var pc = controller[method];\n        var pb = box[method];\n        controller[method] = box[method] = function() {\n          var args = Array.prototype.slice.call(arguments);\n          pc.apply(controller, args);\n          return pb.apply(box, args);\n        }\n      });\n\n      dom.addClass(li, 'has-slider');\n      controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\n\n    }\n    else if (controller instanceof NumberControllerBox) {\n\n      var r = function(returned) {\n\n        // Have we defined both boundaries?\n        if (common.isNumber(controller.__min) && common.isNumber(controller.__max)) {\n\n          // Well, then lets just replace this with a slider.\n          controller.remove();\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [controller.__min, controller.__max, controller.__step]\n              });\n\n        }\n\n        return returned;\n\n      };\n\n      controller.min = common.compose(r, controller.min);\n      controller.max = common.compose(r, controller.max);\n\n    }\n    else if (controller instanceof BooleanController) {\n\n      dom.bind(li, 'click', function() {\n        dom.fakeEvent(controller.__checkbox, 'click');\n      });\n\n      dom.bind(controller.__checkbox, 'click', function(e) {\n        e.stopPropagation(); // Prevents double-toggle\n      })\n\n    }\n    else if (controller instanceof FunctionController) {\n\n      dom.bind(li, 'click', function() {\n        dom.fakeEvent(controller.__button, 'click');\n      });\n\n      dom.bind(li, 'mouseover', function() {\n        dom.addClass(controller.__button, 'hover');\n      });\n\n      dom.bind(li, 'mouseout', function() {\n        dom.removeClass(controller.__button, 'hover');\n      });\n\n    }\n    else if (controller instanceof ColorController) {\n\n      dom.addClass(li, 'color');\n      controller.updateDisplay = common.compose(function(r) {\n        li.style.borderLeftColor = controller.__color.toString();\n        return r;\n      }, controller.updateDisplay);\n\n      controller.updateDisplay();\n\n    }\n\n    controller.setValue = common.compose(function(r) {\n      if (gui.getRoot().__preset_select && controller.isModified()) {\n        markPresetModified(gui.getRoot(), true);\n      }\n      return r;\n    }, controller.setValue);\n\n  }\n\n  function recallSavedValue(gui, controller) {\n\n    // Find the topmost GUI, that's where remembered objects live.\n    var root = gui.getRoot();\n\n    // Does the object we're controlling match anything we've been told to\n    // remember?\n    var matched_index = root.__rememberedObjects.indexOf(controller.object);\n\n    // Why yes, it does!\n    if (matched_index != -1) {\n\n      // Let me fetch a map of controllers for thcommon.isObject.\n      var controller_map =\n          root.__rememberedObjectIndecesToControllers[matched_index];\n\n      // Ohp, I believe this is the first controller we've created for this\n      // object. Lets make the map fresh.\n      if (controller_map === undefined) {\n        controller_map = {};\n        root.__rememberedObjectIndecesToControllers[matched_index] =\n            controller_map;\n      }\n\n      // Keep track of this controller\n      controller_map[controller.property] = controller;\n\n      // Okay, now have we saved any values for this controller?\n      if (root.load && root.load.remembered) {\n\n        var preset_map = root.load.remembered;\n\n        // Which preset are we trying to load?\n        var preset;\n\n        if (preset_map[gui.preset]) {\n\n          preset = preset_map[gui.preset];\n\n        } else if (preset_map[DEFAULT_DEFAULT_PRESET_NAME]) {\n\n          // Uhh, you can have the default instead?\n          preset = preset_map[DEFAULT_DEFAULT_PRESET_NAME];\n\n        } else {\n\n          // Nada.\n\n          return;\n\n        }\n\n\n        // Did the loaded object remember thcommon.isObject?\n        if (preset[matched_index] &&\n\n          // Did we remember this particular property?\n            preset[matched_index][controller.property] !== undefined) {\n\n          // We did remember something for this guy ...\n          var value = preset[matched_index][controller.property];\n\n          // And that's what it is.\n          controller.initialValue = value;\n          controller.setValue(value);\n\n        }\n\n      }\n\n    }\n\n  }\n\n  function getLocalStorageHash(gui, key) {\n    // TODO how does this deal with multiple GUI's?\n    return document.location.href + '.' + key;\n\n  }\n\n  function addSaveMenu(gui) {\n\n    var div = gui.__save_row = document.createElement('li');\n\n    dom.addClass(gui.domElement, 'has-save');\n\n    gui.__ul.insertBefore(div, gui.__ul.firstChild);\n\n    dom.addClass(div, 'save-row');\n\n    var gears = document.createElement('span');\n    gears.innerHTML = '&nbsp;';\n    dom.addClass(gears, 'button gears');\n\n    // TODO replace with FunctionController\n    var button = document.createElement('span');\n    button.innerHTML = 'Save';\n    dom.addClass(button, 'button');\n    dom.addClass(button, 'save');\n\n    var button2 = document.createElement('span');\n    button2.innerHTML = 'New';\n    dom.addClass(button2, 'button');\n    dom.addClass(button2, 'save-as');\n\n    var button3 = document.createElement('span');\n    button3.innerHTML = 'Revert';\n    dom.addClass(button3, 'button');\n    dom.addClass(button3, 'revert');\n\n    var select = gui.__preset_select = document.createElement('select');\n\n    if (gui.load && gui.load.remembered) {\n\n      common.each(gui.load.remembered, function(value, key) {\n        addPresetOption(gui, key, key == gui.preset);\n      });\n\n    } else {\n      addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\n    }\n\n    dom.bind(select, 'change', function() {\n\n\n      for (var index = 0; index < gui.__preset_select.length; index++) {\n        gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\n      }\n\n      gui.preset = this.value;\n\n    });\n\n    div.appendChild(select);\n    div.appendChild(gears);\n    div.appendChild(button);\n    div.appendChild(button2);\n    div.appendChild(button3);\n\n    if (SUPPORTS_LOCAL_STORAGE) {\n\n      var saveLocally = document.getElementById('dg-save-locally');\n      var explain = document.getElementById('dg-local-explain');\n\n      saveLocally.style.display = 'block';\n\n      var localStorageCheckBox = document.getElementById('dg-local-storage');\n\n      if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\n        localStorageCheckBox.setAttribute('checked', 'checked');\n      }\n\n      function showHideExplain() {\n        explain.style.display = gui.useLocalStorage ? 'block' : 'none';\n      }\n\n      showHideExplain();\n\n      // TODO: Use a boolean controller, fool!\n      dom.bind(localStorageCheckBox, 'change', function() {\n        gui.useLocalStorage = !gui.useLocalStorage;\n        showHideExplain();\n      });\n\n    }\n\n    var newConstructorTextArea = document.getElementById('dg-new-constructor');\n\n    dom.bind(newConstructorTextArea, 'keydown', function(e) {\n      if (e.metaKey && (e.which === 67 || e.keyCode == 67)) {\n        SAVE_DIALOGUE.hide();\n      }\n    });\n\n    dom.bind(gears, 'click', function() {\n      newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\n      SAVE_DIALOGUE.show();\n      newConstructorTextArea.focus();\n      newConstructorTextArea.select();\n    });\n\n    dom.bind(button, 'click', function() {\n      gui.save();\n    });\n\n    dom.bind(button2, 'click', function() {\n      var presetName = prompt('Enter a new preset name.');\n      if (presetName) gui.saveAs(presetName);\n    });\n\n    dom.bind(button3, 'click', function() {\n      gui.revert();\n    });\n\n//    div.appendChild(button2);\n\n  }\n\n  function addResizeHandle(gui) {\n\n    gui.__resize_handle = document.createElement('div');\n\n    common.extend(gui.__resize_handle.style, {\n\n      width: '6px',\n      marginLeft: '-3px',\n      height: '200px',\n      cursor: 'ew-resize',\n      position: 'absolute'\n//      border: '1px solid blue'\n\n    });\n\n    var pmouseX;\n\n    dom.bind(gui.__resize_handle, 'mousedown', dragStart);\n    dom.bind(gui.__closeButton, 'mousedown', dragStart);\n\n    gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\n\n    function dragStart(e) {\n\n      e.preventDefault();\n\n      pmouseX = e.clientX;\n\n      dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\n      dom.bind(window, 'mousemove', drag);\n      dom.bind(window, 'mouseup', dragStop);\n\n      return false;\n\n    }\n\n    function drag(e) {\n\n      e.preventDefault();\n\n      gui.width += pmouseX - e.clientX;\n      gui.onResize();\n      pmouseX = e.clientX;\n\n      return false;\n\n    }\n\n    function dragStop() {\n\n      dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\n      dom.unbind(window, 'mousemove', drag);\n      dom.unbind(window, 'mouseup', dragStop);\n\n    }\n\n  }\n\n  function setWidth(gui, w) {\n    gui.domElement.style.width = w + 'px';\n    // Auto placed save-rows are position fixed, so we have to\n    // set the width manually if we want it to bleed to the edge\n    if (gui.__save_row && gui.autoPlace) {\n      gui.__save_row.style.width = w + 'px';\n    }if (gui.__closeButton) {\n      gui.__closeButton.style.width = w + 'px';\n    }\n  }\n\n  function getCurrentPreset(gui, useInitialValues) {\n\n    var toReturn = {};\n\n    // For each object I'm remembering\n    common.each(gui.__rememberedObjects, function(val, index) {\n\n      var saved_values = {};\n\n      // The controllers I've made for thcommon.isObject by property\n      var controller_map =\n          gui.__rememberedObjectIndecesToControllers[index];\n\n      // Remember each value for each property\n      common.each(controller_map, function(controller, property) {\n        saved_values[property] = useInitialValues ? controller.initialValue : controller.getValue();\n      });\n\n      // Save the values for thcommon.isObject\n      toReturn[index] = saved_values;\n\n    });\n\n    return toReturn;\n\n  }\n\n  function addPresetOption(gui, name, setSelected) {\n    var opt = document.createElement('option');\n    opt.innerHTML = name;\n    opt.value = name;\n    gui.__preset_select.appendChild(opt);\n    if (setSelected) {\n      gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\n    }\n  }\n\n  function setPresetSelectIndex(gui) {\n    for (var index = 0; index < gui.__preset_select.length; index++) {\n      if (gui.__preset_select[index].value == gui.preset) {\n        gui.__preset_select.selectedIndex = index;\n      }\n    }\n  }\n\n  function markPresetModified(gui, modified) {\n    var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n//    console.log('mark', modified, opt);\n    if (modified) {\n      opt.innerHTML = opt.value + \"*\";\n    } else {\n      opt.innerHTML = opt.value;\n    }\n  }\n\n  function updateDisplays(controllerArray) {\n\n\n    if (controllerArray.length != 0) {\n\n      requestAnimationFrame(function() {\n        updateDisplays(controllerArray);\n      });\n\n    }\n\n    common.each(controllerArray, function(c) {\n      c.updateDisplay();\n    });\n\n  }\n\n  return GUI;\n\n})(dat.utils.css,\n\"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n      \\n    </div>\\n    \\n  </div>\\n\\n</div>\",\n\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\",\ndat.controllers.factory = (function (OptionController, NumberControllerBox, NumberControllerSlider, StringController, FunctionController, BooleanController, common) {\n\n      return function(object, property) {\n\n        var initialValue = object[property];\n\n        // Providing options?\n        if (common.isArray(arguments[2]) || common.isObject(arguments[2])) {\n          return new OptionController(object, property, arguments[2]);\n        }\n\n        // Providing a map?\n\n        if (common.isNumber(initialValue)) {\n\n          if (common.isNumber(arguments[2]) && common.isNumber(arguments[3])) {\n\n            // Has min and max.\n            return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\n\n          } else {\n\n            return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\n\n          }\n\n        }\n\n        if (common.isString(initialValue)) {\n          return new StringController(object, property);\n        }\n\n        if (common.isFunction(initialValue)) {\n          return new FunctionController(object, property, '');\n        }\n\n        if (common.isBoolean(initialValue)) {\n          return new BooleanController(object, property);\n        }\n\n      }\n\n    })(dat.controllers.OptionController,\ndat.controllers.NumberControllerBox,\ndat.controllers.NumberControllerSlider,\ndat.controllers.StringController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a text input to alter the string property of an object.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var StringController = function(object, property) {\n\n    StringController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    this.__input = document.createElement('input');\n    this.__input.setAttribute('type', 'text');\n\n    dom.bind(this.__input, 'keyup', onChange);\n    dom.bind(this.__input, 'change', onChange);\n    dom.bind(this.__input, 'blur', onBlur);\n    dom.bind(this.__input, 'keydown', function(e) {\n      if (e.keyCode === 13) {\n        this.blur();\n      }\n    });\n    \n\n    function onChange() {\n      _this.setValue(_this.__input.value);\n    }\n\n    function onBlur() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    this.updateDisplay();\n\n    this.domElement.appendChild(this.__input);\n\n  };\n\n  StringController.superclass = Controller;\n\n  common.extend(\n\n      StringController.prototype,\n      Controller.prototype,\n\n      {\n\n        updateDisplay: function() {\n          // Stops the caret from moving on account of:\n          // keyup -> setValue -> updateDisplay\n          if (!dom.isActive(this.__input)) {\n            this.__input.value = this.getValue();\n          }\n          return StringController.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  return StringController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common),\ndat.controllers.FunctionController,\ndat.controllers.BooleanController,\ndat.utils.common),\ndat.controllers.Controller,\ndat.controllers.BooleanController,\ndat.controllers.FunctionController,\ndat.controllers.NumberControllerBox,\ndat.controllers.NumberControllerSlider,\ndat.controllers.OptionController,\ndat.controllers.ColorController = (function (Controller, dom, Color, interpret, common) {\n\n  var ColorController = function(object, property) {\n\n    ColorController.superclass.call(this, object, property);\n\n    this.__color = new Color(this.getValue());\n    this.__temp = new Color(0);\n\n    var _this = this;\n\n    this.domElement = document.createElement('div');\n\n    dom.makeSelectable(this.domElement, false);\n\n    this.__selector = document.createElement('div');\n    this.__selector.className = 'selector';\n\n    this.__saturation_field = document.createElement('div');\n    this.__saturation_field.className = 'saturation-field';\n\n    this.__field_knob = document.createElement('div');\n    this.__field_knob.className = 'field-knob';\n    this.__field_knob_border = '2px solid ';\n\n    this.__hue_knob = document.createElement('div');\n    this.__hue_knob.className = 'hue-knob';\n\n    this.__hue_field = document.createElement('div');\n    this.__hue_field.className = 'hue-field';\n\n    this.__input = document.createElement('input');\n    this.__input.type = 'text';\n    this.__input_textShadow = '0 1px 1px ';\n\n    dom.bind(this.__input, 'keydown', function(e) {\n      if (e.keyCode === 13) { // on enter\n        onBlur.call(this);\n      }\n    });\n\n    dom.bind(this.__input, 'blur', onBlur);\n\n    dom.bind(this.__selector, 'mousedown', function(e) {\n\n      dom\n        .addClass(this, 'drag')\n        .bind(window, 'mouseup', function(e) {\n          dom.removeClass(_this.__selector, 'drag');\n        });\n\n    });\n\n    var value_field = document.createElement('div');\n\n    common.extend(this.__selector.style, {\n      width: '122px',\n      height: '102px',\n      padding: '3px',\n      backgroundColor: '#222',\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\n    });\n\n    common.extend(this.__field_knob.style, {\n      position: 'absolute',\n      width: '12px',\n      height: '12px',\n      border: this.__field_knob_border + (this.__color.v < .5 ? '#fff' : '#000'),\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\n      borderRadius: '12px',\n      zIndex: 1\n    });\n    \n    common.extend(this.__hue_knob.style, {\n      position: 'absolute',\n      width: '15px',\n      height: '2px',\n      borderRight: '4px solid #fff',\n      zIndex: 1\n    });\n\n    common.extend(this.__saturation_field.style, {\n      width: '100px',\n      height: '100px',\n      border: '1px solid #555',\n      marginRight: '3px',\n      display: 'inline-block',\n      cursor: 'pointer'\n    });\n\n    common.extend(value_field.style, {\n      width: '100%',\n      height: '100%',\n      background: 'none'\n    });\n    \n    linearGradient(value_field, 'top', 'rgba(0,0,0,0)', '#000');\n\n    common.extend(this.__hue_field.style, {\n      width: '15px',\n      height: '100px',\n      display: 'inline-block',\n      border: '1px solid #555',\n      cursor: 'ns-resize'\n    });\n\n    hueGradient(this.__hue_field);\n\n    common.extend(this.__input.style, {\n      outline: 'none',\n//      width: '120px',\n      textAlign: 'center',\n//      padding: '4px',\n//      marginBottom: '6px',\n      color: '#fff',\n      border: 0,\n      fontWeight: 'bold',\n      textShadow: this.__input_textShadow + 'rgba(0,0,0,0.7)'\n    });\n\n    dom.bind(this.__saturation_field, 'mousedown', fieldDown);\n    dom.bind(this.__field_knob, 'mousedown', fieldDown);\n\n    dom.bind(this.__hue_field, 'mousedown', function(e) {\n      setH(e);\n      dom.bind(window, 'mousemove', setH);\n      dom.bind(window, 'mouseup', unbindH);\n    });\n\n    function fieldDown(e) {\n      setSV(e);\n      // document.body.style.cursor = 'none';\n      dom.bind(window, 'mousemove', setSV);\n      dom.bind(window, 'mouseup', unbindSV);\n    }\n\n    function unbindSV() {\n      dom.unbind(window, 'mousemove', setSV);\n      dom.unbind(window, 'mouseup', unbindSV);\n      // document.body.style.cursor = 'default';\n    }\n\n    function onBlur() {\n      var i = interpret(this.value);\n      if (i !== false) {\n        _this.__color.__state = i;\n        _this.setValue(_this.__color.toOriginal());\n      } else {\n        this.value = _this.__color.toString();\n      }\n    }\n\n    function unbindH() {\n      dom.unbind(window, 'mousemove', setH);\n      dom.unbind(window, 'mouseup', unbindH);\n    }\n\n    this.__saturation_field.appendChild(value_field);\n    this.__selector.appendChild(this.__field_knob);\n    this.__selector.appendChild(this.__saturation_field);\n    this.__selector.appendChild(this.__hue_field);\n    this.__hue_field.appendChild(this.__hue_knob);\n\n    this.domElement.appendChild(this.__input);\n    this.domElement.appendChild(this.__selector);\n\n    this.updateDisplay();\n\n    function setSV(e) {\n\n      e.preventDefault();\n\n      var w = dom.getWidth(_this.__saturation_field);\n      var o = dom.getOffset(_this.__saturation_field);\n      var s = (e.clientX - o.left + document.body.scrollLeft) / w;\n      var v = 1 - (e.clientY - o.top + document.body.scrollTop) / w;\n\n      if (v > 1) v = 1;\n      else if (v < 0) v = 0;\n\n      if (s > 1) s = 1;\n      else if (s < 0) s = 0;\n\n      _this.__color.v = v;\n      _this.__color.s = s;\n\n      _this.setValue(_this.__color.toOriginal());\n\n\n      return false;\n\n    }\n\n    function setH(e) {\n\n      e.preventDefault();\n\n      var s = dom.getHeight(_this.__hue_field);\n      var o = dom.getOffset(_this.__hue_field);\n      var h = 1 - (e.clientY - o.top + document.body.scrollTop) / s;\n\n      if (h > 1) h = 1;\n      else if (h < 0) h = 0;\n\n      _this.__color.h = h * 360;\n\n      _this.setValue(_this.__color.toOriginal());\n\n      return false;\n\n    }\n\n  };\n\n  ColorController.superclass = Controller;\n\n  common.extend(\n\n      ColorController.prototype,\n      Controller.prototype,\n\n      {\n\n        updateDisplay: function() {\n\n          var i = interpret(this.getValue());\n\n          if (i !== false) {\n\n            var mismatch = false;\n\n            // Check for mismatch on the interpreted value.\n\n            common.each(Color.COMPONENTS, function(component) {\n              if (!common.isUndefined(i[component]) &&\n                  !common.isUndefined(this.__color.__state[component]) &&\n                  i[component] !== this.__color.__state[component]) {\n                mismatch = true;\n                return {}; // break\n              }\n            }, this);\n\n            // If nothing diverges, we keep our previous values\n            // for statefulness, otherwise we recalculate fresh\n            if (mismatch) {\n              common.extend(this.__color.__state, i);\n            }\n\n          }\n\n          common.extend(this.__temp.__state, this.__color.__state);\n\n          this.__temp.a = 1;\n\n          var flip = (this.__color.v < .5 || this.__color.s > .5) ? 255 : 0;\n          var _flip = 255 - flip;\n\n          common.extend(this.__field_knob.style, {\n            marginLeft: 100 * this.__color.s - 7 + 'px',\n            marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\n            backgroundColor: this.__temp.toString(),\n            border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip +')'\n          });\n\n          this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px'\n\n          this.__temp.s = 1;\n          this.__temp.v = 1;\n\n          linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toString());\n\n          common.extend(this.__input.style, {\n            backgroundColor: this.__input.value = this.__color.toString(),\n            color: 'rgb(' + flip + ',' + flip + ',' + flip +')',\n            textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip +',.7)'\n          });\n\n        }\n\n      }\n\n  );\n  \n  var vendors = ['-moz-','-o-','-webkit-','-ms-',''];\n  \n  function linearGradient(elem, x, a, b) {\n    elem.style.background = '';\n    common.each(vendors, function(vendor) {\n      elem.style.cssText += 'background: ' + vendor + 'linear-gradient('+x+', '+a+' 0%, ' + b + ' 100%); ';\n    });\n  }\n  \n  function hueGradient(elem) {\n    elem.style.background = '';\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);'\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n  }\n\n\n  return ColorController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.color.Color = (function (interpret, math, toString, common) {\n\n  var Color = function() {\n\n    this.__state = interpret.apply(this, arguments);\n\n    if (this.__state === false) {\n      throw 'Failed to interpret color arguments';\n    }\n\n    this.__state.a = this.__state.a || 1;\n\n\n  };\n\n  Color.COMPONENTS = ['r','g','b','h','s','v','hex','a'];\n\n  common.extend(Color.prototype, {\n\n    toString: function() {\n      return toString(this);\n    },\n\n    toOriginal: function() {\n      return this.__state.conversion.write(this);\n    }\n\n  });\n\n  defineRGBComponent(Color.prototype, 'r', 2);\n  defineRGBComponent(Color.prototype, 'g', 1);\n  defineRGBComponent(Color.prototype, 'b', 0);\n\n  defineHSVComponent(Color.prototype, 'h');\n  defineHSVComponent(Color.prototype, 's');\n  defineHSVComponent(Color.prototype, 'v');\n\n  Object.defineProperty(Color.prototype, 'a', {\n\n    get: function() {\n      return this.__state.a;\n    },\n\n    set: function(v) {\n      this.__state.a = v;\n    }\n\n  });\n\n  Object.defineProperty(Color.prototype, 'hex', {\n\n    get: function() {\n\n      if (!this.__state.space !== 'HEX') {\n        this.__state.hex = math.rgb_to_hex(this.r, this.g, this.b);\n      }\n\n      return this.__state.hex;\n\n    },\n\n    set: function(v) {\n\n      this.__state.space = 'HEX';\n      this.__state.hex = v;\n\n    }\n\n  });\n\n  function defineRGBComponent(target, component, componentHexIndex) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'RGB') {\n          return this.__state[component];\n        }\n\n        recalculateRGB(this, component, componentHexIndex);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'RGB') {\n          recalculateRGB(this, component, componentHexIndex);\n          this.__state.space = 'RGB';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function defineHSVComponent(target, component) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'HSV')\n          return this.__state[component];\n\n        recalculateHSV(this);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'HSV') {\n          recalculateHSV(this);\n          this.__state.space = 'HSV';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function recalculateRGB(color, component, componentHexIndex) {\n\n    if (color.__state.space === 'HEX') {\n\n      color.__state[component] = math.component_from_hex(color.__state.hex, componentHexIndex);\n\n    } else if (color.__state.space === 'HSV') {\n\n      common.extend(color.__state, math.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n\n    } else {\n\n      throw 'Corrupted color state';\n\n    }\n\n  }\n\n  function recalculateHSV(color) {\n\n    var result = math.rgb_to_hsv(color.r, color.g, color.b);\n\n    common.extend(color.__state,\n        {\n          s: result.s,\n          v: result.v\n        }\n    );\n\n    if (!common.isNaN(result.h)) {\n      color.__state.h = result.h;\n    } else if (common.isUndefined(color.__state.h)) {\n      color.__state.h = 0;\n    }\n\n  }\n\n  return Color;\n\n})(dat.color.interpret,\ndat.color.math = (function () {\n\n  var tmpComponent;\n\n  return {\n\n    hsv_to_rgb: function(h, s, v) {\n\n      var hi = Math.floor(h / 60) % 6;\n\n      var f = h / 60 - Math.floor(h / 60);\n      var p = v * (1.0 - s);\n      var q = v * (1.0 - (f * s));\n      var t = v * (1.0 - ((1.0 - f) * s));\n      var c = [\n        [v, t, p],\n        [q, v, p],\n        [p, v, t],\n        [p, q, v],\n        [t, p, v],\n        [v, p, q]\n      ][hi];\n\n      return {\n        r: c[0] * 255,\n        g: c[1] * 255,\n        b: c[2] * 255\n      };\n\n    },\n\n    rgb_to_hsv: function(r, g, b) {\n\n      var min = Math.min(r, g, b),\n          max = Math.max(r, g, b),\n          delta = max - min,\n          h, s;\n\n      if (max != 0) {\n        s = delta / max;\n      } else {\n        return {\n          h: NaN,\n          s: 0,\n          v: 0\n        };\n      }\n\n      if (r == max) {\n        h = (g - b) / delta;\n      } else if (g == max) {\n        h = 2 + (b - r) / delta;\n      } else {\n        h = 4 + (r - g) / delta;\n      }\n      h /= 6;\n      if (h < 0) {\n        h += 1;\n      }\n\n      return {\n        h: h * 360,\n        s: s,\n        v: max / 255\n      };\n    },\n\n    rgb_to_hex: function(r, g, b) {\n      var hex = this.hex_with_component(0, 2, r);\n      hex = this.hex_with_component(hex, 1, g);\n      hex = this.hex_with_component(hex, 0, b);\n      return hex;\n    },\n\n    component_from_hex: function(hex, componentIndex) {\n      return (hex >> (componentIndex * 8)) & 0xFF;\n    },\n\n    hex_with_component: function(hex, componentIndex, value) {\n      return value << (tmpComponent = componentIndex * 8) | (hex & ~ (0xFF << tmpComponent));\n    }\n\n  }\n\n})(),\ndat.color.toString,\ndat.utils.common),\ndat.color.interpret,\ndat.utils.common),\ndat.utils.requestAnimationFrame = (function () {\n\n  /**\n   * requirejs version of Paul Irish's RequestAnimationFrame\n   * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n   */\n\n  return window.webkitRequestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.oRequestAnimationFrame ||\n      window.msRequestAnimationFrame ||\n      function(callback, element) {\n\n        window.setTimeout(callback, 1000 / 60);\n\n      };\n})(),\ndat.dom.CenteredDiv = (function (dom, common) {\n\n\n  var CenteredDiv = function() {\n\n    this.backgroundElement = document.createElement('div');\n    common.extend(this.backgroundElement.style, {\n      backgroundColor: 'rgba(0,0,0,0.8)',\n      top: 0,\n      left: 0,\n      display: 'none',\n      zIndex: '1000',\n      opacity: 0,\n      WebkitTransition: 'opacity 0.2s linear'\n    });\n\n    dom.makeFullscreen(this.backgroundElement);\n    this.backgroundElement.style.position = 'fixed';\n\n    this.domElement = document.createElement('div');\n    common.extend(this.domElement.style, {\n      position: 'fixed',\n      display: 'none',\n      zIndex: '1001',\n      opacity: 0,\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear'\n    });\n\n\n    document.body.appendChild(this.backgroundElement);\n    document.body.appendChild(this.domElement);\n\n    var _this = this;\n    dom.bind(this.backgroundElement, 'click', function() {\n      _this.hide();\n    });\n\n\n  };\n\n  CenteredDiv.prototype.show = function() {\n\n    var _this = this;\n    \n\n\n    this.backgroundElement.style.display = 'block';\n\n    this.domElement.style.display = 'block';\n    this.domElement.style.opacity = 0;\n//    this.domElement.style.top = '52%';\n    this.domElement.style.webkitTransform = 'scale(1.1)';\n\n    this.layout();\n\n    common.defer(function() {\n      _this.backgroundElement.style.opacity = 1;\n      _this.domElement.style.opacity = 1;\n      _this.domElement.style.webkitTransform = 'scale(1)';\n    });\n\n  };\n\n  CenteredDiv.prototype.hide = function() {\n\n    var _this = this;\n\n    var hide = function() {\n\n      _this.domElement.style.display = 'none';\n      _this.backgroundElement.style.display = 'none';\n\n      dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\n      dom.unbind(_this.domElement, 'transitionend', hide);\n      dom.unbind(_this.domElement, 'oTransitionEnd', hide);\n\n    };\n\n    dom.bind(this.domElement, 'webkitTransitionEnd', hide);\n    dom.bind(this.domElement, 'transitionend', hide);\n    dom.bind(this.domElement, 'oTransitionEnd', hide);\n\n    this.backgroundElement.style.opacity = 0;\n//    this.domElement.style.top = '48%';\n    this.domElement.style.opacity = 0;\n    this.domElement.style.webkitTransform = 'scale(1.1)';\n\n  };\n\n  CenteredDiv.prototype.layout = function() {\n    this.domElement.style.left = window.innerWidth/2 - dom.getWidth(this.domElement) / 2 + 'px';\n    this.domElement.style.top = window.innerHeight/2 - dom.getHeight(this.domElement) / 2 + 'px';\n  };\n  \n  function lockScroll(e) {\n    console.log(e);\n  }\n\n  return CenteredDiv;\n\n})(dat.dom.dom,\ndat.utils.common),\ndat.dom.dom,\ndat.utils.common);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dat-gui/vendor/dat.gui.js\n// module id = 122\n// module chunks = 7","/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n/** @namespace */\nvar dat = module.exports = dat || {};\n\n/** @namespace */\ndat.color = dat.color || {};\n\n/** @namespace */\ndat.utils = dat.utils || {};\n\ndat.utils.common = (function () {\n  \n  var ARR_EACH = Array.prototype.forEach;\n  var ARR_SLICE = Array.prototype.slice;\n\n  /**\n   * Band-aid methods for things that should be a lot easier in JavaScript.\n   * Implementation and structure inspired by underscore.js\n   * http://documentcloud.github.com/underscore/\n   */\n\n  return { \n    \n    BREAK: {},\n  \n    extend: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (!this.isUndefined(obj[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n      \n    },\n    \n    defaults: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (this.isUndefined(target[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n    \n    },\n    \n    compose: function() {\n      var toCall = ARR_SLICE.call(arguments);\n            return function() {\n              var args = ARR_SLICE.call(arguments);\n              for (var i = toCall.length -1; i >= 0; i--) {\n                args = [toCall[i].apply(this, args)];\n              }\n              return args[0];\n            }\n    },\n    \n    each: function(obj, itr, scope) {\n\n      \n      if (ARR_EACH && obj.forEach === ARR_EACH) { \n        \n        obj.forEach(itr, scope);\n        \n      } else if (obj.length === obj.length + 0) { // Is number but not NaN\n        \n        for (var key = 0, l = obj.length; key < l; key++)\n          if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) \n            return;\n            \n      } else {\n\n        for (var key in obj) \n          if (itr.call(scope, obj[key], key) === this.BREAK)\n            return;\n            \n      }\n            \n    },\n    \n    defer: function(fnc) {\n      setTimeout(fnc, 0);\n    },\n    \n    toArray: function(obj) {\n      if (obj.toArray) return obj.toArray();\n      return ARR_SLICE.call(obj);\n    },\n\n    isUndefined: function(obj) {\n      return obj === undefined;\n    },\n    \n    isNull: function(obj) {\n      return obj === null;\n    },\n    \n    isNaN: function(obj) {\n      return obj !== obj;\n    },\n    \n    isArray: Array.isArray || function(obj) {\n      return obj.constructor === Array;\n    },\n    \n    isObject: function(obj) {\n      return obj === Object(obj);\n    },\n    \n    isNumber: function(obj) {\n      return obj === obj+0;\n    },\n    \n    isString: function(obj) {\n      return obj === obj+'';\n    },\n    \n    isBoolean: function(obj) {\n      return obj === false || obj === true;\n    },\n    \n    isFunction: function(obj) {\n      return Object.prototype.toString.call(obj) === '[object Function]';\n    }\n  \n  };\n    \n})();\n\n\ndat.color.toString = (function (common) {\n\n  return function(color) {\n\n    if (color.a == 1 || common.isUndefined(color.a)) {\n\n      var s = color.hex.toString(16);\n      while (s.length < 6) {\n        s = '0' + s;\n      }\n\n      return '#' + s;\n\n    } else {\n\n      return 'rgba(' + Math.round(color.r) + ',' + Math.round(color.g) + ',' + Math.round(color.b) + ',' + color.a + ')';\n\n    }\n\n  }\n\n})(dat.utils.common);\n\n\ndat.Color = dat.color.Color = (function (interpret, math, toString, common) {\n\n  var Color = function() {\n\n    this.__state = interpret.apply(this, arguments);\n\n    if (this.__state === false) {\n      throw 'Failed to interpret color arguments';\n    }\n\n    this.__state.a = this.__state.a || 1;\n\n\n  };\n\n  Color.COMPONENTS = ['r','g','b','h','s','v','hex','a'];\n\n  common.extend(Color.prototype, {\n\n    toString: function() {\n      return toString(this);\n    },\n\n    toOriginal: function() {\n      return this.__state.conversion.write(this);\n    }\n\n  });\n\n  defineRGBComponent(Color.prototype, 'r', 2);\n  defineRGBComponent(Color.prototype, 'g', 1);\n  defineRGBComponent(Color.prototype, 'b', 0);\n\n  defineHSVComponent(Color.prototype, 'h');\n  defineHSVComponent(Color.prototype, 's');\n  defineHSVComponent(Color.prototype, 'v');\n\n  Object.defineProperty(Color.prototype, 'a', {\n\n    get: function() {\n      return this.__state.a;\n    },\n\n    set: function(v) {\n      this.__state.a = v;\n    }\n\n  });\n\n  Object.defineProperty(Color.prototype, 'hex', {\n\n    get: function() {\n\n      if (!this.__state.space !== 'HEX') {\n        this.__state.hex = math.rgb_to_hex(this.r, this.g, this.b);\n      }\n\n      return this.__state.hex;\n\n    },\n\n    set: function(v) {\n\n      this.__state.space = 'HEX';\n      this.__state.hex = v;\n\n    }\n\n  });\n\n  function defineRGBComponent(target, component, componentHexIndex) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'RGB') {\n          return this.__state[component];\n        }\n\n        recalculateRGB(this, component, componentHexIndex);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'RGB') {\n          recalculateRGB(this, component, componentHexIndex);\n          this.__state.space = 'RGB';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function defineHSVComponent(target, component) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'HSV')\n          return this.__state[component];\n\n        recalculateHSV(this);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'HSV') {\n          recalculateHSV(this);\n          this.__state.space = 'HSV';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function recalculateRGB(color, component, componentHexIndex) {\n\n    if (color.__state.space === 'HEX') {\n\n      color.__state[component] = math.component_from_hex(color.__state.hex, componentHexIndex);\n\n    } else if (color.__state.space === 'HSV') {\n\n      common.extend(color.__state, math.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n\n    } else {\n\n      throw 'Corrupted color state';\n\n    }\n\n  }\n\n  function recalculateHSV(color) {\n\n    var result = math.rgb_to_hsv(color.r, color.g, color.b);\n\n    common.extend(color.__state,\n        {\n          s: result.s,\n          v: result.v\n        }\n    );\n\n    if (!common.isNaN(result.h)) {\n      color.__state.h = result.h;\n    } else if (common.isUndefined(color.__state.h)) {\n      color.__state.h = 0;\n    }\n\n  }\n\n  return Color;\n\n})(dat.color.interpret = (function (toString, common) {\n\n  var result, toReturn;\n\n  var interpret = function() {\n\n    toReturn = false;\n\n    var original = arguments.length > 1 ? common.toArray(arguments) : arguments[0];\n\n    common.each(INTERPRETATIONS, function(family) {\n\n      if (family.litmus(original)) {\n\n        common.each(family.conversions, function(conversion, conversionName) {\n\n          result = conversion.read(original);\n\n          if (toReturn === false && result !== false) {\n            toReturn = result;\n            result.conversionName = conversionName;\n            result.conversion = conversion;\n            return common.BREAK;\n\n          }\n\n        });\n\n        return common.BREAK;\n\n      }\n\n    });\n\n    return toReturn;\n\n  };\n\n  var INTERPRETATIONS = [\n\n    // Strings\n    {\n\n      litmus: common.isString,\n\n      conversions: {\n\n        THREE_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt(\n                  '0x' +\n                      test[1].toString() + test[1].toString() +\n                      test[2].toString() + test[2].toString() +\n                      test[3].toString() + test[3].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        SIX_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9]{6})$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt('0x' + test[1].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGB: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3])\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGBA: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3]),\n              a: parseFloat(test[4])\n            };\n\n          },\n\n          write: toString\n\n        }\n\n      }\n\n    },\n\n    // Numbers\n    {\n\n      litmus: common.isNumber,\n\n      conversions: {\n\n        HEX: {\n          read: function(original) {\n            return {\n              space: 'HEX',\n              hex: original,\n              conversionName: 'HEX'\n            }\n          },\n\n          write: function(color) {\n            return color.hex;\n          }\n        }\n\n      }\n\n    },\n\n    // Arrays\n    {\n\n      litmus: common.isArray,\n\n      conversions: {\n\n        RGB_ARRAY: {\n          read: function(original) {\n            if (original.length != 3) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b];\n          }\n\n        },\n\n        RGBA_ARRAY: {\n          read: function(original) {\n            if (original.length != 4) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2],\n              a: original[3]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b, color.a];\n          }\n\n        }\n\n      }\n\n    },\n\n    // Objects\n    {\n\n      litmus: common.isObject,\n\n      conversions: {\n\n        RGBA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b,\n              a: color.a\n            }\n          }\n        },\n\n        RGB_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b\n            }\n          }\n        },\n\n        HSVA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v,\n              a: color.a\n            }\n          }\n        },\n\n        HSV_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v\n            }\n          }\n\n        }\n\n      }\n\n    }\n\n\n  ];\n\n  return interpret;\n\n\n})(dat.color.toString,\ndat.utils.common),\ndat.color.math = (function () {\n\n  var tmpComponent;\n\n  return {\n\n    hsv_to_rgb: function(h, s, v) {\n\n      var hi = Math.floor(h / 60) % 6;\n\n      var f = h / 60 - Math.floor(h / 60);\n      var p = v * (1.0 - s);\n      var q = v * (1.0 - (f * s));\n      var t = v * (1.0 - ((1.0 - f) * s));\n      var c = [\n        [v, t, p],\n        [q, v, p],\n        [p, v, t],\n        [p, q, v],\n        [t, p, v],\n        [v, p, q]\n      ][hi];\n\n      return {\n        r: c[0] * 255,\n        g: c[1] * 255,\n        b: c[2] * 255\n      };\n\n    },\n\n    rgb_to_hsv: function(r, g, b) {\n\n      var min = Math.min(r, g, b),\n          max = Math.max(r, g, b),\n          delta = max - min,\n          h, s;\n\n      if (max != 0) {\n        s = delta / max;\n      } else {\n        return {\n          h: NaN,\n          s: 0,\n          v: 0\n        };\n      }\n\n      if (r == max) {\n        h = (g - b) / delta;\n      } else if (g == max) {\n        h = 2 + (b - r) / delta;\n      } else {\n        h = 4 + (r - g) / delta;\n      }\n      h /= 6;\n      if (h < 0) {\n        h += 1;\n      }\n\n      return {\n        h: h * 360,\n        s: s,\n        v: max / 255\n      };\n    },\n\n    rgb_to_hex: function(r, g, b) {\n      var hex = this.hex_with_component(0, 2, r);\n      hex = this.hex_with_component(hex, 1, g);\n      hex = this.hex_with_component(hex, 0, b);\n      return hex;\n    },\n\n    component_from_hex: function(hex, componentIndex) {\n      return (hex >> (componentIndex * 8)) & 0xFF;\n    },\n\n    hex_with_component: function(hex, componentIndex, value) {\n      return value << (tmpComponent = componentIndex * 8) | (hex & ~ (0xFF << tmpComponent));\n    }\n\n  }\n\n})(),\ndat.color.toString,\ndat.utils.common);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dat-gui/vendor/dat.color.js\n// module id = 123\n// module chunks = 7","// stats.js - http://github.com/mrdoob/stats.js\nvar Stats=function(){var l=Date.now(),m=l,g=0,n=Infinity,o=0,h=0,p=Infinity,q=0,r=0,s=0,f=document.createElement(\"div\");f.id=\"stats\";f.addEventListener(\"mousedown\",function(b){b.preventDefault();t(++s%2)},!1);f.style.cssText=\"width:80px;opacity:0.9;cursor:pointer\";var a=document.createElement(\"div\");a.id=\"fps\";a.style.cssText=\"padding:0 0 3px 3px;text-align:left;background-color:#002\";f.appendChild(a);var i=document.createElement(\"div\");i.id=\"fpsText\";i.style.cssText=\"color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px\";\ni.innerHTML=\"FPS\";a.appendChild(i);var c=document.createElement(\"div\");c.id=\"fpsGraph\";c.style.cssText=\"position:relative;width:74px;height:30px;background-color:#0ff\";for(a.appendChild(c);74>c.children.length;){var j=document.createElement(\"span\");j.style.cssText=\"width:1px;height:30px;float:left;background-color:#113\";c.appendChild(j)}var d=document.createElement(\"div\");d.id=\"ms\";d.style.cssText=\"padding:0 0 3px 3px;text-align:left;background-color:#020;display:none\";f.appendChild(d);var k=document.createElement(\"div\");\nk.id=\"msText\";k.style.cssText=\"color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px\";k.innerHTML=\"MS\";d.appendChild(k);var e=document.createElement(\"div\");e.id=\"msGraph\";e.style.cssText=\"position:relative;width:74px;height:30px;background-color:#0f0\";for(d.appendChild(e);74>e.children.length;)j=document.createElement(\"span\"),j.style.cssText=\"width:1px;height:30px;float:left;background-color:#131\",e.appendChild(j);var t=function(b){s=b;switch(s){case 0:a.style.display=\n\"block\";d.style.display=\"none\";break;case 1:a.style.display=\"none\",d.style.display=\"block\"}};return{REVISION:12,domElement:f,setMode:t,begin:function(){l=Date.now()},end:function(){var b=Date.now();g=b-l;n=Math.min(n,g);o=Math.max(o,g);k.textContent=g+\" MS (\"+n+\"-\"+o+\")\";var a=Math.min(30,30-30*(g/200));e.appendChild(e.firstChild).style.height=a+\"px\";r++;b>m+1E3&&(h=Math.round(1E3*r/(b-m)),p=Math.min(p,h),q=Math.max(q,h),i.textContent=h+\" FPS (\"+p+\"-\"+q+\")\",a=Math.min(30,30-30*(h/100)),c.appendChild(c.firstChild).style.height=\na+\"px\",m=b,r=0);return b},update:function(){l=this.end()}}};\"object\"===typeof module&&(module.exports=Stats);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/stats-js/build/stats.min.js\n// module id = 124\n// module chunks = 7","require('../../modules/es6.object.keys');\nmodule.exports = require('../../modules/_core').Object.keys;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/keys.js\n// module id = 125\n// module chunks = 7","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.keys.js\n// module id = 126\n// module chunks = 7","/**\n * @author mrdoob / http://mrdoob.com/\n * @author jetienne / http://jetienne.com/\n * @author paulirish / http://paulirish.com/\n */\nfunction MemoryStats(){\n\n\tvar msMin\t= 100;\n\tvar msMax\t= 0;\n\n\tvar container\t= document.createElement( 'div' );\n\tcontainer.id\t= 'stats';\n\tcontainer.style.cssText = 'width:80px;opacity:0.9;cursor:pointer';\n\n\tvar msDiv\t= document.createElement( 'div' );\n\tmsDiv.id\t= 'ms';\n\tmsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#020;';\n\tcontainer.appendChild( msDiv );\n\n\tvar msText\t= document.createElement( 'div' );\n\tmsText.id\t= 'msText';\n\tmsText.style.cssText = 'color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tmsText.innerHTML= 'Memory';\n\tmsDiv.appendChild( msText );\n\n\tvar msGraph\t= document.createElement( 'div' );\n\tmsGraph.id\t= 'msGraph';\n\tmsGraph.style.cssText = 'position:relative;width:74px;height:30px;background-color:#0f0';\n\tmsDiv.appendChild( msGraph );\n\n\twhile ( msGraph.children.length < 74 ) {\n\n\t\tvar bar = document.createElement( 'span' );\n\t\tbar.style.cssText = 'width:1px;height:30px;float:left;background-color:#131';\n\t\tmsGraph.appendChild( bar );\n\n\t}\n\n\tvar updateGraph = function ( dom, height, color ) {\n\n\t\tvar child = dom.appendChild( dom.firstChild );\n\t\tchild.style.height = height + 'px';\n\t\tif( color ) child.style.backgroundColor = color;\n\n\t}\n\n\t// polyfill usedJSHeapSize\n\tif (window.performance && !performance.memory){\n\t\tperformance.memory = { usedJSHeapSize : 0 };\n\t}\n\n\t// support of the API?\n\tif( performance.memory.totalJSHeapSize === 0 ){\n\t\tconsole.warn('totalJSHeapSize === 0... performance.memory is only available in Chrome .')\n\t}\n\n\t// TODO, add a sanity check to see if values are bucketed.\n\t// If so, reminde user to adopt the --enable-precise-memory-info flag.\n\t// open -a \"/Applications/Google Chrome.app\" --args --enable-precise-memory-info\n\n\tvar lastTime\t= Date.now();\n\tvar lastUsedHeap= performance.memory.usedJSHeapSize;\n\treturn {\n\t\tdomElement: container,\n\n\t\tupdate: function () {\n\n\t\t\t// refresh only 30time per second\n\t\t\tif( Date.now() - lastTime < 1000/30 )\treturn;\n\t\t\tlastTime\t= Date.now()\n\n\t\t\tvar delta\t= performance.memory.usedJSHeapSize - lastUsedHeap;\n\t\t\tlastUsedHeap\t= performance.memory.usedJSHeapSize;\n\t\t\tvar color\t= delta < 0 ? '#830' : '#131';\n\n\t\t\tvar ms\t= performance.memory.usedJSHeapSize;\n\t\t\tmsMin\t= Math.min( msMin, ms );\n\t\t\tmsMax\t= Math.max( msMax, ms );\n\t\t\tmsText.textContent = \"Mem: \" + bytesToSize(ms, 2);\n\n\t\t\tvar normValue\t= ms / (30*1024*1024);\n\t\t\tvar height\t= (1-(normValue% 1)) * 30;\n\t\t\tupdateGraph( msGraph, height, color);\n\n\t\t\tfunction bytesToSize( bytes, nFractDigit ){\n\t\t\t\tvar sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n\t\t\t\tif (bytes == 0) return 'n/a';\n\t\t\t\tnFractDigit\t= nFractDigit !== undefined ? nFractDigit : 0;\n\t\t\t\tvar precision\t= Math.pow(10, nFractDigit);\n\t\t\t\tvar i \t\t= Math.floor(Math.log(bytes) / Math.log(1024));\n\t\t\t\treturn Math.round(bytes*precision / Math.pow(1024, i))/precision + ' ' + sizes[i];\n\t\t\t};\n\t\t}\n\n\t}\n\n};\n\nmodule.exports = MemoryStats;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/memory-stats/memory-stats.js\n// module id = 127\n// module chunks = 7","/* global PIXI */\nimport * as Core from '../lib/core';\nimport { lerp } from '../lib/utils';\n\n// import filters from 'pixi-filters';\n// import extraFilters from 'pixi-extra-filters';\n\nconst PI2 = Math.PI * 2;\n\nlet idx, p, entityId, position, sprite;\n\n// See also: http://phrogz.net/JS/wheeldelta.html\nconst wheelDistance = function(evt){\n  if (!evt) evt = event;\n  const w=evt.wheelDelta, d=evt.detail;\n  if (d){\n    if (w) return w/d/40*d>0?1:-1; // Opera\n    else return -d/3;              // Firefox;         TODO: do not /3 for OS X\n  } else return w/120;             // IE/Safari/Chrome TODO: /3 for Chrome OS X\n};\n\nexport class ViewportPixi extends Core.System {\n\n  defaultOptions() {\n    return {\n      lineWidth: 5,\n      zoom: 1.0,\n      zoomMin: 0.1,\n      zoomMax: 10.0,\n      zoomWheelFactor: 0.05,\n      gridEnabled: true,\n      gridSize: 250,\n      gridColor: 0x222222,\n      followEnabled: true,\n      followName: null,\n      followEntityId: null\n    };\n  }\n\n  initialize() {\n    this.container = document.querySelector(this.options.container);\n    this.renderer = PIXI.autoDetectRenderer(\n      this.container.offsetWidth,\n      this.container.offsetHeight,\n      { antialias: true }\n    );\n    this.renderer.autoResize = true;\n    this.canvas = this.renderer.view;\n    this.container.appendChild(this.canvas);\n    this.stage = new PIXI.Container();\n\n    this.stage.filters = [\n      // new PIXI.filters.VoidFilter(),\n      // new PIXI.filters.BlurFilter(1, 1, 5)\n    ];\n\n    this.healthBarGraphics = new PIXI.Graphics();\n    this.stage.addChild(this.healthBarGraphics);\n\n    this.backdrop = new PIXI.Graphics();\n    this.stage.addChild(this.backdrop);\n\n    this.graphics = {};\n\n    const events = {\n      'resize': (ev) => { this.updateMetrics(ev); },\n      'orientationchange': (ev) => { this.updateMetrics(ev); },\n      'mousedown': (ev) => { this.onMouseDown(ev); },\n      'mousemove': (ev) => { this.onMouseMove(ev); },\n      'mouseup': (ev) => { this.onMouseUp(ev); }\n    };\n\n    for (const name in events) {\n      this.canvas.addEventListener(name, events[name], false);\n    }\n\n    // See also: http://phrogz.net/JS/wheeldelta.html\n    const boundOnMouseWheel = (ev) => this.onMouseWheel(ev);\n    if (window.addEventListener){\n      window.addEventListener('mousewheel', boundOnMouseWheel, false); // Chrome/Safari/Opera\n      window.addEventListener('DOMMouseScroll', boundOnMouseWheel, false); // Firefox\n    } else if (window.attachEvent){\n      window.attachEvent('onmousewheel', boundOnMouseWheel); // IE\n    }\n\n    this.followEnabled = this.options.followEnabled;\n    this.zoom = this.options.zoom;\n    this.followEntityId = this.options.followEntityId;\n    this.gridEnabled = this.options.gridEnabled;\n    this.lineWidth = this.options.lineWidth;\n\n    this.cursorRawX = 0;\n    this.cursorRawY = 0;\n\n    this.cursorChanged = false;\n    this.cursorPosition = { x: 0, y: 0 };\n\n    this.cameraX = 0;\n    this.cameraY = 0;\n\n    this.debugDummySprite = { size: 100 };\n\n    this.updateMetrics();\n  }\n\n  onMouseWheel(ev) {\n    this.zoom += wheelDistance(ev) * this.options.zoomWheelFactor;\n    if (this.zoom < this.options.zoomMin) {\n      this.zoom = this.options.zoomMin;\n    }\n    if (this.zoom > this.options.zoomMax) {\n      this.zoom = this.options.zoomMax;\n    }\n  }\n\n  // TODO: Use a symbol for 'mouse{Down,Move,Up}' message?\n\n  onMouseDown(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseDown', this.cursorPosition);\n  }\n\n  onMouseMove(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseMove', this.cursorPosition);\n  }\n\n  onMouseUp(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseUp', this.cursorPosition);\n  }\n\n  setCursor(x, y) {\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n\n    this.cursorRawX = x;\n    this.cursorRawY = y;\n\n    const newX = ((x - (width / 2)) / this.zoom) + this.cameraX;\n    const newY = ((y - (height / 2)) / this.zoom) + this.cameraY;\n\n    this.cursorChanged = false;\n    if (newX !== this.cursorPosition.x || newY !== this.cursorPosition.y) {\n      this.cursorChanged = true;\n      this.cursorPosition.x = newX;\n      this.cursorPosition.y = newY;\n    }\n\n    return this.cursorPosition;\n  }\n\n  updateMetrics() {\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n\n    this.visibleWidth = width / this.zoom;\n    this.visibleHeight = height / this.zoom;\n\n    this.visibleLeft = (0 - this.visibleWidth / 2) + this.cameraX;\n    this.visibleTop = (0 - this.visibleHeight / 2) + this.cameraY;\n    this.visibleRight = this.visibleLeft + this.visibleWidth;\n    this.visibleBottom = this.visibleTop + this.visibleHeight;\n  }\n\n  update(/*timeDelta*/) {\n    this.updateMetrics();\n\n    this.setCursor(this.cursorRawX, this.cursorRawY);\n    // FIXME: Should be able to skip doing this unless\n    // this.cursorChanged === true, but for some reason that's not working\n    this.world.publish('mouseMove', this.cursorPosition);\n\n    const sprites = this.world.get('Sprite') || {};\n\n    for (entityId in sprites) {\n      position = this.world.get('Position', entityId);\n      sprite = sprites[entityId];\n      sprite.visible = (\n        (position.right > this.visibleLeft) &&\n        (position.left < this.visibleRight) &&\n        (position.bottom > this.visibleTop) &&\n        (position.top < this.visibleBottom)\n      );\n    }\n\n    const toRemove = Object.keys(this.graphics).filter(key => !(key in sprites));\n    toRemove.forEach(entityId => {\n      this.stage.removeChild(this.graphics[entityId]);\n      delete this.graphics[entityId];\n    });\n\n    const toAdd = Object.keys(sprites).filter(key => !(key in this.graphics));\n    toAdd.forEach(entityId => {\n      this.stage.addChild(this.graphics[entityId] = new PIXI.Graphics());\n    });\n  }\n\n  draw(timeDelta) {\n    this.followEntity();\n    this.drawBackdrop(timeDelta);\n\n    for (const entityId in this.graphics) {\n      this.drawSprite(this.graphics[entityId], entityId, timeDelta);\n    }\n\n    this.stage.setTransform(\n      (this.container.offsetWidth / 2) - (this.cameraX * this.zoom),\n      (this.container.offsetHeight / 2) - (this.cameraY * this.zoom),\n      this.zoom,\n      this.zoom\n    );\n\n    this.renderer.resize(\n      this.container.offsetWidth,\n      this.container.offsetHeight\n    );\n\n    this.renderer.render(this.stage);\n  }\n\n  drawSprite(ctx, entityId, timeDelta) {\n    const sprite = this.world.get('Sprite', entityId);\n    if (!sprite) { return; }\n\n    const position = this.world.get('Position', entityId);\n\n    let spriteFn = getSprite(sprite.name);\n    if (!spriteFn) { spriteFn = getSprite('default'); }\n\n    ctx.position.x = Math.floor(position.x);\n    ctx.position.y = Math.floor(position.y);\n    ctx.rotation = position.rotation + (Math.PI / 2);\n    ctx.scale.x = ctx.scale.y = sprite.size / 100;\n    ctx.lineStyle(this.lineWidth / (sprite.size / 100), sprite.color);\n    spriteFn(ctx, sprite, entityId, timeDelta, this.world);\n\n      /*\n    const health = this.world.get('Health', entityId);\n    if (health) {\n      const perc = (health.current / health.max);\n      ctx.lineStyle(1.0, 0x333333);\n      ctx.moveTo(-50, -57);\n      ctx.drawRect(-50, -57, 100, 5);\n      ctx.moveTo(-50, -57);\n      ctx.beginFill(0x00ff00, 1.0);\n      ctx.drawRect(-50, -57, 100 * perc, 5);\n      ctx.endFill();\n    }\n    */\n\n    sprite.drawn = true;\n    return ctx;\n  }\n\n  followEntity() {\n    if (!this.followEnabled) {\n      this.cameraX = this.cameraY = 0;\n      return;\n    }\n    if (this.options.followName && !this.followEntityId) {\n      // Look up named entity, if necessary.\n      this.followEntityId = Core.getComponent('Name')\n        .findEntityByName(this.world, this.options.followName);\n    }\n    if (this.followEntityId) {\n      // Adjust the viewport center offset to the entity position\n      const position = this.world.get('Position', this.followEntityId);\n      if (position) {\n        this.cameraX = position.x;\n        this.cameraY = position.y;\n        this.setCursor(this.cursorRawX, this.cursorRawY);\n      }\n    }\n  }\n\n  drawBackdrop(/* timeDelta */) {\n    const ctx = this.backdrop;\n\n    if (!this.gridEnabled) {\n      ctx.visible = false;\n      return;\n    }\n\n    const gridSize = this.options.gridSize;\n    const gridOffsetX = this.visibleLeft % gridSize;\n    const gridOffsetY = this.visibleTop % gridSize;\n\n    ctx.visible = true;\n    ctx.clear();\n    ctx.lineStyle(5, this.options.gridColor);\n    ctx.position.x = this.visibleLeft;\n    ctx.position.y = this.visibleTop;\n\n    for (let x = -gridOffsetX; x < this.visibleWidth; x += gridSize) {\n      ctx.moveTo(x, 0);\n      ctx.lineTo(x, this.visibleHeight + gridSize);\n    }\n\n    for (let y = -gridOffsetY; y < this.visibleHeight; y += gridSize) {\n      ctx.moveTo(0, y);\n      ctx.lineTo(this.visibleWidth + gridSize, y);\n    }\n  }\n\n}\n\nCore.registerSystem('ViewportPixi', ViewportPixi);\n\nexport class CanvasSprite extends Core.Component {\n  static defaults() {\n    return {\n      name: null,\n      color: 0xffffff,\n      size: 100,\n      width: null,\n      height: null,\n      drawn: false,\n      visible: false\n    };\n  }\n  static create(attrs) {\n    const c = super.create(attrs);\n    if (!c.width) { c.width = c.size; }\n    if (!c.height) { c.height = c.size; }\n    return c;\n  }\n}\n\nCore.registerComponent('Sprite', CanvasSprite);\n\nconst spriteRegistry = {};\nexport function registerSprite(name, sprite) {\n  spriteRegistry[name] = sprite;\n}\nexport function getSprite(name) {\n  return spriteRegistry[name];\n}\n\nconst defaultShape = [ -50, 0, 50, 0, 0, 0, 0, -50, 0, 50, 0, 0 ];\nfor (let idx = 0; idx < 8; idx++) {\n  const rot = idx * (PI2 / 8);\n  defaultShape.push(50 * Math.cos(rot));\n  defaultShape.push(50 * Math.sin(rot));\n}\ndefaultShape.push(50);\ndefaultShape.push(0);\n\nregisterSprite('default', (g, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n  g.drawPolygon(defaultShape);\n});\n\nregisterSprite('sun', (ctx, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n\n  ctx.arc(0, 0, 50, 0, PI2, true);\n});\n\nregisterSprite('enemyscout', (ctx, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n\n  ctx.moveTo(0, -50);\n  ctx.lineTo(-45, 50);\n  ctx.lineTo(-12.5, 12.5);\n  ctx.lineTo(0, 25);\n  ctx.lineTo(12.5, 12.5);\n  ctx.lineTo(45, 50);\n  ctx.lineTo(0, -50);\n  ctx.moveTo(0, -50);\n});\n\nregisterSprite('enemywing', (g, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n\n  g.lineColor = 0x228822;\n\n  g.moveTo(-50, 0);\n  g.lineTo(-37.5, -37.5);\n  g.lineTo(0, 50);\n  g.lineTo(37.5, -37.5);\n  g.lineTo(50, 0);\n  g.lineTo(37.5, 50);\n  g.lineTo(25, 50);\n  g.lineTo(0, 0);\n  g.lineTo(-25, 50);\n  g.lineTo(-37.5, 50);\n  g.lineTo(-50, 0);\n});\n\nconst repulsorShape = [\n -50,  0,\n -37.5, -50,\n -25, -50,\n -6.25, 25,\n 6.25, 25,\n 25, -50,\n 37.5, -50,\n 50,  0,\n 37.5, 50,\n 25, 50,\n 6.25, -25,\n -6.25, -25,\n -25, 50,\n -37.5, 50,\n -50, 0\n];\nconst repulsorSides = 8;\nconst repulsorPoints = [];\nfor (let idx = 0; idx < repulsorSides; idx++) {\n  const rot = idx * (PI2 / repulsorSides);\n  repulsorPoints.push(Math.cos(rot));\n  repulsorPoints.push(Math.sin(rot));\n}\nrepulsorPoints.push(repulsorPoints[0]);\nrepulsorPoints.push(repulsorPoints[1]);\n\nregisterSprite('repulsor', (g, sprite, entityId, timeDelta, world) => {\n  if (!sprite.drawn) {\n    const t = 0; // Math.floor(Math.random() * 15) * 100;\n    sprite.rings = [\n      { t: t,       startR: 0, endR: 500, startO: 1.0, endO: 0.0, endT: 1500 },\n      { t: t + 250, startR: 0, endR: 500, startO: 1.0, endO: 0.0, endT: 1500 },\n      { t: t + 500, startR: 0, endR: 500, startO: 1.0, endO: 0.0, endT: 1500 }\n    ];\n  }\n\n  const repulsor = world.get('Repulsor', entityId);\n  if (repulsor) {\n    sprite.rings.forEach(ring => ring.endR = repulsor.range);\n  }\n\n  g.clear();\n  g.lineStyle(5 / (sprite.size / 100), 0x228822);\n  g.drawPolygon(repulsorShape);\n\n  const dt = Math.floor(timeDelta * 1000);\n  sprite.rings.forEach(ring => {\n    ring.t += dt;\n    if (ring.t >= ring.endT) { ring.t = 0; }\n\n    if (!sprite.visible) { return; }\n\n    const r = lerp(ring.startR, ring.endR, ring.t / ring.endT);\n    const a = lerp(ring.startO, ring.endO, ring.t / ring.endT);\n\n    g.lineStyle(5 / (sprite.size / 100), 0x228822, a);\n    g.moveTo(-r, 0);\n    g.drawPolygon(repulsorPoints.map(p => r * p));\n  });\n});\n\nconst heroShape = [\n  -50, 0,\n  -37.5, -37.5,\n  0, -50,\n  37.5, -37.5,\n  50, 0,\n  37.5, 50,\n  25, 50,\n  12.5, 12.5,\n  5, 25,\n  -5, 25,\n  -12.5, 12.5,\n  -25, 50,\n  -37.5, 50,\n  -50, 0\n];\n\nregisterSprite('hero', (g, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n  g.drawPolygon(heroShape);\n});\n\nregisterSprite('asteroid', (g, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n\n  const NUM_POINTS = 10 + Math.floor(8 * Math.random());\n  const MAX_RADIUS = 50;\n  const MIN_RADIUS = 35;\n  const ROTATION = PI2 / NUM_POINTS;\n\n  let idx;\n  const points = [];\n\n  for (idx = 0; idx < NUM_POINTS; idx++) {\n    const rot = idx * ROTATION;\n    const dist = (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\n    points.push(dist * Math.cos(rot));\n    points.push(dist * Math.sin(rot));\n  }\n  points.push(points[0]);\n  points.push(points[1]);\n\n  g.drawPolygon(points);\n});\n\nregisterSprite('mine', (g, sprite/*, entityId, timeDelta, world*/) => {\n  if (!sprite.drawn) {\n    let NUM_POINTS = 10 + Math.floor(10 * Math.random());\n    if (NUM_POINTS % 2 !== 0) { NUM_POINTS++; }\n    const ROTATION = PI2 / NUM_POINTS;\n    const MAX_RADIUS = 60;\n    const MIN_RADIUS = 10;\n\n    let even = false;\n\n    sprite.legs = [];\n    for (let idx = 0; idx < NUM_POINTS; idx++) {\n      const dist = even ? 10 : (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\n      const rot = idx * ROTATION;\n      sprite.legs.push(dist * Math.cos(rot));\n      sprite.legs.push(dist * Math.sin(rot));\n      even = !even;\n    }\n    sprite.legs.push(sprite.legs[0]);\n    sprite.legs.push(sprite.legs[1]);\n  }\n\n  if (sprite.drawn && Math.random() > 0.15) { return; }\n\n  g.clear();\n  g.lineStyle(5 / (sprite.size / 100), 0xFF2222);\n  g.drawPolygon(sprite.legs.map(p => p * (0.9 + 0.5 * Math.random())));\n});\n\nregisterSprite('explosion', (g, sprite, entityId, timeDelta) => {\n\n  if (!sprite.drawn) {\n    Object.assign(sprite, {\n      ttl: 2.0,\n      radius: 100,\n      maxParticles: 25,\n      maxParticleSize: 4,\n      maxVelocity: 300,\n      age: 0,\n      alpha: 0,\n      stop: false,\n      particles: []\n    }, sprite);\n    for (idx = 0; idx < sprite.maxParticles; idx++) {\n      sprite.particles.push({ free: true });\n    }\n  }\n\n  for (idx = 0; idx < sprite.particles.length; idx++) {\n    p = sprite.particles[idx];\n\n    if (!sprite.stop && p.free) {\n\n      p.velocity = sprite.maxVelocity * Math.random();\n      p.angle = (Math.PI * 2) * Math.random();\n      p.dx = 0 - (p.velocity * Math.sin(p.angle));\n      p.dy = p.velocity * Math.cos(p.angle);\n      p.distance = p.x = p.y = 0;\n      p.maxDistance = sprite.radius * Math.random();\n      p.size = sprite.maxParticleSize;\n      p.free = false;\n\n    } else if (!p.free) {\n\n      p.x += p.dx * timeDelta;\n      p.y += p.dy * timeDelta;\n\n      p.distance += p.velocity * timeDelta;\n      if (p.distance >= p.maxDistance) {\n        p.distance = p.maxDistance;\n        p.free = true;\n      }\n\n    }\n\n  }\n\n  sprite.age += timeDelta;\n\n  if (sprite.age >= sprite.ttl) {\n    sprite.stop = true;\n  }\n\n  sprite.alpha = Math.max(0, 1 - (sprite.age / sprite.ttl));\n\n  g.clear();\n\n  for (idx = 0; idx < sprite.particles.length; idx++) {\n    p = sprite.particles[idx];\n    if (p.free) { continue; }\n\n    g.lineStyle(5 / (sprite.size / 100), sprite.color,\n      (1 - (p.distance / p.maxDistance)) * sprite.alpha);\n    g.moveTo(0, 0);\n    g.lineTo(p.x, p.y);\n  }\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/viewportPixi.js","// Linear interpolation from v0 to v1 over t[0..1]\r\nexport function lerp(v0, v1, t) {\r\n  return (1-t)*v0 + t*v1;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/utils.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _from = require(\"../core-js/array/from\");\n\nvar _from2 = _interopRequireDefault(_from);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return (0, _from2.default)(arr);\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/toConsumableArray.js\n// module id = 130\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/array/from\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/array/from.js\n// module id = 131\n// module chunks = 7","require('../../modules/es6.string.iterator');\nrequire('../../modules/es6.array.from');\nmodule.exports = require('../../modules/_core').Array.from;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/array/from.js\n// module id = 132\n// module chunks = 7","'use strict';\nvar ctx = require('./_ctx');\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar toLength = require('./_to-length');\nvar createProperty = require('./_create-property');\nvar getIterFn = require('./core.get-iterator-method');\n\n$export($export.S + $export.F * !require('./_iter-detect')(function (iter) { Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n    var O = toObject(arrayLike);\n    var C = typeof this == 'function' ? this : Array;\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var index = 0;\n    var iterFn = getIterFn(O);\n    var length, result, step, iterator;\n    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {\n      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {\n        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);\n      }\n    } else {\n      length = toLength(O.length);\n      for (result = new C(length); length > index; index++) {\n        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.array.from.js\n// module id = 133\n// module chunks = 7","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-call.js\n// module id = 134\n// module chunks = 7","// check on default Array iterator\nvar Iterators = require('./_iterators');\nvar ITERATOR = require('./_wks')('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_is-array-iter.js\n// module id = 135\n// module chunks = 7","'use strict';\nvar $defineProperty = require('./_object-dp');\nvar createDesc = require('./_property-desc');\n\nmodule.exports = function (object, index, value) {\n  if (index in object) $defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_create-property.js\n// module id = 136\n// module chunks = 7","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/core.get-iterator-method.js\n// module id = 137\n// module chunks = 7","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_classof.js\n// module id = 138\n// module chunks = 7","var ITERATOR = require('./_wks')('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-detect.js\n// module id = 139\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/values\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/values.js\n// module id = 140\n// module chunks = 7","require('../../modules/es7.object.values');\nmodule.exports = require('../../modules/_core').Object.values;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/values.js\n// module id = 141\n// module chunks = 7","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.object.values.js\n// module id = 142\n// module chunks = 7","var getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nvar isEnum = require('./_object-pie').f;\nmodule.exports = function (isEntries) {\n  return function (it) {\n    var O = toIObject(it);\n    var keys = getKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) if (isEnum.call(O, key = keys[i++])) {\n      result.push(isEntries ? [key, O[key]] : O[key]);\n    } return result;\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-to-array.js\n// module id = 143\n// module chunks = 7"],"sourceRoot":""}