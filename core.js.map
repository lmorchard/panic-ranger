{"version":3,"sources":["webpack:///webpack/bootstrap 1fbd2566eb1b473d7a72","webpack:///./src/lib/core.js","webpack:///./node_modules/babel-runtime/helpers/classCallCheck.js","webpack:///./node_modules/babel-runtime/helpers/createClass.js","webpack:///./node_modules/babel-runtime/core-js/object/get-prototype-of.js","webpack:///./node_modules/babel-runtime/helpers/possibleConstructorReturn.js","webpack:///./node_modules/babel-runtime/helpers/inherits.js","webpack:///./node_modules/core-js/library/modules/_core.js","webpack:///./node_modules/core-js/library/modules/_export.js","webpack:///./node_modules/core-js/library/modules/_wks.js","webpack:///./src/plugins/position.js","webpack:///./node_modules/core-js/library/modules/_object-dp.js","webpack:///./src/plugins/motion.js","webpack:///./node_modules/core-js/library/modules/_global.js","webpack:///./node_modules/core-js/library/modules/_descriptors.js","webpack:///./node_modules/core-js/library/modules/_to-iobject.js","webpack:///./node_modules/core-js/library/modules/_hide.js","webpack:///./node_modules/core-js/library/modules/_an-object.js","webpack:///./node_modules/core-js/library/modules/_is-object.js","webpack:///./node_modules/core-js/library/modules/_ctx.js","webpack:///./node_modules/core-js/library/modules/_fails.js","webpack:///./node_modules/core-js/library/modules/_object-keys.js","webpack:///./node_modules/core-js/library/modules/_has.js","webpack:///./src/plugins/spawn.js","webpack:///./src/plugins/datGui.js","webpack:///./src/plugins/drawStats.js","webpack:///./src/plugins/memoryStats.js","webpack:///./src/plugins/name.js","webpack:///./node_modules/core-js/library/modules/_to-object.js","webpack:///./node_modules/core-js/library/modules/es6.string.iterator.js","webpack:///./node_modules/core-js/library/modules/_iterators.js","webpack:///./node_modules/babel-runtime/helpers/get.js","webpack:///./src/plugins/health.js","webpack:///./src/lib/Vector2D.js","webpack:///./src/plugins/seeker.js","webpack:///./src/plugins/thruster.js","webpack:///./src/plugins/viewportWebGL.js","webpack:///./node_modules/babel-runtime/core-js/object/assign.js","webpack:///./node_modules/core-js/library/modules/_property-desc.js","webpack:///./node_modules/core-js/library/modules/_object-pie.js","webpack:///./src/plugins/bounce.js","webpack:///./node_modules/core-js/library/modules/web.dom.iterable.js","webpack:///./src/plugins/collision.js","webpack:///./node_modules/babel-runtime/core-js/object/keys.js","webpack:///./src/plugins/playerInputSteering.js","webpack:///./node_modules/core-js/library/modules/_to-length.js","webpack:///./node_modules/core-js/library/modules/_uid.js","webpack:///./node_modules/core-js/library/modules/_object-create.js","webpack:///./node_modules/core-js/library/modules/_set-to-string-tag.js","webpack:///./src/plugins/hordeSpawn.js","webpack:///./src/plugins/repulsor.js","webpack:///./node_modules/core-js/library/modules/_for-of.js","webpack:///./src/lib/utils.js","webpack:///./node_modules/core-js/library/modules/_to-primitive.js","webpack:///./node_modules/core-js/library/modules/_iobject.js","webpack:///./node_modules/core-js/library/modules/_cof.js","webpack:///./node_modules/core-js/library/modules/_defined.js","webpack:///./node_modules/core-js/library/modules/_to-integer.js","webpack:///./node_modules/core-js/library/modules/_shared-key.js","webpack:///./node_modules/core-js/library/modules/_shared.js","webpack:///./node_modules/core-js/library/modules/_enum-bug-keys.js","webpack:///./node_modules/core-js/library/modules/_object-gops.js","webpack:///./node_modules/core-js/library/modules/_object-sap.js","webpack:///./node_modules/core-js/library/modules/_iter-define.js","webpack:///./node_modules/core-js/library/modules/_library.js","webpack:///./node_modules/core-js/library/modules/_wks-ext.js","webpack:///./node_modules/core-js/library/modules/_meta.js","webpack:///./node_modules/core-js/library/modules/_wks-define.js","webpack:///./node_modules/core-js/library/modules/_object-gopd.js","webpack:///./src/plugins/debugCanvas.js","webpack:///./src/plugins/roadRunner.js","webpack:///./node_modules/core-js/library/modules/core.get-iterator-method.js","webpack:///./node_modules/core-js/library/modules/_classof.js","webpack:///./node_modules/core-js/library/modules/_validate-collection.js","webpack:///./node_modules/babel-runtime/helpers/extends.js","webpack:///./node_modules/core-js/library/modules/_a-function.js","webpack:///./node_modules/core-js/library/modules/_ie8-dom-define.js","webpack:///./node_modules/core-js/library/modules/_dom-create.js","webpack:///./node_modules/core-js/library/modules/_object-keys-internal.js","webpack:///./node_modules/core-js/library/modules/_object-gpo.js","webpack:///./node_modules/babel-runtime/helpers/typeof.js","webpack:///./node_modules/core-js/library/modules/_redefine.js","webpack:///./node_modules/core-js/library/modules/_iter-step.js","webpack:///./node_modules/core-js/library/modules/_is-array.js","webpack:///./node_modules/core-js/library/modules/_object-gopn.js","webpack:///./src/plugins/orbiter.js","webpack:///./node_modules/babel-runtime/core-js/get-iterator.js","webpack:///./node_modules/babel-runtime/core-js/map.js","webpack:///./node_modules/core-js/library/modules/_collection-strong.js","webpack:///./node_modules/core-js/library/modules/_redefine-all.js","webpack:///./node_modules/core-js/library/modules/_an-instance.js","webpack:///./node_modules/core-js/library/modules/_iter-call.js","webpack:///./node_modules/core-js/library/modules/_is-array-iter.js","webpack:///./node_modules/core-js/library/modules/_collection.js","webpack:///./node_modules/core-js/library/modules/_collection-to-json.js","webpack:///./node_modules/core-js/library/modules/_set-collection-of.js","webpack:///./node_modules/core-js/library/modules/_set-collection-from.js","webpack:///./node_modules/core-js/library/modules/_object-to-array.js","webpack:///./src/plugins/viewportCanvas.js","webpack:///./node_modules/core-js/library/fn/object/assign.js","webpack:///./node_modules/core-js/library/modules/es6.object.assign.js","webpack:///./node_modules/core-js/library/modules/_object-assign.js","webpack:///./node_modules/core-js/library/modules/_array-includes.js","webpack:///./node_modules/core-js/library/modules/_to-absolute-index.js","webpack:///./node_modules/babel-runtime/core-js/object/define-property.js","webpack:///./node_modules/core-js/library/fn/object/define-property.js","webpack:///./node_modules/core-js/library/modules/es6.object.define-property.js","webpack:///./node_modules/core-js/library/fn/object/get-prototype-of.js","webpack:///./node_modules/core-js/library/modules/es6.object.get-prototype-of.js","webpack:///./node_modules/babel-runtime/core-js/symbol/iterator.js","webpack:///./node_modules/core-js/library/fn/symbol/iterator.js","webpack:///./node_modules/core-js/library/modules/_string-at.js","webpack:///./node_modules/core-js/library/modules/_iter-create.js","webpack:///./node_modules/core-js/library/modules/_object-dps.js","webpack:///./node_modules/core-js/library/modules/_html.js","webpack:///./node_modules/core-js/library/modules/es6.array.iterator.js","webpack:///./node_modules/core-js/library/modules/_add-to-unscopables.js","webpack:///./node_modules/babel-runtime/core-js/symbol.js","webpack:///./node_modules/core-js/library/fn/symbol/index.js","webpack:///./node_modules/core-js/library/modules/es6.symbol.js","webpack:///./node_modules/core-js/library/modules/_keyof.js","webpack:///./node_modules/core-js/library/modules/_enum-keys.js","webpack:///./node_modules/core-js/library/modules/_object-gopn-ext.js","webpack:///./node_modules/core-js/library/modules/es7.symbol.async-iterator.js","webpack:///./node_modules/core-js/library/modules/es7.symbol.observable.js","webpack:///./node_modules/babel-runtime/core-js/object/set-prototype-of.js","webpack:///./node_modules/core-js/library/fn/object/set-prototype-of.js","webpack:///./node_modules/core-js/library/modules/es6.object.set-prototype-of.js","webpack:///./node_modules/core-js/library/modules/_set-proto.js","webpack:///./node_modules/babel-runtime/core-js/object/create.js","webpack:///./node_modules/core-js/library/fn/object/create.js","webpack:///./node_modules/core-js/library/modules/es6.object.create.js","webpack:///./node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js","webpack:///./node_modules/core-js/library/fn/object/get-own-property-descriptor.js","webpack:///./node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js","webpack:///./src/lib/QuadTree.js","webpack:///./node_modules/dat-gui/index.js","webpack:///./node_modules/dat-gui/vendor/dat.gui.js","webpack:///./node_modules/dat-gui/vendor/dat.color.js","webpack:///./node_modules/stats-js/build/stats.min.js","webpack:///./src/plugins/expiration.js","webpack:///./node_modules/core-js/library/fn/object/keys.js","webpack:///./node_modules/core-js/library/modules/es6.object.keys.js","webpack:///./node_modules/memory-stats/memory-stats.js","webpack:///./node_modules/core-js/library/fn/get-iterator.js","webpack:///./node_modules/core-js/library/modules/core.get-iterator.js","webpack:///./node_modules/core-js/library/fn/map.js","webpack:///./node_modules/core-js/library/modules/es6.map.js","webpack:///./node_modules/core-js/library/modules/_set-species.js","webpack:///./node_modules/core-js/library/modules/_array-methods.js","webpack:///./node_modules/core-js/library/modules/_array-species-create.js","webpack:///./node_modules/core-js/library/modules/_array-species-constructor.js","webpack:///./node_modules/core-js/library/modules/es7.map.to-json.js","webpack:///./node_modules/core-js/library/modules/_array-from-iterable.js","webpack:///./node_modules/core-js/library/modules/es7.map.of.js","webpack:///./node_modules/core-js/library/modules/es7.map.from.js","webpack:///./node_modules/babel-runtime/core-js/set.js","webpack:///./node_modules/core-js/library/fn/set.js","webpack:///./node_modules/core-js/library/modules/es6.set.js","webpack:///./node_modules/core-js/library/modules/es7.set.to-json.js","webpack:///./node_modules/core-js/library/modules/es7.set.of.js","webpack:///./node_modules/core-js/library/modules/es7.set.from.js","webpack:///./node_modules/babel-runtime/helpers/slicedToArray.js","webpack:///./node_modules/babel-runtime/core-js/is-iterable.js","webpack:///./node_modules/core-js/library/fn/is-iterable.js","webpack:///./node_modules/core-js/library/modules/core.is-iterable.js","webpack:///./node_modules/babel-runtime/core-js/object/entries.js","webpack:///./node_modules/core-js/library/fn/object/entries.js","webpack:///./node_modules/core-js/library/modules/es7.object.entries.js","webpack:///./src/plugins/steering.js","webpack:///./src/plugins/viewportPixi.js","webpack:///./node_modules/babel-runtime/helpers/toConsumableArray.js","webpack:///./node_modules/babel-runtime/core-js/array/from.js","webpack:///./node_modules/core-js/library/fn/array/from.js","webpack:///./node_modules/core-js/library/modules/es6.array.from.js","webpack:///./node_modules/core-js/library/modules/_create-property.js","webpack:///./node_modules/core-js/library/modules/_iter-detect.js","webpack:///./node_modules/babel-runtime/core-js/object/values.js","webpack:///./node_modules/core-js/library/fn/object/values.js","webpack:///./node_modules/core-js/library/modules/es7.object.values.js"],"names":["TARGET_FPS","TARGET_DURATION","requestAnimationFrame","window","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","fn","setTimeout","entityId","system","systemName","systemAttrs","systemCls","componentName","timeNow","timeDelta","componentAttrs","matches","idx","item","handler","Messages","ENTITY_INSERT","ENTITY_DESTROY","World","options","isRunning","isPaused","debug","systems","addSystems","store","subscribers","tickDuration","maxTickDelta","tickAccumulator","lastTickTime","lastDrawTime","boundTickLoop","tickLoop","boundDrawLoop","timestamp","drawLoop","reset","initialize","Date","now","lastEntityId","msg","push","data","systemsData","getSystem","setWorld","timeDeltaMS","updateStart","update","updateEnd","Math","min","tick","drawStart","draw","drawEnd","out","items","generateEntityId","addComponent","world","publish","length","removeComponent","componentManager","getComponent","component","create","Component","attrs","defaults","System","defaultOptions","get","matchComponent","getMatchingComponents","updateComponent","componentRegistry","registerComponent","systemRegistry","registerSystem","PI2","PI","Position","x","y","rotation","sprite","position","positions","PositionSystem","quadtreeMaxAge","quadtreeObjectsPerNode","quadtreeMaxLevels","bounds","left","top","right","bottom","width","height","quadtree","updateBounds","resetQuadtree","halfWidth","halfHeight","insert","g","lineWidth","strokeStyle","fillStyle","moveTo","arc","lineTo","stroke","drawDebugQuadtreeNode","rect","root","objects","forEach","body","nodes","Motion","dx","dy","drotation","MotionSystem","motion","pos","MSG_SPAWN","MSG_DESTROY","MSG_DESPAWN","MSG_CAPTURE_CAMERA","spawn","Spawn","ttl","age","destroy","tombstone","SpawnSystem","subscribe","spawned","captureCamera","toInsert","DatGui","gui","dat","GUI","DrawStats","drawStats","setMode","domElement","style","document","appendChild","tickStats","begin","end","MemoryStatsSystem","stats","Name","name","names","nid","nameComponent","MSG_DAMAGE","MSG_HEAL","health","Health","max","current","show_bar","c","HealthSystem","to","amount","Vector2D","cloneFrom","object","fromArray","array","zero","prototype","add","vector","addScalar","val","eq","subtract","clone","set","setValues","_at_x","_at_y","dist","sqrt","normalise","normalize","isZero","m","magnitude","reverse","toArray","angle","atan2","rotate","cos","sin","angleTo","rotateAround","point","multiplyScalar","multiply","divide","divideScalar","round","dot","Seeker","active","targetName","targetEntityId","targetPosition","thrusterTurnCutoff","thrusterTurnThrottle","acquisitionDelay","radPerSec","SeekerSystem","vSeeker","vTarget","seeker","findEntityByName","targetAngle","direction","offset","abs","thruster","throttle","targetDr","impulseDr","Thruster","stop","useBrakes","deltaV","maxV","ThrusterSystem","vInertia","vThrust","vBrakes","tickDeltaV","currV","overV","brakingDv","TYPE_SIZES","sprites","sceneSprite","wheelDistance","evt","event","w","wheelDelta","d","detail","ViewportWebGL","zoom","zoomMin","zoomMax","zoomWheelFactor","visibleMargin","gridEnabled","gridSize","gridColor","followEnabled","followName","followEntityId","container","querySelector","canvas","createElement","initWebGL","scene","events","ev","updateMetrics","onMouseDown","onMouseMove","onMouseUp","addEventListener","boundOnMouseWheel","onMouseWheel","attachEvent","cursorRawX","cursorRawY","cursorChanged","cursorPosition","cameraX","cameraY","setCursor","clientX","clientY","offsetWidth","offsetHeight","newX","newY","visibleWidth","visibleHeight","visibleLeft","visibleTop","visibleRight","visibleBottom","charAt","updateBackdrop","shapes","WebGLSprite","init","visible","scale","size","color","followEntity","setUniforms","uLineWidth","uCameraZoom","uCameraOrigin","uViewportSize","clientWidth","clientHeight","bufferSize","calculateBufferSizeForScene","buffer","Float32Array","vertexCount","fillBufferFromScene","gl","bufferData","ARRAY_BUFFER","STATIC_DRAW","viewport","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","drawArrays","TRIANGLE_STRIP","_backdrop","gridOffsetX","gridOffsetY","getContext","antialias","preserveDrawingBuffer","premultipliedAlpha","blendFunc","SRC_ALPHA","ONE","enable","BLEND","disable","DEPTH_TEST","program","createProgram","createShader","VERTEX_SHADER","SHADER_VERTEX","FRAGMENT_SHADER","SHADER_FRAGMENT","useProgram","bindBuffer","createBuffer","numAttribs","getProgramParameter","ACTIVE_ATTRIBUTES","attribs","vertexSize","i","info","getActiveAttrib","type","vertexAttribPointer","FLOAT","enableVertexAttribArray","uniforms","numUniforms","ACTIVE_UNIFORMS","getActiveUniform","getUniformLocation","source","shader","shaderSource","compileShader","success","getShaderParameter","COMPILE_STATUS","deleteShader","vertexShader","fragmentShader","attachShader","linkProgram","LINK_STATUS","deleteProgram","reduce","acc","shape","bufferPos","deltaPosition","deltaScale","deltaRotation","lineIdx","shapesIdx","bufferVertex","shapeIdx","sceneKeys","sort","sceneKeysIdx","key","call","drawn","registry","default","getHandler","defaultShape","rot","register","heroShapes","repulsorSides","repulsorPoints","repulsorShapes","map","p","NUM_POINTS","floor","random","MAX_RADIUS","MIN_RADIUS","ROTATION","even","legs","BounceComponent","mass","BounceSystem","dn","dt","mt","v1","v2","v1n","v1t","v2n","v2t","entities","pairs","aEntityId","aCollidable","bEntityId","inCollisionWith","pair","join","aBouncer","bBouncer","resolveElasticCollision","aPosition","aSprite","aMotion","bPosition","bSprite","bMotion","delta","m1","m2","M","aFactor","processDamage","bFactor","eid","c_eid","v_motion","bouncer","damage","dmg","from","Collidable","inCollision","match","entityId2","bCollidable","radii","CollisionSystem","positionSystemName","positionSystem","retrieveBounds","checkCollisionBound","neighbor","checkCollision","iterate","getDebugGraphics","lineStyle","collidables","collidable","drawCircle","PlayerInputSteering","PlayerInputSteeringSystem","gamepadDeadzone","gamepad","pointer","keys","touch","setPointer","windowEvents","keydown","handleKeyDown","keyup","handleKeyUp","k","bind","updateGamepads","updateKeyboard","steering","updateComponentFromKeyboard","updateComponentFromPointer","updateComponentFromGamepad","updateMotionFromTargetAngle","axis1","axis0","dleft","button13","dright","button14","dup","button11","gamepads","navigator","getGamepads","gp","connected","buttons","pressed","axes","axisX","axisY","ddown","button12","keyCode","preventDefault","targetAngleRaw","HordeSpawn","HordeSpawnSystem","viewportSystemName","minCount","maxFrameSpawn","offscreenTTL","spawnMargin","spawnCount","viewportSystem","cnt","spawnOffscreen","hordespawn","margin","h","r","Repulsor","range","force","components","repulsor","repulsorPosition","neighborSprite","neighborPosition","neighborMotion","repelAngle","repelForce","queryBounds","RepulsorSystem","applyRepulsionBound","applyRepulsion","repulsorId","lerp","v0","t","distance","pow","cachedResults","cacheCall","defaultTTL","self","value","has","result","args","DebugCanvas","debugText","debugT","display","zIndex","backgroundColor","ctx","resetTransform","clearRect","translate","drawDebug","restore","MSG_DESTINATION_REACHED","INFINITY","Road","neighbors","Runner","target","RoadRunnerSystem","astarCacheTTL","debugRange","debugRoads","debugRunners","debugPath","mapNeighbor","updateRoads","updateRunners","roads","road","runners","runner","destination","nearest","a","b","path","nextId","destinationPosition","distanceToDestination","neighborId","neighborRoad","startId","goalId","closedSet","openSet","cameFrom","gScore","fScore","astarHeuristicCostEstimate","currentId","currentCost","itemCost","astarReconstructPath","delete","tentative_gScore","neighbor_gScore","pathId","totalPath","unshift","debugColor","randColor","beginPath","setLineDash","font","fillText","circleSize","last","lastPosition","currentPosition","digits","randDigit","Orbiter","OrbiterSystem","vOrbited","vOrbiter","vOld","orbiter","oPos","angleDelta","CanvasSprite","ViewportCanvas","debugDummySprite","save","centerAndZoom","drawBackdrop","drawScene","drawDebugCursor","fillRect","strokeRect","drawSprite","spriteFn","getSprite","spriteRegistry","registerSprite","points","initialized","radius","maxParticles","maxParticleSize","maxVelocity","particles","free","velocity","maxDistance","alpha","globalAlpha","QuadTree","maxObjects","maxLevels","level","_empty","entityMap","subWidth","subHeight","midX","midY","split","index","getIndex","oldNode","objectIndex","indexOf","splice","iteratorFn","optionalParam","Expiration","ExpirationSystem","expiration","Steering","sensorRange","obstacleRepel","SteeringSystem","seekFactor","pushFactor","avoidFactor","avoidSeeAhead","avoidRayWidthFactor","vectors","avoid","seek","flee","wander","evade","pursue","applySteering","lookForObstacle","targetSprite","A","B","n","edgeRange","U","obstacle","rayX","rayY","oppositeLen","hypotenuseLen","theta","asin","isNaN","obstacleAngle","avoidAngle","travel","rayWidth","vRayUnit","hitCircles","steps","step","searchCircleForObstacle","hits","seekTargetName","seekTargetEntityId","drawAngle","vec","ViewportPixi","renderer","PIXI","autoDetectRenderer","autoResize","view","stage","Container","filters","healthBarGraphics","Graphics","addChild","backdrop","graphics","toRemove","filter","removeChild","toAdd","setTransform","resize","render","drawPolygon","lineColor","repulsorShape","rings","startR","endR","startO","endO","endT","ring","heroShape"],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAQ,oBAAoB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAY,2BAA2B;AACvC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kDAA0C,WAAW,EAAE;AACvD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA,kDAA0C,oBAAoB,WAAW;;AAEzE;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpJA,IAAMA,aAAa,EAAnB;AACA,IAAMC,kBAAkB,OAAOD,UAA/B;;AAEA,IAAME,wBACJC,OAAOD,qBAAP,IACAC,OAAOC,2BADP,IAEAD,OAAOE,wBAFP,IAGAF,OAAOG,sBAHP,IAIAH,OAAOI,uBAJP,IAKA,UAAUC,EAAV,EAAc;AAAEC,aAAWD,EAAX,EAAgB,OAAK,EAArB;AAA4B,CAN9C;;AAQA;AACA,IAAIE,iBAAJ;AAAA,IAAcC,eAAd;AAAA,IAAsBC,mBAAtB;AAAA,IAAkCC,oBAAlC;AAAA,IAA+CC,kBAA/C;AAAA,IAA0DC,sBAA1D;AAAA,IACIC,gBADJ;AAAA,IACaC,kBADb;AAAA,IACwBC,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A;AACA;AACA;;;;;;;;;;;;ACHA;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,qDAAqD,OAAO,EAAE;AAC9D;;;;;;;;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;;AAEA,8BAA8B,aAAa;;AAE3C;AACA;AACA;AACA;AACA;AACA,yCAAyC,oCAAoC;AAC7E,6CAA6C,oCAAoC;AACjF,KAAK,4BAA4B,oCAAoC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,mBAAmB;AACnC;AACA;AACA,kCAAkC,2BAA2B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;ACrEA;;;;;;;;;;;;ACAA;;;;;;;;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD,CAAC;AACD;AACA,qBAAqB;AACrB;AACA,SAAS;AACT,GAAG,EAAE;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,sBAAsB;AAChF,kFAAkF,wBAAwB;AAC1G;;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG,YAAY;AACf;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACfA;;AAEA,IAAaE,WAAb;AAAA;;AAAA;AAAA;;AAA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AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,qBAAqB;AACrB,0BAA0B;AAC1B,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;;;;;;;;;;;AC/IA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;ACNA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACXA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;;;;;;;;;;;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACRA;AACA;AACA;;AAEA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA,GAAG,EAAE;AACL;;;;;;;;;;;;;ACXA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,GAAG,EAAE;AACL;;;;;;;;;;;;AC3BA;AACA;AACA;AACA;AACA;A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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,YAAY,eAAe;AAChC;AACA,KAAK;AACL;AACA;;;;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACNA,kBAAkB,0G;;;;;;;;;;;ACAlB;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACJA;AACA;AACA,2FAAuE,gEAA4C;;;;;;;;;;;;ACFnH;AACA;;;;;;;;;;;;ACDA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;ACRD,kBAAkB,mG;;;;;;;;;;;ACAlB;AACA;AACA;;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;;AAEA;AACA,yHAAkF,aAAa,EAAE;;AAEjG;AACA,qDAAqD,4BAA4B;AACjF;AACA;;;;;;;;;;;;ACZA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACZA;AACA;;;;;;;;;;;;;ACDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC,cAAc;AACd,iBAAiB;AACjB;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACjCA,8BAA8B;;;;;;;;;;;;ACA9B,kBAAkB,0F;;;;;;;;;;;ACAlB;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAsB;AACtB,sBAAsB,uBAAuB,WAAW,IAAI;AAC5D,GAAG;AACH,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;AACA,KAAK;AACL;AACA,sBAAsB,mCAAmC;AACzD,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,gCAAgC;AAChG;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,0DAA0D,kBAAkB;;AAE5E;AACA;AACA;AACA,oBAAoB,uBAAuB;;AAE3C,oDAAoD,6BAA6B;;AAEjF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH,0BAA0B,eAAe,EAAE;AAC3C,0BAA0B,gBAAgB;AAC1C,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,OAAO,QAAQ,iCAAiC;AACpG,CAAC;AACD;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC1OA;AACA;AACA;AA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;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;;AAEA,CAAC;;;AAGD;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;AACA;AACA,cAAc;AACd;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA,SAAS;;AAET;AACA,qBAAqB,QAAQ;AAC7B;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;;AAGA,CAAC;;;AAGD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,CAAC;;;AAGD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,CAAC;AACD;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,+BAA+B;AAC/B,OAAO;AACP;AACA;AACA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA,qBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA,qBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA,qBAAqB,iCAAiC;AACtD;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,QAAQ,OAAO;AACf;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;;AAGA;;AAEA;;;AAGA,CAAC;AACD;;;AAGA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB;AACA,aAAa,QAAQ;AACrB,aAAa,YAAY;AACzB,aAAa,QAAQ;AACrB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;;AAGL;;AAEA;AACA;;AAEA,KAAK;;AAEL,qBAAqB;;AAErB;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,eAAe;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA,OAAO;;;AAGP;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;;AAEA;;AAEA,2CAA2C,mBAAmB;AAC9D,2DAA2D,kBAAkB,EAAE;AAC/E,qDAAqD,mBAAmB;AACxE,sDAAsD,mBAAmB;AACzE;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA,qBAAqB,gCAAgC;AACrD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA,qBAAqB,YAAY;AACjC,oBAAoB,MAAM;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,gCAAgC;;AAEhC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,wCAAwC;;AAExC;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B,oBAAoB,MAAM;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;;AAEA,SAAS;;AAET;AACA,qBAAqB,YAAY;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,SAAS;;AAET;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,SAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;;AAEX;AACA;AACA,WAAW;;AAEX;AACA;AACA;;;AAGA,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;AACA;;AAEA;AACA,WAAW,wEAAwE;;AAEnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe;;AAEf;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA,4BAA4B;AAC5B,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;AACA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;;AAEP;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,SAAS;;AAET;AACA;;AAEA,SAAS;;AAET;;AAEA;;AAEA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,6BAA6B;AAC7B;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA,OAAO;;AAEP,KAAK;AACL;AACA;;AAEA;;;AAGA,yBAAyB,oCAAoC;AAC7D;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,OAAO;;AAEP;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;;AAEA;;A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ACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,6BAA6B;AAC7B;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,wGAAwG;AACxG,KAAK;AACL;;AAEA;AACA;AACA,6JAA6J;AAC7J,0JAA0J;AAC1J,qJAAqJ;AACrJ,sJAAsJ;AACtJ,kJAAkJ;AAClJ;;;AAGA;;AAEA,CAAC;AACD;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;AACA;;AAEA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;;AAEA,CAAC;AACD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,CAAC;AACD;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;;AAEA;AACA;AACA;AACA,KAAK;;;AAGL;;AAEA;;AAEA;;;;AAIA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,CAAC;AACD;AACA;AACA,kB;;;;;;;;;;;AC3kHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,U;;AAEA,aAAa;;AAEb;;AAEA;;AAEA;AACA;AACA;;AAEA,OAAO;;AAEP;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;AACA;AACA;;AAEA,OAAO;;AAEP;;AAEA,KAAK;;AAEL;AACA;AACA;AACA;AACA,4CAA4C,QAAQ;AACpD;AACA;AACA;AACA;AACA,KAAK;;AAEL;;;AAGA,iD;;AAEA;;AAEA,OAAO,0CAA0C;;AAEjD,yCAAyC,SAAS;AAClD;AACA;;AAEA,OAAO;;AAEP;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;;AAEA,CAAC;;;AAGD;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA,CAAC;;;AAGD;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;AACA;;AAEA;;AAEA,GAAG;;AAEH;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,OAAO;;AAEP;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;;AAEA,CAAC;;AAED;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,SAAS;;AAET;;AAEA;;AAEA,KAAK;;AAEL;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA,SAAS;;AAET;;AAEA;;AAEA,mDAAmD,EAAE;AACrD;;AAEA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA,SAAS;;AAET;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA,SAAS;;AAET;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;;AAEA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;;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BAAyB,mEAAmE;AAC5F,CAAC;AACD;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AClBD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAsB,aAAa;AACnC,GAAG;AACH;;;;;;;;;;;;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB;AACA;AACA;AACA,wCAAwC;AACxC;AACA,8BAA8B;AAC9B,6BAA6B;AAC7B,+BAA+B;AAC/B,mCAAmC;AACnC,SAAS,iCAAiC;AAC1C;AACA;AACA;AACA;AACA;;;;;;;;;;;;AC3CA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACLA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;ACfA;AACA;;AAEA,uCAAuC,sEAAkD;;;;;;;;;;;;ACHzF;;AAEA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACNA;AACA;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;ACDA,kBAAkB,uF;;;;;;;;;;;ACAlB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACPA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAyB,mEAAmE;AAC5F,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;ACbD;AACA;;AAEA,uCAAuC,sEAAkD;;;;;;;;;;;;ACHzF;AACA;;;;;;;;;;;;ACDA;AACA;;;;;;;;;;;;;ACDA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wDAAwD,+BAA+B;AACvF;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;A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","file":"core.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tvar parentJsonpFunction = window[\"webpackJsonp\"];\n \twindow[\"webpackJsonp\"] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [], result;\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n \t\tif(executeModules) {\n \t\t\tfor(i=0; i < executeModules.length; i++) {\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = executeModules[i]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t};\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// objects to store loaded and loading chunks\n \tvar installedChunks = {\n \t\t7: 0\n \t};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// This file contains only the entry chunk.\n \t// The chunk loading function for additional chunks\n \t__webpack_require__.e = function requireEnsure(chunkId) {\n \t\tvar installedChunkData = installedChunks[chunkId];\n \t\tif(installedChunkData === 0) {\n \t\t\treturn new Promise(function(resolve) { resolve(); });\n \t\t}\n\n \t\t// a Promise means \"currently loading\".\n \t\tif(installedChunkData) {\n \t\t\treturn installedChunkData[2];\n \t\t}\n\n \t\t// setup Promise in chunk cache\n \t\tvar promise = new Promise(function(resolve, reject) {\n \t\t\tinstalledChunkData = installedChunks[chunkId] = [resolve, reject];\n \t\t});\n \t\tinstalledChunkData[2] = promise;\n\n \t\t// start chunk loading\n \t\tvar head = document.getElementsByTagName('head')[0];\n \t\tvar script = document.createElement('script');\n \t\tscript.type = 'text/javascript';\n \t\tscript.charset = 'utf-8';\n \t\tscript.async = true;\n \t\tscript.timeout = 120000;\n\n \t\tif (__webpack_require__.nc) {\n \t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n \t\t}\n \t\tscript.src = __webpack_require__.p + \"\" + chunkId + \".bundle.js\";\n \t\tvar timeout = setTimeout(onScriptComplete, 120000);\n \t\tscript.onerror = script.onload = onScriptComplete;\n \t\tfunction onScriptComplete() {\n \t\t\t// avoid mem leaks in IE.\n \t\t\tscript.onerror = script.onload = null;\n \t\t\tclearTimeout(timeout);\n \t\t\tvar chunk = installedChunks[chunkId];\n \t\t\tif(chunk !== 0) {\n \t\t\t\tif(chunk) {\n \t\t\t\t\tchunk[1](new Error('Loading chunk ' + chunkId + ' failed.'));\n \t\t\t\t}\n \t\t\t\tinstalledChunks[chunkId] = undefined;\n \t\t\t}\n \t\t};\n \t\thead.appendChild(script);\n\n \t\treturn promise;\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 99);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1fbd2566eb1b473d7a72","const TARGET_FPS = 60;\nconst TARGET_DURATION = 1000 / TARGET_FPS;\n\nconst requestAnimationFrame =\n  window.requestAnimationFrame ||\n  window.webkitRequestAnimationFrame ||\n  window.mozRequestAnimationFrame ||\n  window.oRequestAnimationFrame ||\n  window.msRequestAnimationFrame ||\n  function (fn) { setTimeout(fn, (1000/60)); };\n\n// Commonly used temp variables, pre-declared early.\nlet entityId, system, systemName, systemAttrs, systemCls, componentName,\n    timeNow, timeDelta, componentAttrs, matches, idx, item, handler;\n\nexport const Messages = {\n  ENTITY_INSERT: 'entity_insert',\n  ENTITY_DESTROY: 'entity_destroy'\n};\n\nexport class World {\n  constructor(options) {\n    options = options || {};\n\n    this.isRunning = false;\n    this.isPaused = false;\n    this.debug = false;\n\n    this.systems = {};\n    if (options.systems) {\n      this.addSystems(options.systems);\n    }\n\n    this.store = {};\n\n    this.subscribers = {};\n\n    this.tickDuration = TARGET_DURATION;\n    this.maxTickDelta = TARGET_DURATION * 5;\n    this.tickAccumulator = 0;\n\n    this.lastTickTime = 0;\n    this.lastDrawTime = 0;\n\n    this.boundTickLoop = () => this.tickLoop();\n    this.boundDrawLoop = (timestamp) => this.drawLoop(timestamp);\n\n    this.reset();\n  }\n\n  start() {\n    if (this.isRunning) { return; }\n    this.isRunning = true;\n\n    for (const systemName in this.systems) {\n      this.systems[systemName].initialize();\n    }\n\n    // Game logic separated from display rendering\n    // See also: http://www.chandlerprall.com/2012/06/requestanimationframe-is-not-your-logics-friend/\n    this.lastTickTime = Date.now();\n    this.lastDrawTime = 0;\n\n    setTimeout(this.boundTickLoop, this.tickDuration);\n    requestAnimationFrame(this.boundDrawLoop);\n\n    return this;\n  }\n\n  stop() {\n    this.isRunning = false;\n    return this;\n  }\n\n  pause() {\n    this.isPaused = true;\n    return this;\n  }\n\n  resume() {\n    this.isPaused = false;\n    return this;\n  }\n\n  reset() {\n    this.store = {};\n    this.lastEntityId = 0;\n  }\n\n  // TODO: Use a better pubsub library here. But, pubsub-js seemed to perform\n  // badly in a game loop.\n\n  subscribe(msg, handler) {\n    if (!this.subscribers[msg]) {\n      this.subscribers[msg] = [];\n    }\n    this.subscribers[msg].push(handler);\n    return this;\n  }\n\n  unsubscribe(/* msg, handler */) {\n    // TODO\n    return this;\n  }\n\n  publish(msg, data) {\n    if (!this.subscribers[msg]) { return; }\n    for (idx = 0, handler; handler = this.subscribers[msg][idx]; idx++) {\n      handler(msg, data);\n    }\n    return this;\n  }\n\n  addSystems(systemsData) {\n    for (systemName in systemsData) {\n      systemAttrs = systemsData[systemName];\n      systemCls = getSystem(systemName);\n      system = new systemCls(systemAttrs);\n      system.setWorld(this);\n      this.systems[systemName] = system;\n    }\n  }\n\n  getSystem(systemName) {\n    return this.systems[systemName];\n  }\n\n  tick(timeDeltaMS) {\n    timeDelta = timeDeltaMS / 1000;\n    for (systemName in this.systems) {\n      this.systems[systemName].updateStart(timeDelta);\n    }\n    for (systemName in this.systems) {\n      this.systems[systemName].update(timeDelta);\n    }\n    for (systemName in this.systems) {\n      this.systems[systemName].updateEnd(timeDelta);\n    }\n  }\n\n  tickLoop() {\n    timeNow = Date.now();\n    timeDelta = Math.min(timeNow - this.lastTickTime, this.maxTickDelta);\n    this.lastTickTime = timeNow;\n\n    if (!this.isPaused) {\n      // Fixed-step game logic loop\n      // see: http://gafferongames.com/game-physics/fix-your-timestep/\n      this.tickAccumulator += timeDelta;\n      while (this.tickAccumulator > this.tickDuration) {\n        this.tick(this.tickDuration);\n        this.tickAccumulator -= this.tickDuration;\n      }\n    }\n\n    if (this.isRunning) {\n      setTimeout(this.boundTickLoop, this.tickDuration);\n    }\n  }\n\n  draw(timeDeltaMS) {\n    timeDelta = timeDeltaMS / 1000;\n    for (systemName in this.systems) {\n      this.systems[systemName].drawStart(timeDelta);\n    }\n    for (systemName in this.systems) {\n      this.systems[systemName].draw(timeDelta);\n    }\n    for (systemName in this.systems) {\n      this.systems[systemName].drawEnd(timeDelta);\n    }\n  }\n\n  drawLoop(timestamp) {\n    if (!this.lastDrawTime) { this.lastDrawTime = timestamp; }\n    timeDelta = timestamp - this.lastDrawTime;\n    this.lastDrawTime = timestamp;\n\n    if (!this.isPaused) {\n      this.draw(timeDelta);\n    }\n\n    if (this.isRunning) {\n      requestAnimationFrame(this.boundDrawLoop);\n    }\n  }\n\n  generateEntityId() {\n    return ++(this.lastEntityId);\n  }\n\n  insert(...items) {\n    const out = [];\n    for (idx = 0; item = items[idx]; idx++) {\n      entityId = this.generateEntityId();\n      for (componentName in item) {\n        componentAttrs = item[componentName];\n        this.addComponent(entityId, componentName, componentAttrs);\n      }\n      if (this.world) this.world.publish(Messages.ENTITY_INSERT, entityId);\n      out.push(entityId);\n    }\n    return out.length > 1 ? out : out[0];\n  }\n\n  destroy(entityId) {\n    if (this.world) this.world.publish(Messages.ENTITY_DESTROY, entityId);\n    for (componentName in this.store) {\n      this.removeComponent(entityId, componentName);\n    }\n  }\n\n  addComponent(entityId, componentName, componentAttrs) {\n    const componentManager = getComponent(componentName);\n    const component = componentManager.create(componentAttrs);\n    if (!this.store[componentName]) {\n      this.store[componentName] = {};\n    }\n    this.store[componentName][entityId] = component;\n  }\n\n  removeComponent(entityId, componentName) {\n    if (entityId in this.store[componentName]) {\n      delete this.store[componentName][entityId];\n    }\n  }\n\n  hasComponent(entityId, componentName) {\n    return (componentName in this.store) &&\n           (entityId in this.store[componentName]);\n  }\n\n  get(componentName, entityId) {\n    if (!this.store[componentName]) {\n      return null;\n    } else if (!entityId) {\n      return this.store[componentName];\n    } else {\n      return this.store[componentName][entityId];\n    }\n  }\n\n\n}\n\nexport class Component {\n\n  static defaults() {\n    return {};\n  }\n\n  static create(attrs) {\n    return {...this.defaults(), ...(attrs || {})};\n  }\n\n}\n\nexport class System {\n\n  constructor(options) {\n    this.options = {...this.defaultOptions(), ...(options || {})};\n    this.debug = this.options.debug || false;\n  }\n\n  defaultOptions() {\n    return {};\n  }\n\n  setWorld(world) {\n    this.world = world;\n  }\n\n  matchComponent() { return ''; }\n\n  initialize() { }\n\n  getMatchingComponents() {\n    return this.world.get(this.matchComponent());\n  }\n\n  updateStart(/* timeDelta */) { }\n\n  update(timeDelta) {\n    matches = this.getMatchingComponents();\n    for (entityId in matches) {\n      this.updateComponent(timeDelta, entityId, matches[entityId]);\n    }\n  }\n\n  updateComponent(/* timeDelta, entityId, component */) { }\n\n  updateEnd(/* timeDelta */) { }\n\n  drawStart(/* timeDelta */) { }\n\n  draw(/* timeDelta */) { }\n\n  getDebugGraphics() {\n    // TODO make this work again someday\n    return;\n  }\n\n  drawEnd(/* timeDelta */) { }\n\n}\n\nconst componentRegistry = {};\n\nexport function registerComponent(componentName, componentManager) {\n  componentRegistry[componentName] = componentManager;\n}\n\nexport function getComponent(componentName) {\n  return componentRegistry[componentName];\n}\n\nconst systemRegistry = {};\n\nexport function registerSystem(systemName, system) {\n  systemRegistry[systemName] = system;\n}\n\nexport function getSystem(systemName) {\n  return systemRegistry[systemName];\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/core.js","\"use strict\";\n\nexports.__esModule = true;\n\nexports.default = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/classCallCheck.js\n// module id = 1\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _defineProperty = require(\"../core-js/object/define-property\");\n\nvar _defineProperty2 = _interopRequireDefault(_defineProperty);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      (0, _defineProperty2.default)(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/createClass.js\n// module id = 2\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/get-prototype-of\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/get-prototype-of.js\n// module id = 3\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && ((typeof call === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(call)) === \"object\" || typeof call === \"function\") ? call : self;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/possibleConstructorReturn.js\n// module id = 4\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _setPrototypeOf = require(\"../core-js/object/set-prototype-of\");\n\nvar _setPrototypeOf2 = _interopRequireDefault(_setPrototypeOf);\n\nvar _create = require(\"../core-js/object/create\");\n\nvar _create2 = _interopRequireDefault(_create);\n\nvar _typeof2 = require(\"../helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + (typeof superClass === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(superClass)));\n  }\n\n  subClass.prototype = (0, _create2.default)(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) _setPrototypeOf2.default ? (0, _setPrototypeOf2.default)(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/inherits.js\n// module id = 5\n// module chunks = 7","var core = module.exports = { version: '2.5.0' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_core.js\n// module id = 6\n// module chunks = 7","var global = require('./_global');\nvar core = require('./_core');\nvar ctx = require('./_ctx');\nvar hide = require('./_hide');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var IS_WRAP = type & $export.W;\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE];\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];\n  var key, own, out;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if (own && key in exports) continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function (C) {\n      var F = function (a, b, c) {\n        if (this instanceof C) {\n          switch (arguments.length) {\n            case 0: return new C();\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if (IS_PROTO) {\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_export.js\n// module id = 7\n// module chunks = 7","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_wks.js\n// module id = 8\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\nimport QuadTree from '../lib/QuadTree';\n\nconst PI2 = Math.PI * 2;\n\nexport class Position extends Component {\n  static defaults() {\n    return { x: 0, y: 0, rotation: 0 };\n  }\n}\n\nregisterComponent('Position', Position);\n\nlet entityId, sprite, position, positions;\n\nexport class PositionSystem extends System {\n\n  defaultOptions() {\n    return {\n      debug: false,\n      quadtreeMaxAge: 2,\n      quadtreeObjectsPerNode: 5,\n      quadtreeMaxLevels: 5\n    };\n  }\n\n  matchComponent() { return 'Position'; }\n\n  initialize() {\n    this.bounds = {\n      left: 0, top: 0, right: 0, bottom: 0,\n      width: 0, height: 0\n    };\n    this.quadtree = new QuadTree(\n      -1000, -1000, 2000, 2000,\n      this.options.quadtreeObjectsPerNode,\n      this.options.quadtreeMaxLevels\n    );\n  }\n\n  update(timeDelta) {\n    this.updateBounds();\n    this.resetQuadtree(timeDelta);\n    super.update(timeDelta);\n  }\n\n  resetQuadtree() {\n    this.quadtree.reset(\n      this.bounds.left,\n      this.bounds.top,\n      this.bounds.width,\n      this.bounds.height,\n      this.options.quadtreeObjectsPerNode,\n      this.options.quadtreeMaxLevels\n    );\n  }\n\n  updateBounds() {\n    this.bounds.left = this.bounds.top = this.bounds.right = this.bounds.bottom = null;\n    positions = this.getMatchingComponents();\n    for (entityId in positions) {\n      position = positions[entityId];\n      if (this.bounds.left === null || position.left < this.bounds.left) { this.bounds.left = position.left; }\n      if (this.bounds.top === null || position.top < this.bounds.top) { this.bounds.top = position.top; }\n      if (this.bounds.right === null || position.right > this.bounds.right) { this.bounds.right = position.right; }\n      if (this.bounds.bottom === null || position.bottom > this.bounds.bottom) { this.bounds.bottom = position.bottom; }\n    }\n    this.bounds.width = this.bounds.right - this.bounds.left;\n    this.bounds.height = this.bounds.bottom - this.bounds.top;\n  }\n\n  updateComponent(timeDelta, entityId, position) {\n    sprite = this.world.get('Sprite', entityId);\n    if (!sprite) { return; }\n\n    const halfWidth = sprite.width / 2;\n    const halfHeight = sprite.height / 2;\n\n    position.entityId = entityId;\n    position.width = sprite.width;\n    position.height = sprite.height;\n    position.left = position.x - halfWidth;\n    position.top = position.y - halfHeight;\n    position.right = position.x + halfWidth;\n    position.bottom = position.y + halfHeight;\n\n    this.quadtree.insert(position);\n  }\n\n  drawDebug(timeDelta, g) {\n    if (!this.options.debug) { return; }\n\n    g.lineWidth = 4;\n    g.strokeStyle = g.fillStyle = '#882222';\n    positions = this.getMatchingComponents();\n    for (entityId in positions) {\n      position = positions[entityId];\n      sprite = this.world.get('Sprite', entityId);\n      g.moveTo(position.x, position.y);\n      g.arc(position.x, position.y, sprite.width / 2, 0, PI2);\n      g.moveTo(position.x - 20, position.y);\n      g.lineTo(position.x + 20, position.y);\n      g.moveTo(position.x, position.y - 20);\n      g.lineTo(position.x, position.y + 20);\n    }\n    g.stroke();\n\n    g.strokeStyle = g.fillStyle = '#228822';\n    this.drawDebugQuadtreeNode(g, this.quadtree);\n    g.stroke();\n\n    g.strokeStyle = g.fillStyle = '#ffff33';\n    g.moveTo(-20, 0);\n    g.lineTo(20, 0);\n    g.moveTo(0, -20);\n    g.lineTo(0, 20);\n    g.moveTo(0, 0);\n    g.rect(\n      this.bounds.left,\n      this.bounds.top,\n      this.bounds.width,\n      this.bounds.height\n    );\n    g.stroke();\n  }\n\n  drawDebugQuadtreeNode(g, root) {\n    if (!root) { return; }\n\n    g.strokeStyle = g.fillStyle = '#883388';\n    g.moveTo(root.bounds.left, root.bounds.top);\n    g.rect(root.bounds.left, root.bounds.top,\n               root.bounds.width, root.bounds.height);\n\n    g.strokeStyle = g.fillStyle = '#112222';\n    root.objects.forEach(body => {\n      g.moveTo(body.left, body.top);\n      g.rect(body.left, body.top, body.width, body.height);\n    });\n\n    this.drawDebugQuadtreeNode(g, root.nodes[0]);\n    this.drawDebugQuadtreeNode(g, root.nodes[1]);\n    this.drawDebugQuadtreeNode(g, root.nodes[2]);\n    this.drawDebugQuadtreeNode(g, root.nodes[3]);\n  }\n}\n\nregisterSystem('Position', PositionSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/position.js","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-dp.js\n// module id = 10\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nimport './position';\r\n\r\nconst PI2 = Math.PI * 2;\r\n\r\nexport class Motion extends Core.Component {\r\n  static defaults() {\r\n    return { dx: 0, dy: 0, drotation: 0 };\r\n  }\r\n}\r\nCore.registerComponent('Motion', Motion);\r\n\r\nexport class MotionSystem extends Core.System {\r\n  matchComponent() {\r\n    return 'Motion';\r\n  }\r\n  updateComponent(timeDelta, entityId, motion) {\r\n    const pos = this.world.get('Position', entityId);\r\n    pos.x += motion.dx * timeDelta;\r\n    pos.y += motion.dy * timeDelta;\r\n\r\n    // Update the rotation, ensuring a 0..2*Math.PI range.\r\n    pos.rotation = (pos.rotation + (motion.drotation * timeDelta)) % PI2;\r\n    if (pos.rotation < 0) {\r\n      pos.rotation += PI2;\r\n    }\r\n  }\r\n}\r\nCore.registerSystem('Motion', MotionSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/motion.js","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_global.js\n// module id = 12\n// module chunks = 7","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_descriptors.js\n// module id = 13\n// module chunks = 7","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-iobject.js\n// module id = 14\n// module chunks = 7","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_hide.js\n// module id = 15\n// module chunks = 7","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_an-object.js\n// module id = 16\n// module chunks = 7","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_is-object.js\n// module id = 17\n// module chunks = 7","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_ctx.js\n// module id = 18\n// module chunks = 7","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_fails.js\n// module id = 19\n// module chunks = 7","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-keys.js\n// module id = 20\n// module chunks = 7","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_has.js\n// module id = 21\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\n\nexport const MSG_SPAWN = 'spawnSpawn';\nexport const MSG_DESTROY = 'spawnDestroy';\nexport const MSG_DESPAWN = 'spawnDespawn';\nexport const MSG_CAPTURE_CAMERA = 'spawnCaptureCamera';\n\nlet spawn;\n\nexport class Spawn extends Component {\n  static defaults() {\n    return {\n      ttl: null,\n      age: 0,\n      destroy: false,\n      tombstone: null\n    };\n  }\n}\n\nregisterComponent('Spawn', Spawn);\n\nexport class SpawnSystem extends System {\n  defaultOptions() {\n    return {\n\n    };\n  }\n\n  initialize() {\n    this.world.subscribe(MSG_DESTROY, (msg, entityId) => {\n      spawn = this.world.get('Spawn', entityId);\n      if (spawn) { spawn.destroy = true; }\n    });\n  }\n\n  matchComponent() { return 'Spawn'; }\n\n  updateComponent(timeDelta, entityId, spawn) {\n    if (!spawn.spawned) {\n      spawn.spawned = true;\n      this.world.publish(MSG_SPAWN, entityId);\n      if (spawn.captureCamera) {\n        this.world.publish(MSG_CAPTURE_CAMERA, entityId);\n      }\n    }\n    if (spawn.ttl !== null) {\n      spawn.age += timeDelta;\n      if (spawn.age >= spawn.ttl) {\n        spawn.destroy = true;\n      }\n    }\n    if (spawn.destroy) {\n      if (spawn.tombstone !== null) {\n        const toInsert = (typeof spawn.tombstone === 'function')\n          ? spawn.tombstone(spawn, entityId)\n          : spawn.tombstone;\n        this.world.insert(toInsert);\n      }\n      this.world.publish(MSG_DESPAWN, entityId);\n      this.world.destroy(entityId);\n    }\n  }\n}\n\nregisterSystem('Spawn', SpawnSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/spawn.js","import * as Core from '../lib/core';\r\n\r\nimport dat from 'dat-gui';\r\n\r\nexport class DatGui extends Core.System {\r\n\r\n  initialize() {\r\n    this.gui = new dat.GUI();\r\n  }\r\n\r\n}\r\nCore.registerSystem('DatGui', DatGui);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/datGui.js","import * as Core from '../lib/core';\r\n\r\nimport Stats from 'stats-js';\r\n\r\nexport class DrawStats extends Core.System {\r\n\r\n  initialize() {\r\n\r\n    this.drawStats = new Stats();\r\n    this.drawStats.setMode(0);\r\n    this.drawStats.domElement.style.position = 'absolute';\r\n    this.drawStats.domElement.style.left = '0px';\r\n    this.drawStats.domElement.style.top = '0px';\r\n    document.body.appendChild(this.drawStats.domElement);\r\n\r\n    this.tickStats = new Stats();\r\n    this.tickStats.setMode(0);\r\n    this.tickStats.domElement.style.position = 'absolute';\r\n    this.tickStats.domElement.style.left = '0px';\r\n    this.tickStats.domElement.style.top = '55px';\r\n    document.body.appendChild(this.tickStats.domElement);\r\n\r\n  }\r\n\r\n  updateStart() { this.tickStats.begin(); }\r\n\r\n  updateEnd() { this.tickStats.end(); }\r\n\r\n  drawStart() { this.drawStats.begin(); }\r\n\r\n  drawEnd() { this.drawStats.end(); }\r\n\r\n}\r\nCore.registerSystem('DrawStats', DrawStats);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/drawStats.js","import * as Core from '../lib/core';\r\n\r\nimport MemoryStats from 'memory-stats';\r\n\r\nexport class MemoryStatsSystem extends Core.System {\r\n\r\n  initialize() {\r\n    this.stats = new MemoryStats();\r\n    this.stats.domElement.style.position = 'fixed';\r\n    this.stats.domElement.style.left = '85px';\r\n    this.stats.domElement.style.top = '0px';\r\n    document.body.appendChild(this.stats.domElement);\r\n  }\r\n\r\n  draw() { this.stats.update(); }\r\n\r\n}\r\nCore.registerSystem('MemoryStats', MemoryStatsSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/memoryStats.js","import * as Core from '../lib/core';\r\n\r\nexport class Name extends Core.Component {\r\n  static defaults() {\r\n    return { name: 'unnamed' };\r\n  }\r\n  static findEntityByName(world, name) {\r\n    const names = world.get('Name');\r\n    for (const nid in names) {\r\n      const nameComponent = names[nid];\r\n      if (nameComponent.name === name) {\r\n        return nid;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nCore.registerComponent('Name', Name);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/name.js","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-object.js\n// module id = 27\n// module chunks = 7","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.string.iterator.js\n// module id = 28\n// module chunks = 7","module.exports = {};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iterators.js\n// module id = 29\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _getPrototypeOf = require(\"../core-js/object/get-prototype-of\");\n\nvar _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);\n\nvar _getOwnPropertyDescriptor = require(\"../core-js/object/get-own-property-descriptor\");\n\nvar _getOwnPropertyDescriptor2 = _interopRequireDefault(_getOwnPropertyDescriptor);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = (0, _getOwnPropertyDescriptor2.default)(object, property);\n\n  if (desc === undefined) {\n    var parent = (0, _getPrototypeOf2.default)(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/get.js\n// module id = 30\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\nimport { MSG_DESTROY } from './spawn';\n\nexport const MSG_DAMAGE = 'healthDamage';\nexport const MSG_HEAL = 'healthHeal';\n\nlet health;\n\nexport class Health extends Component {\n  static defaults() {\n    return {\n      max: 1000,\n      current: null,\n      show_bar: true\n    };\n  }\n  static create(attrs) {\n    const c = super.create(attrs);\n    c.current = c.max;\n    return c;\n  }\n}\n\nregisterComponent('Health', Health);\n\nexport class HealthSystem extends System {\n\n  initialize() {\n    this.world\n      .subscribe(MSG_DAMAGE, (msg, data) => {\n        health = this.world.get('Health', data.to);\n        if (health) { health.current -= data.amount; }\n      })\n      .subscribe(MSG_HEAL, (msg, data) => {\n        health = this.world.get('Health', data.to);\n        if (health) { health.current += data.amount; }\n      });\n  }\n\n  matchComponent() { return 'Health'; }\n\n  updateComponent(timeDelta, entityId, health) {\n    if (health.current === null) {\n      health.current = health.max;\n    }\n    if (health.current < 0) {\n      this.world.publish(MSG_DESTROY, entityId);\n    }\n  }\n\n}\n\nregisterSystem('Health', HealthSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/health.js","/*\r\n  Originally by Vitalii [Nayjest] Stepanenko <gmail@vitaliy.in>\r\n  Tweaky & fixes by Les Orchard <me@lmorchard.com>\r\n*/\r\n\r\nexport default function Vector2D(x, y) {\r\n  this.x = x || 0;\r\n  this.y = y || 0;\r\n}\r\n\r\nVector2D.cloneFrom = function(object) {\r\n  return new Vector2D(object.x, object.y);\r\n};\r\n\r\nVector2D.fromArray = function(array) {\r\n  return new Vector2D(array[0], array[1]);\r\n};\r\n\r\nVector2D.zero = new Vector2D(0, 0);\r\n\r\nVector2D.prototype.add = function(vector) {\r\n  this.x += vector.x;\r\n  this.y += vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.addScalar = function(val) {\r\n  this.x += val;\r\n  this.y += val;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.eq = function(vector) {\r\n  return vector.x === this.x && vector.y === this.y;\r\n};\r\n\r\nVector2D.prototype.subtract = function(vector) {\r\n  this.x -= vector.x;\r\n  this.y -= vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.clone = function() {\r\n  return new Vector2D(this.x, this.y);\r\n};\r\n\r\nVector2D.prototype.set = function(vector) {\r\n  this.x = vector.x;\r\n  this.y = vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.setValues = function(_at_x, _at_y) {\r\n  this.x = _at_x;\r\n  this.y = _at_y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.dist = function(vector) {\r\n  return Math.sqrt((vector.x - this.x) * (vector.x - this.x) + (vector.y - this.y) * (vector.y - this.y));\r\n};\r\n\r\nVector2D.prototype.normalise = function() {\r\n  return this.normalize();\r\n};\r\n\r\nVector2D.prototype.normalize = function() {\r\n  if (!this.isZero()) {\r\n    const m = this.magnitude();\r\n    this.x /= m;\r\n    this.y /= m;\r\n  }\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.isZero = function() {\r\n  return this.x === 0 && this.y === 0;\r\n};\r\n\r\nVector2D.prototype.reverse = function() {\r\n  this.x = -this.x;\r\n  this.y = -this.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.magnitude = function() {\r\n  return Math.sqrt(this.x * this.x + this.y * this.y);\r\n};\r\n\r\nVector2D.prototype.toArray = function() {\r\n  return [this.x, this.y];\r\n};\r\n\r\nVector2D.prototype.angle = function() {\r\n  return Math.atan2(this.y, this.x);\r\n};\r\n\r\nVector2D.prototype.rotate = function(angle) {\r\n  const cos = Math.cos(angle);\r\n  const sin = Math.sin(angle);\r\n  return this.setValues(this.x * cos - this.y * sin, this.x * sin + this.y * cos);\r\n};\r\n\r\nVector2D.prototype.angleTo = function(vector) {\r\n  return Math.atan2(vector.y - this.y, vector.x - this.x);\r\n};\r\n\r\nVector2D.prototype.rotateAround = function(point, angle) {\r\n  return this.subtract(point).rotate(angle).add(point);\r\n};\r\n\r\nVector2D.prototype.multiplyScalar = function(val) {\r\n  this.x *= val;\r\n  this.y *= val;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.multiply = function(vector) {\r\n  this.x *= vector.x;\r\n  this.y *= vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.divide = function(vector) {\r\n  this.x /= vector.x;\r\n  this.y /= vector.y;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.divideScalar = function(val) {\r\n  this.x /= val;\r\n  this.y /= val;\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.round = function() {\r\n  this.x = Math.round(this.x);\r\n  this.y = Math.round(this.y);\r\n  return this;\r\n};\r\n\r\nVector2D.prototype.dot = function(vector) {\r\n  return (this.x * vector.x) + (this.y * vector.y);\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/Vector2D.js","import * as Core from '../lib/core';\n\nimport '../plugins/position';\nimport '../plugins/motion';\n\nimport Vector2D from '../lib/Vector2D';\n\nexport class Seeker extends Core.Component {\n  static defaults() {\n    return {\n      active: true,\n      targetName: null,\n      targetEntityId: null,\n      targetPosition: null,\n      thrusterTurnCutoff: null,\n      thrusterTurnThrottle: 0.25,\n      acquisitionDelay: 0,\n      radPerSec: Math.PI\n    };\n  }\n}\n\nCore.registerComponent('Seeker', Seeker);\n\nexport class SeekerSystem extends Core.System {\n\n  matchComponent() { return 'Seeker'; }\n\n  initialize() {\n    this.vSeeker = new Vector2D();\n    this.vTarget = new Vector2D();\n  }\n\n  updateComponent(timeDelta, entityId, seeker) {\n    const position = this.world.get('Position', entityId);\n    const motion = this.world.get('Motion', entityId);\n    if (!position || !motion) { return; }\n\n    if (!seeker.active) {\n      motion.drotation = 0;\n      return;\n    }\n\n    // Look up the orbited entity ID, if only name given.\n    if (seeker.targetName && !seeker.targetEntityId) {\n      seeker.targetEntityId = Core.getComponent('Name')\n        .findEntityByName(this.world, seeker.targetName);\n    }\n\n    // Process a delay before the seeker 'acquires' the target and\n    // starts steering. Makes missiles look interesting.\n    if (seeker.acquisitionDelay > 0) {\n      seeker.acquisitionDelay -= timeDelta;\n      return;\n    }\n\n    // Accept either a raw x/y coord or entity ID as target\n    let targetPosition = seeker.targetPosition;\n    if (!targetPosition) {\n      targetPosition = this.world.get('Position', seeker.targetEntityId);\n    }\n    if (!targetPosition) { return; }\n\n    // Set up the vectors for angle math...\n    this.vSeeker.setValues(position.x, position.y);\n    this.vTarget.setValues(targetPosition.x, targetPosition.y);\n\n    // Get the target angle, ensuring a 0..2*Math.PI range.\n    let targetAngle = this.vSeeker.angleTo(this.vTarget);\n    if (targetAngle < 0) {\n      targetAngle += (2 * Math.PI);\n    }\n\n    // Pick the direction from current to target angle\n    let direction = (targetAngle < position.rotation) ? -1 : 1;\n\n    // If the offset between the angles is more than half a circle, go\n    // the other way because it'll be shorter.\n    const offset = Math.abs(targetAngle - position.rotation);\n    if (offset > Math.PI) {\n      direction = 0 - direction;\n    }\n\n    // Throttle back for sharp turns if necessary\n    if (seeker.thrusterTurnCutoff !== null) {\n      const thruster = this.world.get('Thruster', entityId);\n      thruster.active = true;\n      thruster.throttle = (offset > seeker.thrusterTurnCutoff)\n        ? seeker.thrusterTurnThrottle : 1.0;\n    }\n\n    // Work out the desired delta-rotation to steer toward target\n    const targetDr = direction * Math.min(seeker.radPerSec, offset / timeDelta);\n\n    // Calculate the delta-rotation impulse required to meet the goal,\n    // but constrain to the capability of the steering thrusters\n    let impulseDr = (targetDr - motion.drotation);\n    if (Math.abs(impulseDr) > seeker.radPerSec) {\n      if (impulseDr > 0) {\n        impulseDr = seeker.radPerSec;\n      } else if (impulseDr < 0) {\n        impulseDr = 0 - seeker.radPerSec;\n      }\n    }\n    motion.drotation += impulseDr;\n\n  }\n\n}\n\nCore.registerSystem('Seeker', SeekerSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/seeker.js","import * as Core from '../lib/core';\n\nimport './position';\nimport './motion';\n\nimport Vector2D from '../lib/Vector2D';\n\nexport class Thruster extends Core.Component {\n  static defaults() {\n    return {\n      active: true,\n      stop: false,\n      useBrakes: true,\n      throttle: 1.0,\n      deltaV: 0,\n      maxV: 0\n    };\n  }\n}\nCore.registerComponent('Thruster', Thruster);\n\nexport class ThrusterSystem extends Core.System {\n\n  matchComponent() { return 'Thruster'; }\n\n  initialize() {\n    this.vInertia = new Vector2D();\n    this.vThrust = new Vector2D();\n    this.vBrakes = new Vector2D();\n  }\n\n  updateComponent(timeDelta, entityId, thruster) {\n\n    if (!thruster.active) { return; }\n\n    const pos = this.world.get('Position', entityId);\n    const motion = this.world.get('Motion', entityId);\n    if (!pos || !motion) { return; }\n\n    // Inertia is current motion\n    this.vInertia.setValues(motion.dx, motion.dy);\n\n    // delta-v available for the current tick\n    const tickDeltaV = timeDelta * thruster.deltaV;\n\n    if (!thruster.stop) {\n      // Create thrust vector per rotation and add to inertia.\n      this.vThrust.setValues(tickDeltaV, 0);\n      this.vThrust.rotate(pos.rotation);\n      this.vInertia.add(this.vThrust);\n    }\n\n    if (thruster.useBrakes) {\n      // Try to enforce the max_v limit with braking thrust.\n      const maxV = thruster.stop ? 0 : (thruster.throttle * thruster.maxV);\n      const currV = this.vInertia.magnitude();\n      const overV = currV - maxV;\n      if (overV > 0) {\n        // Braking delta-v is max thruster output or remaining overage,\n        // whichever is smallest. Braking vector opposes inertia.\n        const brakingDv = Math.min(tickDeltaV, overV);\n        this.vBrakes.setValues(this.vInertia.x, this.vInertia.y);\n        this.vBrakes.normalize();\n        this.vBrakes.multiplyScalar(0-brakingDv);\n        this.vInertia.add(this.vBrakes);\n      }\n      if (thruster.stop && currV === 0) {\n        thruster.active = false;\n      }\n    }\n\n    // Update inertia. Note that we've been careful only to make changes\n    // to inertia within the delta-v of the thruster. Other influences\n    // on inertia should be preserved.\n    motion.dx = this.vInertia.x;\n    motion.dy = this.vInertia.y;\n  }\n\n}\nCore.registerSystem('Thruster', ThrusterSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/thruster.js","import * as Core from '../lib/core';\n\nconst PI2 = Math.PI * 2;\n\n// https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/Constants\nconst TYPE_SIZES = {\n  0x1406: 1, // FLOAT\n  0x8B50: 2, // FLOAT_VEC2\n  0x8B51: 3, // FLOAT_VEC3\n  0x8B52: 4  // FLOAT_VEC4\n};\n\nlet entityId, position, sprites, sprite, sceneSprite;\n\n// See also: http://phrogz.net/JS/wheeldelta.html\nconst wheelDistance = function(evt){\n  if (!evt) evt = event;\n  const w=evt.wheelDelta, d=evt.detail;\n  if (d){\n    if (w) return w/d/40*d>0?1:-1; // Opera\n    else return -d/3;              // Firefox;         TODO: do not /3 for OS X\n  } else return w/120;             // IE/Safari/Chrome TODO: /3 for Chrome OS X\n};\n\nexport class ViewportWebGL extends Core.System {\n\n  defaultOptions() {\n    return {\n      lineWidth: 2,\n      zoom: 1.0,\n      zoomMin: 0.1,\n      zoomMax: 10.0,\n      zoomWheelFactor: 0.05,\n      visibleMargin: 250,\n      gridEnabled: true,\n      gridSize: 250,\n      gridColor: 0x222222,\n      followEnabled: true,\n      followName: null,\n      followEntityId: null\n    };\n  }\n\n  initialize() {\n    this.container = document.querySelector(this.options.container);\n    this.canvas = document.createElement('canvas');\n    this.container.appendChild(this.canvas);\n\n    this.initWebGL(this.canvas);\n\n    this.scene = {};\n\n    const events = {\n      'resize': (ev) => { this.updateMetrics(ev); },\n      'orientationchange': (ev) => { this.updateMetrics(ev); },\n      'mousedown': (ev) => { this.onMouseDown(ev); },\n      'mousemove': (ev) => { this.onMouseMove(ev); },\n      'mouseup': (ev) => { this.onMouseUp(ev); }\n    };\n\n    for (const name in events) {\n      this.canvas.addEventListener(name, events[name], false);\n    }\n\n    // See also: http://phrogz.net/JS/wheeldelta.html\n    const boundOnMouseWheel = (ev) => this.onMouseWheel(ev);\n    if (window.addEventListener){\n      window.addEventListener('mousewheel', boundOnMouseWheel, false); // Chrome/Safari/Opera\n      window.addEventListener('DOMMouseScroll', boundOnMouseWheel, false); // Firefox\n    } else if (window.attachEvent){\n      window.attachEvent('onmousewheel', boundOnMouseWheel); // IE\n    }\n\n    this.followEnabled = this.options.followEnabled;\n    this.zoom = this.options.zoom;\n    this.followEntityId = this.options.followEntityId;\n    this.gridEnabled = this.options.gridEnabled;\n    this.lineWidth = this.options.lineWidth;\n\n    this.cursorRawX = 0;\n    this.cursorRawY = 0;\n\n    this.cursorChanged = false;\n    this.cursorPosition = { x: 0, y: 0 };\n\n    this.cameraX = 0;\n    this.cameraY = 0;\n\n    this.updateMetrics();\n  }\n\n  onMouseWheel(ev) {\n    this.zoom += wheelDistance(ev) * this.options.zoomWheelFactor;\n    if (this.zoom < this.options.zoomMin) {\n      this.zoom = this.options.zoomMin;\n    }\n    if (this.zoom > this.options.zoomMax) {\n      this.zoom = this.options.zoomMax;\n    }\n  }\n\n  // TODO: Use a symbol for 'mouse{Down,Move,Up}' message?\n\n  onMouseDown(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseDown', this.cursorPosition);\n  }\n\n  onMouseMove(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseMove', this.cursorPosition);\n  }\n\n  onMouseUp(ev) {\n    this.setCursor(ev.clientX, ev.clientY, true);\n    this.world.publish('mouseUp', this.cursorPosition);\n  }\n\n  setCursor(x, y) {\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n\n    this.cursorRawX = x;\n    this.cursorRawY = y;\n\n    const newX = ((x - (width / 2)) / this.zoom) + this.cameraX;\n    const newY = ((y - (height / 2)) / this.zoom) + this.cameraY;\n\n    this.cursorChanged = false;\n    if (newX !== this.cursorPosition.x || newY !== this.cursorPosition.y) {\n      this.cursorChanged = true;\n      this.cursorPosition.x = newX;\n      this.cursorPosition.y = newY;\n    }\n\n    return this.cursorPosition;\n  }\n\n  updateMetrics() {\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n\n    this.visibleWidth = width / this.zoom;\n    this.visibleHeight = height / this.zoom;\n\n    this.visibleLeft = (0 - this.visibleWidth / 2) + this.cameraX;\n    this.visibleTop = (0 - this.visibleHeight / 2) + this.cameraY;\n    this.visibleRight = this.visibleLeft + this.visibleWidth;\n    this.visibleBottom = this.visibleTop + this.visibleHeight;\n  }\n\n  update(timeDelta) {\n    this.updateMetrics();\n\n    this.setCursor(this.cursorRawX, this.cursorRawY);\n    // FIXME: Should be able to skip doing this unless\n    // this.cursorChanged === true, but for some reason that's not working\n    this.world.publish('mouseMove', this.cursorPosition);\n\n    sprites = this.world.get('Sprite') || {};\n\n    // Delete any stage items not found in sprites, unless they're particles\n    // with \"_\" prefix\n    for (entityId in this.scene) {\n      if (entityId.charAt(0) !== '_' && !(entityId in sprites)) {\n        delete this.scene[entityId];\n      }\n    }\n\n    this.updateBackdrop(timeDelta);\n\n    // Create items for any sprites not found in stage\n    for (entityId in sprites) {\n      sprite = sprites[entityId];\n      position = this.world.get('Position', entityId);\n\n      if (!(entityId in this.scene)) {\n        this.scene[entityId] = {\n          position: [0.0, 0.0],\n          shapes: WebGLSprite.init(sprite, entityId, timeDelta, this.world)\n        };\n      }\n\n      sprite.visible = (\n        (position.right > this.visibleLeft - this.options.visibleMargin) &&\n        (position.left < this.visibleRight + this.options.visibleMargin) &&\n        (position.bottom > this.visibleTop - this.options.visibleMargin) &&\n        (position.top < this.visibleBottom + this.options.visibleMargin)\n      );\n\n      sceneSprite = this.scene[entityId];\n      sceneSprite.visible = sprite.visible;\n      sceneSprite.position[0] = position.x;\n      sceneSprite.position[1] = position.y;\n      sceneSprite.rotation = position.rotation;\n      sceneSprite.scale = sprite.size;\n      sceneSprite.color = [\n        // TODO: this math is terrible\n        (sprite.color / 256 / 256) % 256 / 256,\n        (sprite.color / 256) % 256 / 256,\n        sprite.color % 256 / 256,\n        1.0\n      ];\n      WebGLSprite.update(sceneSprite, sprite, entityId, timeDelta, this.world);\n    }\n  }\n\n  draw() {\n    this.followEntity();\n\n    this.canvas.width = this.container.offsetWidth;\n    this.canvas.height = this.container.offsetHeight;\n\n    // gl.uniform1f(uniforms.uTime, currDrawTime);\n    this.setUniforms({\n      uLineWidth: [0.001 * this.lineWidth],\n      uCameraZoom: [this.zoom],\n      uCameraOrigin: [this.cameraX, this.cameraY],\n      uViewportSize: [this.canvas.clientWidth, this.canvas.clientHeight]\n    });\n\n    // Re-allocate larger buffer if current is too small for the scene.\n    const bufferSize = this.calculateBufferSizeForScene();\n    if (bufferSize > this.buffer.length) {\n      this.buffer = new Float32Array(Math.max(bufferSize * 1.5, this.buffer.length * 2));\n    }\n\n    const vertexCount = this.fillBufferFromScene();\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, this.buffer, this.gl.STATIC_DRAW);\n    this.gl.viewport(0, 0, this.gl.canvas.width, this.gl.canvas.height);\n\n    this.gl.clearColor(0, 0, 0, 0);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n\n    this.gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, vertexCount);\n  }\n\n  followEntity() {\n    if (!this.followEnabled) {\n      this.cameraX = this.cameraY = 0;\n      return;\n    }\n    if (this.options.followName && !this.followEntityId) {\n      // Look up named entity, if necessary.\n      this.followEntityId = Core.getComponent('Name')\n        .findEntityByName(this.world, this.options.followName);\n    }\n    if (this.followEntityId) {\n      // Adjust the viewport center offset to the entity position\n      const position = this.world.get('Position', this.followEntityId);\n      if (position) {\n        this.cameraX = position.x;\n        this.cameraY = position.y;\n        this.setCursor(this.cursorRawX, this.cursorRawY);\n      }\n    }\n  }\n\n  updateBackdrop() {\n    if (!this.gridEnabled) {\n      delete this.scene._backdrop;\n      return;\n    }\n\n    if (!this.scene._backdrop) {\n      this.scene._backdrop = {\n        visible: true,\n        position: [0.0, 0.0],\n        color: [1.0, 1.0, 1.0, 0.5],\n        scale: 1,\n        rotation: Math.PI / 2,\n        shapes: []\n      };\n    }\n\n    const sceneSprite = this.scene._backdrop;\n\n    const gridSize = this.options.gridSize;\n    const gridOffsetX = this.visibleLeft % gridSize;\n    const gridOffsetY = this.visibleTop % gridSize;\n\n    sceneSprite.position[0] = this.visibleLeft;\n    sceneSprite.position[1] = this.visibleTop;\n    sceneSprite.shapes.length = 0;\n\n    for (let x = -gridOffsetX; x < this.visibleWidth; x += gridSize) {\n      sceneSprite.shapes.push([[x, 0], [x, this.visibleHeight + gridSize]]);\n    }\n    for (let y = -gridOffsetY; y < this.visibleHeight; y += gridSize) {\n      sceneSprite.shapes.push([[0, y], [this.visibleWidth + gridSize, y]]);\n    }\n  }\n\n  initWebGL(canvas) {\n    const gl = this.gl = canvas.getContext('webgl', {\n      antialias: true,\n      preserveDrawingBuffer: true,\n      premultipliedAlpha: false\n    });\n\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\n    gl.enable(gl.BLEND);\n    gl.disable(gl.DEPTH_TEST);\n\n    const program = this.createProgram(\n      this.createShader(gl.VERTEX_SHADER, SHADER_VERTEX),\n      this.createShader(gl.FRAGMENT_SHADER, SHADER_FRAGMENT)\n    );\n    gl.useProgram(program);\n\n    // Set up for data buffer\n    gl.bindBuffer(gl.ARRAY_BUFFER, gl.createBuffer());\n\n    // First pass through attributes to count total vertex size and index by name\n    const numAttribs = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    const attribs = {};\n    let vertexSize = 0;\n    for (let i = 0; i < numAttribs; i++) {\n      const info = gl.getActiveAttrib(program, i);\n      const size = TYPE_SIZES[info.type];\n      vertexSize += size;\n      attribs[info.name] = i;\n    }\n\n    // Second pass through attributes to set up attribute pointers into the buffer\n    let pos = 0;\n    for (let i = 0; i < numAttribs; i++) {\n      const info = gl.getActiveAttrib(program, i);\n      const size = TYPE_SIZES[info.type];\n      gl.vertexAttribPointer(i, size, gl.FLOAT, false, vertexSize * 4, pos * 4);\n      gl.enableVertexAttribArray(i);\n      pos += size;\n    }\n\n    // Index uniform locations by name\n    const uniforms = {};\n    const numUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n    for (let i = 0; i < numUniforms; i++) {\n      const info = gl.getActiveUniform(program, i);\n      uniforms[info.name] = gl.getUniformLocation(program, info.name);\n    }\n\n    const buffer = new Float32Array(200000);\n\n    Object.assign(this, { gl, uniforms, attribs, vertexSize, buffer });\n  }\n\n  createShader(type, source) {\n    const shader = this.gl.createShader(type);\n    this.gl.shaderSource(shader, source);\n    this.gl.compileShader(shader);\n    const success = this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS);\n    if (success) { return shader; }\n\n    // console.log('shader', type, 'failed to compile', this.gl.getShaderInfoLog(shader));\n    this.gl.deleteShader(shader);\n  }\n\n  createProgram(vertexShader, fragmentShader) {\n    const program = this.gl.createProgram();\n    this.gl.attachShader(program, vertexShader);\n    this.gl.attachShader(program, fragmentShader);\n    this.gl.linkProgram(program);\n    const success = this.gl.getProgramParameter(program, this.gl.LINK_STATUS);\n    if (success) { return program; }\n\n    // console.log(this.gl.getProgramInfoLog(program));\n    this.gl.deleteProgram(program);\n  }\n\n  calculateBufferSizeForScene() {\n    return Object.values(this.scene)\n      .reduce((acc, item) =>\n        item.shapes.reduce((acc, shape) =>\n          acc + (shape.length - 0.5) * this.vertexSize * 4, 0), 0);\n  }\n\n  fillBufferFromScene() {\n    let vertexCount = 0;\n    let bufferPos = 0;\n    let visible, shape, position, scale, rotation,\n        deltaPosition, deltaScale, deltaRotation, color,\n        lineIdx, shapesIdx, shapes;\n\n    const bufferVertex = (shapeIdx, lineIdx) => {\n      vertexCount++;\n      this.buffer[bufferPos++] = lineIdx;\n      this.buffer[bufferPos++] = shape[shapeIdx - 1][0];\n      this.buffer[bufferPos++] = shape[shapeIdx - 1][1];\n      this.buffer[bufferPos++] = shape[shapeIdx][0];\n      this.buffer[bufferPos++] = shape[shapeIdx][1];\n      this.buffer[bufferPos++] = position[0];\n      this.buffer[bufferPos++] = position[1];\n      this.buffer[bufferPos++] = scale;\n      this.buffer[bufferPos++] = rotation;\n      this.buffer[bufferPos++] = deltaPosition[0];\n      this.buffer[bufferPos++] = deltaPosition[1];\n      this.buffer[bufferPos++] = deltaScale;\n      this.buffer[bufferPos++] = deltaRotation;\n      this.buffer[bufferPos++] = color[0];\n      this.buffer[bufferPos++] = color[1];\n      this.buffer[bufferPos++] = color[2];\n      this.buffer[bufferPos++] = color[3];\n    };\n\n    const sceneKeys = Object.keys(this.scene);\n    sceneKeys.sort();\n    for (let sceneKeysIdx = 0; sceneKeysIdx < sceneKeys.length; sceneKeysIdx++) {\n      ({\n        visible, shapes, position=[0.0, 0.0], scale=0, rotation=0,\n        deltaPosition=[0.0, 0.0], deltaScale=0.0, deltaRotation=0.0,\n        color=[1, 1, 1, 1]\n      } = this.scene[sceneKeys[sceneKeysIdx]]);\n      if (!visible) { continue; }\n      for (shapesIdx = 0; shapesIdx < shapes.length; shapesIdx++) {\n        shape = shapes[shapesIdx];\n        bufferVertex(1, 0);\n        for (lineIdx = 1; lineIdx < shape.length; lineIdx += 1) {\n          bufferVertex(lineIdx, 0);\n          bufferVertex(lineIdx, 1);\n          bufferVertex(lineIdx, 2);\n          bufferVertex(lineIdx, 3);\n        }\n        bufferVertex(shape.length - 1, 3);\n      }\n    }\n\n    return vertexCount;\n  }\n\n  setUniforms(data) {\n    Object.keys(data).forEach(key =>\n      this.gl[`uniform${data[key].length}f`]\n        .call(this.gl, this.uniforms[key], ...data[key]));\n  }\n}\n\nCore.registerSystem('ViewportWebGL', ViewportWebGL);\n\nexport class WebGLSprite extends Core.Component {\n  static defaults() {\n    return {\n      name: null,\n      color: 0xffffff,\n      size: 100,\n      width: null,\n      height: null,\n      drawn: false,\n      visible: false\n    };\n  }\n  static create(attrs) {\n    const c = super.create(attrs);\n    if (!c.width) { c.width = c.size; }\n    if (!c.height) { c.height = c.size; }\n    return c;\n  }\n  static register(name, handler) {\n    if (!WebGLSprite.registry) { WebGLSprite.registry = {}; }\n    WebGLSprite.registry[name] = handler;\n  }\n  static getHandler(name) {\n    return name in WebGLSprite.registry\n      ? WebGLSprite.registry[name]\n      : WebGLSprite.registry.default;\n  }\n  static init(sprite, entityId, timeDelta, world) {\n    return WebGLSprite\n      .getHandler(sprite.name)\n      .init(sprite, entityId, timeDelta, world);\n  }\n  static update(sceneSprite, sprite, entityId, timeDelta, world) {\n    const handler = WebGLSprite.getHandler(sprite.name);\n    return 'update' in handler\n      ? handler.update(sceneSprite, sprite, entityId, timeDelta, world)\n      : false;\n  }\n}\n\nCore.registerComponent('Sprite', WebGLSprite);\n\nconst defaultShape = [ [-0.5, 0], [0.5, 0], [0, 0], [0, -0.5], [0, 0.5], [0, 0] ];\nfor (let idx = 0; idx < 8; idx++) {\n  const rot = idx * (PI2 / 8);\n  defaultShape.push([ 0.5 * Math.cos(rot), 0.5 * Math.sin(rot) ]);\n}\ndefaultShape.push([ 0.5, 0 ]);\n\nWebGLSprite.register('default', {\n  init() { return defaultShape; }\n});\n\nconst heroShapes = [\n  [\n    [ 0.0,     0.5],\n    [ 0.125,   0.4167],\n    [ 0.25,    0.0],\n    [ 0.375,  -0.1667],\n    [ 0.25,   -0.5],\n    [ 0.125,  -0.5],\n    [ 0.0625, -0.25],\n    [-0.0625, -0.25],\n    [-0.125,  -0.5],\n    [-0.25,   -0.5],\n    [-0.375,  -0.1667],\n    [-0.25,    0.0],\n    [-0.125,   0.4167],\n    [ 0.0,     0.5],\n  ]\n];\nWebGLSprite.register('hero', {\n  init() { return heroShapes; }\n});\n\nconst repulsorSides = 8;\nconst repulsorPoints = [];\nfor (let idx = 0; idx < repulsorSides; idx++) {\n  const rot = idx * (PI2 / repulsorSides);\n  repulsorPoints.push([ Math.cos(rot), Math.sin(rot) ]);\n}\nrepulsorPoints.push(repulsorPoints[0]);\n\nconst repulsorShapes = [\n  repulsorPoints.map(p => [p[0] * 1, p[1] * 1]),\n  repulsorPoints.map(p => [p[0] * 2, p[1] * 2]),\n  repulsorPoints.map(p => [p[0] * 3, p[1] * 3]),\n  [\n    [-0.50,    0.0],\n    [-0.375,  -0.50],\n    [-0.25,   -0.50],\n    [-0.0625,  0.25],\n    [ 0.0625,  0.25],\n    [ 0.25,   -0.50],\n    [ 0.375,  -0.50],\n    [ 0.50,    0.0],\n    [ 0.375,   0.50],\n    [ 0.25,    0.50],\n    [ 0.0625, -0.25],\n    [-0.0625, -0.25],\n    [-0.25,    0.50],\n    [-0.375,   0.50],\n    [-0.50,    0.0]\n  ]\n];\nWebGLSprite.register('repulsor', {\n  init() { return repulsorShapes; }\n});\n\nWebGLSprite.register('asteroid', {\n  init(sprite) {\n    const NUM_POINTS = 7 + Math.floor(8 * Math.random());\n    const MAX_RADIUS = 0.50;\n    const MIN_RADIUS = 0.35;\n    const ROTATION = PI2 / NUM_POINTS;\n\n    sprite.shape = [];\n    for (let idx = 0; idx < NUM_POINTS; idx++) {\n      const rot = idx * ROTATION;\n      const dist = (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\n      sprite.shape.push([dist * Math.cos(rot), dist * Math.sin(rot)]);\n    }\n\n    sprite.shape.push(sprite.shape[0]);\n    return [\n      sprite.shape\n    ];\n  }\n});\n\nWebGLSprite.register('mine', {\n  init(sprite) {\n    let NUM_POINTS = 10 + Math.floor(10 * Math.random());\n    if (NUM_POINTS % 2 !== 0) { NUM_POINTS++; }\n    const ROTATION = PI2 / NUM_POINTS;\n    const MAX_RADIUS = 0.6;\n    const MIN_RADIUS = 0.1;\n\n    let even = false;\n\n    sprite.legs = [];\n    for (let idx = 0; idx < NUM_POINTS; idx++) {\n      const dist = even ? 0.1 : (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\n      const rot = idx * ROTATION;\n      sprite.legs.push([ dist * Math.cos(rot), dist * Math.sin(rot) ]);\n      even = !even;\n    }\n    sprite.legs.push([ sprite.legs[0][0], sprite.legs[0][1] ]);\n    sprite.shape = sprite.legs;\n    sprite.drawn = true;\n\n    return [\n      sprite.shape\n    ];\n  },\n  update(/* sceneSprite, sprite, entityId, timeDelta, world */) {\n    /*\n    if (sprite.drawn && Math.random() < 0.15) {\n      sceneSprite.shape = sprite.legs.map(p => [\n        p[0] * (0.9 + 0.5 * Math.random()),\n        p[1] * (0.9 + 0.5 * Math.random())\n      ]);\n    }\n    */\n  }\n});\n\nconst SHADER_VERTEX = `\n// see also: http://m1el.github.io/woscope-how/\nprecision mediump float;\n#define EPS 1E-6\n#define PI 3.141592653589793\n#define PI_2 6.283185307179586\n#define PI_H 1.5707963267948966\n#define PI_Q 0.7853981633974483\n\nuniform float uTime;\nuniform float uLineWidth;\nuniform float uCameraZoom;\nuniform float uCameraRotation;\nuniform vec2 uCameraOrigin;\nuniform vec2 uViewportSize;\n\nattribute float aIdx;\nattribute vec4 aLine;\nattribute vec4 aTransform;\nattribute vec4 aDeltaTransform;\nattribute vec4 aColor;\n\nvarying vec4 uvl;\nvarying vec4 vColor;\nvarying float vLen;\n\nvoid main () {\n  float c, s;\n\n  mat3 mViewportToClipSpace = mat3(\n    2.0 / uViewportSize.x, 0, 0,\n    0, -2.0 / uViewportSize.y, 0,\n    0, 0, 0\n  );\n\n  c = cos(uCameraRotation);\n  s = sin(uCameraRotation);\n  mat3 mCameraRotation = mat3(\n    c, -s, 0.0,\n    s, c, 0.0,\n    0.0, 0.0, 1.0\n  );\n\n  mat3 mCameraOrigin = mat3(\n    1.0, 0.0, 0.0,\n    0.0, 1.0, 0.0,\n    -uCameraOrigin.x, -uCameraOrigin.y, 1.0\n  );\n\n  mat3 mCameraZoom = mat3(\n    uCameraZoom, 0.0, 0.0,\n    0.0, uCameraZoom, 0.0,\n    0.0, 0.0, 1.0\n  );\n\n  c = cos(-aTransform.w + PI_H + (aDeltaTransform.w * uTime));\n  s = sin(-aTransform.w + PI_H + (aDeltaTransform.w * uTime));\n  mat3 mRotation = mat3(\n    c, -s, 0.0,\n    s, c, 0.0,\n    0.0, 0.0, 1.0\n  );\n\n  mat3 mPosition = mat3(\n    1.0, 0.0, 0.0,\n    0.0, 1.0, 0.0,\n    aTransform.x + (aDeltaTransform.x * uTime), aTransform.y + (aDeltaTransform.y * uTime), 1.0\n  );\n\n  mat3 mScale = mat3(\n    aTransform.z + (aDeltaTransform.z * uTime), 0.0, 0.0,\n    0.0, aTransform.z + (aDeltaTransform.z * uTime), 0.0,\n    0.0, 0.0, 1.0\n  );\n\n  // TODO: Move some of these matrices into JS?\n  mat3 mAll = mViewportToClipSpace\n    * mCameraZoom * mCameraRotation * mCameraOrigin\n    * mPosition * mScale * mRotation;\n\n  vec2 tStart = (mAll * vec3(aLine.xy, 1)).xy;\n  vec2 tEnd = (mAll * vec3(aLine.zw, 1)).xy;\n\n  float tang;\n  vec2 current;\n  float idx = aIdx;\n  if (idx >= 2.0) {\n    current = tEnd;\n    tang = 1.0;\n  } else {\n    current = tStart;\n    tang = -1.0;\n  }\n\n  float side = (mod(idx, 2.0)-0.5)*2.0;\n  vec2 dir = tEnd-tStart;\n\n  vColor = aColor;\n\n  uvl.xy = vec2(tang, side);\n  uvl.w = floor(aIdx / 4.0 + 0.5);\n  uvl.z = length(dir);\n  if (uvl.z > EPS) {\n    dir = dir / uvl.z;\n  } else {\n    // If the segment is too short draw a square;\n    dir = vec2(1.0, 0.0);\n  }\n  vec2 norm = vec2(-dir.y, dir.x);\n  gl_Position = vec4((current+(tang*dir+norm*side)*uLineWidth),0.0,1.0);\n}\n`;\n\nconst SHADER_FRAGMENT = `\nprecision mediump float;\nvarying vec4 vColor;\n\nvoid main (void)\n{\n    gl_FragColor = vColor;\n}\n`;\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/viewportWebGL.js","module.exports = { \"default\": require(\"core-js/library/fn/object/assign\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/assign.js\n// module id = 36\n// module chunks = 7","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_property-desc.js\n// module id = 37\n// module chunks = 7","exports.f = {}.propertyIsEnumerable;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-pie.js\n// module id = 38\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nimport './position';\r\nimport './motion';\r\nimport { MSG_DAMAGE } from './health';\r\n\r\nimport Vector2D from '../lib/Vector2D';\r\n\r\nexport class BounceComponent extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      mass: 1000.0\r\n    };\r\n  }\r\n}\r\n\r\nCore.registerComponent('Bounce', BounceComponent);\r\n\r\nexport class BounceSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Bounce'; }\r\n\r\n  initialize() {\r\n    this.dn = new Vector2D();\r\n    this.dt = new Vector2D();\r\n    this.mt = new Vector2D();\r\n    this.v1 = new Vector2D();\r\n    this.v2 = new Vector2D();\r\n    this.v1n = new Vector2D();\r\n    this.v1t = new Vector2D();\r\n    this.v2n = new Vector2D();\r\n    this.v2t = new Vector2D();\r\n  }\r\n\r\n  update(timeDelta) {\r\n    const entities = this.world;\r\n    const matches = this.getMatchingComponents();\r\n\r\n    const pairs = {};\r\n    for (const aEntityId in matches) {\r\n\r\n      // const bounce = matches[aEntityId];\r\n      const aCollidable = entities.get('Collidable', aEntityId);\r\n\r\n      for (const bEntityId in aCollidable.inCollisionWith) {\r\n        const pair = [aEntityId, bEntityId];\r\n        pair.sort();\r\n        pairs[pair.join(':')] = pair;\r\n      }\r\n\r\n      // TODO: Process world boundary edge bounce?\r\n\r\n    }\r\n\r\n    for (const key in pairs) {\r\n      const aEntityId = pairs[key][0];\r\n      const aBouncer = entities.get('Bounce', aEntityId);\r\n      if (!aBouncer) { continue; }\r\n\r\n      const bEntityId = pairs[key][1];\r\n      const bBouncer = entities.get('Bounce', bEntityId);\r\n      if (!bBouncer) { continue; }\r\n\r\n      this.resolveElasticCollision(timeDelta, aEntityId, aBouncer, bEntityId, bBouncer);\r\n    }\r\n\r\n  }\r\n\r\n  // See also:\r\n  // http://en.m.wikipedia.org/wiki/Elastic_collision\r\n  // http://en.m.wikipedia.org/wiki/Dot_product\r\n  // https://github.com/Edifear/volleyball/blob/master/collision.html\r\n  // https://github.com/DominikWidomski/Processing/blob/master/sketch_canvas_red_particles/particles.pde#L47\r\n  resolveElasticCollision(timeDelta, aEntityId, aBouncer, bEntityId, bBouncer) {\r\n\r\n    const entities = this.world;\r\n\r\n    const aPosition = entities.get('Position', aEntityId);\r\n    const aSprite = entities.get('Sprite', aEntityId);\r\n    const aMotion = entities.get('Motion', aEntityId);\r\n\r\n    const bPosition = entities.get('Position', bEntityId);\r\n    const bSprite = entities.get('Sprite', bEntityId);\r\n    const bMotion = entities.get('Motion', bEntityId);\r\n\r\n    // First, back both entities off to try to prevent sticking\r\n    /*\r\n    aPosition.x -= aMotion.dx * timeDelta;\r\n    aPosition.y -= aMotion.dy * timeDelta;\r\n    bPosition.x -= bMotion.dx * timeDelta;\r\n    bPosition.y -= bMotion.dy * timeDelta;\r\n    const radii, dx, dy;\r\n    while (true) {\r\n      aPosition.x -= aMotion.dx * timeDelta;\r\n      aPosition.y -= aMotion.dy * timeDelta;\r\n      bPosition.x -= bMotion.dx * timeDelta;\r\n      bPosition.y -= bMotion.dy * timeDelta;\r\n\r\n      radii = (aSprite.size + bSprite.size) / 2;\r\n      dx = aPosition.x - bPosition.x;\r\n      dy = aPosition.y - bPosition.y;\r\n      if (dx*dx + dy*dy > radii*radii) { break; }\r\n    }\r\n    */\r\n\r\n    // Vector between entities\r\n    this.dn.setValues(aPosition.x - bPosition.x, aPosition.y - bPosition.y);\r\n\r\n    // Distance between entities\r\n    const delta = this.dn.magnitude();\r\n\r\n    // Normal vector of the collision plane\r\n    this.dn.normalize();\r\n\r\n    // Tangential vector of the collision plane\r\n    this.dt.setValues(this.dn.y, -this.dn.x);\r\n\r\n    // HACK: avoid divide by zero\r\n    if (delta === 0) { bPosition.x += 0.01; }\r\n\r\n    // Get total mass for entities\r\n    const m1 = aBouncer.mass;\r\n    const m2 = bBouncer.mass;\r\n    const M = m1 + m2;\r\n\r\n    // Minimum translation vector to push entities apart\r\n    this.mt.setValues(\r\n      this.dn.x * (aSprite.width + bSprite.width - delta) * 1.1,\r\n      this.dn.y * (aSprite.height + bSprite.height - delta) * 1.1\r\n    );\r\n\r\n    // Velocity vectors of entities before collision\r\n    this.v1.setValues((aMotion) ? aMotion.dx : 0, (aMotion) ? aMotion.dy : 0);\r\n    this.v2.setValues((bMotion) ? bMotion.dx : 0, (bMotion) ? bMotion.dy : 0);\r\n\r\n    // split the velocity vector of the first entity into a normal\r\n    // and a tangential component in respect of the collision plane\r\n    this.v1n.setValues(\r\n      this.dn.x * this.v1.dot(this.dn),\r\n      this.dn.y * this.v1.dot(this.dn)\r\n    );\r\n    this.v1t.setValues(\r\n      this.dt.x * this.v1.dot(this.dt),\r\n      this.dt.y * this.v1.dot(this.dt)\r\n    );\r\n\r\n    // split the velocity vector of the second entity into a normal\r\n    // and a tangential component in respect of the collision plane\r\n    this.v2n.setValues(\r\n      this.dn.x * this.v2.dot(this.dn),\r\n      this.dn.y * this.v2.dot(this.dn)\r\n    );\r\n    this.v2t.setValues(\r\n      this.dt.x * this.v2.dot(this.dt),\r\n      this.dt.y * this.v2.dot(this.dt)\r\n    );\r\n\r\n    // calculate new velocity vectors of the entities, the tangential\r\n    // component stays the same, the normal component changes analog to\r\n    // the 1-Dimensional case\r\n\r\n    if (aMotion) {\r\n      const aFactor = (m1 - m2) / M * this.v1n.magnitude() +\r\n                    2 * m2 / M * this.v2n.magnitude();\r\n      aMotion.dx = this.v1t.x + this.dn.x * aFactor;\r\n      aMotion.dy = this.v1t.y + this.dn.y * aFactor;\r\n      this.processDamage(aEntityId, bEntityId, aMotion, aBouncer, m1);\r\n    }\r\n\r\n    if (bMotion) {\r\n      const bFactor = (m2 - m1) / M * this.v2n.magnitude() +\r\n                    2 * m1 / M * this.v1n.magnitude();\r\n      bMotion.dx = this.v2t.x - this.dn.x * bFactor;\r\n      bMotion.dy = this.v2t.y - this.dn.y * bFactor;\r\n      this.processDamage(bEntityId, aEntityId, bMotion, bBouncer, m1);\r\n    }\r\n\r\n  }\r\n\r\n  processDamage(eid, c_eid, v_motion, bouncer, m1) {\r\n    if (!bouncer.damage) { return; }\r\n\r\n    // Convert a fraction of the rebound velocity into damage by mass\r\n    const dmg = Math.sqrt(v_motion.dx * v_motion.dx + v_motion.dy * v_motion.dy) *\r\n                bouncer.damage * m1;\r\n\r\n    this.world.publish(MSG_DAMAGE, {\r\n      to: eid,\r\n      from: c_eid,\r\n      amount: dmg / 2\r\n    });\r\n\r\n    this.world.publish(MSG_DAMAGE, {\r\n      to: c_eid,\r\n      from: eid,\r\n      amount: dmg / 2\r\n    });\r\n  }\r\n\r\n}\r\n\r\nCore.registerSystem('Bounce', BounceSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/bounce.js","require('./es6.array.iterator');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar TO_STRING_TAG = require('./_wks')('toStringTag');\n\nvar DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +\n  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +\n  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +\n  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +\n  'TextTrackList,TouchList').split(',');\n\nfor (var i = 0; i < DOMIterables.length; i++) {\n  var NAME = DOMIterables[i];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n  Iterators[NAME] = Iterators.Array;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/web.dom.iterable.js\n// module id = 40\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nexport class Collidable extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      inCollision: false,\r\n      inCollisionWith: {}\r\n    };\r\n  }\r\n}\r\n\r\nCore.registerComponent('Collidable', Collidable);\r\n\r\nlet match, matches, entityId, entityId2, position, aCollidable, bCollidable, dx, dy, radii;\r\n\r\nexport class CollisionSystem extends Core.System {\r\n\r\n  defaultOptions() {\r\n    return {\r\n      positionSystemName: 'Position'\r\n    };\r\n  }\r\n\r\n  matchComponent() { return 'Collidable'; }\r\n\r\n  initialize() {\r\n    this.positionSystem = this.world.getSystem(this.options.positionSystemName);\r\n    this.width = this.options.width;\r\n    this.height = this.options.height;\r\n    this.retrieveBounds = {};\r\n    this.checkCollisionBound = (neighbor, component) =>\r\n      this.checkCollision(neighbor, component);\r\n  }\r\n\r\n  update(/* timeDelta */) {\r\n    matches = this.getMatchingComponents();\r\n    for (entityId in matches) {\r\n      match = matches[entityId];\r\n      match.inCollision = false;\r\n      for (entityId2 in match.inCollisionWith) {\r\n        delete match.inCollisionWith[entityId2];\r\n      }\r\n    }\r\n    for (entityId in matches) {\r\n      position = this.world.get('Position', entityId);\r\n      if (position) {\r\n        this.positionSystem.quadtree.iterate(position, this.checkCollisionBound, position);\r\n      }\r\n    }\r\n  }\r\n\r\n  checkCollision(bPosition, aPosition) {\r\n    if (aPosition.entityId === bPosition.entityId) { return; }\r\n\r\n    aCollidable = this.world.get('Collidable', aPosition.entityId);\r\n    bCollidable = this.world.get('Collidable', bPosition.entityId);\r\n\r\n    if (!aCollidable || !bCollidable) { return; }\r\n\r\n    dx = aPosition.x - bPosition.x;\r\n    dy = aPosition.y - bPosition.y;\r\n\r\n    // TODO: Pluggable shape intersection detection here?\r\n\r\n    // Check collision circle via distance\r\n    radii = (aPosition.width + bPosition.width) / 2;\r\n    if (dx*dx + dy*dy > radii*radii) { return; }\r\n\r\n    aCollidable.inCollision = true;\r\n    aCollidable.inCollisionWith[bPosition.entityId] = 1;\r\n\r\n    bCollidable.inCollision = true;\r\n    bCollidable.inCollisionWith[aPosition.entityId] = 1;\r\n  }\r\n\r\n  draw(/* timeDelta */) {\r\n    const g = this.getDebugGraphics();\r\n    if (!g) { return; }\r\n\r\n    g.lineStyle(4, 0x999999);\r\n    const collidables = this.world.get('Collidable');\r\n    for (const entityId in collidables) {\r\n      const collidable = collidables[entityId];\r\n      const position = this.world.get('Position', entityId);\r\n\r\n      if (collidable.inCollision) {\r\n        g.drawCircle(position.x, position.y, 40);\r\n      }\r\n    }\r\n\r\n  }\r\n}\r\n\r\nCore.registerSystem('Collision', CollisionSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/collision.js","module.exports = { \"default\": require(\"core-js/library/fn/object/keys\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/keys.js\n// module id = 42\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\n\nexport class PlayerInputSteering extends Component {\n  static defaults() {\n    return {\n      active: true,\n      radPerSec: Math.PI * 2\n    };\n  }\n}\n\nregisterComponent('PlayerInputSteering', PlayerInputSteering);\n\nconst PI2 = Math.PI * 2;\n\nexport class PlayerInputSteeringSystem extends System {\n\n  defaultOptions() {\n    return {\n      gamepadDeadzone: 0.2\n    };\n  }\n\n  matchComponent() { return 'PlayerInputSteering'; }\n\n  initialize() {\n    this.gamepad = { active: false };\n    this.pointer = { active: false, x: 0, y: 0 };\n    this.keys = { active: false };\n    this.touch = { active: false, x: 0, y: 0 };\n\n    this.world\n      .subscribe('mouseDown', (msg, cursorPosition) =>\n        this.setPointer(true, cursorPosition))\n      .subscribe('mouseUp', (msg, cursorPosition) =>\n        this.setPointer(false, cursorPosition))\n      .subscribe('mouseMove', (msg, cursorPosition) =>\n        this.setPointer(this.pointer.active, cursorPosition));\n\n    const windowEvents = {\n      keydown: this.handleKeyDown,\n      keyup: this.handleKeyUp\n    };\n    Object.keys(windowEvents)\n      .forEach(k => window.addEventListener(k, windowEvents[k].bind(this)));\n  }\n\n  setPointer(active, position) {\n    this.pointer.active = active;\n    this.pointer.x = position.x;\n    this.pointer.y = position.y;\n  }\n\n  update(timeDelta) {\n    this.updateGamepads(timeDelta);\n    this.updateKeyboard(timeDelta);\n    super.update(timeDelta);\n  }\n\n  updateComponent(timeDelta, entityId, steering) {\n    const thruster = this.world.get('Thruster', entityId);\n    const motion = this.world.get('Motion', entityId);\n\n    thruster.active = true;\n    thruster.stop = false;\n\n    if (this.keys.active) {\n      return this.updateComponentFromKeyboard(timeDelta, entityId, steering);\n    }\n\n    if (this.pointer.active) {\n      return this.updateComponentFromPointer(timeDelta, entityId, steering);\n    }\n\n    if (this.gamepad.active) {\n      return this.updateComponentFromGamepad(timeDelta, entityId, steering);\n    }\n\n    thruster.stop = true;\n    motion.drotation = 0;\n  }\n\n  updateComponentFromPointer(timeDelta, entityId, steering) {\n    const position = this.world.get('Position', entityId);\n    this.updateMotionFromTargetAngle(timeDelta, entityId, steering,\n      Math.atan2(this.pointer.y - position.y, this.pointer.x - position.x));\n  }\n\n  updateComponentFromGamepad(timeDelta, entityId, steering) {\n    this.updateMotionFromTargetAngle(timeDelta, entityId, steering,\n      Math.atan2(this.gamepad.axis1, this.gamepad.axis0));\n  }\n\n  updateComponentFromKeyboard(timeDelta, entityId, steering) {\n    const thruster = this.world.get('Thruster', entityId);\n    const motion = this.world.get('Motion', entityId);\n\n    const dleft  = (this.keys[65] || this.keys[37] || this.gamepad.button13);\n    const dright = (this.keys[68] || this.keys[39] || this.gamepad.button14);\n    const dup    = (this.keys[87] || this.keys[38] || this.gamepad.button11);\n    // const ddown  = (this.keys[83] || this.keys[40] || this.gamepad.button12);\n\n    if (dup) {\n      thruster.active = true;\n    } else {\n      thruster.stop = true;\n    }\n\n    const direction = dleft ? -1 : (dright ? 1 : 0);\n    const targetDr = direction * steering.radPerSec;\n    motion.drotation = targetDr;\n  }\n\n  updateGamepads() {\n    const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];\n\n    // TODO: specify which gamepad, i.e. for multiplayer\n    for (let i = 0; i < gamepads.length; i++) {\n      const gp = gamepads[i];\n      if (!gp || !gp.connected) continue;\n      gp.buttons.forEach((val, idx) => this.gamepad[`button${idx}`] = val.pressed);\n      gp.axes.forEach((val, idx) => this.gamepad[`axis${idx}`] = val);\n      break; // stop after the first gamepad\n    }\n\n    Object.keys(this.gamepad).forEach(k => {\n      if (!this.gamepad[k]) { delete this.gamepad[k]; }\n    });\n\n    const axisX = this.gamepad.axis0;\n    const axisY = this.gamepad.axis1;\n    this.gamepad.active =\n      (Math.abs(axisX) > 0 || Math.abs(axisY) > 0) &&\n      (Math.sqrt(axisX * axisX + axisY * axisY) > this.options.gamepadDeadzone);\n  }\n\n  updateKeyboard() {\n    const dleft  = (this.keys[65] || this.keys[37] || this.gamepad.button13);\n    const dright = (this.keys[68] || this.keys[39] || this.gamepad.button14);\n    const dup    = (this.keys[87] || this.keys[38] || this.gamepad.button11);\n    const ddown  = (this.keys[83] || this.keys[40] || this.gamepad.button12);\n\n    this.keys.active = (dleft || dright || dup || ddown);\n  }\n\n  handleKeyDown(ev) {\n    this.keys[ev.keyCode] = true;\n    ev.preventDefault();\n  }\n\n  handleKeyUp(ev) {\n    delete this.keys[ev.keyCode];\n    ev.preventDefault();\n  }\n\n  updateMotionFromTargetAngle(timeDelta, entityId, steering, targetAngleRaw) {\n    const position = this.world.get('Position', entityId);\n    const motion = this.world.get('Motion', entityId);\n\n    const targetAngle = (targetAngleRaw < 0) ?\n      targetAngleRaw + PI2 : targetAngleRaw;\n\n    // Pick the direction from current to target angle\n    let direction = (targetAngle < position.rotation) ? -1 : 1;\n\n    // If the offset between the angles is more than half a circle, go\n    // the other way because it'll be shorter.\n    const offset = Math.abs(targetAngle - position.rotation);\n    if (offset > Math.PI) {\n      direction = 0 - direction;\n    }\n\n    // Work out the desired delta-rotation to steer toward target\n    const targetDr = direction * Math.min(steering.radPerSec, offset / timeDelta);\n\n    // Calculate the delta-rotation impulse required to meet the goal,\n    // but constrain to the capability of the steering thrusters\n    let impulseDr = (targetDr - motion.drotation);\n    if (Math.abs(impulseDr) > steering.radPerSec) {\n      if (impulseDr > 0) {\n        impulseDr = steering.radPerSec;\n      } else if (impulseDr < 0) {\n        impulseDr = 0 - steering.radPerSec;\n      }\n    }\n\n    motion.drotation += impulseDr;\n  }\n\n}\n\nregisterSystem('PlayerInputSteering', PlayerInputSteeringSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/playerInputSteering.js","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-length.js\n// module id = 44\n// module chunks = 7","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_uid.js\n// module id = 45\n// module chunks = 7","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-create.js\n// module id = 46\n// module chunks = 7","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_set-to-string-tag.js\n// module id = 47\n// module chunks = 7","import { Component, System, registerComponent, registerSystem } from '../lib/core';\n\nimport { MSG_DESTROY } from './spawn';\n\n// Commonly used temp variables, pre-declared early.\nlet entityId, matches, sprite;\n\nexport class HordeSpawn extends Component {\n  static defaults() {\n    return { age: 0 };\n  }\n}\n\nregisterComponent('HordeSpawn', HordeSpawn);\n\nexport class HordeSpawnSystem extends System {\n\n  defaultOptions() {\n    return {\n      viewportSystemName: 'ViewportPixi',\n      minCount: 100,\n      maxFrameSpawn: 50,\n      offscreenTTL: 1.0,\n      spawnMargin: 100,\n      spawn: () => {}\n    };\n  }\n\n  initialize() {\n    this.spawnCount = 0;\n    this.viewportSystem = this.world.getSystem(this.options.viewportSystemName);\n  }\n\n  matchComponent() { return 'HordeSpawn'; }\n\n  update(timeDelta) {\n    matches = this.getMatchingComponents() || {};\n    this.spawnCount = Object.keys(matches).length;\n    if (this.spawnCount < this.options.minCount) {\n      const cnt = Math.max(\n        this.options.maxFrameSpawn,\n        this.options.minCount - this.spawnCount\n      );\n      for (let i = 0; i < cnt; i++) {\n        this.spawnOffscreen();\n      }\n    }\n    for (entityId in matches) {\n      this.updateComponent(timeDelta, entityId, matches[entityId]);\n    }\n  }\n\n  updateComponent(timeDelta, entityId, hordespawn) {\n    sprite = this.world.get('Sprite', entityId);\n    if (sprite.visible) {\n      hordespawn.age = 0;\n    } else {\n      hordespawn.age += timeDelta;\n      if (hordespawn.age >= this.options.offscreenTTL) {\n        this.world.publish(MSG_DESTROY, entityId);\n      }\n    }\n  }\n\n  spawnOffscreen() {\n    const {visibleLeft, visibleRight, visibleTop, visibleBottom} = this.viewportSystem;\n    const margin = this.options.spawnMargin;\n    const w = (visibleRight + margin) - (visibleLeft - margin);\n    const h = (visibleBottom + margin) - (visibleTop - margin);\n    const r = Math.random();\n\n    let x, y;\n\n    if (r < 0.5) {\n      y = (visibleTop - margin) + (Math.random() * h);\n    } else {\n      x = (visibleLeft - margin) + (Math.random() * w);\n    }\n\n    if (r < 0.25) {\n      x = visibleLeft - margin;\n    } else if (r < 0.5) {\n      x = visibleRight + margin;\n    } else if (r < 0.75) {\n      y = visibleTop - margin;\n    } else {\n      y = visibleBottom + margin;\n    }\n\n    this.options.spawn(x, y);\n  }\n\n}\n\nregisterSystem('HordeSpawn', HordeSpawnSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/hordeSpawn.js","import { Component, System, registerComponent, registerSystem } from '../lib/core';\n\nconst PI2 = Math.PI * 2;\n\nexport class Repulsor extends Component {\n    static defaults() {\n      return {\n        active: true,\n        range: 500,\n        force: 200\n      };\n    }\n}\n\nregisterComponent('Repulsor', Repulsor);\n\nlet components, component, entityId, position, repulsor, repulsorPosition,\n    neighborSprite, neighborPosition, neighborMotion, repelAngle, repelForce,\n    dist;\n\nconst queryBounds = {};\n\nexport class RepulsorSystem extends System {\n\n  defaultOptions() {\n    return {\n      debug: false,\n      positionSystemName: 'Position'\n    };\n  }\n\n  matchComponent() { return 'Repulsor'; }\n\n  initialize() {\n    this.positionSystem = this.world.getSystem(this.options.positionSystemName);\n    this.applyRepulsionBound = (neighbor, component) =>\n      this.applyRepulsion(neighbor, component);\n  }\n\n  updateComponent(timeDelta, entityId, component) {\n    if (!component.active) { return; }\n\n    position = this.world.get('Position', entityId);\n\n    queryBounds.left = position.left - component.range;\n    queryBounds.right = position.right + component.range;\n    queryBounds.top = position.top - component.range;\n    queryBounds.bottom = position.bottom + component.range;\n\n    this.positionSystem.quadtree.iterate(queryBounds, this.applyRepulsionBound, entityId);\n  }\n\n  applyRepulsion(neighbor, repulsorId) {\n    if (entityId === neighbor.entityId) { return; }\n\n    neighborSprite = this.world.get('Sprite', neighbor.entityId);\n    if (neighborSprite.name !== 'mine') { return; }\n\n    repulsor = this.world.get('Repulsor', repulsorId);\n    repulsorPosition = this.world.get('Position', repulsorId);\n    neighborPosition = this.world.get('Position', neighbor.entityId);\n    neighborMotion = this.world.get('Motion', neighbor.entityId);\n\n    dist =\n      (neighborPosition.x - repulsorPosition.x) *\n      (neighborPosition.x - repulsorPosition.x)\n      +\n      (neighborPosition.y - repulsorPosition.y) *\n      (neighborPosition.y - repulsorPosition.y)\n    ;\n\n    if (dist > (repulsor.range * repulsor.range)) { return; }\n    // if (dist < repulsor.range) { return; }\n\n    repelAngle = Math.atan2(\n      repulsorPosition.y - neighborPosition.y,\n      repulsorPosition.x - neighborPosition.x\n    );\n\n    repelForce = -repulsor.force;\n\n    neighborMotion.dx += repelForce * Math.cos(repelAngle);\n    neighborMotion.dy += repelForce * Math.sin(repelAngle);\n  }\n\n  drawDebug(timeDelta, g) {\n    if (!this.options.debug) { return; }\n\n    g.lineWidth = 4;\n    g.strokeStyle = '#882222';\n    components = this.getMatchingComponents();\n    for (entityId in components) {\n      component = components[entityId];\n      position = this.world.get('Position', entityId);\n      g.arc(position.x, position.y, component.range, 0, PI2);\n    }\n  }\n\n}\n\nregisterSystem('Repulsor', RepulsorSystem);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/repulsor.js","var ctx = require('./_ctx');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar anObject = require('./_an-object');\nvar toLength = require('./_to-length');\nvar getIterFn = require('./core.get-iterator-method');\nvar BREAK = {};\nvar RETURN = {};\nvar exports = module.exports = function (iterable, entries, fn, that, ITERATOR) {\n  var iterFn = ITERATOR ? function () { return iterable; } : getIterFn(iterable);\n  var f = ctx(fn, that, entries ? 2 : 1);\n  var index = 0;\n  var length, step, iterator, result;\n  if (typeof iterFn != 'function') throw TypeError(iterable + ' is not iterable!');\n  // fast case for arrays with default iterator\n  if (isArrayIter(iterFn)) for (length = toLength(iterable.length); length > index; index++) {\n    result = entries ? f(anObject(step = iterable[index])[0], step[1]) : f(iterable[index]);\n    if (result === BREAK || result === RETURN) return result;\n  } else for (iterator = iterFn.call(iterable); !(step = iterator.next()).done;) {\n    result = call(iterator, f, step.value, entries);\n    if (result === BREAK || result === RETURN) return result;\n  }\n};\nexports.BREAK = BREAK;\nexports.RETURN = RETURN;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_for-of.js\n// module id = 50\n// module chunks = 7","// Linear interpolation from v0 to v1 over t[0..1]\nexport function lerp(v0, v1, t) {\n  return (1-t)*v0 + t*v1;\n}\n\nexport function distance(aPosition, bPosition) {\n  return Math.sqrt(\n    Math.pow(bPosition.x - aPosition.x, 2) +\n    Math.pow(bPosition.y - aPosition.y, 2)\n  );\n}\n\nconst cachedResults = new Map();\n\nexport function cacheCall(timeDelta, defaultTTL, key, self, fn, ...args) {\n  let value;\n  if (cachedResults.has(key)) {\n    value = cachedResults.get(key);\n    value.ttl -= timeDelta;\n    if (value.ttl > 0) {\n      cachedResults.set(key, value);\n      return value.result;\n    }\n  }\n  value = {\n    ttl: defaultTTL,\n    result: self[fn](...args)\n  };\n  cachedResults.set(key, value);\n  return value.result;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/utils.js","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-primitive.js\n// module id = 52\n// module chunks = 7","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iobject.js\n// module id = 53\n// module chunks = 7","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_cof.js\n// module id = 54\n// module chunks = 7","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_defined.js\n// module id = 55\n// module chunks = 7","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-integer.js\n// module id = 56\n// module chunks = 7","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_shared-key.js\n// module id = 57\n// module chunks = 7","var global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function (key) {\n  return store[key] || (store[key] = {});\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_shared.js\n// module id = 58\n// module chunks = 7","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_enum-bug-keys.js\n// module id = 59\n// module chunks = 7","exports.f = Object.getOwnPropertySymbols;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gops.js\n// module id = 60\n// module chunks = 7","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-sap.js\n// module id = 61\n// module chunks = 7","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && !has(IteratorPrototype, ITERATOR)) hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-define.js\n// module id = 62\n// module chunks = 7","module.exports = true;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_library.js\n// module id = 63\n// module chunks = 7","exports.f = require('./_wks');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_wks-ext.js\n// module id = 64\n// module chunks = 7","var META = require('./_uid')('meta');\nvar isObject = require('./_is-object');\nvar has = require('./_has');\nvar setDesc = require('./_object-dp').f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !require('./_fails')(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_meta.js\n// module id = 65\n// module chunks = 7","var global = require('./_global');\nvar core = require('./_core');\nvar LIBRARY = require('./_library');\nvar wksExt = require('./_wks-ext');\nvar defineProperty = require('./_object-dp').f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_wks-define.js\n// module id = 66\n// module chunks = 7","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gopd.js\n// module id = 67\n// module chunks = 7","import * as Core from '../lib/core';\n\nexport class DebugCanvas extends Core.System {\n\n  defaultOptions() {\n    return {\n      debugText: false\n    };\n  }\n\n  initialize() {\n    this.viewportSystem = this.world.getSystem(this.options.viewportSystemName);\n    this.container = document.querySelector(this.options.container);\n\n    this.debugT = document.createElement('textarea');\n    document.body.appendChild(this.debugT);\n    Object.assign(this.debugT.style, {\n      width: '400px', height: '300px',\n      display: 'block', position: 'absolute',\n      zIndex: 1000, bottom: '0px', right: '0px',\n      color: '#fff', backgroundColor: 'rgba(0, 0, 0, 0.7)',\n    });\n\n    this.canvas = document.createElement('canvas');\n    this.container.appendChild(this.canvas);\n\n    Object.assign(this.canvas.style, {\n      zIndex: -1999,\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      width: '100%',\n      height: '100%',\n      backgroundColor: 'rgba(0, 0, 0, 0)',\n    });\n\n    this.ctx = this.canvas.getContext('2d');\n\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n    this.canvas.width = width;\n    this.canvas.height = height;\n\n    this.debug = true;\n  }\n\n  update() {\n    this.debugT.style.display = (this.options.debugText)\n      ? 'block'\n      : 'none';\n  }\n\n  drawStart() {\n    if (!this.world.debug) {\n      if ('none' !== this.canvas.style.display) {\n        this.canvas.style.display = 'none';\n      }\n      return;\n    }\n\n    if ('block' !== this.canvas.style.display) {\n      this.canvas.style.display = 'block';\n    }\n\n    this.canvas.width = this.container.offsetWidth;\n    this.canvas.height = this.container.offsetHeight;\n\n    this.ctx.resetTransform();\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.ctx.translate(this.canvas.width / 2, this.canvas.height / 2);\n    this.ctx.scale(this.viewportSystem.zoom, this.viewportSystem.zoom);\n    this.ctx.translate(\n      0 - this.viewportSystem.cameraX,\n      0 - this.viewportSystem.cameraY\n    );\n  }\n\n  draw(timeDelta) {\n    if (!this.world.debug) { return; }\n\n    for (const systemName in this.world.systems) {\n      if ('drawDebug' in this.world.systems[systemName]) {\n        this.world.systems[systemName].drawDebug(timeDelta, this.ctx);\n      }\n    }\n  }\n\n  drawEnd() {\n    if (!this.world.debug) { return; }\n\n    this.ctx.restore();\n  }\n\n}\n\nCore.registerSystem('DebugCanvas', DebugCanvas);\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/debugCanvas.js","import * as Core from '../lib/core';\nimport { distance, cacheCall } from '../lib/utils';\n\nexport const MSG_DESTINATION_REACHED = 'roadRunnerDestinationReached';\n\nconst INFINITY = 1000000000;\n\nexport class Road extends Core.Component {\n  static defaults() {\n    return {\n      type: 'main',\n      range: 1000,\n      neighbors: {}\n    };\n  }\n}\n\nCore.registerComponent('Road', Road);\n\nexport class Runner extends Core.Component {\n  static defaults() {\n    return {\n      target: 'main',\n      range: 1000,\n    };\n  }\n}\n\nCore.registerComponent('Runner', Runner);\n\nexport class RoadRunnerSystem extends Core.System {\n\n  defaultOptions() {\n    return {\n      astarCacheTTL: 1.0,\n      debug: true,\n      debugRange: false,\n      debugRoads: true,\n      debugRunners: true,\n      debugPath: true,\n      positionSystemName: 'Position'\n    };\n  }\n\n  initialize() {\n    this.positionSystem = this.world.getSystem(this.options.positionSystemName);\n    this.mapNeighbor = this.mapNeighbor.bind(this);\n  }\n\n  update(timeDelta) {\n    this.updateRoads(timeDelta);\n    this.updateRunners(timeDelta);\n  }\n\n  updateRoads(/* timeDelta */) {\n    const roads = this.world.get('Road');\n    for (const entityId in roads) {\n      const road = roads[entityId];\n      const position = this.world.get('Position', entityId);\n      const range = road.range;\n      road.neighbors = {};\n      this.positionSystem.quadtree.iterate(\n        {\n          left: position.left - range,\n          top: position.top - range,\n          right: position.right + range,\n          bottom: position.bottom + range\n        },\n        this.mapNeighbor,\n        [range, road, position]\n      );\n    }\n  }\n\n  updateRunners(timeDelta) {\n    const runners = this.world.get('Runner');\n    for (const entityId in runners) {\n      // Find throttle & seeker for steering, otherwise bail out.\n      const thruster = this.world.get('Thruster', entityId);\n      const seeker = this.world.get('Seeker', entityId);\n      if (!seeker || !thruster) { continue; }\n\n      // If we don't have a destination, bail out.\n      const runner = runners[entityId];\n      if (!runner.destination) { continue; }\n\n      // Find nearby path elements\n      const position = this.world.get('Position', entityId);\n      const range = runner.range;\n      runner.neighbors = {};\n      this.positionSystem.quadtree.iterate(\n        {\n          left: position.left - range,\n          top: position.top - range,\n          right: position.right + range,\n          bottom: position.bottom + range\n        },\n        this.mapNeighbor,\n        [range, runner, position]\n      );\n\n      // Find nearest path element, bail if none\n      const neighbors = Object.entries(runner.neighbors);\n      runner.nearest = (neighbors.length === 0)\n        ? null : neighbors.sort((a, b) => a[1] - b[1])[0][0];\n      if (!runner.nearest) { continue; }\n\n      // Update our path from nearest path element to destination\n      // runner.path = this.astar(runner.nearest, runner.destination);\n      runner.path = cacheCall(\n        timeDelta, this.options.astarCacheTTL,\n        `astar:${runner.nearest}:${runner.destination}`,\n        this, 'astar',\n        runner.nearest, runner.destination\n      );\n      if (runner.path === null) { continue; }\n\n      // If we have a next step in the path, seek it.\n      const nextId = runner.path[1];\n      if (nextId) {\n        thruster.throttle = 1.0;\n        seeker.active = true;\n        seeker.targetEntityId = nextId;\n        continue;\n      }\n\n      // We're down to the last step in the path, time for a landing.\n      const destinationPosition =\n        this.world.get('Position', runner.destination);\n      const distanceToDestination =\n        distance(position, destinationPosition);\n      if (distanceToDestination > 100) {\n        // Close but not yet at the destination, so throttle back to help\n        // prevent just orbiting it.\n        thruster.throttle = 0.25;\n        seeker.active = true;\n        seeker.targetEntityId = runner.destination;\n      } else {\n        // Close enough to the destination, so stop seeking and call it.\n        seeker.active = false;\n        seeker.targetEntityId = null;\n        this.world.publish(MSG_DESTINATION_REACHED, entityId);\n      }\n    }\n  }\n\n  mapNeighbor(neighborPosition, [range, road, position]) {\n    const neighborId = neighborPosition.entityId;\n    if (position.entityId === neighborId) { return; }\n\n    const neighborRoad = this.world.get('Road', neighborId);\n    if (!neighborRoad) { return; }\n\n    const dist = distance(position, neighborPosition);\n    if (dist < range) { road.neighbors[neighborId] = dist; }\n  }\n\n  // https://en.wikipedia.org/wiki/A-star#Pseudocode\n  astar(startId, goalId) {\n    const roads = this.world.get('Road');\n\n    // The set of nodes already evaluated\n    const closedSet = new Set();\n\n    // The set of currently discovered nodes that are not evaluated yet.\n    // Initially, only the start node is known.\n    const openSet = new Set([startId]);\n\n    // For each node, which node it can most efficiently be reached from.\n    // If a node can be reached from many nodes, cameFrom will eventually contain the\n    // most efficient previous step.\n    const cameFrom = new Map();\n\n    // For each node, the cost of getting from the start node to that node.\n    const gScore = new Map();\n\n    // The cost of going from start to start is zero.\n    gScore.set(startId, 0);\n\n    // For each node, the total cost of getting from the start node to the goal\n    // by passing by that node. That value is partly known, partly heuristic.\n    const fScore = new Map();\n\n    // For the first node, that value is completely heuristic.\n    fScore.set(startId, this.astarHeuristicCostEstimate(startId, goalId));\n\n    while (openSet.size > 0) {\n      // Find the node in openSet having the lowest fScore[] value\n      let currentId = null;\n      let currentCost = INFINITY;\n      for (const key of openSet) {\n        const itemCost = fScore.has(key) ? fScore.get(key) : INFINITY;\n        if (itemCost < currentCost) {\n          currentCost = itemCost;\n          currentId = key;\n        }\n      }\n\n      if (currentId === goalId) {\n        return this.astarReconstructPath(cameFrom, currentId);\n      }\n\n      openSet.delete(currentId);\n      closedSet.add(currentId);\n\n      const neighbors = roads[currentId].neighbors || {};\n      for (const neighborId in neighbors) {\n        if (closedSet.has(neighborId)) {\n          // Ignore the neighbor which is already evaluated.\n          continue;\n        }\n\n        if (!closedSet.has(neighborId)) {\n          // Discover a new node\n          openSet.add(neighborId);\n        }\n\n        // The distance from start to a neighbor\n        const tentative_gScore =\n          gScore.get(currentId) + neighbors[neighborId];\n        const neighbor_gScore = gScore.has(neighborId)\n          ? gScore.get(neighborId) : INFINITY;\n        if (tentative_gScore >= neighbor_gScore) {\n          // This is not a better path.\n          continue;\n        }\n\n        // This path is the best until now. Record it!\n        cameFrom.set(neighborId, currentId);\n        gScore.set(neighborId, tentative_gScore);\n        fScore.set(neighborId,\n          gScore.get(neighborId)\n          + this.astarHeuristicCostEstimate(neighborId, goalId));\n      }\n    }\n\n    return null;\n  }\n\n  astarHeuristicCostEstimate(startId, goalId) {\n    return distance(\n      this.world.get('Position', startId),\n      this.world.get('Position', goalId)\n    );\n  }\n\n  astarReconstructPath(cameFrom, startId) {\n    let pathId = startId;\n    const totalPath = [pathId];\n    while (cameFrom.has(pathId)) {\n      pathId = cameFrom.get(pathId);\n      totalPath.unshift(pathId);\n    }\n    return totalPath;\n  }\n\n\n  drawDebug(timeDelta, g) {\n    if (!this.options.debug) { return; }\n\n    const roads = this.world.get('Road');\n    for (const entityId in roads) {\n      const road = roads[entityId];\n      const position = this.world.get('Position', entityId);\n      if (!road.debugColor) {\n        road.debugColor = randColor();\n      }\n\n      if (this.options.debugRange) {\n        g.beginPath();\n        g.setLineDash([5, 15]);\n        g.moveTo(position.x + road.range, position.y);\n        g.arc(position.x, position.y, road.range, 0, Math.PI * 2);\n        g.lineWidth = 4;\n        g.strokeStyle = road.debugColor;\n        g.stroke();\n      }\n\n      if (this.options.debugRoads) {\n        g.font = '128px monospace';\n        g.strokeStyle = road.debugColor;\n        g.fillStyle = road.debugColor;\n        g.fillText('#' + entityId, position.x + 96, position.y + 96);\n\n        for (const neighborId in road.neighbors) {\n          const neighborPosition = this.world.get('Position', neighborId);\n          g.beginPath();\n          g.setLineDash([15, 5]);\n          g.moveTo(\n            position.x + Math.random() * 10,\n            position.y + Math.random() * 10\n          );\n          g.lineTo(\n            neighborPosition.x + Math.random() * 10,\n            neighborPosition.y + Math.random() * 10\n          );\n          g.lineWidth = 4;\n          g.strokeStyle = road.debugColor;\n          g.stroke();\n        }\n      }\n    }\n\n    if (this.options.debugRunners) {\n      const runners = this.world.get('Runner');\n      for (const entityId in runners) {\n        const runner = runners[entityId];\n        if (!runner.debugColor) {\n          runner.debugColor = randColor();\n        }\n\n        if (this.options.debugPath && runner.path) {\n          const circleSize = 220 + 10 * Math.random();\n          [runner.nearest, runner.destination].forEach(entityId => {\n            if (entityId) {\n              const position = this.world.get('Position', entityId);\n              g.beginPath();\n              g.setLineDash([15, 15]);\n              g.moveTo(position.x + circleSize, position.y);\n              g.arc(position.x, position.y, circleSize, 0, Math.PI * 2);\n              g.lineWidth = 4;\n              g.strokeStyle = runner.debugColor;\n              g.stroke();\n            }\n          });\n\n          let last = runner.path[0];\n          for (let idx = 1; idx < runner.path.length; idx++) {\n            const current = runner.path[idx];\n\n            const lastPosition = this.world.get('Position', last);\n            const currentPosition = this.world.get('Position', current);\n\n            g.beginPath();\n            g.setLineDash([5, 5]);\n            g.moveTo(\n              lastPosition.x + Math.random() * 10,\n              lastPosition.y + Math.random() * 10\n            );\n            g.lineTo(\n              currentPosition.x + Math.random() * 10,\n              currentPosition.y + Math.random() * 10\n            );\n            g.lineWidth = 48;\n            g.strokeStyle = runner.debugColor;\n            g.stroke();\n\n            last = current;\n          }\n        }\n      }\n    }\n\n  }\n\n}\n\nCore.registerSystem('RoadRunner', RoadRunnerSystem);\n\nconst digits = '0123456789abcdef';\nconst randDigit = () => digits.charAt(Math.floor(Math.random() * digits.length));\nconst randColor = () => '#' + randDigit() + randDigit() + randDigit() + randDigit() + randDigit() + randDigit();\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/roadRunner.js","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').getIteratorMethod = function (it) {\n  if (it != undefined) return it[ITERATOR]\n    || it['@@iterator']\n    || Iterators[classof(it)];\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/core.get-iterator-method.js\n// module id = 71\n// module chunks = 7","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_classof.js\n// module id = 72\n// module chunks = 7","var isObject = require('./_is-object');\nmodule.exports = function (it, TYPE) {\n  if (!isObject(it) || it._t !== TYPE) throw TypeError('Incompatible receiver, ' + TYPE + ' required!');\n  return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_validate-collection.js\n// module id = 73\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _assign = require(\"../core-js/object/assign\");\n\nvar _assign2 = _interopRequireDefault(_assign);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _assign2.default || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/extends.js\n// module id = 74\n// module chunks = 7","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_a-function.js\n// module id = 75\n// module chunks = 7","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_ie8-dom-define.js\n// module id = 76\n// module chunks = 7","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_dom-create.js\n// module id = 77\n// module chunks = 7","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-keys-internal.js\n// module id = 78\n// module chunks = 7","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gpo.js\n// module id = 79\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _iterator = require(\"../core-js/symbol/iterator\");\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _symbol = require(\"../core-js/symbol\");\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nvar _typeof = typeof _symbol2.default === \"function\" && typeof _iterator2.default === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = typeof _symbol2.default === \"function\" && _typeof(_iterator2.default) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n} : function (obj) {\n  return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/typeof.js\n// module id = 80\n// module chunks = 7","module.exports = require('./_hide');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_redefine.js\n// module id = 81\n// module chunks = 7","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-step.js\n// module id = 82\n// module chunks = 7","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_is-array.js\n// module id = 83\n// module chunks = 7","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gopn.js\n// module id = 84\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nimport './position';\r\n\r\nimport Vector2D from '../lib/Vector2D';\r\n\r\nexport class Orbiter extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      name: null,\r\n      entityId: null,\r\n      angle: 0.0,\r\n      rotate: true,\r\n      radPerSec: Math.PI / 4\r\n    };\r\n  }\r\n}\r\nCore.registerComponent('Orbiter', Orbiter);\r\n\r\nexport class OrbiterSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Orbiter'; }\r\n\r\n  initialize() {\r\n    this.vOrbited = new Vector2D();\r\n    this.vOrbiter = new Vector2D();\r\n    this.vOld = new Vector2D();\r\n  }\r\n\r\n  updateComponent(timeDelta, entityId, orbiter) {\r\n\r\n    // Look up the orbited entity ID, if only name given.\r\n    if (orbiter.name && !orbiter.entityId) {\r\n      orbiter.entityId = Core.getComponent('Name')\r\n        .findEntityByName(this.world, orbiter.name);\r\n    }\r\n\r\n    const pos = this.world.get('Position', entityId);\r\n    const oPos = this.world.get('Position', orbiter.entityId);\r\n\r\n    this.vOrbited.setValues(oPos.x, oPos.y);\r\n    this.vOrbiter.setValues(pos.x, pos.y);\r\n\r\n    const angleDelta = timeDelta * orbiter.radPerSec;\r\n    this.vOrbiter.rotateAround(this.vOrbited, angleDelta);\r\n\r\n    this.vOld.setValues(pos.x, pos.y);\r\n    pos.x = this.vOrbiter.x;\r\n    pos.y = this.vOrbiter.y;\r\n    if (orbiter.rotate) {\r\n      pos.rotation = this.vOld.angleTo(this.vOrbiter);\r\n    }\r\n\r\n  }\r\n}\r\nCore.registerSystem('Orbiter', OrbiterSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/orbiter.js","module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/get-iterator.js\n// module id = 86\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/map\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/map.js\n// module id = 87\n// module chunks = 7","'use strict';\nvar dP = require('./_object-dp').f;\nvar create = require('./_object-create');\nvar redefineAll = require('./_redefine-all');\nvar ctx = require('./_ctx');\nvar anInstance = require('./_an-instance');\nvar forOf = require('./_for-of');\nvar $iterDefine = require('./_iter-define');\nvar step = require('./_iter-step');\nvar setSpecies = require('./_set-species');\nvar DESCRIPTORS = require('./_descriptors');\nvar fastKey = require('./_meta').fastKey;\nvar validate = require('./_validate-collection');\nvar SIZE = DESCRIPTORS ? '_s' : 'size';\n\nvar getEntry = function (that, key) {\n  // fast case\n  var index = fastKey(key);\n  var entry;\n  if (index !== 'F') return that._i[index];\n  // frozen object case\n  for (entry = that._f; entry; entry = entry.n) {\n    if (entry.k == key) return entry;\n  }\n};\n\nmodule.exports = {\n  getConstructor: function (wrapper, NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, NAME, '_i');\n      that._t = NAME;         // collection type\n      that._i = create(null); // index\n      that._f = undefined;    // first entry\n      that._l = undefined;    // last entry\n      that[SIZE] = 0;         // size\n      if (iterable != undefined) forOf(iterable, IS_MAP, that[ADDER], that);\n    });\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear() {\n        for (var that = validate(this, NAME), data = that._i, entry = that._f; entry; entry = entry.n) {\n          entry.r = true;\n          if (entry.p) entry.p = entry.p.n = undefined;\n          delete data[entry.i];\n        }\n        that._f = that._l = undefined;\n        that[SIZE] = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function (key) {\n        var that = validate(this, NAME);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.n;\n          var prev = entry.p;\n          delete that._i[entry.i];\n          entry.r = true;\n          if (prev) prev.n = next;\n          if (next) next.p = prev;\n          if (that._f == entry) that._f = next;\n          if (that._l == entry) that._l = prev;\n          that[SIZE]--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        validate(this, NAME);\n        var f = ctx(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);\n        var entry;\n        while (entry = entry ? entry.n : this._f) {\n          f(entry.v, entry.k, this);\n          // revert to the last existing entry\n          while (entry && entry.r) entry = entry.p;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key) {\n        return !!getEntry(validate(this, NAME), key);\n      }\n    });\n    if (DESCRIPTORS) dP(C.prototype, 'size', {\n      get: function () {\n        return validate(this, NAME)[SIZE];\n      }\n    });\n    return C;\n  },\n  def: function (that, key, value) {\n    var entry = getEntry(that, key);\n    var prev, index;\n    // change existing entry\n    if (entry) {\n      entry.v = value;\n    // create new entry\n    } else {\n      that._l = entry = {\n        i: index = fastKey(key, true), // <- index\n        k: key,                        // <- key\n        v: value,                      // <- value\n        p: prev = that._l,             // <- previous entry\n        n: undefined,                  // <- next entry\n        r: false                       // <- removed\n      };\n      if (!that._f) that._f = entry;\n      if (prev) prev.n = entry;\n      that[SIZE]++;\n      // add to index\n      if (index !== 'F') that._i[index] = entry;\n    } return that;\n  },\n  getEntry: getEntry,\n  setStrong: function (C, NAME, IS_MAP) {\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    $iterDefine(C, NAME, function (iterated, kind) {\n      this._t = validate(iterated, NAME); // target\n      this._k = kind;                     // kind\n      this._l = undefined;                // previous\n    }, function () {\n      var that = this;\n      var kind = that._k;\n      var entry = that._l;\n      // revert to the last existing entry\n      while (entry && entry.r) entry = entry.p;\n      // get next entry\n      if (!that._t || !(that._l = entry = entry ? entry.n : that._t._f)) {\n        // or finish the iteration\n        that._t = undefined;\n        return step(1);\n      }\n      // return step by kind\n      if (kind == 'keys') return step(0, entry.k);\n      if (kind == 'values') return step(0, entry.v);\n      return step(0, [entry.k, entry.v]);\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(NAME);\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_collection-strong.js\n// module id = 88\n// module chunks = 7","var hide = require('./_hide');\nmodule.exports = function (target, src, safe) {\n  for (var key in src) {\n    if (safe && target[key]) target[key] = src[key];\n    else hide(target, key, src[key]);\n  } return target;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_redefine-all.js\n// module id = 89\n// module chunks = 7","module.exports = function (it, Constructor, name, forbiddenField) {\n  if (!(it instanceof Constructor) || (forbiddenField !== undefined && forbiddenField in it)) {\n    throw TypeError(name + ': incorrect invocation!');\n  } return it;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_an-instance.js\n// module id = 90\n// module chunks = 7","// call something on iterator step with safe closing on error\nvar anObject = require('./_an-object');\nmodule.exports = function (iterator, fn, value, entries) {\n  try {\n    return entries ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (e) {\n    var ret = iterator['return'];\n    if (ret !== undefined) anObject(ret.call(iterator));\n    throw e;\n  }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-call.js\n// module id = 91\n// module chunks = 7","// check on default Array iterator\nvar Iterators = require('./_iterators');\nvar ITERATOR = require('./_wks')('iterator');\nvar ArrayProto = Array.prototype;\n\nmodule.exports = function (it) {\n  return it !== undefined && (Iterators.Array === it || ArrayProto[ITERATOR] === it);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_is-array-iter.js\n// module id = 92\n// module chunks = 7","'use strict';\nvar global = require('./_global');\nvar $export = require('./_export');\nvar meta = require('./_meta');\nvar fails = require('./_fails');\nvar hide = require('./_hide');\nvar redefineAll = require('./_redefine-all');\nvar forOf = require('./_for-of');\nvar anInstance = require('./_an-instance');\nvar isObject = require('./_is-object');\nvar setToStringTag = require('./_set-to-string-tag');\nvar dP = require('./_object-dp').f;\nvar each = require('./_array-methods')(0);\nvar DESCRIPTORS = require('./_descriptors');\n\nmodule.exports = function (NAME, wrapper, methods, common, IS_MAP, IS_WEAK) {\n  var Base = global[NAME];\n  var C = Base;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var proto = C && C.prototype;\n  var O = {};\n  if (!DESCRIPTORS || typeof C != 'function' || !(IS_WEAK || proto.forEach && !fails(function () {\n    new C().entries().next();\n  }))) {\n    // create collection constructor\n    C = common.getConstructor(wrapper, NAME, IS_MAP, ADDER);\n    redefineAll(C.prototype, methods);\n    meta.NEED = true;\n  } else {\n    C = wrapper(function (target, iterable) {\n      anInstance(target, C, NAME, '_c');\n      target._c = new Base();\n      if (iterable != undefined) forOf(iterable, IS_MAP, target[ADDER], target);\n    });\n    each('add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON'.split(','), function (KEY) {\n      var IS_ADDER = KEY == 'add' || KEY == 'set';\n      if (KEY in proto && !(IS_WEAK && KEY == 'clear')) hide(C.prototype, KEY, function (a, b) {\n        anInstance(this, C, KEY);\n        if (!IS_ADDER && IS_WEAK && !isObject(a)) return KEY == 'get' ? undefined : false;\n        var result = this._c[KEY](a === 0 ? 0 : a, b);\n        return IS_ADDER ? this : result;\n      });\n    });\n    IS_WEAK || dP(C.prototype, 'size', {\n      get: function () {\n        return this._c.size;\n      }\n    });\n  }\n\n  setToStringTag(C, NAME);\n\n  O[NAME] = C;\n  $export($export.G + $export.W + $export.F, O);\n\n  if (!IS_WEAK) common.setStrong(C, NAME, IS_MAP);\n\n  return C;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_collection.js\n// module id = 93\n// module chunks = 7","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar classof = require('./_classof');\nvar from = require('./_array-from-iterable');\nmodule.exports = function (NAME) {\n  return function toJSON() {\n    if (classof(this) != NAME) throw TypeError(NAME + \"#toJSON isn't generic\");\n    return from(this);\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_collection-to-json.js\n// module id = 94\n// module chunks = 7","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar $export = require('./_export');\n\nmodule.exports = function (COLLECTION) {\n  $export($export.S, COLLECTION, { of: function of() {\n    var length = arguments.length;\n    var A = Array(length);\n    while (length--) A[length] = arguments[length];\n    return new this(A);\n  } });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_set-collection-of.js\n// module id = 95\n// module chunks = 7","'use strict';\n// https://tc39.github.io/proposal-setmap-offrom/\nvar $export = require('./_export');\nvar aFunction = require('./_a-function');\nvar ctx = require('./_ctx');\nvar forOf = require('./_for-of');\n\nmodule.exports = function (COLLECTION) {\n  $export($export.S, COLLECTION, { from: function from(source /* , mapFn, thisArg */) {\n    var mapFn = arguments[1];\n    var mapping, A, n, cb;\n    aFunction(this);\n    mapping = mapFn !== undefined;\n    if (mapping) aFunction(mapFn);\n    if (source == undefined) return new this();\n    A = [];\n    if (mapping) {\n      n = 0;\n      cb = ctx(mapFn, arguments[2], 2);\n      forOf(source, false, function (nextItem) {\n        A.push(cb(nextItem, n++));\n      });\n    } else {\n      forOf(source, false, A.push, A);\n    }\n    return new this(A);\n  } });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_set-collection-from.js\n// module id = 96\n// module chunks = 7","var getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nvar isEnum = require('./_object-pie').f;\nmodule.exports = function (isEntries) {\n  return function (it) {\n    var O = toIObject(it);\n    var keys = getKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) if (isEnum.call(O, key = keys[i++])) {\n      result.push(isEntries ? [key, O[key]] : O[key]);\n    } return result;\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-to-array.js\n// module id = 97\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nexport class CanvasSprite extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      name: null,\r\n      color: '#fff',\r\n      size: 100,\r\n      width: null,\r\n      height: null\r\n    };\r\n  }\r\n  static create(attrs) {\r\n    const c = super.create(attrs);\r\n    if (!c.width) { c.width = c.size; }\r\n    if (!c.height) { c.height = c.size; }\r\n    return c;\r\n  }\r\n}\r\nCore.registerComponent('Sprite', CanvasSprite);\r\n\r\n// See also: http://phrogz.net/JS/wheeldelta.html\r\nconst wheelDistance = function(evt){\r\n  if (!evt) evt = event;\r\n  const w=evt.wheelDelta, d=evt.detail;\r\n  if (d){\r\n    if (w) return w/d/40*d>0?1:-1; // Opera\r\n    else return -d/3;              // Firefox;         TODO: do not /3 for OS X\r\n  } else return w/120;             // IE/Safari/Chrome TODO: /3 for Chrome OS X\r\n};\r\n\r\nexport class ViewportCanvas extends Core.System {\r\n\r\n  defaultOptions() {\r\n    return {\r\n      lineWidth: 1.5,\r\n      zoom: 1.0,\r\n      zoomMin: 0.1,\r\n      zoomMax: 10.0,\r\n      zoomWheelFactor: 0.025,\r\n      gridEnabled: true,\r\n      gridSize: 500,\r\n      gridColor: '#111',\r\n      followEnabled: true,\r\n      followName: null,\r\n      followEntityId: null\r\n    };\r\n  }\r\n\r\n  initialize() {\r\n    this.container = document.querySelector(this.options.container);\r\n    this.canvas = document.createElement('canvas');\r\n    this.container.appendChild(this.canvas);\r\n\r\n    this.ctx = this.canvas.getContext('2d');\r\n\r\n    const events = {\r\n      'resize': (ev) => { this.updateMetrics(ev); },\r\n      'orientationchange': (ev) => { this.updateMetrics(ev); },\r\n      'mousedown': (ev) => { this.onMouseDown(ev); },\r\n      'mousemove': (ev) => { this.onMouseMove(ev); },\r\n      'mouseup': (ev) => { this.onMouseUp(ev); },\r\n      //'wheel': (ev) => { this.onMouseWheel(ev); }\r\n    };\r\n\r\n    for (const name in events) {\r\n      this.canvas.addEventListener(name, events[name], false);\r\n    }\r\n\r\n    // See also: http://phrogz.net/JS/wheeldelta.html\r\n    const boundOnMouseWheel = (ev) => this.onMouseWheel(ev);\r\n    if (window.addEventListener){\r\n      window.addEventListener('mousewheel', boundOnMouseWheel, false); // Chrome/Safari/Opera\r\n      window.addEventListener('DOMMouseScroll', boundOnMouseWheel, false); // Firefox\r\n    } else if (window.attachEvent){\r\n      window.attachEvent('onmousewheel', boundOnMouseWheel); // IE\r\n    }\r\n\r\n    this.followEnabled = this.options.followEnabled;\r\n    this.zoom = this.options.zoom;\r\n    this.followEntityId = this.options.followEntityId;\r\n    this.gridEnabled = this.options.gridEnabled;\r\n    this.lineWidth = this.options.lineWidth;\r\n\r\n    this.cursorRawX = 0;\r\n    this.cursorRawY = 0;\r\n\r\n    this.cursorChanged = false;\r\n    this.cursorPosition = { x: 0, y: 0 };\r\n\r\n    this.cameraX = 0;\r\n    this.cameraY = 0;\r\n\r\n    this.debugDummySprite = { size: 100 };\r\n  }\r\n\r\n  draw(timeDelta) {\r\n    this.updateMetrics();\r\n    this.ctx.save();\r\n\r\n    this.clear();\r\n    this.centerAndZoom(timeDelta);\r\n    this.followEntity(timeDelta);\r\n\r\n    if (this.gridEnabled) { this.drawBackdrop(timeDelta); }\r\n\r\n    this.drawScene(timeDelta);\r\n\r\n    if (this.world.debug) { this.drawDebugCursor(); }\r\n\r\n    this.ctx.restore();\r\n  }\r\n\r\n  onMouseWheel(ev) {\r\n    this.zoom += wheelDistance(ev) * this.options.zoomWheelFactor;\r\n    if (this.zoom < this.options.zoomMin) {\r\n      this.zoom = this.options.zoomMin;\r\n    }\r\n    if (this.zoom > this.options.zoomMax) {\r\n      this.zoom = this.options.zoomMax;\r\n    }\r\n  }\r\n\r\n  // TODO: Use a symbol for 'mouse{Down,Move,Up}' message?\r\n\r\n  onMouseDown(ev) {\r\n    this.setCursor(ev.clientX, ev.clientY);\r\n    this.world.publish('mouseDown', this.cursorPosition);\r\n  }\r\n\r\n  onMouseMove(ev) {\r\n    this.setCursor(ev.clientX, ev.clientY);\r\n  }\r\n\r\n  onMouseUp(ev) {\r\n    this.setCursor(ev.clientX, ev.clientY);\r\n    this.world.publish('mouseUp', this.cursorPosition);\r\n  }\r\n\r\n  update(/* timeDelta */) {\r\n    // Use the cursorChanged flag set by setCursor to limit mouseMove messages\r\n    // to one per game loop tick\r\n    if (this.cursorChanged) {\r\n      this.cursorChanged = false;\r\n      this.world.publish('mouseMove', this.cursorPosition);\r\n    }\r\n  }\r\n\r\n  setCursor(x, y) {\r\n    const width = this.container.offsetWidth;\r\n    const height = this.container.offsetHeight;\r\n\r\n    this.cursorRawX = x;\r\n    this.cursorRawY = y;\r\n\r\n    const newX = ((x - (width / 2)) / this.zoom) + this.cameraX;\r\n    const newY = ((y - (height / 2)) / this.zoom) + this.cameraY;\r\n\r\n    if (newX !== this.cursorPosition.x || newY !== this.cursorPosition.y) {\r\n      this.cursorChanged = true;\r\n      this.cursorPosition.x = newX;\r\n      this.cursorPosition.y = newY;\r\n    }\r\n  }\r\n\r\n  updateMetrics() {\r\n    const width = this.container.offsetWidth;\r\n    const height = this.container.offsetHeight;\r\n\r\n    this.canvas.width = width;\r\n    this.canvas.height = height;\r\n\r\n    this.visibleWidth = width / this.zoom;\r\n    this.visibleHeight = height / this.zoom;\r\n\r\n    this.visibleLeft = (0 - this.visibleWidth / 2) + this.cameraX;\r\n    this.visibleTop = (0 - this.visibleHeight / 2) + this.cameraY;\r\n    this.visibleRight = this.visibleLeft + this.visibleWidth;\r\n    this.visibleBottom = this.visibleTop + this.visibleHeight;\r\n  }\r\n\r\n  clear() {\r\n    this.ctx.fillStyle = 'rgba(0, 0, 0, 1.0)';\r\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\r\n  }\r\n\r\n  centerAndZoom() {\r\n    this.ctx.translate(this.canvas.width / 2, this.canvas.height / 2);\r\n    this.ctx.scale(this.zoom, this.zoom);\r\n  }\r\n\r\n  followEntity() {\r\n    if (!this.followEnabled) {\r\n      this.cameraX = this.cameraY = 0;\r\n      return;\r\n    }\r\n    if (this.options.followName && !this.followEntityId) {\r\n      // Look up named entity, if necessary.\r\n      this.followEntityId = Core.getComponent('Name')\r\n        .findEntityByName(this.world, this.options.followName);\r\n    }\r\n    if (this.followEntityId) {\r\n      // Adjust the viewport center offset to the entity position\r\n      const position = this.world.get('Position', this.followEntityId);\r\n      if (position) {\r\n        this.cameraX = position.x;\r\n        this.cameraY = position.y;\r\n        this.setCursor(this.cursorRawX, this.cursorRawY);\r\n        this.ctx.translate(0 - this.cameraX, 0 - this.cameraY);\r\n      }\r\n    }\r\n  }\r\n\r\n  drawDebugCursor() {\r\n    const ctx = this.ctx;\r\n    ctx.save();\r\n    ctx.strokeStyle = '#f0f';\r\n    ctx.lineWidth = this.lineWidth / this.zoom;\r\n    ctx.translate(this.cursorPosition.x, this.cursorPosition.y);\r\n    ctx.beginPath();\r\n    ctx.moveTo(-20, 0);\r\n    ctx.lineTo(20, 0);\r\n    ctx.moveTo(0, -20);\r\n    ctx.lineTo(0, 20);\r\n    ctx.strokeRect(-10, -10, 20, 20);\r\n    ctx.stroke();\r\n    ctx.restore();\r\n  }\r\n\r\n  drawBackdrop() {\r\n    const gridSize = this.options.gridSize;\r\n    const gridOffsetX = this.visibleLeft % gridSize;\r\n    const gridOffsetY = this.visibleTop % gridSize;\r\n\r\n    const ctx = this.ctx;\r\n\r\n    ctx.save();\r\n    ctx.beginPath();\r\n\r\n    ctx.strokeStyle = this.options.gridColor;\r\n    ctx.lineWidth = this.lineWidth / this.zoom;\r\n\r\n    for (let x = (this.visibleLeft - gridOffsetX); x < this.visibleRight; x += gridSize) {\r\n      ctx.moveTo(x, this.visibleTop);\r\n      ctx.lineTo(x, this.visibleBottom);\r\n    }\r\n\r\n    for (let y = (this.visibleTop - gridOffsetY); y < this.visibleBottom; y += gridSize) {\r\n      ctx.moveTo(this.visibleLeft, y);\r\n      ctx.lineTo(this.visibleRight, y);\r\n    }\r\n\r\n    ctx.stroke();\r\n    ctx.restore();\r\n  }\r\n\r\n  drawScene(timeDelta) {\r\n    const positions = this.world.get('Position');\r\n    for (const entityId in positions) {\r\n      this.drawSprite(timeDelta, entityId, positions[entityId]);\r\n    }\r\n  }\r\n\r\n  drawSprite(timeDelta, entityId, position) {\r\n\r\n    let sprite = this.world.get('Sprite', entityId);\r\n    if (!sprite) { sprite = CanvasSprite.defaults(); }\r\n\r\n    let spriteFn = getSprite(sprite.name);\r\n    if (!spriteFn) { spriteFn = getSprite('default'); }\r\n\r\n    const ctx = this.ctx;\r\n\r\n    ctx.save();\r\n\r\n    ctx.translate(position.x, position.y);\r\n\r\n    ctx.rotate(position.rotation + Math.PI/2);\r\n    ctx.scale(sprite.size / 100, sprite.size / 100);\r\n\r\n    // HACK: Try to keep line width consistent regardless of zoom, to sort of\r\n    // simulate a vector display\r\n    ctx.lineWidth = this.lineWidth / this.zoom / (sprite.size / 100);\r\n\r\n    ctx.strokeStyle = sprite.color;\r\n    spriteFn(ctx, timeDelta, sprite, entityId);\r\n\r\n    ctx.restore();\r\n\r\n  }\r\n\r\n}\r\n\r\nCore.registerSystem('ViewportCanvas', ViewportCanvas);\r\n\r\nconst spriteRegistry = {};\r\nexport function registerSprite(name, sprite) {\r\n  spriteRegistry[name] = sprite;\r\n}\r\nexport function getSprite(name) {\r\n  return spriteRegistry[name];\r\n}\r\n\r\nconst PI2 = Math.PI * 2;\r\n\r\nregisterSprite('default', (ctx/*, timeDelta, sprite, entityId*/) => {\r\n  ctx.beginPath();\r\n  ctx.arc(0, 0, 50, 0, PI2, true);\r\n  ctx.moveTo(0, 0);\r\n  ctx.lineTo(0, -50);\r\n  ctx.moveTo(0, 0);\r\n  ctx.stroke();\r\n});\r\n\r\nregisterSprite('sun', (ctx/*, timeDelta, sprite, entityId*/) => {\r\n  ctx.beginPath();\r\n  ctx.arc(0, 0, 50, 0, PI2, true);\r\n  ctx.stroke();\r\n});\r\n\r\nregisterSprite('enemyscout', (ctx/*, timeDelta, sprite, entityId*/) => {\r\n  ctx.beginPath();\r\n  ctx.moveTo(0, -50);\r\n  ctx.lineTo(-45, 50);\r\n  ctx.lineTo(-12.5, 12.5);\r\n  ctx.lineTo(0, 25);\r\n  ctx.lineTo(12.5, 12.5);\r\n  ctx.lineTo(45, 50);\r\n  ctx.lineTo(0, -50);\r\n  ctx.moveTo(0, -50);\r\n  ctx.stroke();\r\n});\r\n\r\nregisterSprite('hero', (ctx/*, timeDelta, sprite, entityId*/) => {\r\n  ctx.rotate(Math.PI);\r\n  ctx.beginPath();\r\n  ctx.moveTo(-12.5, -50);\r\n  ctx.lineTo(-25, -50);\r\n  ctx.lineTo(-50, 0);\r\n  ctx.arc(0, 0, 50, Math.PI, 0, true);\r\n  ctx.lineTo(25, -50);\r\n  ctx.lineTo(12.5, -50);\r\n  ctx.lineTo(25, 0);\r\n  ctx.arc(0, 0, 25, 0, Math.PI, true);\r\n  ctx.lineTo(-12.5, -50);\r\n  ctx.stroke();\r\n});\r\n\r\nregisterSprite('asteroid', (ctx, timeDelta, sprite/*, entityId*/) => {\r\n  let idx;\r\n\r\n  if (!sprite.points) {\r\n    const NUM_POINTS = 7 + Math.floor(8 * Math.random());\r\n    const MAX_RADIUS = 50;\r\n    const MIN_RADIUS = 35;\r\n    const ROTATION = PI2 / NUM_POINTS;\r\n\r\n    sprite.points = [];\r\n    for (idx = 0; idx < NUM_POINTS; idx++) {\r\n      const rot = idx * ROTATION;\r\n      const dist = (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\r\n      sprite.points.push([dist * Math.cos(rot), dist * Math.sin(rot)]);\r\n    }\r\n  }\r\n\r\n  ctx.beginPath();\r\n  ctx.moveTo(sprite.points[0][0], sprite.points[0][1]);\r\n  for (idx = 0; idx < sprite.points.length; idx++) {\r\n    ctx.lineTo(sprite.points[idx][0], sprite.points[idx][1]);\r\n  }\r\n  ctx.lineTo(sprite.points[0][0], sprite.points[0][1]);\r\n  ctx.stroke();\r\n\r\n});\r\n\r\nregisterSprite('explosion', (ctx, timeDelta, sprite/*, entityId*/) => {\r\n  let p, idx;\r\n\r\n  if (!sprite.initialized) {\r\n\r\n    sprite.initialized = true;\r\n\r\n    Object.assign(sprite, {\r\n      ttl: 2.0,\r\n      radius: 100,\r\n      maxParticles: 25,\r\n      maxParticleSize: 4,\r\n      maxVelocity: 300,\r\n      color: '#f00',\r\n      age: 0,\r\n      stop: false,\r\n      ...sprite\r\n    });\r\n\r\n    sprite.particles = [];\r\n\r\n    for (idx = 0; idx < sprite.maxParticles; idx++) {\r\n      sprite.particles.push({ free: true });\r\n    }\r\n\r\n  }\r\n\r\n  for (idx = 0; idx < sprite.particles.length; idx++) {\r\n    p = sprite.particles[idx];\r\n\r\n    if (!sprite.stop && p.free) {\r\n\r\n      p.velocity = sprite.maxVelocity * Math.random();\r\n      p.angle = (Math.PI * 2) * Math.random();\r\n      p.dx = 0 - (p.velocity * Math.sin(p.angle));\r\n      p.dy = p.velocity * Math.cos(p.angle);\r\n      p.distance = p.x = p.y = 0;\r\n      p.maxDistance = sprite.radius * Math.random();\r\n      p.size = sprite.maxParticleSize;\r\n      p.free = false;\r\n\r\n    } else if (!p.free) {\r\n\r\n      p.x += p.dx * timeDelta;\r\n      p.y += p.dy * timeDelta;\r\n\r\n      p.distance += p.velocity * timeDelta;\r\n      if (p.distance >= p.maxDistance) {\r\n        p.distance = p.maxDistance;\r\n        p.free = true;\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  sprite.age += timeDelta;\r\n\r\n  if (sprite.age >= sprite.ttl) {\r\n    sprite.stop = true;\r\n  }\r\n\r\n  const alpha = Math.max(0, 1 - (sprite.age / sprite.ttl));\r\n\r\n  ctx.save();\r\n  ctx.strokeStyle = sprite.color;\r\n  ctx.fillStyle = sprite.color;\r\n\r\n  for (idx = 0; idx < sprite.particles.length; idx++) {\r\n    p = sprite.particles[idx];\r\n    if (p.free) { continue; }\r\n\r\n    ctx.globalAlpha = (1 - (p.distance / p.maxDistance)) * alpha;\r\n\r\n    ctx.beginPath();\r\n    ctx.moveTo(0, 0);\r\n    ctx.lineWidth = p.size;\r\n    ctx.lineTo(p.x, p.y);\r\n    ctx.stroke();\r\n  }\r\n\r\n  ctx.restore();\r\n\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/viewportCanvas.js","require('../../modules/es6.object.assign');\nmodule.exports = require('../../modules/_core').Object.assign;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/assign.js\n// module id = 100\n// module chunks = 7","// 19.1.3.1 Object.assign(target, source)\nvar $export = require('./_export');\n\n$export($export.S + $export.F, 'Object', { assign: require('./_object-assign') });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.assign.js\n// module id = 101\n// module chunks = 7","'use strict';\n// 19.1.2.1 Object.assign(target, source, ...)\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nvar toObject = require('./_to-object');\nvar IObject = require('./_iobject');\nvar $assign = Object.assign;\n\n// should work with symbols and should have deterministic property order (V8 bug)\nmodule.exports = !$assign || require('./_fails')(function () {\n  var A = {};\n  var B = {};\n  // eslint-disable-next-line no-undef\n  var S = Symbol();\n  var K = 'abcdefghijklmnopqrst';\n  A[S] = 7;\n  K.split('').forEach(function (k) { B[k] = k; });\n  return $assign({}, A)[S] != 7 || Object.keys($assign({}, B)).join('') != K;\n}) ? function assign(target, source) { // eslint-disable-line no-unused-vars\n  var T = toObject(target);\n  var aLen = arguments.length;\n  var index = 1;\n  var getSymbols = gOPS.f;\n  var isEnum = pIE.f;\n  while (aLen > index) {\n    var S = IObject(arguments[index++]);\n    var keys = getSymbols ? getKeys(S).concat(getSymbols(S)) : getKeys(S);\n    var length = keys.length;\n    var j = 0;\n    var key;\n    while (length > j) if (isEnum.call(S, key = keys[j++])) T[key] = S[key];\n  } return T;\n} : $assign;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-assign.js\n// module id = 102\n// module chunks = 7","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_array-includes.js\n// module id = 103\n// module chunks = 7","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_to-absolute-index.js\n// module id = 104\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/define-property\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/define-property.js\n// module id = 105\n// module chunks = 7","require('../../modules/es6.object.define-property');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperty(it, key, desc) {\n  return $Object.defineProperty(it, key, desc);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/define-property.js\n// module id = 106\n// module chunks = 7","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.define-property.js\n// module id = 107\n// module chunks = 7","require('../../modules/es6.object.get-prototype-of');\nmodule.exports = require('../../modules/_core').Object.getPrototypeOf;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/get-prototype-of.js\n// module id = 108\n// module chunks = 7","// 19.1.2.9 Object.getPrototypeOf(O)\nvar toObject = require('./_to-object');\nvar $getPrototypeOf = require('./_object-gpo');\n\nrequire('./_object-sap')('getPrototypeOf', function () {\n  return function getPrototypeOf(it) {\n    return $getPrototypeOf(toObject(it));\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.get-prototype-of.js\n// module id = 109\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/symbol/iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/symbol/iterator.js\n// module id = 110\n// module chunks = 7","require('../../modules/es6.string.iterator');\nrequire('../../modules/web.dom.iterable');\nmodule.exports = require('../../modules/_wks-ext').f('iterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/symbol/iterator.js\n// module id = 111\n// module chunks = 7","var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_string-at.js\n// module id = 112\n// module chunks = 7","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-create.js\n// module id = 113\n// module chunks = 7","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-dps.js\n// module id = 114\n// module chunks = 7","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_html.js\n// module id = 115\n// module chunks = 7","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.array.iterator.js\n// module id = 116\n// module chunks = 7","module.exports = function () { /* empty */ };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_add-to-unscopables.js\n// module id = 117\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/symbol\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/symbol.js\n// module id = 118\n// module chunks = 7","require('../../modules/es6.symbol');\nrequire('../../modules/es6.object.to-string');\nrequire('../../modules/es7.symbol.async-iterator');\nrequire('../../modules/es7.symbol.observable');\nmodule.exports = require('../../modules/_core').Symbol;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/symbol/index.js\n// module id = 119\n// module chunks = 7","'use strict';\n// ECMAScript 6 symbols shim\nvar global = require('./_global');\nvar has = require('./_has');\nvar DESCRIPTORS = require('./_descriptors');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar META = require('./_meta').KEY;\nvar $fails = require('./_fails');\nvar shared = require('./_shared');\nvar setToStringTag = require('./_set-to-string-tag');\nvar uid = require('./_uid');\nvar wks = require('./_wks');\nvar wksExt = require('./_wks-ext');\nvar wksDefine = require('./_wks-define');\nvar keyOf = require('./_keyof');\nvar enumKeys = require('./_enum-keys');\nvar isArray = require('./_is-array');\nvar anObject = require('./_an-object');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar createDesc = require('./_property-desc');\nvar _create = require('./_object-create');\nvar gOPNExt = require('./_object-gopn-ext');\nvar $GOPD = require('./_object-gopd');\nvar $DP = require('./_object-dp');\nvar $keys = require('./_object-keys');\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function';\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f = $propertyIsEnumerable;\n  require('./_object-gops').f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !require('./_library')) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(key) {\n    if (isSymbol(key)) return keyOf(SymbolRegistry, key);\n    throw TypeError(key + ' is not a symbol!');\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    if (it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    replacer = args[1];\n    if (typeof replacer == 'function') $replacer = replacer;\n    if ($replacer || !isArray(replacer)) replacer = function (key, value) {\n      if ($replacer) value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.symbol.js\n// module id = 120\n// module chunks = 7","var getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nmodule.exports = function (object, el) {\n  var O = toIObject(object);\n  var keys = getKeys(O);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) if (O[key = keys[index++]] === el) return key;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_keyof.js\n// module id = 121\n// module chunks = 7","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_enum-keys.js\n// module id = 122\n// module chunks = 7","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject');\nvar gOPN = require('./_object-gopn').f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-gopn-ext.js\n// module id = 123\n// module chunks = 7","require('./_wks-define')('asyncIterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.symbol.async-iterator.js\n// module id = 124\n// module chunks = 7","require('./_wks-define')('observable');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.symbol.observable.js\n// module id = 125\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/set-prototype-of\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/set-prototype-of.js\n// module id = 126\n// module chunks = 7","require('../../modules/es6.object.set-prototype-of');\nmodule.exports = require('../../modules/_core').Object.setPrototypeOf;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/set-prototype-of.js\n// module id = 127\n// module chunks = 7","// 19.1.3.19 Object.setPrototypeOf(O, proto)\nvar $export = require('./_export');\n$export($export.S, 'Object', { setPrototypeOf: require('./_set-proto').set });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.set-prototype-of.js\n// module id = 128\n// module chunks = 7","// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nvar isObject = require('./_is-object');\nvar anObject = require('./_an-object');\nvar check = function (O, proto) {\n  anObject(O);\n  if (!isObject(proto) && proto !== null) throw TypeError(proto + \": can't set as prototype!\");\n};\nmodule.exports = {\n  set: Object.setPrototypeOf || ('__proto__' in {} ? // eslint-disable-line\n    function (test, buggy, set) {\n      try {\n        set = require('./_ctx')(Function.call, require('./_object-gopd').f(Object.prototype, '__proto__').set, 2);\n        set(test, []);\n        buggy = !(test instanceof Array);\n      } catch (e) { buggy = true; }\n      return function setPrototypeOf(O, proto) {\n        check(O, proto);\n        if (buggy) O.__proto__ = proto;\n        else set(O, proto);\n        return O;\n      };\n    }({}, false) : undefined),\n  check: check\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_set-proto.js\n// module id = 129\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/create.js\n// module id = 130\n// module chunks = 7","require('../../modules/es6.object.create');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function create(P, D) {\n  return $Object.create(P, D);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/create.js\n// module id = 131\n// module chunks = 7","var $export = require('./_export');\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', { create: require('./_object-create') });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.create.js\n// module id = 132\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/get-own-property-descriptor\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/get-own-property-descriptor.js\n// module id = 133\n// module chunks = 7","require('../../modules/es6.object.get-own-property-descriptor');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function getOwnPropertyDescriptor(it, key) {\n  return $Object.getOwnPropertyDescriptor(it, key);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/get-own-property-descriptor.js\n// module id = 134\n// module chunks = 7","// 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\nvar toIObject = require('./_to-iobject');\nvar $getOwnPropertyDescriptor = require('./_object-gopd').f;\n\nrequire('./_object-sap')('getOwnPropertyDescriptor', function () {\n  return function getOwnPropertyDescriptor(it, key) {\n    return $getOwnPropertyDescriptor(toIObject(it), key);\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.get-own-property-descriptor.js\n// module id = 135\n// module chunks = 7","/**\r\n * @author       Timo Hausmann\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2014 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\r\n\r\n/**\r\n * A QuadTree implementation. The original code was a conversion of the Java code posted to GameDevTuts.\r\n * However I've tweaked it massively to add node indexing, removed lots of temp. var creation and significantly increased performance as a result.\r\n * Original version at https://github.com/timohausmann/quadtree-js/\r\n *\r\n * @class QuadTree\r\n * @constructor\r\n * @param {number} x - The top left coordinate of the quadtree.\r\n * @param {number} y - The top left coordinate of the quadtree.\r\n * @param {number} width - The width of the quadtree in pixels.\r\n * @param {number} height - The height of the quadtree in pixels.\r\n * @param {number} [maxObjects=10] - The maximum number of objects per node.\r\n * @param {number} [maxLevels=4] - The maximum number of levels to iterate to.\r\n * @param {number} [level=0] - Which level is this?\r\n */\r\nexport default function QuadTree(left, top, width, height, maxObjects, maxLevels, level, root) {\r\n\r\n  /**\r\n   * @property {number} maxObjects - The maximum number of objects per node.\r\n   * @default\r\n   */\r\n  this.maxObjects = 10;\r\n\r\n  /**\r\n   * @property {number} maxLevels - The maximum number of levels to break down to.\r\n   * @default\r\n   */\r\n  this.maxLevels = 4;\r\n\r\n  /**\r\n   * @property {number} level - The current level.\r\n   */\r\n  this.level = 0;\r\n\r\n  /**\r\n   * @property {object} bounds - Object that contains the quadtree bounds.\r\n   */\r\n  this.bounds = {};\r\n\r\n  /**\r\n   * @property {array} objects - Array of quadtree children.\r\n   */\r\n  this.objects = [];\r\n\r\n  /**\r\n   * @property {array} nodes - Array of associated child nodes.\r\n   */\r\n  this.nodes = [];\r\n\r\n  /**\r\n   * @property {array} _empty - Internal empty array.\r\n   * @private\r\n   */\r\n  this._empty = [];\r\n\r\n  this.root = root || this;\r\n  this.entityMap = {};\r\n\r\n  this.reset(left, top, width, height, maxObjects, maxLevels, level);\r\n\r\n};\r\n\r\nQuadTree.prototype = {\r\n\r\n  /**\r\n   * Resets the QuadTree.\r\n   *\r\n   * @method QuadTree#reset\r\n   * @param {number} x - The top left coordinate of the quadtree.\r\n   * @param {number} y - The top left coordinate of the quadtree.\r\n   * @param {number} width - The width of the quadtree in pixels.\r\n   * @param {number} height - The height of the quadtree in pixels.\r\n   * @param {number} [maxObjects=10] - The maximum number of objects per node.\r\n   * @param {number} [maxLevels=4] - The maximum number of levels to iterate to.\r\n   * @param {number} [level=0] - Which level is this?\r\n   */\r\n  reset: function (left, top, width, height, maxObjects, maxLevels, level) {\r\n\r\n    this.maxObjects = maxObjects || 10;\r\n    this.maxLevels = maxLevels || 4;\r\n    this.level = level || 0;\r\n\r\n    this.bounds = {\r\n      width: width,\r\n      height: height,\r\n      subWidth: Math.floor(width / 2),\r\n      subHeight: Math.floor(height / 2),\r\n      left: Math.round(left),\r\n      top: Math.round(top),\r\n      midX: Math.round(left + width / 2),\r\n      midY: Math.round(top + height / 2),\r\n      right: Math.round(left + width),\r\n      bottom: Math.round(top + height)\r\n    };\r\n\r\n    this.objects.length = 0;\r\n    this.nodes.length = 0;\r\n\r\n  },\r\n\r\n  /**\r\n   * Split the node into 4 subnodes\r\n   *\r\n   * @method QuadTree#split\r\n   */\r\n  split: function () {\r\n\r\n    //  top right node\r\n    this.nodes[0] = new QuadTree(\r\n      this.bounds.left + this.bounds.subWidth,\r\n      this.bounds.top,\r\n      this.bounds.subWidth, this.bounds.subHeight,\r\n      this.maxObjects, this.maxLevels, (this.level + 1), this.root\r\n    );\r\n\r\n    //  top left node\r\n    this.nodes[1] = new QuadTree(\r\n      this.bounds.left,\r\n      this.bounds.top,\r\n      this.bounds.subWidth, this.bounds.subHeight,\r\n      this.maxObjects, this.maxLevels, (this.level + 1), this.root\r\n    );\r\n\r\n    //  bottom left node\r\n    this.nodes[2] = new QuadTree(\r\n      this.bounds.left,\r\n      this.bounds.top + this.bounds.subHeight,\r\n      this.bounds.subWidth, this.bounds.subHeight,\r\n      this.maxObjects, this.maxLevels, (this.level + 1), this.root\r\n    );\r\n\r\n    //  bottom right node\r\n    this.nodes[3] = new QuadTree(\r\n      this.bounds.left + this.bounds.subWidth,\r\n      this.bounds.top + this.bounds.subHeight,\r\n      this.bounds.subWidth, this.bounds.subHeight,\r\n      this.maxObjects, this.maxLevels, (this.level + 1), this.root\r\n    );\r\n\r\n  },\r\n\r\n  /**\r\n   * Insert the object into the node. If the node exceeds the capacity, it will split and add all objects to their corresponding subnodes.\r\n   *\r\n   * @method QuadTree#insert\r\n   * @param {Phaser.Physics.Arcade.Body|object} body - The Body object to insert into the quadtree. Can be any object so long as it exposes x, y, right and bottom properties.\r\n   */\r\n  insert: function (body) {\r\n\r\n    var i = 0;\r\n    var index;\r\n\r\n    //  if we have subnodes ...\r\n    if (this.nodes[0] != null) {\r\n      index = this.getIndex(body);\r\n      if (index !== -1) {\r\n        this.nodes[index].insert(body);\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Check if we already have this item in the quadtree structure.\r\n    var oldNode = this.root.entityMap[body.entityId];\r\n    if (oldNode === this) {\r\n      // If we have the item, and it's this current sub-tree, then just bail.\r\n      return;\r\n    }\r\n    if (oldNode) {\r\n      // If the item is known, but in another sub-tree, then delete it from there.\r\n      var objectIndex = oldNode.objects.indexOf(body);\r\n      if (objectIndex !== -1) {\r\n        oldNode.objects.splice(objectIndex, 1);\r\n      }\r\n    }\r\n\r\n    /*\r\n    // TODO: Need the opposite of split() to consolidate subtrees when they\r\n    // lose items.\r\n\r\n    this.root.entityMap[body.entityId] = this;\r\n    */\r\n\r\n    this.objects.push(body);\r\n\r\n    if (this.objects.length > this.maxObjects && this.level < this.maxLevels) {\r\n      //  Split if we don't already have subnodes\r\n      if (this.nodes[0] == null) {\r\n        this.split();\r\n      }\r\n      //  Add objects to subnodes\r\n      while (i < this.objects.length) {\r\n        index = this.getIndex(this.objects[i]);\r\n        if (index !== -1) {\r\n          //  this is expensive - see what we can do about it\r\n          this.nodes[index].insert(this.objects.splice(i, 1)[0]);\r\n        } else {\r\n          i++;\r\n        }\r\n      }\r\n    }\r\n\r\n  },\r\n\r\n  /**\r\n   * Determine which node the object belongs to.\r\n   *\r\n   * @method QuadTree#getIndex\r\n   * @param {Phaser.Rectangle|object} rect - The bounds in which to check.\r\n   * @return {number} index - Index of the subnode (0-3), or -1 if rect cannot completely fit within a subnode and is part of the parent node.\r\n   */\r\n  getIndex: function (rect) {\r\n    if (rect.left < this.bounds.midX && rect.right < this.bounds.midX) {\r\n      if (rect.top < this.bounds.midY && rect.bottom < this.bounds.midY) {\r\n        //  rect fits within the top-left quadrant of this quadtree\r\n        return 1;\r\n      } else if (rect.top > this.bounds.midY) {\r\n        //  rect fits within the bottom-left quadrant of this quadtree\r\n        return 2;\r\n      }\r\n    } else if (rect.left > this.bounds.midX) {\r\n      //  rect can completely fit within the right quadrants\r\n      if (rect.top < this.bounds.midY && rect.bottom < this.bounds.midY) {\r\n        //  rect fits within the top-right quadrant of this quadtree\r\n        return 0;\r\n      } else if (rect.top > this.bounds.midY) {\r\n        //  rect fits within the bottom-right quadrant of this quadtree\r\n        return 3;\r\n      }\r\n    }\r\n    // rect doesn't fit, i.e. it straddles the internal quadrants\r\n    return -1;\r\n  },\r\n\r\n  /**\r\n   * Iterate through all objects that could collide with the given Sprite or Rectangle.\r\n   *\r\n   * @method QuadTree#retrieve\r\n   * @param {Phaser.Sprite|Phaser.Rectangle} source - The source object to check the QuadTree against. Either a Sprite or Rectangle.\r\n   */\r\n  iterate: function (source, iteratorFn, optionalParam) {\r\n    var index = this.getIndex(source);\r\n\r\n    for (var i = 0; i < this.objects.length; i++) {\r\n      iteratorFn(this.objects[i], optionalParam);\r\n    }\r\n\r\n    if (this.nodes[0]) {\r\n      //  If rect fits into a subnode ..\r\n      if (index !== -1) {\r\n        this.nodes[index].iterate(source, iteratorFn, optionalParam);\r\n      } else {\r\n        //  If rect does not fit into a subnode, check it against all subnodes (unrolled for speed)\r\n        this.nodes[0].iterate(source, iteratorFn, optionalParam);\r\n        this.nodes[1].iterate(source, iteratorFn, optionalParam);\r\n        this.nodes[2].iterate(source, iteratorFn, optionalParam);\r\n        this.nodes[3].iterate(source, iteratorFn, optionalParam);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Clear the quadtree.\r\n   * @method QuadTree#clear\r\n   */\r\n  clear: function () {\r\n    this.objects.length = 0;\r\n    var i = this.nodes.length;\r\n    while (i--) {\r\n      this.nodes[i].clear();\r\n      this.nodes.splice(i, 1);\r\n    }\r\n    this.nodes.length = 0;\r\n  }\r\n\r\n};\r\n\r\n/**\r\n * Javascript QuadTree\r\n * @version 1.0\r\n *\r\n * @version 1.3, March 11th 2014\r\n * @author Richard Davey\r\n * The original code was a conversion of the Java code posted to GameDevTuts. However I've tweaked\r\n * it massively to add node indexing, removed lots of temp. var creation and significantly\r\n * increased performance as a result.\r\n *\r\n * Original version at https://github.com/timohausmann/quadtree-js/\r\n */\r\n\r\n/**\r\n * @copyright © 2012 Timo Hausmann\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining\r\n * a copy of this software and associated documentation files (the\r\n * \"Software\"), to deal in the Software without restriction, including\r\n * without limitation the rights to use, copy, modify, merge, publish,\r\n * distribute, sublicense, and/or sell copies of the Software, and to\r\n * permit persons to whom the Software is furnished to do so, subject to\r\n * the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be\r\n * included in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\n * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\n * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/QuadTree.js","module.exports = require('./vendor/dat.gui')\nmodule.exports.color = require('./vendor/dat.color')\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dat-gui/index.js\n// module id = 137\n// module chunks = 7","/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n/** @namespace */\nvar dat = module.exports = dat || {};\n\n/** @namespace */\ndat.gui = dat.gui || {};\n\n/** @namespace */\ndat.utils = dat.utils || {};\n\n/** @namespace */\ndat.controllers = dat.controllers || {};\n\n/** @namespace */\ndat.dom = dat.dom || {};\n\n/** @namespace */\ndat.color = dat.color || {};\n\ndat.utils.css = (function () {\n  return {\n    load: function (url, doc) {\n      doc = doc || document;\n      var link = doc.createElement('link');\n      link.type = 'text/css';\n      link.rel = 'stylesheet';\n      link.href = url;\n      doc.getElementsByTagName('head')[0].appendChild(link);\n    },\n    inject: function(css, doc) {\n      doc = doc || document;\n      var injected = document.createElement('style');\n      injected.type = 'text/css';\n      injected.innerHTML = css;\n      doc.getElementsByTagName('head')[0].appendChild(injected);\n    }\n  }\n})();\n\n\ndat.utils.common = (function () {\n  \n  var ARR_EACH = Array.prototype.forEach;\n  var ARR_SLICE = Array.prototype.slice;\n\n  /**\n   * Band-aid methods for things that should be a lot easier in JavaScript.\n   * Implementation and structure inspired by underscore.js\n   * http://documentcloud.github.com/underscore/\n   */\n\n  return { \n    \n    BREAK: {},\n  \n    extend: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (!this.isUndefined(obj[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n      \n    },\n    \n    defaults: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (this.isUndefined(target[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n    \n    },\n    \n    compose: function() {\n      var toCall = ARR_SLICE.call(arguments);\n            return function() {\n              var args = ARR_SLICE.call(arguments);\n              for (var i = toCall.length -1; i >= 0; i--) {\n                args = [toCall[i].apply(this, args)];\n              }\n              return args[0];\n            }\n    },\n    \n    each: function(obj, itr, scope) {\n\n      \n      if (ARR_EACH && obj.forEach === ARR_EACH) { \n        \n        obj.forEach(itr, scope);\n        \n      } else if (obj.length === obj.length + 0) { // Is number but not NaN\n        \n        for (var key = 0, l = obj.length; key < l; key++)\n          if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) \n            return;\n            \n      } else {\n\n        for (var key in obj) \n          if (itr.call(scope, obj[key], key) === this.BREAK)\n            return;\n            \n      }\n            \n    },\n    \n    defer: function(fnc) {\n      setTimeout(fnc, 0);\n    },\n    \n    toArray: function(obj) {\n      if (obj.toArray) return obj.toArray();\n      return ARR_SLICE.call(obj);\n    },\n\n    isUndefined: function(obj) {\n      return obj === undefined;\n    },\n    \n    isNull: function(obj) {\n      return obj === null;\n    },\n    \n    isNaN: function(obj) {\n      return obj !== obj;\n    },\n    \n    isArray: Array.isArray || function(obj) {\n      return obj.constructor === Array;\n    },\n    \n    isObject: function(obj) {\n      return obj === Object(obj);\n    },\n    \n    isNumber: function(obj) {\n      return obj === obj+0;\n    },\n    \n    isString: function(obj) {\n      return obj === obj+'';\n    },\n    \n    isBoolean: function(obj) {\n      return obj === false || obj === true;\n    },\n    \n    isFunction: function(obj) {\n      return Object.prototype.toString.call(obj) === '[object Function]';\n    }\n  \n  };\n    \n})();\n\n\ndat.controllers.Controller = (function (common) {\n\n  /**\n   * @class An \"abstract\" class that represents a given property of an object.\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var Controller = function(object, property) {\n\n    this.initialValue = object[property];\n\n    /**\n     * Those who extend this class will put their DOM elements in here.\n     * @type {DOMElement}\n     */\n    this.domElement = document.createElement('div');\n\n    /**\n     * The object to manipulate\n     * @type {Object}\n     */\n    this.object = object;\n\n    /**\n     * The name of the property to manipulate\n     * @type {String}\n     */\n    this.property = property;\n\n    /**\n     * The function to be called on change.\n     * @type {Function}\n     * @ignore\n     */\n    this.__onChange = undefined;\n\n    /**\n     * The function to be called on finishing change.\n     * @type {Function}\n     * @ignore\n     */\n    this.__onFinishChange = undefined;\n\n  };\n\n  common.extend(\n\n      Controller.prototype,\n\n      /** @lends dat.controllers.Controller.prototype */\n      {\n\n        /**\n         * Specify that a function fire every time someone changes the value with\n         * this Controller.\n         *\n         * @param {Function} fnc This function will be called whenever the value\n         * is modified via this Controller.\n         * @returns {dat.controllers.Controller} this\n         */\n        onChange: function(fnc) {\n          this.__onChange = fnc;\n          return this;\n        },\n\n        /**\n         * Specify that a function fire every time someone \"finishes\" changing\n         * the value wih this Controller. Useful for values that change\n         * incrementally like numbers or strings.\n         *\n         * @param {Function} fnc This function will be called whenever\n         * someone \"finishes\" changing the value via this Controller.\n         * @returns {dat.controllers.Controller} this\n         */\n        onFinishChange: function(fnc) {\n          this.__onFinishChange = fnc;\n          return this;\n        },\n\n        /**\n         * Change the value of <code>object[property]</code>\n         *\n         * @param {Object} newValue The new value of <code>object[property]</code>\n         */\n        setValue: function(newValue) {\n          this.object[this.property] = newValue;\n          if (this.__onChange) {\n            this.__onChange.call(this, newValue);\n          }\n          this.updateDisplay();\n          return this;\n        },\n\n        /**\n         * Gets the value of <code>object[property]</code>\n         *\n         * @returns {Object} The current value of <code>object[property]</code>\n         */\n        getValue: function() {\n          return this.object[this.property];\n        },\n\n        /**\n         * Refreshes the visual display of a Controller in order to keep sync\n         * with the object's current value.\n         * @returns {dat.controllers.Controller} this\n         */\n        updateDisplay: function() {\n          return this;\n        },\n\n        /**\n         * @returns {Boolean} true if the value has deviated from initialValue\n         */\n        isModified: function() {\n          return this.initialValue !== this.getValue()\n        }\n\n      }\n\n  );\n\n  return Controller;\n\n\n})(dat.utils.common);\n\n\ndat.dom.dom = (function (common) {\n\n  var EVENT_MAP = {\n    'HTMLEvents': ['change'],\n    'MouseEvents': ['click','mousemove','mousedown','mouseup', 'mouseover'],\n    'KeyboardEvents': ['keydown']\n  };\n\n  var EVENT_MAP_INV = {};\n  common.each(EVENT_MAP, function(v, k) {\n    common.each(v, function(e) {\n      EVENT_MAP_INV[e] = k;\n    });\n  });\n\n  var CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\n\n  function cssValueToPixels(val) {\n\n    if (val === '0' || common.isUndefined(val)) return 0;\n\n    var match = val.match(CSS_VALUE_PIXELS);\n\n    if (!common.isNull(match)) {\n      return parseFloat(match[1]);\n    }\n\n    // TODO ...ems? %?\n\n    return 0;\n\n  }\n\n  /**\n   * @namespace\n   * @member dat.dom\n   */\n  var dom = {\n\n    /**\n     * \n     * @param elem\n     * @param selectable\n     */\n    makeSelectable: function(elem, selectable) {\n\n      if (elem === undefined || elem.style === undefined) return;\n\n      elem.onselectstart = selectable ? function() {\n        return false;\n      } : function() {\n      };\n\n      elem.style.MozUserSelect = selectable ? 'auto' : 'none';\n      elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\n      elem.unselectable = selectable ? 'on' : 'off';\n\n    },\n\n    /**\n     *\n     * @param elem\n     * @param horizontal\n     * @param vertical\n     */\n    makeFullscreen: function(elem, horizontal, vertical) {\n\n      if (common.isUndefined(horizontal)) horizontal = true;\n      if (common.isUndefined(vertical)) vertical = true;\n\n      elem.style.position = 'absolute';\n\n      if (horizontal) {\n        elem.style.left = 0;\n        elem.style.right = 0;\n      }\n      if (vertical) {\n        elem.style.top = 0;\n        elem.style.bottom = 0;\n      }\n\n    },\n\n    /**\n     *\n     * @param elem\n     * @param eventType\n     * @param params\n     */\n    fakeEvent: function(elem, eventType, params, aux) {\n      params = params || {};\n      var className = EVENT_MAP_INV[eventType];\n      if (!className) {\n        throw new Error('Event type ' + eventType + ' not supported.');\n      }\n      var evt = document.createEvent(className);\n      switch (className) {\n        case 'MouseEvents':\n          var clientX = params.x || params.clientX || 0;\n          var clientY = params.y || params.clientY || 0;\n          evt.initMouseEvent(eventType, params.bubbles || false,\n              params.cancelable || true, window, params.clickCount || 1,\n              0, //screen X\n              0, //screen Y\n              clientX, //client X\n              clientY, //client Y\n              false, false, false, false, 0, null);\n          break;\n        case 'KeyboardEvents':\n          var init = evt.initKeyboardEvent || evt.initKeyEvent; // webkit || moz\n          common.defaults(params, {\n            cancelable: true,\n            ctrlKey: false,\n            altKey: false,\n            shiftKey: false,\n            metaKey: false,\n            keyCode: undefined,\n            charCode: undefined\n          });\n          init(eventType, params.bubbles || false,\n              params.cancelable, window,\n              params.ctrlKey, params.altKey,\n              params.shiftKey, params.metaKey,\n              params.keyCode, params.charCode);\n          break;\n        default:\n          evt.initEvent(eventType, params.bubbles || false,\n              params.cancelable || true);\n          break;\n      }\n      common.defaults(evt, aux);\n      elem.dispatchEvent(evt);\n    },\n\n    /**\n     *\n     * @param elem\n     * @param event\n     * @param func\n     * @param bool\n     */\n    bind: function(elem, event, func, bool) {\n      bool = bool || false;\n      if (elem.addEventListener)\n        elem.addEventListener(event, func, bool);\n      else if (elem.attachEvent)\n        elem.attachEvent('on' + event, func);\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param event\n     * @param func\n     * @param bool\n     */\n    unbind: function(elem, event, func, bool) {\n      bool = bool || false;\n      if (elem.removeEventListener)\n        elem.removeEventListener(event, func, bool);\n      else if (elem.detachEvent)\n        elem.detachEvent('on' + event, func);\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param className\n     */\n    addClass: function(elem, className) {\n      if (elem.className === undefined) {\n        elem.className = className;\n      } else if (elem.className !== className) {\n        var classes = elem.className.split(/ +/);\n        if (classes.indexOf(className) == -1) {\n          classes.push(className);\n          elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\n        }\n      }\n      return dom;\n    },\n\n    /**\n     *\n     * @param elem\n     * @param className\n     */\n    removeClass: function(elem, className) {\n      if (className) {\n        if (elem.className === undefined) {\n          // elem.className = className;\n        } else if (elem.className === className) {\n          elem.removeAttribute('class');\n        } else {\n          var classes = elem.className.split(/ +/);\n          var index = classes.indexOf(className);\n          if (index != -1) {\n            classes.splice(index, 1);\n            elem.className = classes.join(' ');\n          }\n        }\n      } else {\n        elem.className = undefined;\n      }\n      return dom;\n    },\n\n    hasClass: function(elem, className) {\n      return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getWidth: function(elem) {\n\n      var style = getComputedStyle(elem);\n\n      return cssValueToPixels(style['border-left-width']) +\n          cssValueToPixels(style['border-right-width']) +\n          cssValueToPixels(style['padding-left']) +\n          cssValueToPixels(style['padding-right']) +\n          cssValueToPixels(style['width']);\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getHeight: function(elem) {\n\n      var style = getComputedStyle(elem);\n\n      return cssValueToPixels(style['border-top-width']) +\n          cssValueToPixels(style['border-bottom-width']) +\n          cssValueToPixels(style['padding-top']) +\n          cssValueToPixels(style['padding-bottom']) +\n          cssValueToPixels(style['height']);\n    },\n\n    /**\n     *\n     * @param elem\n     */\n    getOffset: function(elem) {\n      var offset = {left: 0, top:0};\n      if (elem.offsetParent) {\n        do {\n          offset.left += elem.offsetLeft;\n          offset.top += elem.offsetTop;\n        } while (elem = elem.offsetParent);\n      }\n      return offset;\n    },\n\n    // http://stackoverflow.com/posts/2684561/revisions\n    /**\n     * \n     * @param elem\n     */\n    isActive: function(elem) {\n      return elem === document.activeElement && ( elem.type || elem.href );\n    }\n\n  };\n\n  return dom;\n\n})(dat.utils.common);\n\n\ndat.controllers.OptionController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a select input to alter the property of an object, using a\n   * list of accepted values.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object|string[]} options A map of labels to acceptable values, or\n   * a list of acceptable string values.\n   *\n   * @member dat.controllers\n   */\n  var OptionController = function(object, property, options) {\n\n    OptionController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    /**\n     * The drop down menu\n     * @ignore\n     */\n    this.__select = document.createElement('select');\n\n    if (common.isArray(options)) {\n      var map = {};\n      common.each(options, function(element) {\n        map[element] = element;\n      });\n      options = map;\n    }\n\n    common.each(options, function(value, key) {\n\n      var opt = document.createElement('option');\n      opt.innerHTML = key;\n      opt.setAttribute('value', value);\n      _this.__select.appendChild(opt);\n\n    });\n\n    // Acknowledge original value\n    this.updateDisplay();\n\n    dom.bind(this.__select, 'change', function() {\n      var desiredValue = this.options[this.selectedIndex].value;\n      _this.setValue(desiredValue);\n    });\n\n    this.domElement.appendChild(this.__select);\n\n  };\n\n  OptionController.superclass = Controller;\n\n  common.extend(\n\n      OptionController.prototype,\n      Controller.prototype,\n\n      {\n\n        setValue: function(v) {\n          var toReturn = OptionController.superclass.prototype.setValue.call(this, v);\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          return toReturn;\n        },\n\n        updateDisplay: function() {\n          this.__select.value = this.getValue();\n          return OptionController.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  return OptionController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.NumberController = (function (Controller, common) {\n\n  /**\n   * @class Represents a given property of an object that is a number.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object} [params] Optional parameters\n   * @param {Number} [params.min] Minimum allowed value\n   * @param {Number} [params.max] Maximum allowed value\n   * @param {Number} [params.step] Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberController = function(object, property, params) {\n\n    NumberController.superclass.call(this, object, property);\n\n    params = params || {};\n\n    this.__min = params.min;\n    this.__max = params.max;\n    this.__step = params.step;\n\n    if (common.isUndefined(this.__step)) {\n\n      if (this.initialValue == 0) {\n        this.__impliedStep = 1; // What are we, psychics?\n      } else {\n        // Hey Doug, check this out.\n        this.__impliedStep = Math.pow(10, Math.floor(Math.log(this.initialValue)/Math.LN10))/10;\n      }\n\n    } else {\n\n      this.__impliedStep = this.__step;\n\n    }\n\n    this.__precision = numDecimals(this.__impliedStep);\n\n\n  };\n\n  NumberController.superclass = Controller;\n\n  common.extend(\n\n      NumberController.prototype,\n      Controller.prototype,\n\n      /** @lends dat.controllers.NumberController.prototype */\n      {\n\n        setValue: function(v) {\n\n          if (this.__min !== undefined && v < this.__min) {\n            v = this.__min;\n          } else if (this.__max !== undefined && v > this.__max) {\n            v = this.__max;\n          }\n\n          if (this.__step !== undefined && v % this.__step != 0) {\n            v = Math.round(v / this.__step) * this.__step;\n          }\n\n          return NumberController.superclass.prototype.setValue.call(this, v);\n\n        },\n\n        /**\n         * Specify a minimum value for <code>object[property]</code>.\n         *\n         * @param {Number} minValue The minimum value for\n         * <code>object[property]</code>\n         * @returns {dat.controllers.NumberController} this\n         */\n        min: function(v) {\n          this.__min = v;\n          return this;\n        },\n\n        /**\n         * Specify a maximum value for <code>object[property]</code>.\n         *\n         * @param {Number} maxValue The maximum value for\n         * <code>object[property]</code>\n         * @returns {dat.controllers.NumberController} this\n         */\n        max: function(v) {\n          this.__max = v;\n          return this;\n        },\n\n        /**\n         * Specify a step value that dat.controllers.NumberController\n         * increments by.\n         *\n         * @param {Number} stepValue The step value for\n         * dat.controllers.NumberController\n         * @default if minimum and maximum specified increment is 1% of the\n         * difference otherwise stepValue is 1\n         * @returns {dat.controllers.NumberController} this\n         */\n        step: function(v) {\n          this.__step = v;\n          return this;\n        }\n\n      }\n\n  );\n\n  function numDecimals(x) {\n    x = x.toString();\n    if (x.indexOf('.') > -1) {\n      return x.length - x.indexOf('.') - 1;\n    } else {\n      return 0;\n    }\n  }\n\n  return NumberController;\n\n})(dat.controllers.Controller,\ndat.utils.common);\n\n\ndat.controllers.NumberControllerBox = (function (NumberController, dom, common) {\n\n  /**\n   * @class Represents a given property of an object that is a number and\n   * provides an input element with which to manipulate it.\n   *\n   * @extends dat.controllers.Controller\n   * @extends dat.controllers.NumberController\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Object} [params] Optional parameters\n   * @param {Number} [params.min] Minimum allowed value\n   * @param {Number} [params.max] Maximum allowed value\n   * @param {Number} [params.step] Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberControllerBox = function(object, property, params) {\n\n    this.__truncationSuspended = false;\n\n    NumberControllerBox.superclass.call(this, object, property, params);\n\n    var _this = this;\n\n    /**\n     * {Number} Previous mouse y position\n     * @ignore\n     */\n    var prev_y;\n\n    this.__input = document.createElement('input');\n    this.__input.setAttribute('type', 'text');\n\n    // Makes it so manually specified values are not truncated.\n\n    dom.bind(this.__input, 'change', onChange);\n    dom.bind(this.__input, 'blur', onBlur);\n    dom.bind(this.__input, 'mousedown', onMouseDown);\n    dom.bind(this.__input, 'keydown', function(e) {\n\n      // When pressing entire, you can be as precise as you want.\n      if (e.keyCode === 13) {\n        _this.__truncationSuspended = true;\n        this.blur();\n        _this.__truncationSuspended = false;\n      }\n\n    });\n\n    function onChange() {\n      var attempted = parseFloat(_this.__input.value);\n      if (!common.isNaN(attempted)) _this.setValue(attempted);\n    }\n\n    function onBlur() {\n      onChange();\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    function onMouseDown(e) {\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n      prev_y = e.clientY;\n    }\n\n    function onMouseDrag(e) {\n\n      var diff = prev_y - e.clientY;\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\n\n      prev_y = e.clientY;\n\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n    }\n\n    this.updateDisplay();\n\n    this.domElement.appendChild(this.__input);\n\n  };\n\n  NumberControllerBox.superclass = NumberController;\n\n  common.extend(\n\n      NumberControllerBox.prototype,\n      NumberController.prototype,\n\n      {\n\n        updateDisplay: function() {\n\n          this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\n          return NumberControllerBox.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  function roundToDecimal(value, decimals) {\n    var tenTo = Math.pow(10, decimals);\n    return Math.round(value * tenTo) / tenTo;\n  }\n\n  return NumberControllerBox;\n\n})(dat.controllers.NumberController,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.NumberControllerSlider = (function (NumberController, dom, css, common, styleSheet) {\n\n  /**\n   * @class Represents a given property of an object that is a number, contains\n   * a minimum and maximum, and provides a slider element with which to\n   * manipulate it. It should be noted that the slider element is made up of\n   * <code>&lt;div&gt;</code> tags, <strong>not</strong> the html5\n   * <code>&lt;slider&gt;</code> element.\n   *\n   * @extends dat.controllers.Controller\n   * @extends dat.controllers.NumberController\n   * \n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   * @param {Number} minValue Minimum allowed value\n   * @param {Number} maxValue Maximum allowed value\n   * @param {Number} stepValue Increment by which to change value\n   *\n   * @member dat.controllers\n   */\n  var NumberControllerSlider = function(object, property, min, max, step) {\n\n    NumberControllerSlider.superclass.call(this, object, property, { min: min, max: max, step: step });\n\n    var _this = this;\n\n    this.__background = document.createElement('div');\n    this.__foreground = document.createElement('div');\n    \n\n\n    dom.bind(this.__background, 'mousedown', onMouseDown);\n    \n    dom.addClass(this.__background, 'slider');\n    dom.addClass(this.__foreground, 'slider-fg');\n\n    function onMouseDown(e) {\n\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n\n      onMouseDrag(e);\n    }\n\n    function onMouseDrag(e) {\n\n      e.preventDefault();\n\n      var offset = dom.getOffset(_this.__background);\n      var width = dom.getWidth(_this.__background);\n      \n      _this.setValue(\n        map(e.clientX, offset.left, offset.left + width, _this.__min, _this.__max)\n      );\n\n      return false;\n\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    this.updateDisplay();\n\n    this.__background.appendChild(this.__foreground);\n    this.domElement.appendChild(this.__background);\n\n  };\n\n  NumberControllerSlider.superclass = NumberController;\n\n  /**\n   * Injects default stylesheet for slider elements.\n   */\n  NumberControllerSlider.useDefaultStyles = function() {\n    css.inject(styleSheet);\n  };\n\n  common.extend(\n\n      NumberControllerSlider.prototype,\n      NumberController.prototype,\n\n      {\n\n        updateDisplay: function() {\n          var pct = (this.getValue() - this.__min)/(this.__max - this.__min);\n          this.__foreground.style.width = pct*100+'%';\n          return NumberControllerSlider.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n\n\n  );\n\n  function map(v, i1, i2, o1, o2) {\n    return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\n  }\n\n  return NumberControllerSlider;\n  \n})(dat.controllers.NumberController,\ndat.dom.dom,\ndat.utils.css,\ndat.utils.common,\n\".slider {\\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\\n  height: 1em;\\n  border-radius: 1em;\\n  background-color: #eee;\\n  padding: 0 0.5em;\\n  overflow: hidden;\\n}\\n\\n.slider-fg {\\n  padding: 1px 0 2px 0;\\n  background-color: #aaa;\\n  height: 1em;\\n  margin-left: -0.5em;\\n  padding-right: 0.5em;\\n  border-radius: 1em 0 0 1em;\\n}\\n\\n.slider-fg:after {\\n  display: inline-block;\\n  border-radius: 1em;\\n  background-color: #fff;\\n  border:  1px solid #aaa;\\n  content: '';\\n  float: right;\\n  margin-right: -1em;\\n  margin-top: -1px;\\n  height: 0.9em;\\n  width: 0.9em;\\n}\");\n\n\ndat.controllers.FunctionController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a GUI interface to fire a specified method, a property of an object.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var FunctionController = function(object, property, text) {\n\n    FunctionController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    this.__button = document.createElement('div');\n    this.__button.innerHTML = text === undefined ? 'Fire' : text;\n    dom.bind(this.__button, 'click', function(e) {\n      e.preventDefault();\n      _this.fire();\n      return false;\n    });\n\n    dom.addClass(this.__button, 'button');\n\n    this.domElement.appendChild(this.__button);\n\n\n  };\n\n  FunctionController.superclass = Controller;\n\n  common.extend(\n\n      FunctionController.prototype,\n      Controller.prototype,\n      {\n        \n        fire: function() {\n          if (this.__onChange) {\n            this.__onChange.call(this);\n          }\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          this.getValue().call(this.object);\n        }\n      }\n\n  );\n\n  return FunctionController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.controllers.BooleanController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a checkbox input to alter the boolean property of an object.\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var BooleanController = function(object, property) {\n\n    BooleanController.superclass.call(this, object, property);\n\n    var _this = this;\n    this.__prev = this.getValue();\n\n    this.__checkbox = document.createElement('input');\n    this.__checkbox.setAttribute('type', 'checkbox');\n\n\n    dom.bind(this.__checkbox, 'change', onChange, false);\n\n    this.domElement.appendChild(this.__checkbox);\n\n    // Match original value\n    this.updateDisplay();\n\n    function onChange() {\n      _this.setValue(!_this.__prev);\n    }\n\n  };\n\n  BooleanController.superclass = Controller;\n\n  common.extend(\n\n      BooleanController.prototype,\n      Controller.prototype,\n\n      {\n\n        setValue: function(v) {\n          var toReturn = BooleanController.superclass.prototype.setValue.call(this, v);\n          if (this.__onFinishChange) {\n            this.__onFinishChange.call(this, this.getValue());\n          }\n          this.__prev = this.getValue();\n          return toReturn;\n        },\n\n        updateDisplay: function() {\n          \n          if (this.getValue() === true) {\n            this.__checkbox.setAttribute('checked', 'checked');\n            this.__checkbox.checked = true;    \n          } else {\n              this.__checkbox.checked = false;\n          }\n\n          return BooleanController.superclass.prototype.updateDisplay.call(this);\n\n        }\n\n\n      }\n\n  );\n\n  return BooleanController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common);\n\n\ndat.color.toString = (function (common) {\n\n  return function(color) {\n\n    if (color.a == 1 || common.isUndefined(color.a)) {\n\n      var s = color.hex.toString(16);\n      while (s.length < 6) {\n        s = '0' + s;\n      }\n\n      return '#' + s;\n\n    } else {\n\n      return 'rgba(' + Math.round(color.r) + ',' + Math.round(color.g) + ',' + Math.round(color.b) + ',' + color.a + ')';\n\n    }\n\n  }\n\n})(dat.utils.common);\n\n\ndat.color.interpret = (function (toString, common) {\n\n  var result, toReturn;\n\n  var interpret = function() {\n\n    toReturn = false;\n\n    var original = arguments.length > 1 ? common.toArray(arguments) : arguments[0];\n\n    common.each(INTERPRETATIONS, function(family) {\n\n      if (family.litmus(original)) {\n\n        common.each(family.conversions, function(conversion, conversionName) {\n\n          result = conversion.read(original);\n\n          if (toReturn === false && result !== false) {\n            toReturn = result;\n            result.conversionName = conversionName;\n            result.conversion = conversion;\n            return common.BREAK;\n\n          }\n\n        });\n\n        return common.BREAK;\n\n      }\n\n    });\n\n    return toReturn;\n\n  };\n\n  var INTERPRETATIONS = [\n\n    // Strings\n    {\n\n      litmus: common.isString,\n\n      conversions: {\n\n        THREE_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt(\n                  '0x' +\n                      test[1].toString() + test[1].toString() +\n                      test[2].toString() + test[2].toString() +\n                      test[3].toString() + test[3].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        SIX_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9]{6})$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt('0x' + test[1].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGB: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3])\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGBA: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3]),\n              a: parseFloat(test[4])\n            };\n\n          },\n\n          write: toString\n\n        }\n\n      }\n\n    },\n\n    // Numbers\n    {\n\n      litmus: common.isNumber,\n\n      conversions: {\n\n        HEX: {\n          read: function(original) {\n            return {\n              space: 'HEX',\n              hex: original,\n              conversionName: 'HEX'\n            }\n          },\n\n          write: function(color) {\n            return color.hex;\n          }\n        }\n\n      }\n\n    },\n\n    // Arrays\n    {\n\n      litmus: common.isArray,\n\n      conversions: {\n\n        RGB_ARRAY: {\n          read: function(original) {\n            if (original.length != 3) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b];\n          }\n\n        },\n\n        RGBA_ARRAY: {\n          read: function(original) {\n            if (original.length != 4) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2],\n              a: original[3]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b, color.a];\n          }\n\n        }\n\n      }\n\n    },\n\n    // Objects\n    {\n\n      litmus: common.isObject,\n\n      conversions: {\n\n        RGBA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b,\n              a: color.a\n            }\n          }\n        },\n\n        RGB_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b\n            }\n          }\n        },\n\n        HSVA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v,\n              a: color.a\n            }\n          }\n        },\n\n        HSV_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v\n            }\n          }\n\n        }\n\n      }\n\n    }\n\n\n  ];\n\n  return interpret;\n\n\n})(dat.color.toString,\ndat.utils.common);\n\n\ndat.GUI = dat.gui.GUI = (function (css, saveDialogueContents, styleSheet, controllerFactory, Controller, BooleanController, FunctionController, NumberControllerBox, NumberControllerSlider, OptionController, ColorController, requestAnimationFrame, CenteredDiv, dom, common) {\n\n  css.inject(styleSheet);\n\n  /** Outer-most className for GUI's */\n  var CSS_NAMESPACE = 'dg';\n\n  var HIDE_KEY_CODE = 72;\n\n  /** The only value shared between the JS and SCSS. Use caution. */\n  var CLOSE_BUTTON_HEIGHT = 20;\n\n  var DEFAULT_DEFAULT_PRESET_NAME = 'Default';\n\n  var SUPPORTS_LOCAL_STORAGE = (function() {\n    try {\n      return 'localStorage' in window && window['localStorage'] !== null;\n    } catch (e) {\n      return false;\n    }\n  })();\n\n  var SAVE_DIALOGUE;\n\n  /** Have we yet to create an autoPlace GUI? */\n  var auto_place_virgin = true;\n\n  /** Fixed position div that auto place GUI's go inside */\n  var auto_place_container;\n\n  /** Are we hiding the GUI's ? */\n  var hide = false;\n\n  /** GUI's which should be hidden */\n  var hideable_guis = [];\n\n  /**\n   * A lightweight controller library for JavaScript. It allows you to easily\n   * manipulate variables and fire functions on the fly.\n   * @class\n   *\n   * @member dat.gui\n   *\n   * @param {Object} [params]\n   * @param {String} [params.name] The name of this GUI.\n   * @param {Object} [params.load] JSON object representing the saved state of\n   * this GUI.\n   * @param {Boolean} [params.auto=true]\n   * @param {dat.gui.GUI} [params.parent] The GUI I'm nested in.\n   * @param {Boolean} [params.closed] If true, starts closed\n   */\n  var GUI = function(params) {\n\n    var _this = this;\n\n    /**\n     * Outermost DOM Element\n     * @type DOMElement\n     */\n    this.domElement = document.createElement('div');\n    this.__ul = document.createElement('ul');\n    this.domElement.appendChild(this.__ul);\n\n    dom.addClass(this.domElement, CSS_NAMESPACE);\n\n    /**\n     * Nested GUI's by name\n     * @ignore\n     */\n    this.__folders = {};\n\n    this.__controllers = [];\n\n    /**\n     * List of objects I'm remembering for save, only used in top level GUI\n     * @ignore\n     */\n    this.__rememberedObjects = [];\n\n    /**\n     * Maps the index of remembered objects to a map of controllers, only used\n     * in top level GUI.\n     *\n     * @private\n     * @ignore\n     *\n     * @example\n     * [\n     *  {\n     *    propertyName: Controller,\n     *    anotherPropertyName: Controller\n     *  },\n     *  {\n     *    propertyName: Controller\n     *  }\n     * ]\n     */\n    this.__rememberedObjectIndecesToControllers = [];\n\n    this.__listening = [];\n\n    params = params || {};\n\n    // Default parameters\n    params = common.defaults(params, {\n      autoPlace: true,\n      width: GUI.DEFAULT_WIDTH\n    });\n\n    params = common.defaults(params, {\n      resizable: params.autoPlace,\n      hideable: params.autoPlace\n    });\n\n\n    if (!common.isUndefined(params.load)) {\n\n      // Explicit preset\n      if (params.preset) params.load.preset = params.preset;\n\n    } else {\n\n      params.load = { preset: DEFAULT_DEFAULT_PRESET_NAME };\n\n    }\n\n    if (common.isUndefined(params.parent) && params.hideable) {\n      hideable_guis.push(this);\n    }\n\n    // Only root level GUI's are resizable.\n    params.resizable = common.isUndefined(params.parent) && params.resizable;\n\n\n    if (params.autoPlace && common.isUndefined(params.scrollable)) {\n      params.scrollable = true;\n    }\n//    params.scrollable = common.isUndefined(params.parent) && params.scrollable === true;\n\n    // Not part of params because I don't want people passing this in via\n    // constructor. Should be a 'remembered' value.\n    var use_local_storage =\n        SUPPORTS_LOCAL_STORAGE &&\n            localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\n\n    Object.defineProperties(this,\n\n        /** @lends dat.gui.GUI.prototype */\n        {\n\n          /**\n           * The parent <code>GUI</code>\n           * @type dat.gui.GUI\n           */\n          parent: {\n            get: function() {\n              return params.parent;\n            }\n          },\n\n          scrollable: {\n            get: function() {\n              return params.scrollable;\n            }\n          },\n\n          /**\n           * Handles <code>GUI</code>'s element placement for you\n           * @type Boolean\n           */\n          autoPlace: {\n            get: function() {\n              return params.autoPlace;\n            }\n          },\n\n          /**\n           * The identifier for a set of saved values\n           * @type String\n           */\n          preset: {\n\n            get: function() {\n              if (_this.parent) {\n                return _this.getRoot().preset;\n              } else {\n                return params.load.preset;\n              }\n            },\n\n            set: function(v) {\n              if (_this.parent) {\n                _this.getRoot().preset = v;\n              } else {\n                params.load.preset = v;\n              }\n              setPresetSelectIndex(this);\n              _this.revert();\n            }\n\n          },\n\n          /**\n           * The width of <code>GUI</code> element\n           * @type Number\n           */\n          width: {\n            get: function() {\n              return params.width;\n            },\n            set: function(v) {\n              params.width = v;\n              setWidth(_this, v);\n            }\n          },\n\n          /**\n           * The name of <code>GUI</code>. Used for folders. i.e\n           * a folder's name\n           * @type String\n           */\n          name: {\n            get: function() {\n              return params.name;\n            },\n            set: function(v) {\n              // TODO Check for collisions among sibling folders\n              params.name = v;\n              if (title_row_name) {\n                title_row_name.innerHTML = params.name;\n              }\n            }\n          },\n\n          /**\n           * Whether the <code>GUI</code> is collapsed or not\n           * @type Boolean\n           */\n          closed: {\n            get: function() {\n              return params.closed;\n            },\n            set: function(v) {\n              params.closed = v;\n              if (params.closed) {\n                dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\n              } else {\n                dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\n              }\n              // For browsers that aren't going to respect the CSS transition,\n              // Lets just check our height against the window height right off\n              // the bat.\n              this.onResize();\n\n              if (_this.__closeButton) {\n                _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\n              }\n            }\n          },\n\n          /**\n           * Contains all presets\n           * @type Object\n           */\n          load: {\n            get: function() {\n              return params.load;\n            }\n          },\n\n          /**\n           * Determines whether or not to use <a href=\"https://developer.mozilla.org/en/DOM/Storage#localStorage\">localStorage</a> as the means for\n           * <code>remember</code>ing\n           * @type Boolean\n           */\n          useLocalStorage: {\n\n            get: function() {\n              return use_local_storage;\n            },\n            set: function(bool) {\n              if (SUPPORTS_LOCAL_STORAGE) {\n                use_local_storage = bool;\n                if (bool) {\n                  dom.bind(window, 'unload', saveToLocalStorage);\n                } else {\n                  dom.unbind(window, 'unload', saveToLocalStorage);\n                }\n                localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\n              }\n            }\n\n          }\n\n        });\n\n    // Are we a root level GUI?\n    if (common.isUndefined(params.parent)) {\n\n      params.closed = false;\n\n      dom.addClass(this.domElement, GUI.CLASS_MAIN);\n      dom.makeSelectable(this.domElement, false);\n\n      // Are we supposed to be loading locally?\n      if (SUPPORTS_LOCAL_STORAGE) {\n\n        if (use_local_storage) {\n\n          _this.useLocalStorage = true;\n\n          var saved_gui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\n\n          if (saved_gui) {\n            params.load = JSON.parse(saved_gui);\n          }\n\n        }\n\n      }\n\n      this.__closeButton = document.createElement('div');\n      this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\n      this.domElement.appendChild(this.__closeButton);\n\n      dom.bind(this.__closeButton, 'click', function() {\n\n        _this.closed = !_this.closed;\n\n\n      });\n\n\n      // Oh, you're a nested GUI!\n    } else {\n\n      if (params.closed === undefined) {\n        params.closed = true;\n      }\n\n      var title_row_name = document.createTextNode(params.name);\n      dom.addClass(title_row_name, 'controller-name');\n\n      var title_row = addRow(_this, title_row_name);\n\n      var on_click_title = function(e) {\n        e.preventDefault();\n        _this.closed = !_this.closed;\n        return false;\n      };\n\n      dom.addClass(this.__ul, GUI.CLASS_CLOSED);\n\n      dom.addClass(title_row, 'title');\n      dom.bind(title_row, 'click', on_click_title);\n\n      if (!params.closed) {\n        this.closed = false;\n      }\n\n    }\n\n    if (params.autoPlace) {\n\n      if (common.isUndefined(params.parent)) {\n\n        if (auto_place_virgin) {\n          auto_place_container = document.createElement('div');\n          dom.addClass(auto_place_container, CSS_NAMESPACE);\n          dom.addClass(auto_place_container, GUI.CLASS_AUTO_PLACE_CONTAINER);\n          document.body.appendChild(auto_place_container);\n          auto_place_virgin = false;\n        }\n\n        // Put it in the dom for you.\n        auto_place_container.appendChild(this.domElement);\n\n        // Apply the auto styles\n        dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\n\n      }\n\n\n      // Make it not elastic.\n      if (!this.parent) setWidth(_this, params.width);\n\n    }\n\n    dom.bind(window, 'resize', function() { _this.onResize() });\n    dom.bind(this.__ul, 'webkitTransitionEnd', function() { _this.onResize(); });\n    dom.bind(this.__ul, 'transitionend', function() { _this.onResize() });\n    dom.bind(this.__ul, 'oTransitionEnd', function() { _this.onResize() });\n    this.onResize();\n\n\n    if (params.resizable) {\n      addResizeHandle(this);\n    }\n\n    function saveToLocalStorage() {\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\n    }\n\n    var root = _this.getRoot();\n    function resetWidth() {\n        var root = _this.getRoot();\n        root.width += 1;\n        common.defer(function() {\n          root.width -= 1;\n        });\n      }\n\n      if (!params.parent) {\n        resetWidth();\n      }\n\n  };\n\n  GUI.toggleHide = function() {\n\n    hide = !hide;\n    common.each(hideable_guis, function(gui) {\n      gui.domElement.style.zIndex = hide ? -999 : 999;\n      gui.domElement.style.opacity = hide ? 0 : 1;\n    });\n  };\n\n  GUI.CLASS_AUTO_PLACE = 'a';\n  GUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\n  GUI.CLASS_MAIN = 'main';\n  GUI.CLASS_CONTROLLER_ROW = 'cr';\n  GUI.CLASS_TOO_TALL = 'taller-than-window';\n  GUI.CLASS_CLOSED = 'closed';\n  GUI.CLASS_CLOSE_BUTTON = 'close-button';\n  GUI.CLASS_DRAG = 'drag';\n\n  GUI.DEFAULT_WIDTH = 245;\n  GUI.TEXT_CLOSED = 'Close Controls';\n  GUI.TEXT_OPEN = 'Open Controls';\n\n  dom.bind(window, 'keydown', function(e) {\n\n    if (document.activeElement.type !== 'text' &&\n        (e.which === HIDE_KEY_CODE || e.keyCode == HIDE_KEY_CODE)) {\n      GUI.toggleHide();\n    }\n\n  }, false);\n\n  common.extend(\n\n      GUI.prototype,\n\n      /** @lends dat.gui.GUI */\n      {\n\n        /**\n         * @param object\n         * @param property\n         * @returns {dat.controllers.Controller} The new controller that was added.\n         * @instance\n         */\n        add: function(object, property) {\n\n          return add(\n              this,\n              object,\n              property,\n              {\n                factoryArgs: Array.prototype.slice.call(arguments, 2)\n              }\n          );\n\n        },\n\n        /**\n         * @param object\n         * @param property\n         * @returns {dat.controllers.ColorController} The new controller that was added.\n         * @instance\n         */\n        addColor: function(object, property) {\n\n          return add(\n              this,\n              object,\n              property,\n              {\n                color: true\n              }\n          );\n\n        },\n\n        /**\n         * @param controller\n         * @instance\n         */\n        remove: function(controller) {\n\n          // TODO listening?\n          this.__ul.removeChild(controller.__li);\n          this.__controllers.slice(this.__controllers.indexOf(controller), 1);\n          var _this = this;\n          common.defer(function() {\n            _this.onResize();\n          });\n\n        },\n\n        destroy: function() {\n\n          if (this.autoPlace) {\n            auto_place_container.removeChild(this.domElement);\n          }\n\n        },\n\n        /**\n         * @param name\n         * @returns {dat.gui.GUI} The new folder.\n         * @throws {Error} if this GUI already has a folder by the specified\n         * name\n         * @instance\n         */\n        addFolder: function(name) {\n\n          // We have to prevent collisions on names in order to have a key\n          // by which to remember saved values\n          if (this.__folders[name] !== undefined) {\n            throw new Error('You already have a folder in this GUI by the' +\n                ' name \"' + name + '\"');\n          }\n\n          var new_gui_params = { name: name, parent: this };\n\n          // We need to pass down the autoPlace trait so that we can\n          // attach event listeners to open/close folder actions to\n          // ensure that a scrollbar appears if the window is too short.\n          new_gui_params.autoPlace = this.autoPlace;\n\n          // Do we have saved appearance data for this folder?\n\n          if (this.load && // Anything loaded?\n              this.load.folders && // Was my parent a dead-end?\n              this.load.folders[name]) { // Did daddy remember me?\n\n            // Start me closed if I was closed\n            new_gui_params.closed = this.load.folders[name].closed;\n\n            // Pass down the loaded data\n            new_gui_params.load = this.load.folders[name];\n\n          }\n\n          var gui = new GUI(new_gui_params);\n          this.__folders[name] = gui;\n\n          var li = addRow(this, gui.domElement);\n          dom.addClass(li, 'folder');\n          return gui;\n\n        },\n\n        open: function() {\n          this.closed = false;\n        },\n\n        close: function() {\n          this.closed = true;\n        },\n\n        onResize: function() {\n\n          var root = this.getRoot();\n\n          if (root.scrollable) {\n\n            var top = dom.getOffset(root.__ul).top;\n            var h = 0;\n\n            common.each(root.__ul.childNodes, function(node) {\n              if (! (root.autoPlace && node === root.__save_row))\n                h += dom.getHeight(node);\n            });\n\n            if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\n              dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\n              root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\n            } else {\n              dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\n              root.__ul.style.height = 'auto';\n            }\n\n          }\n\n          if (root.__resize_handle) {\n            common.defer(function() {\n              root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\n            });\n          }\n\n          if (root.__closeButton) {\n            root.__closeButton.style.width = root.width + 'px';\n          }\n\n        },\n\n        /**\n         * Mark objects for saving. The order of these objects cannot change as\n         * the GUI grows. When remembering new objects, append them to the end\n         * of the list.\n         *\n         * @param {Object...} objects\n         * @throws {Error} if not called on a top level GUI.\n         * @instance\n         */\n        remember: function() {\n\n          if (common.isUndefined(SAVE_DIALOGUE)) {\n            SAVE_DIALOGUE = new CenteredDiv();\n            SAVE_DIALOGUE.domElement.innerHTML = saveDialogueContents;\n          }\n\n          if (this.parent) {\n            throw new Error(\"You can only call remember on a top level GUI.\");\n          }\n\n          var _this = this;\n\n          common.each(Array.prototype.slice.call(arguments), function(object) {\n            if (_this.__rememberedObjects.length == 0) {\n              addSaveMenu(_this);\n            }\n            if (_this.__rememberedObjects.indexOf(object) == -1) {\n              _this.__rememberedObjects.push(object);\n            }\n          });\n\n          if (this.autoPlace) {\n            // Set save row width\n            setWidth(this, this.width);\n          }\n\n        },\n\n        /**\n         * @returns {dat.gui.GUI} the topmost parent GUI of a nested GUI.\n         * @instance\n         */\n        getRoot: function() {\n          var gui = this;\n          while (gui.parent) {\n            gui = gui.parent;\n          }\n          return gui;\n        },\n\n        /**\n         * @returns {Object} a JSON object representing the current state of\n         * this GUI as well as its remembered properties.\n         * @instance\n         */\n        getSaveObject: function() {\n\n          var toReturn = this.load;\n\n          toReturn.closed = this.closed;\n\n          // Am I remembering any values?\n          if (this.__rememberedObjects.length > 0) {\n\n            toReturn.preset = this.preset;\n\n            if (!toReturn.remembered) {\n              toReturn.remembered = {};\n            }\n\n            toReturn.remembered[this.preset] = getCurrentPreset(this);\n\n          }\n\n          toReturn.folders = {};\n          common.each(this.__folders, function(element, key) {\n            toReturn.folders[key] = element.getSaveObject();\n          });\n\n          return toReturn;\n\n        },\n\n        save: function() {\n\n          if (!this.load.remembered) {\n            this.load.remembered = {};\n          }\n\n          this.load.remembered[this.preset] = getCurrentPreset(this);\n          markPresetModified(this, false);\n\n        },\n\n        saveAs: function(presetName) {\n\n          if (!this.load.remembered) {\n\n            // Retain default values upon first save\n            this.load.remembered = {};\n            this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\n\n          }\n\n          this.load.remembered[presetName] = getCurrentPreset(this);\n          this.preset = presetName;\n          addPresetOption(this, presetName, true);\n\n        },\n\n        revert: function(gui) {\n\n          common.each(this.__controllers, function(controller) {\n            // Make revert work on Default.\n            if (!this.getRoot().load.remembered) {\n              controller.setValue(controller.initialValue);\n            } else {\n              recallSavedValue(gui || this.getRoot(), controller);\n            }\n          }, this);\n\n          common.each(this.__folders, function(folder) {\n            folder.revert(folder);\n          });\n\n          if (!gui) {\n            markPresetModified(this.getRoot(), false);\n          }\n\n\n        },\n\n        listen: function(controller) {\n\n          var init = this.__listening.length == 0;\n          this.__listening.push(controller);\n          if (init) updateDisplays(this.__listening);\n\n        }\n\n      }\n\n  );\n\n  function add(gui, object, property, params) {\n\n    if (object[property] === undefined) {\n      throw new Error(\"Object \" + object + \" has no property \\\"\" + property + \"\\\"\");\n    }\n\n    var controller;\n\n    if (params.color) {\n\n      controller = new ColorController(object, property);\n\n    } else {\n\n      var factoryArgs = [object,property].concat(params.factoryArgs);\n      controller = controllerFactory.apply(gui, factoryArgs);\n\n    }\n\n    if (params.before instanceof Controller) {\n      params.before = params.before.__li;\n    }\n\n    recallSavedValue(gui, controller);\n\n    dom.addClass(controller.domElement, 'c');\n\n    var name = document.createElement('span');\n    dom.addClass(name, 'property-name');\n    name.innerHTML = controller.property;\n\n    var container = document.createElement('div');\n    container.appendChild(name);\n    container.appendChild(controller.domElement);\n\n    var li = addRow(gui, container, params.before);\n\n    dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\n    dom.addClass(li, typeof controller.getValue());\n\n    augmentController(gui, li, controller);\n\n    gui.__controllers.push(controller);\n\n    return controller;\n\n  }\n\n  /**\n   * Add a row to the end of the GUI or before another row.\n   *\n   * @param gui\n   * @param [dom] If specified, inserts the dom content in the new row\n   * @param [liBefore] If specified, places the new row before another row\n   */\n  function addRow(gui, dom, liBefore) {\n    var li = document.createElement('li');\n    if (dom) li.appendChild(dom);\n    if (liBefore) {\n      gui.__ul.insertBefore(li, params.before);\n    } else {\n      gui.__ul.appendChild(li);\n    }\n    gui.onResize();\n    return li;\n  }\n\n  function augmentController(gui, li, controller) {\n\n    controller.__li = li;\n    controller.__gui = gui;\n\n    common.extend(controller, {\n\n      options: function(options) {\n\n        if (arguments.length > 1) {\n          controller.remove();\n\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [common.toArray(arguments)]\n              }\n          );\n\n        }\n\n        if (common.isArray(options) || common.isObject(options)) {\n          controller.remove();\n\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [options]\n              }\n          );\n\n        }\n\n      },\n\n      name: function(v) {\n        controller.__li.firstElementChild.firstElementChild.innerHTML = v;\n        return controller;\n      },\n\n      listen: function() {\n        controller.__gui.listen(controller);\n        return controller;\n      },\n\n      remove: function() {\n        controller.__gui.remove(controller);\n        return controller;\n      }\n\n    });\n\n    // All sliders should be accompanied by a box.\n    if (controller instanceof NumberControllerSlider) {\n\n      var box = new NumberControllerBox(controller.object, controller.property,\n          { min: controller.__min, max: controller.__max, step: controller.__step });\n\n      common.each(['updateDisplay', 'onChange', 'onFinishChange'], function(method) {\n        var pc = controller[method];\n        var pb = box[method];\n        controller[method] = box[method] = function() {\n          var args = Array.prototype.slice.call(arguments);\n          pc.apply(controller, args);\n          return pb.apply(box, args);\n        }\n      });\n\n      dom.addClass(li, 'has-slider');\n      controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\n\n    }\n    else if (controller instanceof NumberControllerBox) {\n\n      var r = function(returned) {\n\n        // Have we defined both boundaries?\n        if (common.isNumber(controller.__min) && common.isNumber(controller.__max)) {\n\n          // Well, then lets just replace this with a slider.\n          controller.remove();\n          return add(\n              gui,\n              controller.object,\n              controller.property,\n              {\n                before: controller.__li.nextElementSibling,\n                factoryArgs: [controller.__min, controller.__max, controller.__step]\n              });\n\n        }\n\n        return returned;\n\n      };\n\n      controller.min = common.compose(r, controller.min);\n      controller.max = common.compose(r, controller.max);\n\n    }\n    else if (controller instanceof BooleanController) {\n\n      dom.bind(li, 'click', function() {\n        dom.fakeEvent(controller.__checkbox, 'click');\n      });\n\n      dom.bind(controller.__checkbox, 'click', function(e) {\n        e.stopPropagation(); // Prevents double-toggle\n      })\n\n    }\n    else if (controller instanceof FunctionController) {\n\n      dom.bind(li, 'click', function() {\n        dom.fakeEvent(controller.__button, 'click');\n      });\n\n      dom.bind(li, 'mouseover', function() {\n        dom.addClass(controller.__button, 'hover');\n      });\n\n      dom.bind(li, 'mouseout', function() {\n        dom.removeClass(controller.__button, 'hover');\n      });\n\n    }\n    else if (controller instanceof ColorController) {\n\n      dom.addClass(li, 'color');\n      controller.updateDisplay = common.compose(function(r) {\n        li.style.borderLeftColor = controller.__color.toString();\n        return r;\n      }, controller.updateDisplay);\n\n      controller.updateDisplay();\n\n    }\n\n    controller.setValue = common.compose(function(r) {\n      if (gui.getRoot().__preset_select && controller.isModified()) {\n        markPresetModified(gui.getRoot(), true);\n      }\n      return r;\n    }, controller.setValue);\n\n  }\n\n  function recallSavedValue(gui, controller) {\n\n    // Find the topmost GUI, that's where remembered objects live.\n    var root = gui.getRoot();\n\n    // Does the object we're controlling match anything we've been told to\n    // remember?\n    var matched_index = root.__rememberedObjects.indexOf(controller.object);\n\n    // Why yes, it does!\n    if (matched_index != -1) {\n\n      // Let me fetch a map of controllers for thcommon.isObject.\n      var controller_map =\n          root.__rememberedObjectIndecesToControllers[matched_index];\n\n      // Ohp, I believe this is the first controller we've created for this\n      // object. Lets make the map fresh.\n      if (controller_map === undefined) {\n        controller_map = {};\n        root.__rememberedObjectIndecesToControllers[matched_index] =\n            controller_map;\n      }\n\n      // Keep track of this controller\n      controller_map[controller.property] = controller;\n\n      // Okay, now have we saved any values for this controller?\n      if (root.load && root.load.remembered) {\n\n        var preset_map = root.load.remembered;\n\n        // Which preset are we trying to load?\n        var preset;\n\n        if (preset_map[gui.preset]) {\n\n          preset = preset_map[gui.preset];\n\n        } else if (preset_map[DEFAULT_DEFAULT_PRESET_NAME]) {\n\n          // Uhh, you can have the default instead?\n          preset = preset_map[DEFAULT_DEFAULT_PRESET_NAME];\n\n        } else {\n\n          // Nada.\n\n          return;\n\n        }\n\n\n        // Did the loaded object remember thcommon.isObject?\n        if (preset[matched_index] &&\n\n          // Did we remember this particular property?\n            preset[matched_index][controller.property] !== undefined) {\n\n          // We did remember something for this guy ...\n          var value = preset[matched_index][controller.property];\n\n          // And that's what it is.\n          controller.initialValue = value;\n          controller.setValue(value);\n\n        }\n\n      }\n\n    }\n\n  }\n\n  function getLocalStorageHash(gui, key) {\n    // TODO how does this deal with multiple GUI's?\n    return document.location.href + '.' + key;\n\n  }\n\n  function addSaveMenu(gui) {\n\n    var div = gui.__save_row = document.createElement('li');\n\n    dom.addClass(gui.domElement, 'has-save');\n\n    gui.__ul.insertBefore(div, gui.__ul.firstChild);\n\n    dom.addClass(div, 'save-row');\n\n    var gears = document.createElement('span');\n    gears.innerHTML = '&nbsp;';\n    dom.addClass(gears, 'button gears');\n\n    // TODO replace with FunctionController\n    var button = document.createElement('span');\n    button.innerHTML = 'Save';\n    dom.addClass(button, 'button');\n    dom.addClass(button, 'save');\n\n    var button2 = document.createElement('span');\n    button2.innerHTML = 'New';\n    dom.addClass(button2, 'button');\n    dom.addClass(button2, 'save-as');\n\n    var button3 = document.createElement('span');\n    button3.innerHTML = 'Revert';\n    dom.addClass(button3, 'button');\n    dom.addClass(button3, 'revert');\n\n    var select = gui.__preset_select = document.createElement('select');\n\n    if (gui.load && gui.load.remembered) {\n\n      common.each(gui.load.remembered, function(value, key) {\n        addPresetOption(gui, key, key == gui.preset);\n      });\n\n    } else {\n      addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\n    }\n\n    dom.bind(select, 'change', function() {\n\n\n      for (var index = 0; index < gui.__preset_select.length; index++) {\n        gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\n      }\n\n      gui.preset = this.value;\n\n    });\n\n    div.appendChild(select);\n    div.appendChild(gears);\n    div.appendChild(button);\n    div.appendChild(button2);\n    div.appendChild(button3);\n\n    if (SUPPORTS_LOCAL_STORAGE) {\n\n      var saveLocally = document.getElementById('dg-save-locally');\n      var explain = document.getElementById('dg-local-explain');\n\n      saveLocally.style.display = 'block';\n\n      var localStorageCheckBox = document.getElementById('dg-local-storage');\n\n      if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\n        localStorageCheckBox.setAttribute('checked', 'checked');\n      }\n\n      function showHideExplain() {\n        explain.style.display = gui.useLocalStorage ? 'block' : 'none';\n      }\n\n      showHideExplain();\n\n      // TODO: Use a boolean controller, fool!\n      dom.bind(localStorageCheckBox, 'change', function() {\n        gui.useLocalStorage = !gui.useLocalStorage;\n        showHideExplain();\n      });\n\n    }\n\n    var newConstructorTextArea = document.getElementById('dg-new-constructor');\n\n    dom.bind(newConstructorTextArea, 'keydown', function(e) {\n      if (e.metaKey && (e.which === 67 || e.keyCode == 67)) {\n        SAVE_DIALOGUE.hide();\n      }\n    });\n\n    dom.bind(gears, 'click', function() {\n      newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\n      SAVE_DIALOGUE.show();\n      newConstructorTextArea.focus();\n      newConstructorTextArea.select();\n    });\n\n    dom.bind(button, 'click', function() {\n      gui.save();\n    });\n\n    dom.bind(button2, 'click', function() {\n      var presetName = prompt('Enter a new preset name.');\n      if (presetName) gui.saveAs(presetName);\n    });\n\n    dom.bind(button3, 'click', function() {\n      gui.revert();\n    });\n\n//    div.appendChild(button2);\n\n  }\n\n  function addResizeHandle(gui) {\n\n    gui.__resize_handle = document.createElement('div');\n\n    common.extend(gui.__resize_handle.style, {\n\n      width: '6px',\n      marginLeft: '-3px',\n      height: '200px',\n      cursor: 'ew-resize',\n      position: 'absolute'\n//      border: '1px solid blue'\n\n    });\n\n    var pmouseX;\n\n    dom.bind(gui.__resize_handle, 'mousedown', dragStart);\n    dom.bind(gui.__closeButton, 'mousedown', dragStart);\n\n    gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\n\n    function dragStart(e) {\n\n      e.preventDefault();\n\n      pmouseX = e.clientX;\n\n      dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\n      dom.bind(window, 'mousemove', drag);\n      dom.bind(window, 'mouseup', dragStop);\n\n      return false;\n\n    }\n\n    function drag(e) {\n\n      e.preventDefault();\n\n      gui.width += pmouseX - e.clientX;\n      gui.onResize();\n      pmouseX = e.clientX;\n\n      return false;\n\n    }\n\n    function dragStop() {\n\n      dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\n      dom.unbind(window, 'mousemove', drag);\n      dom.unbind(window, 'mouseup', dragStop);\n\n    }\n\n  }\n\n  function setWidth(gui, w) {\n    gui.domElement.style.width = w + 'px';\n    // Auto placed save-rows are position fixed, so we have to\n    // set the width manually if we want it to bleed to the edge\n    if (gui.__save_row && gui.autoPlace) {\n      gui.__save_row.style.width = w + 'px';\n    }if (gui.__closeButton) {\n      gui.__closeButton.style.width = w + 'px';\n    }\n  }\n\n  function getCurrentPreset(gui, useInitialValues) {\n\n    var toReturn = {};\n\n    // For each object I'm remembering\n    common.each(gui.__rememberedObjects, function(val, index) {\n\n      var saved_values = {};\n\n      // The controllers I've made for thcommon.isObject by property\n      var controller_map =\n          gui.__rememberedObjectIndecesToControllers[index];\n\n      // Remember each value for each property\n      common.each(controller_map, function(controller, property) {\n        saved_values[property] = useInitialValues ? controller.initialValue : controller.getValue();\n      });\n\n      // Save the values for thcommon.isObject\n      toReturn[index] = saved_values;\n\n    });\n\n    return toReturn;\n\n  }\n\n  function addPresetOption(gui, name, setSelected) {\n    var opt = document.createElement('option');\n    opt.innerHTML = name;\n    opt.value = name;\n    gui.__preset_select.appendChild(opt);\n    if (setSelected) {\n      gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\n    }\n  }\n\n  function setPresetSelectIndex(gui) {\n    for (var index = 0; index < gui.__preset_select.length; index++) {\n      if (gui.__preset_select[index].value == gui.preset) {\n        gui.__preset_select.selectedIndex = index;\n      }\n    }\n  }\n\n  function markPresetModified(gui, modified) {\n    var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n//    console.log('mark', modified, opt);\n    if (modified) {\n      opt.innerHTML = opt.value + \"*\";\n    } else {\n      opt.innerHTML = opt.value;\n    }\n  }\n\n  function updateDisplays(controllerArray) {\n\n\n    if (controllerArray.length != 0) {\n\n      requestAnimationFrame(function() {\n        updateDisplays(controllerArray);\n      });\n\n    }\n\n    common.each(controllerArray, function(c) {\n      c.updateDisplay();\n    });\n\n  }\n\n  return GUI;\n\n})(dat.utils.css,\n\"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n      \\n    </div>\\n    \\n  </div>\\n\\n</div>\",\n\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\",\ndat.controllers.factory = (function (OptionController, NumberControllerBox, NumberControllerSlider, StringController, FunctionController, BooleanController, common) {\n\n      return function(object, property) {\n\n        var initialValue = object[property];\n\n        // Providing options?\n        if (common.isArray(arguments[2]) || common.isObject(arguments[2])) {\n          return new OptionController(object, property, arguments[2]);\n        }\n\n        // Providing a map?\n\n        if (common.isNumber(initialValue)) {\n\n          if (common.isNumber(arguments[2]) && common.isNumber(arguments[3])) {\n\n            // Has min and max.\n            return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\n\n          } else {\n\n            return new NumberControllerBox(object, property, { min: arguments[2], max: arguments[3] });\n\n          }\n\n        }\n\n        if (common.isString(initialValue)) {\n          return new StringController(object, property);\n        }\n\n        if (common.isFunction(initialValue)) {\n          return new FunctionController(object, property, '');\n        }\n\n        if (common.isBoolean(initialValue)) {\n          return new BooleanController(object, property);\n        }\n\n      }\n\n    })(dat.controllers.OptionController,\ndat.controllers.NumberControllerBox,\ndat.controllers.NumberControllerSlider,\ndat.controllers.StringController = (function (Controller, dom, common) {\n\n  /**\n   * @class Provides a text input to alter the string property of an object.\n   *\n   * @extends dat.controllers.Controller\n   *\n   * @param {Object} object The object to be manipulated\n   * @param {string} property The name of the property to be manipulated\n   *\n   * @member dat.controllers\n   */\n  var StringController = function(object, property) {\n\n    StringController.superclass.call(this, object, property);\n\n    var _this = this;\n\n    this.__input = document.createElement('input');\n    this.__input.setAttribute('type', 'text');\n\n    dom.bind(this.__input, 'keyup', onChange);\n    dom.bind(this.__input, 'change', onChange);\n    dom.bind(this.__input, 'blur', onBlur);\n    dom.bind(this.__input, 'keydown', function(e) {\n      if (e.keyCode === 13) {\n        this.blur();\n      }\n    });\n    \n\n    function onChange() {\n      _this.setValue(_this.__input.value);\n    }\n\n    function onBlur() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    this.updateDisplay();\n\n    this.domElement.appendChild(this.__input);\n\n  };\n\n  StringController.superclass = Controller;\n\n  common.extend(\n\n      StringController.prototype,\n      Controller.prototype,\n\n      {\n\n        updateDisplay: function() {\n          // Stops the caret from moving on account of:\n          // keyup -> setValue -> updateDisplay\n          if (!dom.isActive(this.__input)) {\n            this.__input.value = this.getValue();\n          }\n          return StringController.superclass.prototype.updateDisplay.call(this);\n        }\n\n      }\n\n  );\n\n  return StringController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.utils.common),\ndat.controllers.FunctionController,\ndat.controllers.BooleanController,\ndat.utils.common),\ndat.controllers.Controller,\ndat.controllers.BooleanController,\ndat.controllers.FunctionController,\ndat.controllers.NumberControllerBox,\ndat.controllers.NumberControllerSlider,\ndat.controllers.OptionController,\ndat.controllers.ColorController = (function (Controller, dom, Color, interpret, common) {\n\n  var ColorController = function(object, property) {\n\n    ColorController.superclass.call(this, object, property);\n\n    this.__color = new Color(this.getValue());\n    this.__temp = new Color(0);\n\n    var _this = this;\n\n    this.domElement = document.createElement('div');\n\n    dom.makeSelectable(this.domElement, false);\n\n    this.__selector = document.createElement('div');\n    this.__selector.className = 'selector';\n\n    this.__saturation_field = document.createElement('div');\n    this.__saturation_field.className = 'saturation-field';\n\n    this.__field_knob = document.createElement('div');\n    this.__field_knob.className = 'field-knob';\n    this.__field_knob_border = '2px solid ';\n\n    this.__hue_knob = document.createElement('div');\n    this.__hue_knob.className = 'hue-knob';\n\n    this.__hue_field = document.createElement('div');\n    this.__hue_field.className = 'hue-field';\n\n    this.__input = document.createElement('input');\n    this.__input.type = 'text';\n    this.__input_textShadow = '0 1px 1px ';\n\n    dom.bind(this.__input, 'keydown', function(e) {\n      if (e.keyCode === 13) { // on enter\n        onBlur.call(this);\n      }\n    });\n\n    dom.bind(this.__input, 'blur', onBlur);\n\n    dom.bind(this.__selector, 'mousedown', function(e) {\n\n      dom\n        .addClass(this, 'drag')\n        .bind(window, 'mouseup', function(e) {\n          dom.removeClass(_this.__selector, 'drag');\n        });\n\n    });\n\n    var value_field = document.createElement('div');\n\n    common.extend(this.__selector.style, {\n      width: '122px',\n      height: '102px',\n      padding: '3px',\n      backgroundColor: '#222',\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\n    });\n\n    common.extend(this.__field_knob.style, {\n      position: 'absolute',\n      width: '12px',\n      height: '12px',\n      border: this.__field_knob_border + (this.__color.v < .5 ? '#fff' : '#000'),\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\n      borderRadius: '12px',\n      zIndex: 1\n    });\n    \n    common.extend(this.__hue_knob.style, {\n      position: 'absolute',\n      width: '15px',\n      height: '2px',\n      borderRight: '4px solid #fff',\n      zIndex: 1\n    });\n\n    common.extend(this.__saturation_field.style, {\n      width: '100px',\n      height: '100px',\n      border: '1px solid #555',\n      marginRight: '3px',\n      display: 'inline-block',\n      cursor: 'pointer'\n    });\n\n    common.extend(value_field.style, {\n      width: '100%',\n      height: '100%',\n      background: 'none'\n    });\n    \n    linearGradient(value_field, 'top', 'rgba(0,0,0,0)', '#000');\n\n    common.extend(this.__hue_field.style, {\n      width: '15px',\n      height: '100px',\n      display: 'inline-block',\n      border: '1px solid #555',\n      cursor: 'ns-resize'\n    });\n\n    hueGradient(this.__hue_field);\n\n    common.extend(this.__input.style, {\n      outline: 'none',\n//      width: '120px',\n      textAlign: 'center',\n//      padding: '4px',\n//      marginBottom: '6px',\n      color: '#fff',\n      border: 0,\n      fontWeight: 'bold',\n      textShadow: this.__input_textShadow + 'rgba(0,0,0,0.7)'\n    });\n\n    dom.bind(this.__saturation_field, 'mousedown', fieldDown);\n    dom.bind(this.__field_knob, 'mousedown', fieldDown);\n\n    dom.bind(this.__hue_field, 'mousedown', function(e) {\n      setH(e);\n      dom.bind(window, 'mousemove', setH);\n      dom.bind(window, 'mouseup', unbindH);\n    });\n\n    function fieldDown(e) {\n      setSV(e);\n      // document.body.style.cursor = 'none';\n      dom.bind(window, 'mousemove', setSV);\n      dom.bind(window, 'mouseup', unbindSV);\n    }\n\n    function unbindSV() {\n      dom.unbind(window, 'mousemove', setSV);\n      dom.unbind(window, 'mouseup', unbindSV);\n      // document.body.style.cursor = 'default';\n    }\n\n    function onBlur() {\n      var i = interpret(this.value);\n      if (i !== false) {\n        _this.__color.__state = i;\n        _this.setValue(_this.__color.toOriginal());\n      } else {\n        this.value = _this.__color.toString();\n      }\n    }\n\n    function unbindH() {\n      dom.unbind(window, 'mousemove', setH);\n      dom.unbind(window, 'mouseup', unbindH);\n    }\n\n    this.__saturation_field.appendChild(value_field);\n    this.__selector.appendChild(this.__field_knob);\n    this.__selector.appendChild(this.__saturation_field);\n    this.__selector.appendChild(this.__hue_field);\n    this.__hue_field.appendChild(this.__hue_knob);\n\n    this.domElement.appendChild(this.__input);\n    this.domElement.appendChild(this.__selector);\n\n    this.updateDisplay();\n\n    function setSV(e) {\n\n      e.preventDefault();\n\n      var w = dom.getWidth(_this.__saturation_field);\n      var o = dom.getOffset(_this.__saturation_field);\n      var s = (e.clientX - o.left + document.body.scrollLeft) / w;\n      var v = 1 - (e.clientY - o.top + document.body.scrollTop) / w;\n\n      if (v > 1) v = 1;\n      else if (v < 0) v = 0;\n\n      if (s > 1) s = 1;\n      else if (s < 0) s = 0;\n\n      _this.__color.v = v;\n      _this.__color.s = s;\n\n      _this.setValue(_this.__color.toOriginal());\n\n\n      return false;\n\n    }\n\n    function setH(e) {\n\n      e.preventDefault();\n\n      var s = dom.getHeight(_this.__hue_field);\n      var o = dom.getOffset(_this.__hue_field);\n      var h = 1 - (e.clientY - o.top + document.body.scrollTop) / s;\n\n      if (h > 1) h = 1;\n      else if (h < 0) h = 0;\n\n      _this.__color.h = h * 360;\n\n      _this.setValue(_this.__color.toOriginal());\n\n      return false;\n\n    }\n\n  };\n\n  ColorController.superclass = Controller;\n\n  common.extend(\n\n      ColorController.prototype,\n      Controller.prototype,\n\n      {\n\n        updateDisplay: function() {\n\n          var i = interpret(this.getValue());\n\n          if (i !== false) {\n\n            var mismatch = false;\n\n            // Check for mismatch on the interpreted value.\n\n            common.each(Color.COMPONENTS, function(component) {\n              if (!common.isUndefined(i[component]) &&\n                  !common.isUndefined(this.__color.__state[component]) &&\n                  i[component] !== this.__color.__state[component]) {\n                mismatch = true;\n                return {}; // break\n              }\n            }, this);\n\n            // If nothing diverges, we keep our previous values\n            // for statefulness, otherwise we recalculate fresh\n            if (mismatch) {\n              common.extend(this.__color.__state, i);\n            }\n\n          }\n\n          common.extend(this.__temp.__state, this.__color.__state);\n\n          this.__temp.a = 1;\n\n          var flip = (this.__color.v < .5 || this.__color.s > .5) ? 255 : 0;\n          var _flip = 255 - flip;\n\n          common.extend(this.__field_knob.style, {\n            marginLeft: 100 * this.__color.s - 7 + 'px',\n            marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\n            backgroundColor: this.__temp.toString(),\n            border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip +')'\n          });\n\n          this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px'\n\n          this.__temp.s = 1;\n          this.__temp.v = 1;\n\n          linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toString());\n\n          common.extend(this.__input.style, {\n            backgroundColor: this.__input.value = this.__color.toString(),\n            color: 'rgb(' + flip + ',' + flip + ',' + flip +')',\n            textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip +',.7)'\n          });\n\n        }\n\n      }\n\n  );\n  \n  var vendors = ['-moz-','-o-','-webkit-','-ms-',''];\n  \n  function linearGradient(elem, x, a, b) {\n    elem.style.background = '';\n    common.each(vendors, function(vendor) {\n      elem.style.cssText += 'background: ' + vendor + 'linear-gradient('+x+', '+a+' 0%, ' + b + ' 100%); ';\n    });\n  }\n  \n  function hueGradient(elem) {\n    elem.style.background = '';\n    elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);'\n    elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n    elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);'\n  }\n\n\n  return ColorController;\n\n})(dat.controllers.Controller,\ndat.dom.dom,\ndat.color.Color = (function (interpret, math, toString, common) {\n\n  var Color = function() {\n\n    this.__state = interpret.apply(this, arguments);\n\n    if (this.__state === false) {\n      throw 'Failed to interpret color arguments';\n    }\n\n    this.__state.a = this.__state.a || 1;\n\n\n  };\n\n  Color.COMPONENTS = ['r','g','b','h','s','v','hex','a'];\n\n  common.extend(Color.prototype, {\n\n    toString: function() {\n      return toString(this);\n    },\n\n    toOriginal: function() {\n      return this.__state.conversion.write(this);\n    }\n\n  });\n\n  defineRGBComponent(Color.prototype, 'r', 2);\n  defineRGBComponent(Color.prototype, 'g', 1);\n  defineRGBComponent(Color.prototype, 'b', 0);\n\n  defineHSVComponent(Color.prototype, 'h');\n  defineHSVComponent(Color.prototype, 's');\n  defineHSVComponent(Color.prototype, 'v');\n\n  Object.defineProperty(Color.prototype, 'a', {\n\n    get: function() {\n      return this.__state.a;\n    },\n\n    set: function(v) {\n      this.__state.a = v;\n    }\n\n  });\n\n  Object.defineProperty(Color.prototype, 'hex', {\n\n    get: function() {\n\n      if (!this.__state.space !== 'HEX') {\n        this.__state.hex = math.rgb_to_hex(this.r, this.g, this.b);\n      }\n\n      return this.__state.hex;\n\n    },\n\n    set: function(v) {\n\n      this.__state.space = 'HEX';\n      this.__state.hex = v;\n\n    }\n\n  });\n\n  function defineRGBComponent(target, component, componentHexIndex) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'RGB') {\n          return this.__state[component];\n        }\n\n        recalculateRGB(this, component, componentHexIndex);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'RGB') {\n          recalculateRGB(this, component, componentHexIndex);\n          this.__state.space = 'RGB';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function defineHSVComponent(target, component) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'HSV')\n          return this.__state[component];\n\n        recalculateHSV(this);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'HSV') {\n          recalculateHSV(this);\n          this.__state.space = 'HSV';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function recalculateRGB(color, component, componentHexIndex) {\n\n    if (color.__state.space === 'HEX') {\n\n      color.__state[component] = math.component_from_hex(color.__state.hex, componentHexIndex);\n\n    } else if (color.__state.space === 'HSV') {\n\n      common.extend(color.__state, math.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n\n    } else {\n\n      throw 'Corrupted color state';\n\n    }\n\n  }\n\n  function recalculateHSV(color) {\n\n    var result = math.rgb_to_hsv(color.r, color.g, color.b);\n\n    common.extend(color.__state,\n        {\n          s: result.s,\n          v: result.v\n        }\n    );\n\n    if (!common.isNaN(result.h)) {\n      color.__state.h = result.h;\n    } else if (common.isUndefined(color.__state.h)) {\n      color.__state.h = 0;\n    }\n\n  }\n\n  return Color;\n\n})(dat.color.interpret,\ndat.color.math = (function () {\n\n  var tmpComponent;\n\n  return {\n\n    hsv_to_rgb: function(h, s, v) {\n\n      var hi = Math.floor(h / 60) % 6;\n\n      var f = h / 60 - Math.floor(h / 60);\n      var p = v * (1.0 - s);\n      var q = v * (1.0 - (f * s));\n      var t = v * (1.0 - ((1.0 - f) * s));\n      var c = [\n        [v, t, p],\n        [q, v, p],\n        [p, v, t],\n        [p, q, v],\n        [t, p, v],\n        [v, p, q]\n      ][hi];\n\n      return {\n        r: c[0] * 255,\n        g: c[1] * 255,\n        b: c[2] * 255\n      };\n\n    },\n\n    rgb_to_hsv: function(r, g, b) {\n\n      var min = Math.min(r, g, b),\n          max = Math.max(r, g, b),\n          delta = max - min,\n          h, s;\n\n      if (max != 0) {\n        s = delta / max;\n      } else {\n        return {\n          h: NaN,\n          s: 0,\n          v: 0\n        };\n      }\n\n      if (r == max) {\n        h = (g - b) / delta;\n      } else if (g == max) {\n        h = 2 + (b - r) / delta;\n      } else {\n        h = 4 + (r - g) / delta;\n      }\n      h /= 6;\n      if (h < 0) {\n        h += 1;\n      }\n\n      return {\n        h: h * 360,\n        s: s,\n        v: max / 255\n      };\n    },\n\n    rgb_to_hex: function(r, g, b) {\n      var hex = this.hex_with_component(0, 2, r);\n      hex = this.hex_with_component(hex, 1, g);\n      hex = this.hex_with_component(hex, 0, b);\n      return hex;\n    },\n\n    component_from_hex: function(hex, componentIndex) {\n      return (hex >> (componentIndex * 8)) & 0xFF;\n    },\n\n    hex_with_component: function(hex, componentIndex, value) {\n      return value << (tmpComponent = componentIndex * 8) | (hex & ~ (0xFF << tmpComponent));\n    }\n\n  }\n\n})(),\ndat.color.toString,\ndat.utils.common),\ndat.color.interpret,\ndat.utils.common),\ndat.utils.requestAnimationFrame = (function () {\n\n  /**\n   * requirejs version of Paul Irish's RequestAnimationFrame\n   * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n   */\n\n  return window.webkitRequestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.oRequestAnimationFrame ||\n      window.msRequestAnimationFrame ||\n      function(callback, element) {\n\n        window.setTimeout(callback, 1000 / 60);\n\n      };\n})(),\ndat.dom.CenteredDiv = (function (dom, common) {\n\n\n  var CenteredDiv = function() {\n\n    this.backgroundElement = document.createElement('div');\n    common.extend(this.backgroundElement.style, {\n      backgroundColor: 'rgba(0,0,0,0.8)',\n      top: 0,\n      left: 0,\n      display: 'none',\n      zIndex: '1000',\n      opacity: 0,\n      WebkitTransition: 'opacity 0.2s linear'\n    });\n\n    dom.makeFullscreen(this.backgroundElement);\n    this.backgroundElement.style.position = 'fixed';\n\n    this.domElement = document.createElement('div');\n    common.extend(this.domElement.style, {\n      position: 'fixed',\n      display: 'none',\n      zIndex: '1001',\n      opacity: 0,\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear'\n    });\n\n\n    document.body.appendChild(this.backgroundElement);\n    document.body.appendChild(this.domElement);\n\n    var _this = this;\n    dom.bind(this.backgroundElement, 'click', function() {\n      _this.hide();\n    });\n\n\n  };\n\n  CenteredDiv.prototype.show = function() {\n\n    var _this = this;\n    \n\n\n    this.backgroundElement.style.display = 'block';\n\n    this.domElement.style.display = 'block';\n    this.domElement.style.opacity = 0;\n//    this.domElement.style.top = '52%';\n    this.domElement.style.webkitTransform = 'scale(1.1)';\n\n    this.layout();\n\n    common.defer(function() {\n      _this.backgroundElement.style.opacity = 1;\n      _this.domElement.style.opacity = 1;\n      _this.domElement.style.webkitTransform = 'scale(1)';\n    });\n\n  };\n\n  CenteredDiv.prototype.hide = function() {\n\n    var _this = this;\n\n    var hide = function() {\n\n      _this.domElement.style.display = 'none';\n      _this.backgroundElement.style.display = 'none';\n\n      dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\n      dom.unbind(_this.domElement, 'transitionend', hide);\n      dom.unbind(_this.domElement, 'oTransitionEnd', hide);\n\n    };\n\n    dom.bind(this.domElement, 'webkitTransitionEnd', hide);\n    dom.bind(this.domElement, 'transitionend', hide);\n    dom.bind(this.domElement, 'oTransitionEnd', hide);\n\n    this.backgroundElement.style.opacity = 0;\n//    this.domElement.style.top = '48%';\n    this.domElement.style.opacity = 0;\n    this.domElement.style.webkitTransform = 'scale(1.1)';\n\n  };\n\n  CenteredDiv.prototype.layout = function() {\n    this.domElement.style.left = window.innerWidth/2 - dom.getWidth(this.domElement) / 2 + 'px';\n    this.domElement.style.top = window.innerHeight/2 - dom.getHeight(this.domElement) / 2 + 'px';\n  };\n  \n  function lockScroll(e) {\n    console.log(e);\n  }\n\n  return CenteredDiv;\n\n})(dat.dom.dom,\ndat.utils.common),\ndat.dom.dom,\ndat.utils.common);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dat-gui/vendor/dat.gui.js\n// module id = 138\n// module chunks = 7","/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n/** @namespace */\nvar dat = module.exports = dat || {};\n\n/** @namespace */\ndat.color = dat.color || {};\n\n/** @namespace */\ndat.utils = dat.utils || {};\n\ndat.utils.common = (function () {\n  \n  var ARR_EACH = Array.prototype.forEach;\n  var ARR_SLICE = Array.prototype.slice;\n\n  /**\n   * Band-aid methods for things that should be a lot easier in JavaScript.\n   * Implementation and structure inspired by underscore.js\n   * http://documentcloud.github.com/underscore/\n   */\n\n  return { \n    \n    BREAK: {},\n  \n    extend: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (!this.isUndefined(obj[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n      \n    },\n    \n    defaults: function(target) {\n      \n      this.each(ARR_SLICE.call(arguments, 1), function(obj) {\n        \n        for (var key in obj)\n          if (this.isUndefined(target[key])) \n            target[key] = obj[key];\n        \n      }, this);\n      \n      return target;\n    \n    },\n    \n    compose: function() {\n      var toCall = ARR_SLICE.call(arguments);\n            return function() {\n              var args = ARR_SLICE.call(arguments);\n              for (var i = toCall.length -1; i >= 0; i--) {\n                args = [toCall[i].apply(this, args)];\n              }\n              return args[0];\n            }\n    },\n    \n    each: function(obj, itr, scope) {\n\n      \n      if (ARR_EACH && obj.forEach === ARR_EACH) { \n        \n        obj.forEach(itr, scope);\n        \n      } else if (obj.length === obj.length + 0) { // Is number but not NaN\n        \n        for (var key = 0, l = obj.length; key < l; key++)\n          if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) \n            return;\n            \n      } else {\n\n        for (var key in obj) \n          if (itr.call(scope, obj[key], key) === this.BREAK)\n            return;\n            \n      }\n            \n    },\n    \n    defer: function(fnc) {\n      setTimeout(fnc, 0);\n    },\n    \n    toArray: function(obj) {\n      if (obj.toArray) return obj.toArray();\n      return ARR_SLICE.call(obj);\n    },\n\n    isUndefined: function(obj) {\n      return obj === undefined;\n    },\n    \n    isNull: function(obj) {\n      return obj === null;\n    },\n    \n    isNaN: function(obj) {\n      return obj !== obj;\n    },\n    \n    isArray: Array.isArray || function(obj) {\n      return obj.constructor === Array;\n    },\n    \n    isObject: function(obj) {\n      return obj === Object(obj);\n    },\n    \n    isNumber: function(obj) {\n      return obj === obj+0;\n    },\n    \n    isString: function(obj) {\n      return obj === obj+'';\n    },\n    \n    isBoolean: function(obj) {\n      return obj === false || obj === true;\n    },\n    \n    isFunction: function(obj) {\n      return Object.prototype.toString.call(obj) === '[object Function]';\n    }\n  \n  };\n    \n})();\n\n\ndat.color.toString = (function (common) {\n\n  return function(color) {\n\n    if (color.a == 1 || common.isUndefined(color.a)) {\n\n      var s = color.hex.toString(16);\n      while (s.length < 6) {\n        s = '0' + s;\n      }\n\n      return '#' + s;\n\n    } else {\n\n      return 'rgba(' + Math.round(color.r) + ',' + Math.round(color.g) + ',' + Math.round(color.b) + ',' + color.a + ')';\n\n    }\n\n  }\n\n})(dat.utils.common);\n\n\ndat.Color = dat.color.Color = (function (interpret, math, toString, common) {\n\n  var Color = function() {\n\n    this.__state = interpret.apply(this, arguments);\n\n    if (this.__state === false) {\n      throw 'Failed to interpret color arguments';\n    }\n\n    this.__state.a = this.__state.a || 1;\n\n\n  };\n\n  Color.COMPONENTS = ['r','g','b','h','s','v','hex','a'];\n\n  common.extend(Color.prototype, {\n\n    toString: function() {\n      return toString(this);\n    },\n\n    toOriginal: function() {\n      return this.__state.conversion.write(this);\n    }\n\n  });\n\n  defineRGBComponent(Color.prototype, 'r', 2);\n  defineRGBComponent(Color.prototype, 'g', 1);\n  defineRGBComponent(Color.prototype, 'b', 0);\n\n  defineHSVComponent(Color.prototype, 'h');\n  defineHSVComponent(Color.prototype, 's');\n  defineHSVComponent(Color.prototype, 'v');\n\n  Object.defineProperty(Color.prototype, 'a', {\n\n    get: function() {\n      return this.__state.a;\n    },\n\n    set: function(v) {\n      this.__state.a = v;\n    }\n\n  });\n\n  Object.defineProperty(Color.prototype, 'hex', {\n\n    get: function() {\n\n      if (!this.__state.space !== 'HEX') {\n        this.__state.hex = math.rgb_to_hex(this.r, this.g, this.b);\n      }\n\n      return this.__state.hex;\n\n    },\n\n    set: function(v) {\n\n      this.__state.space = 'HEX';\n      this.__state.hex = v;\n\n    }\n\n  });\n\n  function defineRGBComponent(target, component, componentHexIndex) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'RGB') {\n          return this.__state[component];\n        }\n\n        recalculateRGB(this, component, componentHexIndex);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'RGB') {\n          recalculateRGB(this, component, componentHexIndex);\n          this.__state.space = 'RGB';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function defineHSVComponent(target, component) {\n\n    Object.defineProperty(target, component, {\n\n      get: function() {\n\n        if (this.__state.space === 'HSV')\n          return this.__state[component];\n\n        recalculateHSV(this);\n\n        return this.__state[component];\n\n      },\n\n      set: function(v) {\n\n        if (this.__state.space !== 'HSV') {\n          recalculateHSV(this);\n          this.__state.space = 'HSV';\n        }\n\n        this.__state[component] = v;\n\n      }\n\n    });\n\n  }\n\n  function recalculateRGB(color, component, componentHexIndex) {\n\n    if (color.__state.space === 'HEX') {\n\n      color.__state[component] = math.component_from_hex(color.__state.hex, componentHexIndex);\n\n    } else if (color.__state.space === 'HSV') {\n\n      common.extend(color.__state, math.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n\n    } else {\n\n      throw 'Corrupted color state';\n\n    }\n\n  }\n\n  function recalculateHSV(color) {\n\n    var result = math.rgb_to_hsv(color.r, color.g, color.b);\n\n    common.extend(color.__state,\n        {\n          s: result.s,\n          v: result.v\n        }\n    );\n\n    if (!common.isNaN(result.h)) {\n      color.__state.h = result.h;\n    } else if (common.isUndefined(color.__state.h)) {\n      color.__state.h = 0;\n    }\n\n  }\n\n  return Color;\n\n})(dat.color.interpret = (function (toString, common) {\n\n  var result, toReturn;\n\n  var interpret = function() {\n\n    toReturn = false;\n\n    var original = arguments.length > 1 ? common.toArray(arguments) : arguments[0];\n\n    common.each(INTERPRETATIONS, function(family) {\n\n      if (family.litmus(original)) {\n\n        common.each(family.conversions, function(conversion, conversionName) {\n\n          result = conversion.read(original);\n\n          if (toReturn === false && result !== false) {\n            toReturn = result;\n            result.conversionName = conversionName;\n            result.conversion = conversion;\n            return common.BREAK;\n\n          }\n\n        });\n\n        return common.BREAK;\n\n      }\n\n    });\n\n    return toReturn;\n\n  };\n\n  var INTERPRETATIONS = [\n\n    // Strings\n    {\n\n      litmus: common.isString,\n\n      conversions: {\n\n        THREE_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt(\n                  '0x' +\n                      test[1].toString() + test[1].toString() +\n                      test[2].toString() + test[2].toString() +\n                      test[3].toString() + test[3].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        SIX_CHAR_HEX: {\n\n          read: function(original) {\n\n            var test = original.match(/^#([A-F0-9]{6})$/i);\n            if (test === null) return false;\n\n            return {\n              space: 'HEX',\n              hex: parseInt('0x' + test[1].toString())\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGB: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3])\n            };\n\n          },\n\n          write: toString\n\n        },\n\n        CSS_RGBA: {\n\n          read: function(original) {\n\n            var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\,\\s*(.+)\\s*\\)/);\n            if (test === null) return false;\n\n            return {\n              space: 'RGB',\n              r: parseFloat(test[1]),\n              g: parseFloat(test[2]),\n              b: parseFloat(test[3]),\n              a: parseFloat(test[4])\n            };\n\n          },\n\n          write: toString\n\n        }\n\n      }\n\n    },\n\n    // Numbers\n    {\n\n      litmus: common.isNumber,\n\n      conversions: {\n\n        HEX: {\n          read: function(original) {\n            return {\n              space: 'HEX',\n              hex: original,\n              conversionName: 'HEX'\n            }\n          },\n\n          write: function(color) {\n            return color.hex;\n          }\n        }\n\n      }\n\n    },\n\n    // Arrays\n    {\n\n      litmus: common.isArray,\n\n      conversions: {\n\n        RGB_ARRAY: {\n          read: function(original) {\n            if (original.length != 3) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b];\n          }\n\n        },\n\n        RGBA_ARRAY: {\n          read: function(original) {\n            if (original.length != 4) return false;\n            return {\n              space: 'RGB',\n              r: original[0],\n              g: original[1],\n              b: original[2],\n              a: original[3]\n            };\n          },\n\n          write: function(color) {\n            return [color.r, color.g, color.b, color.a];\n          }\n\n        }\n\n      }\n\n    },\n\n    // Objects\n    {\n\n      litmus: common.isObject,\n\n      conversions: {\n\n        RGBA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b,\n              a: color.a\n            }\n          }\n        },\n\n        RGB_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.r) &&\n                common.isNumber(original.g) &&\n                common.isNumber(original.b)) {\n              return {\n                space: 'RGB',\n                r: original.r,\n                g: original.g,\n                b: original.b\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              r: color.r,\n              g: color.g,\n              b: color.b\n            }\n          }\n        },\n\n        HSVA_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v) &&\n                common.isNumber(original.a)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v,\n                a: original.a\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v,\n              a: color.a\n            }\n          }\n        },\n\n        HSV_OBJ: {\n          read: function(original) {\n            if (common.isNumber(original.h) &&\n                common.isNumber(original.s) &&\n                common.isNumber(original.v)) {\n              return {\n                space: 'HSV',\n                h: original.h,\n                s: original.s,\n                v: original.v\n              }\n            }\n            return false;\n          },\n\n          write: function(color) {\n            return {\n              h: color.h,\n              s: color.s,\n              v: color.v\n            }\n          }\n\n        }\n\n      }\n\n    }\n\n\n  ];\n\n  return interpret;\n\n\n})(dat.color.toString,\ndat.utils.common),\ndat.color.math = (function () {\n\n  var tmpComponent;\n\n  return {\n\n    hsv_to_rgb: function(h, s, v) {\n\n      var hi = Math.floor(h / 60) % 6;\n\n      var f = h / 60 - Math.floor(h / 60);\n      var p = v * (1.0 - s);\n      var q = v * (1.0 - (f * s));\n      var t = v * (1.0 - ((1.0 - f) * s));\n      var c = [\n        [v, t, p],\n        [q, v, p],\n        [p, v, t],\n        [p, q, v],\n        [t, p, v],\n        [v, p, q]\n      ][hi];\n\n      return {\n        r: c[0] * 255,\n        g: c[1] * 255,\n        b: c[2] * 255\n      };\n\n    },\n\n    rgb_to_hsv: function(r, g, b) {\n\n      var min = Math.min(r, g, b),\n          max = Math.max(r, g, b),\n          delta = max - min,\n          h, s;\n\n      if (max != 0) {\n        s = delta / max;\n      } else {\n        return {\n          h: NaN,\n          s: 0,\n          v: 0\n        };\n      }\n\n      if (r == max) {\n        h = (g - b) / delta;\n      } else if (g == max) {\n        h = 2 + (b - r) / delta;\n      } else {\n        h = 4 + (r - g) / delta;\n      }\n      h /= 6;\n      if (h < 0) {\n        h += 1;\n      }\n\n      return {\n        h: h * 360,\n        s: s,\n        v: max / 255\n      };\n    },\n\n    rgb_to_hex: function(r, g, b) {\n      var hex = this.hex_with_component(0, 2, r);\n      hex = this.hex_with_component(hex, 1, g);\n      hex = this.hex_with_component(hex, 0, b);\n      return hex;\n    },\n\n    component_from_hex: function(hex, componentIndex) {\n      return (hex >> (componentIndex * 8)) & 0xFF;\n    },\n\n    hex_with_component: function(hex, componentIndex, value) {\n      return value << (tmpComponent = componentIndex * 8) | (hex & ~ (0xFF << tmpComponent));\n    }\n\n  }\n\n})(),\ndat.color.toString,\ndat.utils.common);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/dat-gui/vendor/dat.color.js\n// module id = 139\n// module chunks = 7","// stats.js - http://github.com/mrdoob/stats.js\nvar Stats=function(){var l=Date.now(),m=l,g=0,n=Infinity,o=0,h=0,p=Infinity,q=0,r=0,s=0,f=document.createElement(\"div\");f.id=\"stats\";f.addEventListener(\"mousedown\",function(b){b.preventDefault();t(++s%2)},!1);f.style.cssText=\"width:80px;opacity:0.9;cursor:pointer\";var a=document.createElement(\"div\");a.id=\"fps\";a.style.cssText=\"padding:0 0 3px 3px;text-align:left;background-color:#002\";f.appendChild(a);var i=document.createElement(\"div\");i.id=\"fpsText\";i.style.cssText=\"color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px\";\ni.innerHTML=\"FPS\";a.appendChild(i);var c=document.createElement(\"div\");c.id=\"fpsGraph\";c.style.cssText=\"position:relative;width:74px;height:30px;background-color:#0ff\";for(a.appendChild(c);74>c.children.length;){var j=document.createElement(\"span\");j.style.cssText=\"width:1px;height:30px;float:left;background-color:#113\";c.appendChild(j)}var d=document.createElement(\"div\");d.id=\"ms\";d.style.cssText=\"padding:0 0 3px 3px;text-align:left;background-color:#020;display:none\";f.appendChild(d);var k=document.createElement(\"div\");\nk.id=\"msText\";k.style.cssText=\"color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px\";k.innerHTML=\"MS\";d.appendChild(k);var e=document.createElement(\"div\");e.id=\"msGraph\";e.style.cssText=\"position:relative;width:74px;height:30px;background-color:#0f0\";for(d.appendChild(e);74>e.children.length;)j=document.createElement(\"span\"),j.style.cssText=\"width:1px;height:30px;float:left;background-color:#131\",e.appendChild(j);var t=function(b){s=b;switch(s){case 0:a.style.display=\n\"block\";d.style.display=\"none\";break;case 1:a.style.display=\"none\",d.style.display=\"block\"}};return{REVISION:12,domElement:f,setMode:t,begin:function(){l=Date.now()},end:function(){var b=Date.now();g=b-l;n=Math.min(n,g);o=Math.max(o,g);k.textContent=g+\" MS (\"+n+\"-\"+o+\")\";var a=Math.min(30,30-30*(g/200));e.appendChild(e.firstChild).style.height=a+\"px\";r++;b>m+1E3&&(h=Math.round(1E3*r/(b-m)),p=Math.min(p,h),q=Math.max(q,h),i.textContent=h+\" FPS (\"+p+\"-\"+q+\")\",a=Math.min(30,30-30*(h/100)),c.appendChild(c.firstChild).style.height=\na+\"px\",m=b,r=0);return b},update:function(){l=this.end()}}};\"object\"===typeof module&&(module.exports=Stats);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/stats-js/build/stats.min.js\n// module id = 140\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nexport class Expiration extends Core.Component {\r\n  static defaults() {\r\n    return { ttl: 0, age: 0 };\r\n  }\r\n}\r\nCore.registerComponent('Expiration', Expiration);\r\n\r\nexport class ExpirationSystem extends Core.System {\r\n  matchComponent() {\r\n    return 'Expiration';\r\n  }\r\n  updateComponent(timeDelta, entityId, expiration) {\r\n    expiration.age += timeDelta;\r\n    if (expiration.age >= expiration.ttl) {\r\n      this.world.destroy(entityId);\r\n    }\r\n  }\r\n}\r\nCore.registerSystem('Expiration', ExpirationSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/expiration.js","require('../../modules/es6.object.keys');\nmodule.exports = require('../../modules/_core').Object.keys;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/keys.js\n// module id = 142\n// module chunks = 7","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.keys.js\n// module id = 143\n// module chunks = 7","/**\n * @author mrdoob / http://mrdoob.com/\n * @author jetienne / http://jetienne.com/\n * @author paulirish / http://paulirish.com/\n */\nfunction MemoryStats(){\n\n\tvar msMin\t= 100;\n\tvar msMax\t= 0;\n\n\tvar container\t= document.createElement( 'div' );\n\tcontainer.id\t= 'stats';\n\tcontainer.style.cssText = 'width:80px;opacity:0.9;cursor:pointer';\n\n\tvar msDiv\t= document.createElement( 'div' );\n\tmsDiv.id\t= 'ms';\n\tmsDiv.style.cssText = 'padding:0 0 3px 3px;text-align:left;background-color:#020;';\n\tcontainer.appendChild( msDiv );\n\n\tvar msText\t= document.createElement( 'div' );\n\tmsText.id\t= 'msText';\n\tmsText.style.cssText = 'color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px';\n\tmsText.innerHTML= 'Memory';\n\tmsDiv.appendChild( msText );\n\n\tvar msGraph\t= document.createElement( 'div' );\n\tmsGraph.id\t= 'msGraph';\n\tmsGraph.style.cssText = 'position:relative;width:74px;height:30px;background-color:#0f0';\n\tmsDiv.appendChild( msGraph );\n\n\twhile ( msGraph.children.length < 74 ) {\n\n\t\tvar bar = document.createElement( 'span' );\n\t\tbar.style.cssText = 'width:1px;height:30px;float:left;background-color:#131';\n\t\tmsGraph.appendChild( bar );\n\n\t}\n\n\tvar updateGraph = function ( dom, height, color ) {\n\n\t\tvar child = dom.appendChild( dom.firstChild );\n\t\tchild.style.height = height + 'px';\n\t\tif( color ) child.style.backgroundColor = color;\n\n\t}\n\n\t// polyfill usedJSHeapSize\n\tif (window.performance && !performance.memory){\n\t\tperformance.memory = { usedJSHeapSize : 0 };\n\t}\n\n\t// support of the API?\n\tif( performance.memory.totalJSHeapSize === 0 ){\n\t\tconsole.warn('totalJSHeapSize === 0... performance.memory is only available in Chrome .')\n\t}\n\n\t// TODO, add a sanity check to see if values are bucketed.\n\t// If so, reminde user to adopt the --enable-precise-memory-info flag.\n\t// open -a \"/Applications/Google Chrome.app\" --args --enable-precise-memory-info\n\n\tvar lastTime\t= Date.now();\n\tvar lastUsedHeap= performance.memory.usedJSHeapSize;\n\treturn {\n\t\tdomElement: container,\n\n\t\tupdate: function () {\n\n\t\t\t// refresh only 30time per second\n\t\t\tif( Date.now() - lastTime < 1000/30 )\treturn;\n\t\t\tlastTime\t= Date.now()\n\n\t\t\tvar delta\t= performance.memory.usedJSHeapSize - lastUsedHeap;\n\t\t\tlastUsedHeap\t= performance.memory.usedJSHeapSize;\n\t\t\tvar color\t= delta < 0 ? '#830' : '#131';\n\n\t\t\tvar ms\t= performance.memory.usedJSHeapSize;\n\t\t\tmsMin\t= Math.min( msMin, ms );\n\t\t\tmsMax\t= Math.max( msMax, ms );\n\t\t\tmsText.textContent = \"Mem: \" + bytesToSize(ms, 2);\n\n\t\t\tvar normValue\t= ms / (30*1024*1024);\n\t\t\tvar height\t= (1-(normValue% 1)) * 30;\n\t\t\tupdateGraph( msGraph, height, color);\n\n\t\t\tfunction bytesToSize( bytes, nFractDigit ){\n\t\t\t\tvar sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n\t\t\t\tif (bytes == 0) return 'n/a';\n\t\t\t\tnFractDigit\t= nFractDigit !== undefined ? nFractDigit : 0;\n\t\t\t\tvar precision\t= Math.pow(10, nFractDigit);\n\t\t\t\tvar i \t\t= Math.floor(Math.log(bytes) / Math.log(1024));\n\t\t\t\treturn Math.round(bytes*precision / Math.pow(1024, i))/precision + ' ' + sizes[i];\n\t\t\t};\n\t\t}\n\n\t}\n\n};\n\nmodule.exports = MemoryStats;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/memory-stats/memory-stats.js\n// module id = 144\n// module chunks = 7","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/get-iterator.js\n// module id = 145\n// module chunks = 7","var anObject = require('./_an-object');\nvar get = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function (it) {\n  var iterFn = get(it);\n  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/core.get-iterator.js\n// module id = 146\n// module chunks = 7","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.map');\nrequire('../modules/es7.map.to-json');\nrequire('../modules/es7.map.of');\nrequire('../modules/es7.map.from');\nmodule.exports = require('../modules/_core').Map;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/map.js\n// module id = 147\n// module chunks = 7","'use strict';\nvar strong = require('./_collection-strong');\nvar validate = require('./_validate-collection');\nvar MAP = 'Map';\n\n// 23.1 Map Objects\nmodule.exports = require('./_collection')(MAP, function (get) {\n  return function Map() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.1.3.6 Map.prototype.get(key)\n  get: function get(key) {\n    var entry = strong.getEntry(validate(this, MAP), key);\n    return entry && entry.v;\n  },\n  // 23.1.3.9 Map.prototype.set(key, value)\n  set: function set(key, value) {\n    return strong.def(validate(this, MAP), key === 0 ? 0 : key, value);\n  }\n}, strong, true);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.map.js\n// module id = 148\n// module chunks = 7","'use strict';\nvar global = require('./_global');\nvar core = require('./_core');\nvar dP = require('./_object-dp');\nvar DESCRIPTORS = require('./_descriptors');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (KEY) {\n  var C = typeof core[KEY] == 'function' ? core[KEY] : global[KEY];\n  if (DESCRIPTORS && C && !C[SPECIES]) dP.f(C, SPECIES, {\n    configurable: true,\n    get: function () { return this; }\n  });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_set-species.js\n// module id = 149\n// module chunks = 7","// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx = require('./_ctx');\nvar IObject = require('./_iobject');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar asc = require('./_array-species-create');\nmodule.exports = function (TYPE, $create) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = $create || asc;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IObject(O);\n    var f = ctx(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var val, res;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      val = self[index];\n      res = f(val, index, O);\n      if (TYPE) {\n        if (IS_MAP) result[index] = res;   // map\n        else if (res) switch (TYPE) {\n          case 3: return true;             // some\n          case 5: return val;              // find\n          case 6: return index;            // findIndex\n          case 2: result.push(val);        // filter\n        } else if (IS_EVERY) return false; // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_array-methods.js\n// module id = 150\n// module chunks = 7","// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = require('./_array-species-constructor');\n\nmodule.exports = function (original, length) {\n  return new (speciesConstructor(original))(length);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_array-species-create.js\n// module id = 151\n// module chunks = 7","var isObject = require('./_is-object');\nvar isArray = require('./_is-array');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (original) {\n  var C;\n  if (isArray(original)) {\n    C = original.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_array-species-constructor.js\n// module id = 152\n// module chunks = 7","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar $export = require('./_export');\n\n$export($export.P + $export.R, 'Map', { toJSON: require('./_collection-to-json')('Map') });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.map.to-json.js\n// module id = 153\n// module chunks = 7","var forOf = require('./_for-of');\n\nmodule.exports = function (iter, ITERATOR) {\n  var result = [];\n  forOf(iter, false, result.push, result, ITERATOR);\n  return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_array-from-iterable.js\n// module id = 154\n// module chunks = 7","// https://tc39.github.io/proposal-setmap-offrom/#sec-map.of\nrequire('./_set-collection-of')('Map');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.map.of.js\n// module id = 155\n// module chunks = 7","// https://tc39.github.io/proposal-setmap-offrom/#sec-map.from\nrequire('./_set-collection-from')('Map');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.map.from.js\n// module id = 156\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/set\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/set.js\n// module id = 157\n// module chunks = 7","require('../modules/es6.object.to-string');\nrequire('../modules/es6.string.iterator');\nrequire('../modules/web.dom.iterable');\nrequire('../modules/es6.set');\nrequire('../modules/es7.set.to-json');\nrequire('../modules/es7.set.of');\nrequire('../modules/es7.set.from');\nmodule.exports = require('../modules/_core').Set;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/set.js\n// module id = 158\n// module chunks = 7","'use strict';\nvar strong = require('./_collection-strong');\nvar validate = require('./_validate-collection');\nvar SET = 'Set';\n\n// 23.2 Set Objects\nmodule.exports = require('./_collection')(SET, function (get) {\n  return function Set() { return get(this, arguments.length > 0 ? arguments[0] : undefined); };\n}, {\n  // 23.2.3.1 Set.prototype.add(value)\n  add: function add(value) {\n    return strong.def(validate(this, SET), value = value === 0 ? 0 : value, value);\n  }\n}, strong);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.set.js\n// module id = 159\n// module chunks = 7","// https://github.com/DavidBruant/Map-Set.prototype.toJSON\nvar $export = require('./_export');\n\n$export($export.P + $export.R, 'Set', { toJSON: require('./_collection-to-json')('Set') });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.set.to-json.js\n// module id = 160\n// module chunks = 7","// https://tc39.github.io/proposal-setmap-offrom/#sec-set.of\nrequire('./_set-collection-of')('Set');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.set.of.js\n// module id = 161\n// module chunks = 7","// https://tc39.github.io/proposal-setmap-offrom/#sec-set.from\nrequire('./_set-collection-from')('Set');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.set.from.js\n// module id = 162\n// module chunks = 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _isIterable2 = require(\"../core-js/is-iterable\");\n\nvar _isIterable3 = _interopRequireDefault(_isIterable2);\n\nvar _getIterator2 = require(\"../core-js/get-iterator\");\n\nvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = (0, _getIterator3.default)(arr), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if ((0, _isIterable3.default)(Object(arr))) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/slicedToArray.js\n// module id = 163\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/is-iterable\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/is-iterable.js\n// module id = 164\n// module chunks = 7","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.is-iterable');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/is-iterable.js\n// module id = 165\n// module chunks = 7","var classof = require('./_classof');\nvar ITERATOR = require('./_wks')('iterator');\nvar Iterators = require('./_iterators');\nmodule.exports = require('./_core').isIterable = function (it) {\n  var O = Object(it);\n  return O[ITERATOR] !== undefined\n    || '@@iterator' in O\n    // eslint-disable-next-line no-prototype-builtins\n    || Iterators.hasOwnProperty(classof(O));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/core.is-iterable.js\n// module id = 166\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/entries\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/entries.js\n// module id = 167\n// module chunks = 7","require('../../modules/es7.object.entries');\nmodule.exports = require('../../modules/_core').Object.entries;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/entries.js\n// module id = 168\n// module chunks = 7","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $entries = require('./_object-to-array')(true);\n\n$export($export.S, 'Object', {\n  entries: function entries(it) {\n    return $entries(it);\n  }\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.object.entries.js\n// module id = 169\n// module chunks = 7","import * as Core from '../lib/core';\r\n\r\nimport '../plugins/position';\r\nimport '../plugins/motion';\r\n\r\nimport Vector2D from '../lib/Vector2D';\r\n\r\nconst PI2 = Math.PI * 2;\r\n\r\nexport class Steering extends Core.Component {\r\n  static defaults() {\r\n    return {\r\n      sensorRange: 350,\r\n      obstacleRepel: [400, 2.1]\r\n    };\r\n  }\r\n}\r\n\r\nCore.registerComponent('Steering', Steering);\r\n\r\nexport class SteeringSystem extends Core.System {\r\n\r\n  matchComponent() { return 'Steering'; }\r\n\r\n  initialize() {\r\n\r\n    this.seekFactor = 1;\r\n\r\n    this.pushFactor = 7;\r\n\r\n    this.avoidFactor = 10;\r\n\r\n    this.avoidSeeAhead = 500;\r\n    this.avoidRayWidthFactor = 1.5;\r\n\r\n    this.vTarget = new Vector2D();\r\n\r\n    this.vectors = {\r\n      avoid: new Vector2D(),\r\n      push: new Vector2D(),\r\n      seek: new Vector2D(),\r\n      flee: new Vector2D(),\r\n      wander: new Vector2D(),\r\n      evade: new Vector2D(),\r\n      pursue: new Vector2D()\r\n    };\r\n\r\n  }\r\n\r\n  updateComponent(timeDelta, entityId, steering) {\r\n\r\n    this.vTarget.setValues(0, 0);\r\n\r\n    for (const key in this.vectors) {\r\n      this.vectors[key].setValues(0, 0);\r\n      this[key](this.vectors[key], timeDelta, entityId, steering);\r\n      this.vTarget.add(this.vectors[key]);\r\n    }\r\n\r\n    this.applySteering(timeDelta, entityId, steering);\r\n\r\n  }\r\n\r\n  avoid(vector, timeDelta, entityId, steering) {\r\n\r\n    if (this.debug) { steering.vectors = []; }\r\n\r\n    const sprite = this.world.get('Sprite', entityId);\r\n    const position = this.world.get('Position', entityId);\r\n\r\n    const result = this.lookForObstacle(entityId, position, sprite, steering);\r\n    if (!result) { return; }\r\n\r\n    const range = steering.sensorRange;\r\n    this.world.getSystem('Collision').quadtree.iterate({\r\n      x: position.x - (range / 2),\r\n      y: position.y - (range / 2),\r\n      width: range,\r\n      height: range\r\n    }, (item) => {\r\n\r\n      if (entityId === item.entityId) { return; }\r\n\r\n      const targetPosition = this.world.get('Position', item.entityId);\r\n      if (!targetPosition) { return; }\r\n\r\n      const targetSprite = this.world.get('Sprite', item.entityId);\r\n\r\n      const A = 0;\r\n      const B = steering.obstacleRepel[0];\r\n      const n = 0;\r\n      const m = steering.obstacleRepel[1];\r\n\r\n      const dx = position.x - targetPosition.x;\r\n      const dy = position.y - targetPosition.y;\r\n      const edgeRange = sprite.size / 2 + targetSprite.size / 2;\r\n      let distance = Math.sqrt(dx*dx + dy*dy) - edgeRange;\r\n      if (distance <= 0) { distance = 0.01; }\r\n\r\n      if (distance > steering.sensorRange) { return; }\r\n\r\n      const U = (-A / Math.pow(distance, n)) +\r\n              ( B / Math.pow(distance, m));\r\n\r\n      vector.x += dx * U;\r\n      vector.y += dy * U;\r\n\r\n      if (this.debug) {\r\n        steering.vectors.push([targetPosition.x, targetPosition.y, U]);\r\n      }\r\n\r\n    });\r\n\r\n  }\r\n\r\n  push(/*vector, timeDelta, entityId, steering*/) {\r\n\r\n  }\r\n\r\n  avoid_ray(vector, timeDelta, entityId, steering) {\r\n\r\n    const sprite = this.world.get('Sprite', entityId);\r\n    const position = this.world.get('Position', entityId);\r\n\r\n    // Scan ahead for an obstacle, bail if none found.\r\n    const result = this.lookForObstacle(entityId, position, sprite, steering);\r\n    if (!result) { return; }\r\n\r\n    const obstacle = result[0];\r\n    const rayX = result[1];\r\n    const rayY = result[2];\r\n\r\n    // Opposite right triangle leg is distance from obstacle to avoid collision.\r\n    const oppositeLen = obstacle.sprite.size / 2 +\r\n      sprite.size * this.avoidRayWidthFactor;\r\n\r\n    // Hypotenuse length is distance from obstacle.\r\n    const hypotenuseLen = Math.sqrt(\r\n      Math.pow(obstacle.position.x - rayX, 2) +\r\n      Math.pow(obstacle.position.y - rayY, 2)\r\n    );\r\n\r\n    // Adjacent length would be avoid tangent, but no need to calculate.\r\n\r\n    // Find angle from direct collision to avoidance\r\n    let theta = Math.asin(oppositeLen / hypotenuseLen);\r\n\r\n    // HACK: Too close, panic and steer hard away\r\n    if (isNaN(theta)) { theta = Math.PI * 0.66; }\r\n\r\n    // Find the absolute angle to the obstacle from entity.\r\n    const obstacleAngle = Math.atan2(\r\n      obstacle.position.y - rayY,\r\n      obstacle.position.x - rayX\r\n    );\r\n\r\n    // Calculate nearest target angle for avoidance...\r\n    // Try turning clockwise from obstacle.\r\n    let avoidAngle = (obstacleAngle + theta);\r\n    // Calculate the 'travel' needed from current rotation.\r\n    const travel = Math.min(PI2 - Math.abs(position.rotation - avoidAngle),\r\n                          Math.abs(position.rotation - avoidAngle));\r\n    if (travel > theta) {\r\n      // Clockwise travel exceeds theta, so counterclockwise is shorter.\r\n      avoidAngle = obstacleAngle - theta;\r\n    }\r\n\r\n    // Set up the avoidance vector.\r\n    vector.setValues(this.avoidFactor, 0);\r\n    vector.rotate(avoidAngle);\r\n\r\n  }\r\n\r\n  lookForObstacle(entityId, position, sprite, steering) {\r\n    const rayWidth = sprite.size * this.avoidRayWidthFactor;\r\n\r\n    const vRayUnit = new Vector2D();\r\n    vRayUnit.setValues(rayWidth, 0);\r\n    vRayUnit.rotate(position.rotation);\r\n\r\n    if (this.debug) { steering.hitCircles = []; }\r\n\r\n    let obstacle, rayX, rayY;\r\n    const steps = this.avoidSeeAhead / rayWidth;\r\n    for (let step = 0; step < steps; step++) {\r\n      rayX = position.x + vRayUnit.x * step;\r\n      rayY = position.y + vRayUnit.y * step;\r\n      obstacle = this.searchCircleForObstacle(\r\n        steering, entityId,\r\n        rayX, rayY, rayWidth\r\n      );\r\n      if (obstacle) {\r\n        return [obstacle, rayX, rayY];\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  searchCircleForObstacle(steering, entityId, x, y, size) {\r\n\r\n    if (this.debug) {\r\n      steering.hitCircles.push([x, y, size]);\r\n    }\r\n\r\n    const hits = [];\r\n\r\n    this.world.getSystem('Collision').quadtree.iterate({\r\n      x: x - (size / 2),\r\n      y: y - (size / 2),\r\n      width: size,\r\n      height: size\r\n    }, (item) => {\r\n\r\n      if (entityId === item.entityId) { return; }\r\n      const dx = item.position.x - x;\r\n      const dy = item.position.y - y;\r\n      const range = dx*dx + dy*dy;\r\n      const radii = (size + item.sprite.size) / 2;\r\n      if (range < radii*radii) {\r\n        hits.push([range, item]);\r\n      }\r\n\r\n    });\r\n\r\n    hits.sort(function (a, b) { return b[0] - a[0]; });\r\n    return hits.length ? hits[0][1] : null;\r\n  }\r\n\r\n  seek(vector, timeDelta, entityId, steering) {\r\n\r\n    // Look up the entity ID to seek, if only name given.\r\n    if (steering.seekTargetName && !steering.seekTargetEntityId) {\r\n      steering.seekTargetEntityId = Core.getComponent('Name')\r\n        .findEntityByName(this.world, steering.seekTargetName);\r\n    }\r\n\r\n    if (!steering.seekTargetEntityId) { return; }\r\n\r\n    const position = this.world.get('Position', entityId);\r\n    if (!position) { return; }\r\n\r\n    // Accept either a raw x/y coord or entity ID as target\r\n    let targetPosition = steering.targetPosition;\r\n    if (!targetPosition) {\r\n      targetPosition = this.world.get('Position', steering.seekTargetEntityId);\r\n    }\r\n    if (!targetPosition) { return; }\r\n\r\n    vector.setValues(targetPosition.x - position.x, targetPosition.y - position.y);\r\n    vector.normalize();\r\n    vector.multiplyScalar(this.seekFactor);\r\n\r\n  }\r\n\r\n  flee(/*vector, timeDelta, entityId, steering*/) {\r\n  }\r\n\r\n  wander(/*vector, timeDelta, entityId, steering*/) {\r\n  }\r\n\r\n  evade(/*vector, timeDelta, entityId, steering*/) {\r\n  }\r\n\r\n  pursue(/*vector, timeDelta, entityId, steering*/) {\r\n  }\r\n\r\n  applySteering(timeDelta, entityId, steering) {\r\n\r\n    const motion = this.world.get('Motion', entityId);\r\n\r\n    let targetDr = 0;\r\n\r\n    if (!this.vTarget.isZero()) {\r\n      const position = this.world.get('Position', entityId);\r\n\r\n      // Get the target angle, ensuring a 0..2*Math.PI range.\r\n      let targetAngle = this.vTarget.angle();\r\n      if (targetAngle < 0) { targetAngle += (2 * Math.PI); }\r\n\r\n      if (this.debug) { steering.targetAngle = targetAngle; }\r\n\r\n      // Pick the direction from current to target angle\r\n      let direction = (targetAngle < position.rotation) ? -1 : 1;\r\n\r\n      // If the offset between the angles is more than half a circle, it's\r\n      // shorter to go the other way.\r\n      const offset = Math.abs(targetAngle - position.rotation);\r\n      if (offset > Math.PI) { direction = 0 - direction; }\r\n\r\n      // Work out the desired delta-rotation to steer toward target\r\n      targetDr = direction * Math.min(steering.radPerSec, offset / timeDelta);\r\n    }\r\n\r\n    // Calculate the delta-rotation impulse required to meet the goal,\r\n    // but constrain to the capability of the steering thrusters\r\n    let impulseDr = (targetDr - motion.drotation);\r\n    if (Math.abs(impulseDr) > steering.radPerSec) {\r\n      if (impulseDr > 0) {\r\n        impulseDr = steering.radPerSec;\r\n      } else if (impulseDr < 0) {\r\n        impulseDr = 0 - steering.radPerSec;\r\n      }\r\n    }\r\n\r\n    motion.drotation += impulseDr;\r\n\r\n  }\r\n\r\n  draw(/*timeDelta*/) {\r\n    if (!this.debug) { return; }\r\n\r\n    /*\r\n    const vpSystem = this.world.getSystem('CanvasViewport');\r\n    const ctx = vpSystem.ctx;\r\n    ctx.save();\r\n\r\n    vpSystem.centerAndZoom(timeDelta);\r\n    vpSystem.followEntity(timeDelta);\r\n\r\n    const matches = this.getMatchingComponents();\r\n    for (const entityId in matches) {\r\n      ctx.save();\r\n\r\n      const steering = matches[entityId];\r\n      const position = this.world.get('Position', entityId);\r\n      const sprite = this.world.get('Sprite', entityId);\r\n\r\n      this.drawSteeringVsPosition(ctx, steering, position);\r\n\r\n      if (steering.hitCircles) {\r\n        for (const [x, y, size] of steering.hitCircles) {\r\n          ctx.strokeStyle = '#d00';\r\n          ctx.beginPath();\r\n          ctx.arc(x, y, size, 0, PI2, false);\r\n          ctx.stroke();\r\n        }\r\n      }\r\n\r\n      if (steering.sensorRange) {\r\n          ctx.strokeStyle = 'rgba(0, 64, 64, 0.75)';\r\n          ctx.beginPath();\r\n          ctx.arc(position.x, position.y, steering.sensorRange, 0, PI2, false);\r\n          ctx.stroke();\r\n      }\r\n\r\n      if (steering.vectors) {\r\n        for (const [x, y, U] of steering.vectors) {\r\n          ctx.strokeStyle = 'rgba(0, 64, 64, 0.75)';\r\n          ctx.beginPath();\r\n          ctx.moveTo(position.x, position.y);\r\n          ctx.lineWidth = Math.max(1, Math.min(U, sprite.width));\r\n          ctx.lineTo(x, y);\r\n          ctx.stroke();\r\n        }\r\n      }\r\n\r\n      if (steering.pushing) {\r\n        this.drawAngle(ctx, position, position.rotation, '#d0d');\r\n      }\r\n\r\n      ctx.restore();\r\n    }\r\n\r\n    ctx.restore();\r\n    */\r\n  }\r\n\r\n  drawSteeringVsPosition(ctx, steering, position) {\r\n    this.drawAngle(ctx, position, position.rotation, '#ddd');\r\n    if (steering.targetAngle) {\r\n      this.drawAngle(ctx, position, steering.targetAngle, '#dd0');\r\n    }\r\n  }\r\n\r\n  drawAngle(ctx, position, angle, color) {\r\n    const vec = new Vector2D();\r\n    vec.setValues(this.avoidSeeAhead, 0);\r\n    vec.rotate(angle);\r\n    ctx.strokeStyle = color;\r\n    ctx.beginPath();\r\n    ctx.moveTo(position.x, position.y);\r\n    ctx.lineTo(position.x + vec.x, position.y + vec.y);\r\n    ctx.stroke();\r\n  }\r\n\r\n}\r\n\r\nCore.registerSystem('Steering', SteeringSystem);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/steering.js","/* global PIXI */\nimport * as Core from '../lib/core';\nimport { lerp } from '../lib/utils';\n\n// import filters from 'pixi-filters';\n// import extraFilters from 'pixi-extra-filters';\n\nconst PI2 = Math.PI * 2;\n\nlet idx, p, entityId, position, sprite;\n\n// See also: http://phrogz.net/JS/wheeldelta.html\nconst wheelDistance = function(evt){\n  if (!evt) evt = event;\n  const w=evt.wheelDelta, d=evt.detail;\n  if (d){\n    if (w) return w/d/40*d>0?1:-1; // Opera\n    else return -d/3;              // Firefox;         TODO: do not /3 for OS X\n  } else return w/120;             // IE/Safari/Chrome TODO: /3 for Chrome OS X\n};\n\nexport class ViewportPixi extends Core.System {\n\n  defaultOptions() {\n    return {\n      lineWidth: 5,\n      zoom: 1.0,\n      zoomMin: 0.1,\n      zoomMax: 10.0,\n      zoomWheelFactor: 0.05,\n      gridEnabled: true,\n      gridSize: 250,\n      gridColor: 0x222222,\n      followEnabled: true,\n      followName: null,\n      followEntityId: null\n    };\n  }\n\n  initialize() {\n    this.container = document.querySelector(this.options.container);\n    this.renderer = PIXI.autoDetectRenderer(\n      this.container.offsetWidth,\n      this.container.offsetHeight,\n      { antialias: true }\n    );\n    this.renderer.autoResize = true;\n    this.canvas = this.renderer.view;\n    this.container.appendChild(this.canvas);\n    this.stage = new PIXI.Container();\n\n    this.stage.filters = [\n      // new PIXI.filters.VoidFilter(),\n      // new PIXI.filters.BlurFilter(1, 1, 5)\n    ];\n\n    this.healthBarGraphics = new PIXI.Graphics();\n    this.stage.addChild(this.healthBarGraphics);\n\n    this.backdrop = new PIXI.Graphics();\n    this.stage.addChild(this.backdrop);\n\n    this.graphics = {};\n\n    const events = {\n      'resize': (ev) => { this.updateMetrics(ev); },\n      'orientationchange': (ev) => { this.updateMetrics(ev); },\n      'mousedown': (ev) => { this.onMouseDown(ev); },\n      'mousemove': (ev) => { this.onMouseMove(ev); },\n      'mouseup': (ev) => { this.onMouseUp(ev); }\n    };\n\n    for (const name in events) {\n      this.canvas.addEventListener(name, events[name], false);\n    }\n\n    // See also: http://phrogz.net/JS/wheeldelta.html\n    const boundOnMouseWheel = (ev) => this.onMouseWheel(ev);\n    if (window.addEventListener){\n      window.addEventListener('mousewheel', boundOnMouseWheel, false); // Chrome/Safari/Opera\n      window.addEventListener('DOMMouseScroll', boundOnMouseWheel, false); // Firefox\n    } else if (window.attachEvent){\n      window.attachEvent('onmousewheel', boundOnMouseWheel); // IE\n    }\n\n    this.followEnabled = this.options.followEnabled;\n    this.zoom = this.options.zoom;\n    this.followEntityId = this.options.followEntityId;\n    this.gridEnabled = this.options.gridEnabled;\n    this.lineWidth = this.options.lineWidth;\n\n    this.cursorRawX = 0;\n    this.cursorRawY = 0;\n\n    this.cursorChanged = false;\n    this.cursorPosition = { x: 0, y: 0 };\n\n    this.cameraX = 0;\n    this.cameraY = 0;\n\n    this.debugDummySprite = { size: 100 };\n\n    this.updateMetrics();\n  }\n\n  onMouseWheel(ev) {\n    this.zoom += wheelDistance(ev) * this.options.zoomWheelFactor;\n    if (this.zoom < this.options.zoomMin) {\n      this.zoom = this.options.zoomMin;\n    }\n    if (this.zoom > this.options.zoomMax) {\n      this.zoom = this.options.zoomMax;\n    }\n  }\n\n  // TODO: Use a symbol for 'mouse{Down,Move,Up}' message?\n\n  onMouseDown(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseDown', this.cursorPosition);\n  }\n\n  onMouseMove(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseMove', this.cursorPosition);\n  }\n\n  onMouseUp(ev) {\n    this.setCursor(ev.clientX, ev.clientY);\n    this.world.publish('mouseUp', this.cursorPosition);\n  }\n\n  setCursor(x, y) {\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n\n    this.cursorRawX = x;\n    this.cursorRawY = y;\n\n    const newX = ((x - (width / 2)) / this.zoom) + this.cameraX;\n    const newY = ((y - (height / 2)) / this.zoom) + this.cameraY;\n\n    this.cursorChanged = false;\n    if (newX !== this.cursorPosition.x || newY !== this.cursorPosition.y) {\n      this.cursorChanged = true;\n      this.cursorPosition.x = newX;\n      this.cursorPosition.y = newY;\n    }\n\n    return this.cursorPosition;\n  }\n\n  updateMetrics() {\n    const width = this.container.offsetWidth;\n    const height = this.container.offsetHeight;\n\n    this.visibleWidth = width / this.zoom;\n    this.visibleHeight = height / this.zoom;\n\n    this.visibleLeft = (0 - this.visibleWidth / 2) + this.cameraX;\n    this.visibleTop = (0 - this.visibleHeight / 2) + this.cameraY;\n    this.visibleRight = this.visibleLeft + this.visibleWidth;\n    this.visibleBottom = this.visibleTop + this.visibleHeight;\n  }\n\n  update(/*timeDelta*/) {\n    this.updateMetrics();\n\n    this.setCursor(this.cursorRawX, this.cursorRawY);\n    // FIXME: Should be able to skip doing this unless\n    // this.cursorChanged === true, but for some reason that's not working\n    this.world.publish('mouseMove', this.cursorPosition);\n\n    const sprites = this.world.get('Sprite') || {};\n\n    for (entityId in sprites) {\n      position = this.world.get('Position', entityId);\n      sprite = sprites[entityId];\n      sprite.visible = (\n        (position.right > this.visibleLeft) &&\n        (position.left < this.visibleRight) &&\n        (position.bottom > this.visibleTop) &&\n        (position.top < this.visibleBottom)\n      );\n    }\n\n    const toRemove = Object.keys(this.graphics).filter(key => !(key in sprites));\n    toRemove.forEach(entityId => {\n      this.stage.removeChild(this.graphics[entityId]);\n      delete this.graphics[entityId];\n    });\n\n    const toAdd = Object.keys(sprites).filter(key => !(key in this.graphics));\n    toAdd.forEach(entityId => {\n      this.stage.addChild(this.graphics[entityId] = new PIXI.Graphics());\n    });\n  }\n\n  draw(timeDelta) {\n    this.followEntity();\n    this.drawBackdrop(timeDelta);\n\n    for (const entityId in this.graphics) {\n      this.drawSprite(this.graphics[entityId], entityId, timeDelta);\n    }\n\n    this.stage.setTransform(\n      (this.container.offsetWidth / 2) - (this.cameraX * this.zoom),\n      (this.container.offsetHeight / 2) - (this.cameraY * this.zoom),\n      this.zoom,\n      this.zoom\n    );\n\n    this.renderer.resize(\n      this.container.offsetWidth,\n      this.container.offsetHeight\n    );\n\n    this.renderer.render(this.stage);\n  }\n\n  drawSprite(ctx, entityId, timeDelta) {\n    const sprite = this.world.get('Sprite', entityId);\n    if (!sprite) { return; }\n\n    const position = this.world.get('Position', entityId);\n\n    let spriteFn = getSprite(sprite.name);\n    if (!spriteFn) { spriteFn = getSprite('default'); }\n\n    ctx.position.x = Math.floor(position.x);\n    ctx.position.y = Math.floor(position.y);\n    ctx.rotation = position.rotation + (Math.PI / 2);\n    ctx.scale.x = ctx.scale.y = sprite.size / 100;\n    ctx.lineStyle(this.lineWidth / (sprite.size / 100), sprite.color);\n    spriteFn(ctx, sprite, entityId, timeDelta, this.world);\n\n      /*\n    const health = this.world.get('Health', entityId);\n    if (health) {\n      const perc = (health.current / health.max);\n      ctx.lineStyle(1.0, 0x333333);\n      ctx.moveTo(-50, -57);\n      ctx.drawRect(-50, -57, 100, 5);\n      ctx.moveTo(-50, -57);\n      ctx.beginFill(0x00ff00, 1.0);\n      ctx.drawRect(-50, -57, 100 * perc, 5);\n      ctx.endFill();\n    }\n    */\n\n    sprite.drawn = true;\n    return ctx;\n  }\n\n  followEntity() {\n    if (!this.followEnabled) {\n      this.cameraX = this.cameraY = 0;\n      return;\n    }\n    if (this.options.followName && !this.followEntityId) {\n      // Look up named entity, if necessary.\n      this.followEntityId = Core.getComponent('Name')\n        .findEntityByName(this.world, this.options.followName);\n    }\n    if (this.followEntityId) {\n      // Adjust the viewport center offset to the entity position\n      const position = this.world.get('Position', this.followEntityId);\n      if (position) {\n        this.cameraX = position.x;\n        this.cameraY = position.y;\n        this.setCursor(this.cursorRawX, this.cursorRawY);\n      }\n    }\n  }\n\n  drawBackdrop(/* timeDelta */) {\n    const ctx = this.backdrop;\n\n    if (!this.gridEnabled) {\n      ctx.visible = false;\n      return;\n    }\n\n    const gridSize = this.options.gridSize;\n    const gridOffsetX = this.visibleLeft % gridSize;\n    const gridOffsetY = this.visibleTop % gridSize;\n\n    ctx.visible = true;\n    ctx.clear();\n    ctx.lineStyle(5, this.options.gridColor);\n    ctx.position.x = this.visibleLeft;\n    ctx.position.y = this.visibleTop;\n\n    for (let x = -gridOffsetX; x < this.visibleWidth; x += gridSize) {\n      ctx.moveTo(x, 0);\n      ctx.lineTo(x, this.visibleHeight + gridSize);\n    }\n\n    for (let y = -gridOffsetY; y < this.visibleHeight; y += gridSize) {\n      ctx.moveTo(0, y);\n      ctx.lineTo(this.visibleWidth + gridSize, y);\n    }\n  }\n\n}\n\nCore.registerSystem('ViewportPixi', ViewportPixi);\n\nexport class CanvasSprite extends Core.Component {\n  static defaults() {\n    return {\n      name: null,\n      color: 0xffffff,\n      size: 100,\n      width: null,\n      height: null,\n      drawn: false,\n      visible: false\n    };\n  }\n  static create(attrs) {\n    const c = super.create(attrs);\n    if (!c.width) { c.width = c.size; }\n    if (!c.height) { c.height = c.size; }\n    return c;\n  }\n}\n\nCore.registerComponent('Sprite', CanvasSprite);\n\nconst spriteRegistry = {};\nexport function registerSprite(name, sprite) {\n  spriteRegistry[name] = sprite;\n}\nexport function getSprite(name) {\n  return spriteRegistry[name];\n}\n\nconst defaultShape = [ -50, 0, 50, 0, 0, 0, 0, -50, 0, 50, 0, 0 ];\nfor (let idx = 0; idx < 8; idx++) {\n  const rot = idx * (PI2 / 8);\n  defaultShape.push(50 * Math.cos(rot));\n  defaultShape.push(50 * Math.sin(rot));\n}\ndefaultShape.push(50);\ndefaultShape.push(0);\n\nregisterSprite('default', (g, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n  g.drawPolygon(defaultShape);\n});\n\nregisterSprite('sun', (ctx, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n\n  ctx.arc(0, 0, 50, 0, PI2, true);\n});\n\nregisterSprite('enemyscout', (ctx, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n\n  ctx.moveTo(0, -50);\n  ctx.lineTo(-45, 50);\n  ctx.lineTo(-12.5, 12.5);\n  ctx.lineTo(0, 25);\n  ctx.lineTo(12.5, 12.5);\n  ctx.lineTo(45, 50);\n  ctx.lineTo(0, -50);\n  ctx.moveTo(0, -50);\n});\n\nregisterSprite('enemywing', (g, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n\n  g.lineColor = 0x228822;\n\n  g.moveTo(-50, 0);\n  g.lineTo(-37.5, -37.5);\n  g.lineTo(0, 50);\n  g.lineTo(37.5, -37.5);\n  g.lineTo(50, 0);\n  g.lineTo(37.5, 50);\n  g.lineTo(25, 50);\n  g.lineTo(0, 0);\n  g.lineTo(-25, 50);\n  g.lineTo(-37.5, 50);\n  g.lineTo(-50, 0);\n});\n\nconst repulsorShape = [\n -50,  0,\n -37.5, -50,\n -25, -50,\n -6.25, 25,\n 6.25, 25,\n 25, -50,\n 37.5, -50,\n 50,  0,\n 37.5, 50,\n 25, 50,\n 6.25, -25,\n -6.25, -25,\n -25, 50,\n -37.5, 50,\n -50, 0\n];\nconst repulsorSides = 8;\nconst repulsorPoints = [];\nfor (let idx = 0; idx < repulsorSides; idx++) {\n  const rot = idx * (PI2 / repulsorSides);\n  repulsorPoints.push(Math.cos(rot));\n  repulsorPoints.push(Math.sin(rot));\n}\nrepulsorPoints.push(repulsorPoints[0]);\nrepulsorPoints.push(repulsorPoints[1]);\n\nregisterSprite('repulsor', (g, sprite, entityId, timeDelta, world) => {\n  if (!sprite.drawn) {\n    const t = 0; // Math.floor(Math.random() * 15) * 100;\n    sprite.rings = [\n      { t: t,       startR: 0, endR: 500, startO: 1.0, endO: 0.0, endT: 1500 },\n      { t: t + 250, startR: 0, endR: 500, startO: 1.0, endO: 0.0, endT: 1500 },\n      { t: t + 500, startR: 0, endR: 500, startO: 1.0, endO: 0.0, endT: 1500 }\n    ];\n  }\n\n  const repulsor = world.get('Repulsor', entityId);\n  if (repulsor) {\n    sprite.rings.forEach(ring => ring.endR = repulsor.range);\n  }\n\n  g.clear();\n  g.lineStyle(5 / (sprite.size / 100), 0x228822);\n  g.drawPolygon(repulsorShape);\n\n  const dt = Math.floor(timeDelta * 1000);\n  sprite.rings.forEach(ring => {\n    ring.t += dt;\n    if (ring.t >= ring.endT) { ring.t = 0; }\n\n    if (!sprite.visible) { return; }\n\n    const r = lerp(ring.startR, ring.endR, ring.t / ring.endT);\n    const a = lerp(ring.startO, ring.endO, ring.t / ring.endT);\n\n    g.lineStyle(5 / (sprite.size / 100), 0x228822, a);\n    g.moveTo(-r, 0);\n    g.drawPolygon(repulsorPoints.map(p => r * p));\n  });\n});\n\nconst heroShape = [\n  -50, 0,\n  -37.5, -37.5,\n  0, -50,\n  37.5, -37.5,\n  50, 0,\n  37.5, 50,\n  25, 50,\n  12.5, 12.5,\n  5, 25,\n  -5, 25,\n  -12.5, 12.5,\n  -25, 50,\n  -37.5, 50,\n  -50, 0\n];\n\nregisterSprite('hero', (g, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n  g.drawPolygon(heroShape);\n});\n\nregisterSprite('asteroid', (g, sprite/*, entityId*/) => {\n  if (sprite.drawn) { return; }\n\n  const NUM_POINTS = 10 + Math.floor(8 * Math.random());\n  const MAX_RADIUS = 50;\n  const MIN_RADIUS = 35;\n  const ROTATION = PI2 / NUM_POINTS;\n\n  let idx;\n  const points = [];\n\n  for (idx = 0; idx < NUM_POINTS; idx++) {\n    const rot = idx * ROTATION;\n    const dist = (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\n    points.push(dist * Math.cos(rot));\n    points.push(dist * Math.sin(rot));\n  }\n  points.push(points[0]);\n  points.push(points[1]);\n\n  g.drawPolygon(points);\n});\n\nregisterSprite('mine', (g, sprite/*, entityId, timeDelta, world*/) => {\n  if (!sprite.drawn) {\n    let NUM_POINTS = 10 + Math.floor(10 * Math.random());\n    if (NUM_POINTS % 2 !== 0) { NUM_POINTS++; }\n    const ROTATION = PI2 / NUM_POINTS;\n    const MAX_RADIUS = 60;\n    const MIN_RADIUS = 10;\n\n    let even = false;\n\n    sprite.legs = [];\n    for (let idx = 0; idx < NUM_POINTS; idx++) {\n      const dist = even ? 10 : (Math.random() * (MAX_RADIUS - MIN_RADIUS)) + MIN_RADIUS;\n      const rot = idx * ROTATION;\n      sprite.legs.push(dist * Math.cos(rot));\n      sprite.legs.push(dist * Math.sin(rot));\n      even = !even;\n    }\n    sprite.legs.push(sprite.legs[0]);\n    sprite.legs.push(sprite.legs[1]);\n  }\n\n  if (sprite.drawn && Math.random() > 0.15) { return; }\n\n  g.clear();\n  g.lineStyle(5 / (sprite.size / 100), 0xFF2222);\n  g.drawPolygon(sprite.legs.map(p => p * (0.9 + 0.5 * Math.random())));\n});\n\nregisterSprite('explosion', (g, sprite, entityId, timeDelta) => {\n\n  if (!sprite.drawn) {\n    Object.assign(sprite, {\n      ttl: 2.0,\n      radius: 100,\n      maxParticles: 25,\n      maxParticleSize: 4,\n      maxVelocity: 300,\n      age: 0,\n      alpha: 0,\n      stop: false,\n      particles: []\n    }, sprite);\n    for (idx = 0; idx < sprite.maxParticles; idx++) {\n      sprite.particles.push({ free: true });\n    }\n  }\n\n  for (idx = 0; idx < sprite.particles.length; idx++) {\n    p = sprite.particles[idx];\n\n    if (!sprite.stop && p.free) {\n\n      p.velocity = sprite.maxVelocity * Math.random();\n      p.angle = (Math.PI * 2) * Math.random();\n      p.dx = 0 - (p.velocity * Math.sin(p.angle));\n      p.dy = p.velocity * Math.cos(p.angle);\n      p.distance = p.x = p.y = 0;\n      p.maxDistance = sprite.radius * Math.random();\n      p.size = sprite.maxParticleSize;\n      p.free = false;\n\n    } else if (!p.free) {\n\n      p.x += p.dx * timeDelta;\n      p.y += p.dy * timeDelta;\n\n      p.distance += p.velocity * timeDelta;\n      if (p.distance >= p.maxDistance) {\n        p.distance = p.maxDistance;\n        p.free = true;\n      }\n\n    }\n\n  }\n\n  sprite.age += timeDelta;\n\n  if (sprite.age >= sprite.ttl) {\n    sprite.stop = true;\n  }\n\n  sprite.alpha = Math.max(0, 1 - (sprite.age / sprite.ttl));\n\n  g.clear();\n\n  for (idx = 0; idx < sprite.particles.length; idx++) {\n    p = sprite.particles[idx];\n    if (p.free) { continue; }\n\n    g.lineStyle(5 / (sprite.size / 100), sprite.color,\n      (1 - (p.distance / p.maxDistance)) * sprite.alpha);\n    g.moveTo(0, 0);\n    g.lineTo(p.x, p.y);\n  }\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/viewportPixi.js","\"use strict\";\n\nexports.__esModule = true;\n\nvar _from = require(\"../core-js/array/from\");\n\nvar _from2 = _interopRequireDefault(_from);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = function (arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return (0, _from2.default)(arr);\n  }\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/helpers/toConsumableArray.js\n// module id = 172\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/array/from\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/array/from.js\n// module id = 173\n// module chunks = 7","require('../../modules/es6.string.iterator');\nrequire('../../modules/es6.array.from');\nmodule.exports = require('../../modules/_core').Array.from;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/array/from.js\n// module id = 174\n// module chunks = 7","'use strict';\nvar ctx = require('./_ctx');\nvar $export = require('./_export');\nvar toObject = require('./_to-object');\nvar call = require('./_iter-call');\nvar isArrayIter = require('./_is-array-iter');\nvar toLength = require('./_to-length');\nvar createProperty = require('./_create-property');\nvar getIterFn = require('./core.get-iterator-method');\n\n$export($export.S + $export.F * !require('./_iter-detect')(function (iter) { Array.from(iter); }), 'Array', {\n  // 22.1.2.1 Array.from(arrayLike, mapfn = undefined, thisArg = undefined)\n  from: function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n    var O = toObject(arrayLike);\n    var C = typeof this == 'function' ? this : Array;\n    var aLen = arguments.length;\n    var mapfn = aLen > 1 ? arguments[1] : undefined;\n    var mapping = mapfn !== undefined;\n    var index = 0;\n    var iterFn = getIterFn(O);\n    var length, result, step, iterator;\n    if (mapping) mapfn = ctx(mapfn, aLen > 2 ? arguments[2] : undefined, 2);\n    // if object isn't iterable or it's array with default iterator - use simple case\n    if (iterFn != undefined && !(C == Array && isArrayIter(iterFn))) {\n      for (iterator = iterFn.call(O), result = new C(); !(step = iterator.next()).done; index++) {\n        createProperty(result, index, mapping ? call(iterator, mapfn, [step.value, index], true) : step.value);\n      }\n    } else {\n      length = toLength(O.length);\n      for (result = new C(length); length > index; index++) {\n        createProperty(result, index, mapping ? mapfn(O[index], index) : O[index]);\n      }\n    }\n    result.length = index;\n    return result;\n  }\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.array.from.js\n// module id = 175\n// module chunks = 7","'use strict';\nvar $defineProperty = require('./_object-dp');\nvar createDesc = require('./_property-desc');\n\nmodule.exports = function (object, index, value) {\n  if (index in object) $defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_create-property.js\n// module id = 176\n// module chunks = 7","var ITERATOR = require('./_wks')('iterator');\nvar SAFE_CLOSING = false;\n\ntry {\n  var riter = [7][ITERATOR]();\n  riter['return'] = function () { SAFE_CLOSING = true; };\n  // eslint-disable-next-line no-throw-literal\n  Array.from(riter, function () { throw 2; });\n} catch (e) { /* empty */ }\n\nmodule.exports = function (exec, skipClosing) {\n  if (!skipClosing && !SAFE_CLOSING) return false;\n  var safe = false;\n  try {\n    var arr = [7];\n    var iter = arr[ITERATOR]();\n    iter.next = function () { return { done: safe = true }; };\n    arr[ITERATOR] = function () { return iter; };\n    exec(arr);\n  } catch (e) { /* empty */ }\n  return safe;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_iter-detect.js\n// module id = 177\n// module chunks = 7","module.exports = { \"default\": require(\"core-js/library/fn/object/values\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/values.js\n// module id = 178\n// module chunks = 7","require('../../modules/es7.object.values');\nmodule.exports = require('../../modules/_core').Object.values;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/values.js\n// module id = 179\n// module chunks = 7","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es7.object.values.js\n// module id = 180\n// module chunks = 7"],"sourceRoot":""}